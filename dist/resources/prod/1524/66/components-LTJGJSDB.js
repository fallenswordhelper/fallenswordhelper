import{a as He,b as Ue,c as We}from"./chunk-CVQZXUFM.js";import"./chunk-KTJNAJHL.js";import{a as Ve}from"./chunk-N6YA7UBS.js";import{a as Re}from"./chunk-QYKTX7K2.js";import{a as z}from"./chunk-73OARAJ4.js";import{a as Pe}from"./chunk-YQ4BED3J.js";import"./chunk-YJVBIGD3.js";import{a as V}from"./chunk-2OMMRFOM.js";import"./chunk-WPQM6NGY.js";import"./chunk-2DWXCWIM.js";import{B as ne,D as K,I as re,J as le,M as P,N as R,O as h,P as v,R as xe,S as Ne,V as M,W as Q,X as x,Y as F,Z as G,a as D,d as U,e as se,g as Me,h as te,m as W,o as u,p as y,q as C,r as Qe,s as g,t as A,u as B,v as oe,z as E}from"./chunk-4MM6RLJ7.js";import{a as ie}from"./chunk-6TB3RDXS.js";import{a as je}from"./chunk-7P7Q4VHF.js";import{a as Le}from"./chunk-REBGK4RZ.js";import{a as Ie}from"./chunk-H222GJ44.js";import{a as ee}from"./chunk-HMVU6YYT.js";import{a as Be}from"./chunk-YZ2VIXA6.js";import"./chunk-C4L2DL62.js";import{a as L}from"./chunk-AMIV6VU6.js";import{a as Z}from"./chunk-CQI4LTJC.js";import"./chunk-DREXNAOH.js";import{a as De}from"./chunk-VOWLBX22.js";import"./chunk-IPCPLARM.js";import{a as Ae}from"./chunk-H3CO5HSE.js";import{a as J}from"./chunk-ODQJYK6Y.js";import{a as Se}from"./chunk-SMGTENZD.js";import{a as Y}from"./chunk-Q3PN54RS.js";import{a as ce}from"./chunk-DO7SCVXY.js";import{a as X}from"./chunk-HNI63WVA.js";import"./chunk-KE767BLN.js";import{a as qe}from"./chunk-TUVTWIHM.js";import"./chunk-4ATHPVF4.js";import"./chunk-RTMHI3L7.js";import"./chunk-IWE7LPGP.js";import{a as ve}from"./chunk-VWFYI5BK.js";import"./chunk-QVWAWWED.js";import"./chunk-PYHGZC4L.js";import{a as we}from"./chunk-D76XH5RX.js";import{a as j}from"./chunk-MA3AC62H.js";import"./chunk-DTSXLBNB.js";import"./chunk-NCV3HP3S.js";import{a as Ee}from"./chunk-YG74QOJP.js";import"./chunk-STY5NEH4.js";import"./chunk-M7Q5FD7X.js";import"./chunk-K2U7JEMX.js";import{a as Te}from"./chunk-VCDLAVQZ.js";import"./chunk-PUAVFQTB.js";import{b as ye,i as Ce}from"./chunk-OHKPSLFK.js";import"./chunk-EJREXK3Y.js";var N=He(new Map),Fe=Ue(N,t=>[...t].reduce((e,[,o])=>e+(o.get("del")?.length??0),0));function it(t){let e;return{c(){e=g("tr"),e.innerHTML='<td class="compDel svelte-1qoer4b" colspan="3">Deleted</td>'},m(o,n){y(o,e,n)},p:D,i:D,o:D,d(o){o&&C(e)}}}function ct(t){let e,o,n,r,l,s,i,$=t[0].get("del").length+"",p,a,f,k,w,m,d=[at,st],_=[];function T(c,I){return I&1&&(f=null),f==null&&(f=!!c[0].get("delPending")),f?0:1}return k=T(t,-1),w=_[k]=d[k](t),{c(){e=g("tr"),o=g("td"),n=g("img"),s=B(),i=g("td"),p=A($),a=B(),w.c(),se(n.src,r=t[1](t[0]))||E(n,"src",r),E(n,"class","tip-dynamic"),E(n,"data-tipped",l=t[2](t[0])),E(n,"alt","component")},m(c,I){y(c,e,I),u(e,o),u(o,n),u(e,s),u(e,i),u(i,p),u(e,a),_[k].m(e,null),m=!0},p(c,I){(!m||I&1&&!se(n.src,r=c[1](c[0])))&&E(n,"src",r),(!m||I&1&&l!==(l=c[2](c[0])))&&E(n,"data-tipped",l),(!m||I&1)&&$!==($=c[0].get("del").length+"")&&ne(p,$);let b=k;k=T(c,I),k===b?_[k].p(c,I):(P(),v(_[b],1,1,()=>{_[b]=null}),R(),w=_[k],w?w.p(c,I):(w=_[k]=d[k](c),w.c()),h(w,1),w.m(e,null))},i(c){m||(h(w),m=!0)},o(c){v(w),m=!1},d(c){c&&C(e),_[k].d()}}}function st(t){let e,o,n;return o=new V({props:{$$slots:{default:[pt]},$$scope:{ctx:t}}}),o.$on("click",W(t[3])),{c(){e=g("td"),M(o.$$.fragment)},m(r,l){y(r,e,l),Q(o,e,null),n=!0},p(r,l){let s={};l&256&&(s.$$scope={dirty:l,ctx:r}),o.$set(s)},i(r){n||(h(o.$$.fragment,r),n=!0)},o(r){v(o.$$.fragment,r),n=!1},d(r){r&&C(e),x(o)}}}function at(t){let e;return{c(){e=g("td"),e.innerHTML='<span class="fshSpinner fshSpinner12"></span>',E(e,"class","compSumSpin")},m(o,n){y(o,e,n)},p:D,i:D,o:D,d(o){o&&C(e)}}}function pt(t){let e;return{c(){e=A("Del")},m(o,n){y(o,e,n)},d(o){o&&C(e)}}}function ft(t){let e,o,n,r,l,s=[ct,it],i=[];function $(p,a){return a&1&&(e=null),e==null&&(e=!!p[0].get("del").length),e?0:1}return o=$(t,-1),n=i[o]=s[o](t),{c(){n.c(),r=oe()},m(p,a){i[o].m(p,a),y(p,r,a),l=!0},p(p,[a]){let f=o;o=$(p,a),o===f?i[o].p(p,a):(P(),v(i[f],1,1,()=>{i[f]=null}),R(),n=i[o],n?n.p(p,a):(n=i[o]=s[o](p),n.c()),h(n,1),n.m(r.parentNode,r))},i(p){l||(h(n),l=!0)},o(p){v(n),l=!1},d(p){i[o].d(p),p&&C(r)}}}function mt(t,e,o){let n;te(t,N,f=>o(5,n=f));let{itemId:r}=e,l=re(),s=Ie(),i=f=>`${ye}items/${f.get("b")}.gif`,$=f=>`fetchitem.php?item_id=${f.get("b")}&inv_id=${f.get("a")}&t=2&p=${s}&vcode=${f.get("v")}`,p;function a(){L("components","delType"),l("delType",r)}return t.$$set=f=>{"itemId"in f&&o(4,r=f.itemId)},t.$$.update=()=>{if(t.$$.dirty&48){e:o(0,p=n.get(r))}},[p,i,$,a,r,n]}var Ge=class extends G{constructor(e){super();F(this,e,mt,ft,U,{itemId:4})}},ze=Ge;var ut=/\?item_id=(\d+)&inv_id=(\d+)&.*&vcode=([0-9a-f]+)/;function dt(t){let e=t.children[0].dataset.tipped.match(ut);return{a:Number(e[2]),b:Number(e[1]),v:e[3]}}var _t=t=>qe(t.href),bt=t=>J('a[href*="=destroycomponent&"]',t).map(dt),gt=t=>Se('td[background*="/1x1mini."]',t).length;function ht(t){let e=ce(t);return J('a[href*="profile&component_page="]',e).slice(1).map(_t)}function kt(t){let e=Array(57);return e[56]={k:56,v:t.map(gt).reduce(Ve,0)},{p:e}}var $t=t=>({h:kt(t),r:t.flatMap(bt),s:!0});async function ae(){let t=await X({cmd:"profile"}),e=await Y([t,...ht(t)]);return $t(e.map(ce))}function pe(){return ee({subcmd:"loadcomponents"})}function fe(){return Z(pe,ae)}async function me(t){let e=await t();if(!e?.s)throw new Error(e?.e?.message??"Unknown Error");return e}function ue(t){return new Map(we(t))}function Je(t){t[4]=t[6].rollup,t[5]=t[6].maxComp}function Ke(t,e,o){let n=t.slice();return n[7]=e[o],n}function vt(t){let e,o=t[10].message+"",n;return{c(){e=g("p"),n=A(o),K(e,"color","red")},m(r,l){y(r,e,l),u(e,n)},p:D,i:D,o:D,d(r){r&&C(e)}}}function yt(t){Je(t);let e,o,n,r,l,s,i,$,p,a,f,k,w,m=t[5]+"",d,_,T=t[4],c=[];for(let b=0;b<T.length;b+=1)c[b]=Oe(Ke(t,T,b));let I=b=>v(c[b],1,1,()=>{c[b]=null});return{c(){e=g("div"),o=g("table"),n=g("thead"),n.innerHTML='<tr><th colspan="3">Component Summary</th></tr>',r=B(),l=g("tbody");for(let b=0;b<c.length;b+=1)c[b].c();s=B(),i=g("tfoot"),$=g("tr"),p=g("td"),p.textContent="Total:",a=B(),f=g("td"),k=A(t[0]),w=A(" / "),d=A(m),E(f,"colspan","2"),E(o,"class","fshTblCenter")},m(b,q){y(b,e,q),u(e,o),u(o,n),u(o,r),u(o,l);for(let S=0;S<c.length;S+=1)c[S].m(l,null);u(o,s),u(o,i),u(i,$),u($,p),u($,a),u($,f),u(f,k),u(f,w),u(f,d),_=!0},p(b,q){if(Je(b),q&2){T=b[4];let S;for(S=0;S<T.length;S+=1){let $e=Ke(b,T,S);c[S]?(c[S].p($e,q),h(c[S],1)):(c[S]=Oe($e),c[S].c(),h(c[S],1),c[S].m(l,null))}for(P(),S=T.length;S<c.length;S+=1)I(S);R()}(!_||q&1)&&ne(k,b[0])},i(b){if(!_){for(let q=0;q<T.length;q+=1)h(c[q]);_=!0}},o(b){c=c.filter(Boolean);for(let q=0;q<c.length;q+=1)v(c[q]);_=!1},d(b){b&&C(e),Qe(c,b)}}}function Oe(t){let e,o;return e=new ze({props:{itemId:t[7]}}),e.$on("delType",t[2]),{c(){M(e.$$.fragment)},m(n,r){Q(e,n,r),o=!0},p:D,i(n){o||(h(e.$$.fragment,n),o=!0)},o(n){v(e.$$.fragment,n),o=!1},d(n){x(e,n)}}}function Ct(t){let e;return{c(){e=g("div"),e.innerHTML='<span class="fshSpinner fshSpinner12"></span>',E(e,"class","compSumSpin")},m(o,n){y(o,e,n)},p:D,i:D,o:D,d(o){o&&C(e)}}}function St(t){let e,o,n,r={ctx:t,current:null,token:null,hasCatch:!0,pending:Ct,then:yt,catch:vt,value:6,error:10,blocks:[,,,]};return xe(o=t[1](),r),{c(){e=oe(),r.block.c()},m(l,s){y(l,e,s),r.block.m(l,r.anchor=s),r.mount=()=>e.parentNode,r.anchor=e,n=!0},p(l,[s]){t=l,Ne(r,t,s)},i(l){n||(h(r.block),n=!0)},o(l){for(let s=0;s<3;s+=1){let i=r.blocks[s];v(i)}n=!1},d(l){l&&C(e),r.block.d(l),r.token=null,r=null}}}function wt(t,e,o){let n;te(t,Fe,i=>o(0,n=i));function r(i){let $=new Map(ie(i,"b").map(p=>[p.b,ue({...p,del:i.filter(({b:a})=>a===p.b).map(({a})=>a),delPending:!1})]));return N.set($),[...$.keys()]}async function l(){let i=await me(fe);return{rollup:r(i.r),maxComp:i.h?.p[56]?.v}}function s(i){le.call(this,t,i)}return[n,l,s]}var Xe=class extends G{constructor(e){super();F(this,e,wt,St,U,{})}},Ye=Xe;function Ze(t){let e,o,n;return o=new V({props:{$$slots:{default:[Dt]},$$scope:{ctx:t}}}),o.$on("click",W(t[2])),{c(){e=g("div"),M(o.$$.fragment)},m(r,l){y(r,e,l),Q(o,e,null),n=!0},p(r,l){let s={};l&256&&(s.$$scope={dirty:l,ctx:r}),o.$set(s)},i(r){n||(h(o.$$.fragment,r),n=!0)},o(r){v(o.$$.fragment,r),n=!1},d(r){r&&C(e),x(o)}}}function Dt(t){let e;return{c(){e=A("Enable Quick Del")},m(o,n){y(o,e,n)},d(o){o&&C(e)}}}function Tt(t){let e,o;return e=new Ye({}),e.$on("delType",t[6]),{c(){M(e.$$.fragment)},m(n,r){Q(e,n,r),o=!0},p:D,i(n){o||(h(e.$$.fragment,n),o=!0)},o(n){v(e.$$.fragment,n),o=!1},d(n){x(e,n)}}}function Et(t){let e,o,n;return o=new V({props:{$$slots:{default:[qt]},$$scope:{ctx:t}}}),o.$on("click",W(t[3])),{c(){e=g("div"),M(o.$$.fragment)},m(r,l){y(r,e,l),Q(o,e,null),n=!0},p(r,l){let s={};l&256&&(s.$$scope={dirty:l,ctx:r}),o.$set(s)},i(r){n||(h(o.$$.fragment,r),n=!0)},o(r){v(o.$$.fragment,r),n=!1},d(r){r&&C(e),x(o)}}}function qt(t){let e;return{c(){e=A("Count Components")},m(o,n){y(o,e,n)},d(o){o&&C(e)}}}function At(t){let e;return{c(){e=A("Quick Extract")},m(o,n){y(o,e,n)},d(o){o&&C(e)}}}function et(t){let e,o,n,r;return o=new V({props:{$$slots:{default:[It]},$$scope:{ctx:t}}}),o.$on("click",W(t[5])),{c(){e=g("div"),n=g("div"),M(o.$$.fragment),K(n,"display","contents"),K(n,"--button-color","red")},m(l,s){y(l,e,s),u(e,n),Q(o,n,null),r=!0},p(l,s){let i={};s&256&&(i.$$scope={dirty:s,ctx:l}),o.$set(i)},i(l){r||(h(o.$$.fragment,l),r=!0)},o(l){v(o.$$.fragment,l),r=!1},d(l){l&&C(e),x(o)}}}function It(t){let e;return{c(){e=A("Delete All Visible")},m(o,n){y(o,e,n)},d(o){o&&C(e)}}}function Bt(t){let e,o,n,r,l,s,i,$,p,a=!t[0]&&Ze(t),f=[Et,Tt],k=[];function w(d,_){return d[1]?1:0}n=w(t,-1),r=k[n]=f[n](t),i=new V({props:{$$slots:{default:[At]},$$scope:{ctx:t}}}),i.$on("click",t[4]);let m=t[0]&&et(t);return{c(){e=g("div"),a&&a.c(),o=B(),r.c(),l=B(),s=g("div"),M(i.$$.fragment),$=B(),m&&m.c(),E(e,"class","fshCenter")},m(d,_){y(d,e,_),a&&a.m(e,null),u(e,o),k[n].m(e,null),u(e,l),u(e,s),Q(i,s,null),u(e,$),m&&m.m(e,null),p=!0},p(d,[_]){d[0]?a&&(P(),v(a,1,1,()=>{a=null}),R()):a?(a.p(d,_),_&1&&h(a,1)):(a=Ze(d),a.c(),h(a,1),a.m(e,o));let T=n;n=w(d,_),n===T?k[n].p(d,_):(P(),v(k[T],1,1,()=>{k[T]=null}),R(),r=k[n],r?r.p(d,_):(r=k[n]=f[n](d),r.c()),h(r,1),r.m(e,l));let c={};_&256&&(c.$$scope={dirty:_,ctx:d}),i.$set(c),d[0]?m?(m.p(d,_),_&1&&h(m,1)):(m=et(d),m.c(),h(m,1),m.m(e,null)):m&&(P(),v(m,1,1,()=>{m=null}),R())},i(d){p||(h(a),h(r),h(i.$$.fragment,d),h(m),p=!0)},o(d){v(a),v(r),v(i.$$.fragment,d),v(m),p=!1},d(d){d&&C(e),a&&a.d(),k[n].d(),x(i),m&&m.d()}}}function Mt(t,e,o){let n,r,l=re();function s(){L("components","enableQuickDel"),o(0,n=!0),l("enableQuickDel")}function i(){L("components","countComponents"),o(1,r=!0)}function $(){L("components","insertQuickExtract"),je()}function p(){L("components","deleteAllVisible"),l("deleteAllVisible")}function a(f){le.call(this,t,f)}return[n,r,s,i,$,p,a]}var tt=class extends G{constructor(e){super();F(this,e,Mt,Bt,U,{})}},ot=tt;function de(t){return ee({subcmd:"destroycomponent",removeIndex:t})}function Qt(t,e){let o=Be(e),n=1;return o==="Component destroyed."&&(n=0),{r:n,m:o,c:t}}function xt(t){return X({cmd:"profile",subcmd:"destroycomponent",component_id:t}).then(j(Qt,t))}function Nt(t){let e=t.filter(n=>n.r===0),o=t.filter(n=>n.r===1);return e.length>0?{r:e.map(n=>n.c),s:!0}:o.length>0?{e:{message:o[0].m},s:!1}:{e:{message:t[0].m},s:!1}}function _e(t){return Pe(t.map(xt),Nt)}function be(t){return Z(de,_e,t)}function jt(t,e){if(!e)return;let o=e.get("del").filter(n=>!t.includes(n));e.set("del",o)}function Lt(t,e){N.update(o=>(jt(e,o.get(t)),o))}function Pt(t,e,o){N.update(n=>(n.get(t)?.set(e,o),n))}function Rt(t){if(!t)return;let e=t.children[0];return e.replaceWith(De({className:"compSumSpin",innerHTML:'<span class="fshSpinner fshSpinner12"></span>'})),e}function nt(t,e){Pt(e,"delPending",t)}function Vt(t){t.forEach(([e,o])=>{o&&e.children[0].replaceWith(o)})}var Ht=t=>t.forEach(([e])=>e?.children[0]?.remove()),Ut=t=>t.map(([e])=>[e,Rt(e)]),Wt=([,t])=>t,rt=t=>ie(t.map(Wt)),lt=([,,t])=>t,Ft=t=>rt(t).map(e=>[e,t.filter(([,o])=>o===e).map(lt)]),Gt=t=>Lt(...t);async function zt(t){let e=Ut(t),o=await be(t.map(lt));o?.s?(Ft(t).forEach(Gt),Ht(e)):(We(o?.e?.message??"Unknown Error"),Vt(e))}async function H(t){let e=rt(t);e.forEach(j(nt,!0)),await Y(Re(30,t).map(zt)),e.forEach(j(nt,!1))}var Jt=t=>Me(N).get(t.detail).get("del"),Kt=(t,e)=>z(Ae(`img[data-tipped*="&inv_id=${e}&"]`,t));async function ge(t,e){H(Jt(e).map(o=>[Kt(t,o),e.detail,o]))}function O(t){let e=t.dataset.tipped.match(Ce);return[Number(e[1]),Number(e[2])]}var Ot=t=>[z(t),...O(t)];function he(t){H(J("img",t).map(Ot))}function Xt(t){t.target.tagName==="IMG"&&(t.preventDefault(),L("components","quickDel"),Le(t.target),H([[z(t.target),...O(t.target)]]))}function ke(t){t.classList.add("fshQuickDel"),Ee(t,Xt)}function Yt(){let t=ve("profileRightColumn"),e=Te("inventory-table",t);if(e.length===2)return e[1]}function Zt(){let t=Yt();if(!t)return;let e=new ot({target:t.parentNode});e.$on("enableQuickDel",j(ke,t)),e.$on("delType",j(ge,t)),e.$on("deleteAllVisible",j(he,t))}export{Zt as default};
//# sourceMappingURL=components-LTJGJSDB.js.map
