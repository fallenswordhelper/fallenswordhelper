import{e}from"./executeAll-DIAWIge1.js"
import{ag as t,m as n,g as a,a9 as r,i as o,c as s,v as i,o as l,s as c,aC as u,aE as f,aF as d,aG as m,aH as p,aI as h,y as g,b as v,ai as b,aJ as k,aK as y,aL as w,aM as C,aN as L,ae as D,k as V,aO as M,q as x,aP as A,aQ as S,aR as N,aS as H,D as B,aT as T,aU as E,aV as G,aW as P,aX as j,aY as R,aZ as _,a_ as F,a$ as I,b0 as O,b1 as W,aj as q,a8 as K,b2 as Y,b3 as z,b4 as U,a as Q,$ as J,S as X,L as Z,M as ee,am as te,T as ne,a0 as ae,a1 as re,O as oe,a4 as se,b5 as ie,U as le,a5 as ce,N as ue,P as fe,Q as de,b6 as me,b7 as pe,b8 as he,b9 as ge,Z as ve,_ as be,X as ke,ba as ye,d as we,ap as Ce,bb as $e,bc as Le,bd as De,E as Ve,be as Me,bf as xe,bg as Ae,bh as Se,bi as Ne,bj as He,bk as Be,bl as Te,bm as Ee,bn as Ge,bo as Pe,bp as je,bq as Re,br as _e,bs as Fe,bt as Ie,bu as Oe,bv as We,bw as qe,bx as Ke,by as Ye,bz as ze,bA as Ue,bB as Qe,bC as Je,bD as Xe,bE as Ze,bF as et,bG as tt,bH as nt,bI as at,bJ as rt,bK as ot,bL as st,bM as it,ah as lt}from"./calfSystem-KuDT30_2.js"
import{i as ct}from"./insertElementAfter-D5EF1yqq.js"
import{t as ut}from"./toggleForce-br4z9gGd.js"
import{c as ft}from"./createSpan-C30Y7sS2.js"
import{i as dt}from"./insertTextBeforeEnd-MysPxmZE.js"
import{r as mt,a as pt}from"./roundToString-Hif1MLyB.js"
import{a as ht}from"./addCommas-C_h2HN8s.js"
import{d as gt,q as vt}from"./quickbuffSuccess-Ddf_trJ1.js"
import{c as bt}from"./createButton-C7jaVjSz.js"
import{i as kt}from"./isArray-eVldfhw1.js"
import{o as yt}from"./openQuickBuffById-BBkCBFOh.js"
import{c as wt}from"./createInput-BYjEUt90.js"
import{c as Ct}from"./createLabel-CHNzJaaO.js"
import{r as $t}from"./rnd-D_QmA-Fa.js"
import{v as Lt}from"./valueText-DmqsoxRt.js"
import{c as Dt}from"./createStyle-DFJFrzGF.js"
import{h as Vt,u as Mt}from"./await_block-BmB8vVOj.js"
import{u as xt}from"./uniq-DDHnmX2G.js"
import{g as At}from"./guild-CXX8zghN.js"
import{c as St}from"./createTable-BnO729BN.js"
import{g as Nt,t as Ht,a as Bt}from"./getTitanString-DvEb_zLX.js"
import{p as Tt}from"./padZ-DFV6JBPu.js"
import{f as Et}from"./fshOpen-AuKioUPF.js"
import{L as Gt}from"./LinkButton-DOtoHB7L.js"
import{r as Pt}from"./reduceBuffArray-Diy1E3zc.js"
import{p as jt}from"./profile-fEGJmCcT.js"
import{a as Rt}from"./all-YfMtr2SN.js"
import{n as _t}from"./numberIsNaN-CGkd1jiA.js"
import{r as Ft}from"./reliclist-1bigAyqH.js"
import{d as It}from"./daGroupStats-CdYZszxD.js"
import{d as Ot,m as Wt}from"./mercEffect-C_KSnHGh.js"
import{d as qt}from"./daViewGroups-Bdvqyi5t.js"
import{a as Kt}from"./attribsToArray-K1vu8rR9.js"
import{g as Yt}from"./guildMembers-BI7B-WBZ.js"
import{r as zt}from"./remainingPages-BzskAxSU.js"
import{t as Ut}from"./testQuant-CUL735o8.js"
import{m as Qt}from"./myStats-D85E22gh.js"
import{s as Jt}from"./shouldBeArray-1GGu5onE.js"
import{s as Xt,j as Zt}from"./simpleCheckbox-m5XXnXYd.js"
import{i as en}from"./isSelected-BWnMzKlW.js"
import{b as tn}from"./bitwiseAnd-C5gmj-aX.js"
import"./buffReportParser-Cmj6gA7T.js"
import"./buffObj-BIwiFUIW.js"
import"./guildGroups-BcuFiNat.js"
import"./view-C0Bb7fTF.js"
import"./intValue-C7nTQec1.js"
import"./csvSplit-4xUWBldR.js"
import"./isChecked-D_0do7nT.js"
let nn=0
function an(e){return e}function rn(e){if(function(e){return t.showBuffInfo&&e.some(an)}(e))return function(){if(nn)ut(nn,!1)
else{nn=n({className:"fshActionBox",innerHTML:"<div></div><div></div><div></div><div></div><div></div>"})
const e=a("actionContainer")
ct(nn,e.children[2])}return nn}()
nn&&ut(nn,!0)}function on(e,t,n,a){t&&(e.className=t),r(n,e)
const s=ft()
return o(e,s),dt(e,a),s}let sn=0,ln=0
function cn(e,t){sn?ut(sn,!1):function(e){sn=e.children[3],ln=on(sn,"fshBlue","CA "," active")}(e),r(t.level,ln)}function un(e,t){t?cn(e,t):sn&&ut(sn,!0)}let fn=0,dn=0
function mn(e,t){fn?ut(fn,!1):function(e){fn=e.children[4],dn=on(fn,"fshRed","Doubler "," active")}(e),r(t.level,dn)}function pn(e,t){t?mn(e,t):fn&&ut(fn,!0)}let hn=0,gn=0
function vn(e,t,n){hn?ut(hn,!1):function(e){hn=e.children[2],gn=on(hn,"","Damage bonus: ","%")}(e),r(function(e,t){if(e){const n=Math.min(.01*Math.round(Math.floor(t/5)*Number(e.level)),20)
return mt(n,2).toString()}return"0"}(t,Number(n)),gn)}function bn(e,t,n){t?vn(e,t,n):hn&&ut(hn,!0)}let kn=0,yn=0
function wn(e,t){kn?ut(kn,!1):function(e){kn=e.children[1],yn=on(kn,"","Kill Streak: ","")}(e),function(e,t){r(ht(e),t)}(t,yn)}function Cn(e,t,n,a){t||n?wn(e,a):kn&&ut(kn,!0)}function $n(e,t){return t.name===e}function Ln(e){const{buffs:t}=GameData.player()
if(t)return t.find(s($n,e))}const Dn=["red","orange","yellow"]
let Vn=0,Mn=0
async function xn(){if(c("NewMap","recastClick"),Ln("Summon Shield Imp"))return
!function(e){vt(e)&&GameData.fetch(f)}(await gt([u()],[55]))}const An=["imp-0","imp-1","imp-1"]
function Sn(e,t){Vn?ut(Vn,!1):function(e){[Vn]=e.children,r("Shield Imps Remaining: ",Vn),Mn=ft(),o(Vn,Mn),i(Vn,"&nbsp;")
const t=bt({className:"xSmallLink",textContent:"Recast"})
o(Vn,t),l(t,xn)}(e)
const n=function(e){return e?Number(e.stack):0}(t)
Vn.className=function(e){return An[e]??"fshGreen"}(n),r(n,Mn)}function Nn(e,t,n){t||n?Sn(e,t):Vn&&ut(Vn,!0)}function Hn(e){return 0===e.type}let Bn=0,Tn=0,En=0,Gn=0,Pn=0,jn=0
function Rn(){Bn=Ln("Death Dealer"),Tn=Ln("Doubler"),En=Ln("Counter Attack"),Gn=Ln("Summon Shield Imp"),Pn=function(){const{dynamic:e}=GameData.realm()
return kt(e)&&e.some(Hn)}(),jn=GameData.player().killStreak}function _n(){!function(){const e=$("#actionlist-shield-imp")
1===e.length&&e.css("background-color",Dn[e.text()]||"#ad8043")}(),Rn()
const e=rn([Bn,Tn,En,Gn,Pn])
e&&(Nn(e,Gn,Bn),Cn(e,Bn,Pn,jn),bn(e,Bn,jn),un(e,En),pn(e,Tn))}function Fn(e){return ft({textContent:e})}function In(){window.GameController&&GameController.Realm&&!GameController.Realm.footprintTileList&&(GameController.Realm.footprintTileList=[])}function On(e,t,n){return Ct({className:`fshCurveEle fshCurveLbl fshPoint tip-static ${e}`,dataset:{tipped:t},htmlFor:n})}function Wn(e){const t=n({className:"fshToggle"}),a=wt({checked:e.prefVal,id:e.checkId,type:"checkbox"})
o(t,a)
const r=On(e.onClass,e.onTip,e.checkId)
o(t,r)
const s=On(e.offClass,e.offTip,e.checkId)
return o(t,s),o(e.worldName,t),a}let qn=0,Kn=0,Yn=0,zn=0,Un=0,Qn=0,Jn=0,Xn=0,Zn=0
const ea=e=>Fn(e?e.toString():"?")
function ta(e,t,a){const r=n({textContent:`${t} Lvl: `})
o(r,a),o(e,r)}function na(e,t,n){const a=bt({className:`fshCurveEle fshCurveBtn fshPoint tip-static ${e}`,dataset:{tipped:t}})
return o(n,a),a}function aa(e){!function(e){const t=n({className:"fshFsty"})
Kn=ea(GameData.realm().minlevel),ta(t,"Min",Kn),Yn=ea(GameData.player().level),ta(t,"Your",Yn),o(e,t)}(e),zn=na("fshFormGroup","Quick Create Attack Group",e),Un=na("fshQuickBuff","Open Quick Buff Popup",e),Qn=na("fshRealmMap","Open Realm Map",e),Jn=na("fshTempleOne","Search map in Ultimate FSG",e)}function ra(){aa(qn),function(e){if(b("showSpeakerOnWorld")){const t=b("playNewMessageSound")
Xn=Wn({prefVal:t,checkId:"fshSoundCheck",onClass:"soundOn",onTip:"Turn Off Sound when you have a new log message",offClass:"soundOff",offTip:"Turn On Sound when you have a new log message",worldName:e})}}(qn),function(e){const n=t.huntingMode
Zn=Wn({prefVal:n,checkId:"fshHuntCheck",onClass:"huntOn",onTip:"Hunting mode is ON",offClass:"huntOff",offTip:"Hunting mode is OFF",worldName:e})}(qn)}const oa=[[()=>Xn,function(){c("NewMap","toggleSound"),D("playNewMessageSound",!b("playNewMessageSound"))}],[()=>Zn,function(){c("NewMap","toggleHuntMode"),t.huntingMode=!t.huntingMode,D("huntingMode",t.huntingMode)}]],sa=[[()=>zn,function(e){c("NewMap","doFormGroup"),k(e),GameData.doAction(12,401,{},0)}],[()=>Un,function(){c("NewMap","openQuickBuff"),yt(y())}],[()=>Qn,function(){c("NewMap","openRealmMap"),window.open(`${w+C}map`,"fsMap")}],[()=>Jn,function(){c("NewMap","openUfsgMap")
const e=GameData.realm()
window.open(`${L}realms${C}view&realm_id=${e.id}`,"mapUfsg")}]]
function ia(e,t){const{target:n}=t,[,a]=e.find((([e])=>e()===n))??[]
a&&(n.blur(),a(n))}function la(e){return s(ia,e)}function ca(){qn||(qn=n({className:"fshCurveContainer",id:"fshWorldButtonContainer"}),ra(),l(qn,la(sa)),v(qn,"change",la(oa)),g(qn,a("worldCoord")))}function ua(e,t){Kn&&t.b.minlevel&&(In(),r(t.b.minlevel,Kn))}function fa(e,t){Yn&&r(t.b,Yn)}const da=["NORMAL","CHAMPION","ELITE","SUPER ELITE","TITAN","LEGENDARY"],ma=`url("${A}ui/world/icon_action_attack_`
let pa=!1
function ha(e){return x(".verb.attack",e)}function ga(e){const t=da.indexOf(e.toUpperCase())
return V(`#actionList .actionListItem.creature.creature-${t}`)}function va(e){e.classList.remove("attack-1","attack-2","attack-3","attack-4","attack-5","attack-6","attack-7","attack-8"),e.style.backgroundImage=""}function ba(e,t){null!==e&&(e.classList.add(`attack-${t+1}`),e.style.backgroundImage=`${ma}${t+1}.png")`)}function ka(e){const t=["LEGENDARY","NORMAL"].flatMap(ga),n=ga("CHAMPION"),[a,r]=e?[t,n]:[n,t]
a.map(ha).filter((e=>null!==e)).forEach(va),r.slice(0,8).map(ha).forEach(ba)}function ya(e){if(!e.altKey||!e.shiftKey||"INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName)return
if(pa||ka(!0),pa=!0,!/(?:Digit|Numpad)[1-8]/.test(e.code))return
const t=ga("CHAMPION"),n=parseInt(e.code.slice(-1),10)-1
n<t.length&&function(e){const t=ha(e)
t&&(c("NewMap","ChampionAttack"),M(t))}(t[n])}function wa(e){!pa||e.ctrlKey&&e.shiftKey||(pa=!1,ka(!1))}const Ca=["Breaker","Protection","Master Thief","Protect Gold","Disarm","Duelist","Thievery","Master Blacksmith","Master Crafter","Fury Caster","Master Inventor","Sustain"]
let $a=[],La=0
function Da(e){54!==e.id&&26!==e.id||(La.player.buffs[e.id]=parseInt(e.level,10))}function Va(e){-1===Ca.indexOf(e.name)&&(La.player.enhancements[e.name]=e.value)}function Ma(e){La={},La.combat=e.response.data,La.combat.inventory_id&&(La.combat.drop=La.combat.item.id),La.player={},La.player.buffs={},La.player.enhancements={},function(e){e.player.buffs&&e.player.buffs.forEach(Da)}(e),function(e){e.player.enhancements&&e.player.enhancements.forEach(Va)}(e),La.time=e.time,$a.push(La),H("fsh_combatLog",$a)}function xa(e,t){0===t.response.response&&Ma(t)}function Aa(e){return!e?.response?.data}async function Sa(e){const t=await T({cache:!1,url:"fetchdata.php",data:{...e,fshrnd:$t()},dataType:"text"})
return E(t)??{response:{msg:"Server Error",response:1}}}const Na=[]
const Ha=(e,t)=>e===Number(t.response.data.id)
function Ba(e,t){e(t)}async function Ta(e,t){const n=Na.find(s(Ha,e))
if(n)return function(e){return new Promise((t=>{G(3,Ba,[t,e])}))}(n)
const a=await Sa({a:1,d:0,id:e,passback:t})
return function(e){Aa(e)||Na.push(e)}(a),a}let Ea=0,Ga=0,Pa=0,ja=0,Ra=0,_a=0
const Fa=()=>Ea,Ia=()=>Ga,Oa=()=>Pa,Wa=()=>ja,qa=()=>Ra,Ka=()=>_a
function Ya(e,t){return Lt(P(t,e))}function za(){var e
Ea=GameData.player().level,e=a("statbar-character-tooltip-stats"),Pa=Ya(e,j),Ga=Ya(e,R),Ra=Ya(e,_),ja=Ya(e,F),_a=Ya(e,I)}const Ua=e=>`<td>${e}:&nbsp;</td>`,Qa=e=>`<td width="40%">${e}</td>`
function Ja([e,t,n,a,r]){return[Ua(e),Qa(`${t} (your ${n}:<span class="${a}">${r()}</span>)`)]}function Xa(e){return["<tr>",...e,"</tr>"].join("")}function Za(e,t){return Xa([...Ja(e),...Ja(t)])}const er='<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Enhancements</td></tr>'
function tr(e){return`<tr><td colspan="2">${e.name}:</td><td colspan="2">${e.value}</td></tr>`}function nr(e,t,n){return function(e){return`<table><tr><td><img src="${A}creatures/${e.image_id}.png" height="200" width="200"></td><td rowspan="2"><table width="400"><tr><td class="header" colspan="4" class="fshCenter">Statistics</td></tr>`}(e)+function(e,t){return Xa([Ua("Class"),Qa(e.creature_class),...Ja(["Level",e.level,"level",t,Fa])])}(e,n)+function(e){return Za(["Attack",e.attack,"defense","fshYellow",Ia],["Defense",e.defense,"attack","fshYellow",Oa])}(e)+function(e){return Za(["Armor",e.armor,"damage","fshYellow",Wa],["Damage",e.damage,"armor","fshYellow",qa])}(e)+function(e,t){return Xa([Ua("HP"),Qa(`${e.hp} (your HP:<span class="fshYellow">${Ka()}</span>)(1H: <span class="fshRed">${t}</span>)`),Ua("Gold"),Qa(e.gold)])}(e,t)+er+function(e){return 0===e.enhancements.length?'<tr><td colspan="4">[no enhancements]</td></tr>':e.enhancements.map(tr).join("")}(e)+function(e){return`<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Description</td></tr><tr><td colspan="4">${e.description}</td></tr><tr><td colspan="4" height="5"></td></tr></table></td></tr><tr><td class="fshCenter"><b>${e.name}</b></td></tr></table>`}(e)}function ar(e){if(!Aa(e))return function(e){const n=Math.ceil(e.hp*t.hpVariable+e.armor*t.generalVariable)
let a="fshYellow"
return za(),Fa()>e.level&&(a="fshRed"),nr(e,n,a)}(e.response.data)}const rr=["verb","view","tip-static"]
async function or(e,t){const n=function(e){return O(e.parentNode.children).indexOf(e)}(e),a=await Ta(GameData.actions()[n].data.id,n)
Aa(a)||function(e,t){const n=ar(t)
e.set("content.text",n)}(t,a)}function sr(e,t){c("NewMap","CreatureInfo"),e.classList.add("fshTip")
var n
const a=(n="Loading...",$(e).qtip({overwrite:!0,show:{event:"mouseover",ready:!0},style:{classes:"qtip-tipsy qtip-custom"},position:{my:"center right",at:"center left",effect:!1,viewport:$(window)},content:{text:n},hide:{effect:!1}})).qtip("api")
a&&or(t,a)}function ir(e,t){return n=e,rr.every((e=>B(e,n)))&&!B("fshTip",e)&&B("creature",t)
var n}function lr(e){if(!t.showCreatureInfo)return
const{target:n}=e,a=n.parentNode.parentNode.parentNode
ir(n,a)&&sr(n,a)}function cr(e){return t.doNotKillList.includes(W(e))}function ur(e){e.classList.toggle("fshBlue",cr(K(e)))}function fr(){const e=a("actionList")
q("creature",e).forEach(ur)}function dr(e){const t=GameData.actions()[e]
if(t)return function(e,t){if(cr(e))return c("NewMap","creatureOnList"),a("actionList").children[t].children[0].children[1].classList.remove("loading"),!0}(t.data.name,e)}const mr={2:function(e){return function(t,n,a,r){dr(a.passback)||e(t,n,a,r)}}}
function pr(e){return function(t,n,a,r){const o=mr[t];(function(e){return e&&z(e)})(o)&&function(e){return Y(e)||0===e}(r)?o(e)(t,n,a,r):e(t,n,a,r)}}function hr(){return e={subcmd:"contrib"},Q({cmd:"globalquests",...e})
var e}function gr(e){e[1]=e[2].r}function vr(e,t,n){const a=e.slice()
return a[3]=t[n].player,a[4]=t[n].value,a[6]=n,a}function br(e){let t,n,a=e[7].message+""
return{c(){t=oe("p"),n=se(a),ie(t,"color","red")},m(e,a){ne(e,t,a),le(t,n)},p(e,t){1&t&&a!==(a=e[7].message+"")&&ce(n,a)},d(e){e&&re(t)}}}function kr(e){let t,n
function a(e,n){return 1&n&&(t=null),null==t&&(t=!!kt(e[1])),t?wr:yr}gr(e)
let r=a(e,-1),o=r(e)
return{c(){o.c(),n=te()},m(e,t){o.m(e,t),ne(e,n,t)},p(e,t){gr(e),r===(r=a(e,t))&&o?o.p(e,t):(o.d(1),o=r(e),o&&(o.c(),o.m(n.parentNode,n)))},d(e){e&&re(n),o.d(e)}}}function yr(e){let t
return{c(){t=se("Server Error")},m(e,n){ne(e,t,n)},p:ae,d(e){e&&re(t)}}}function wr(e){let t,n,a,r,o=ue(e[1]),s=[]
for(let t=0;t<o.length;t+=1)s[t]=$r(vr(e,o,t))
return{c(){t=oe("table"),n=oe("tbody"),a=oe("tr"),a.innerHTML='<td class="header"></td> <td class="header"></td> <td class="header">Username</td> <td class="header">Kills</td>',r=fe()
for(let e=0;e<s.length;e+=1)s[e].c()
de(a,"class","svelte-2qtc6g"),de(t,"id","world-event-contrib-table"),de(t,"class","svelte-2qtc6g")},m(e,o){ne(e,t,o),le(t,n),le(n,a),le(n,r)
for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(n,null)},p(e,t){if(1&t){let a
for(o=ue(e[1]),a=0;a<o.length;a+=1){const r=vr(e,o,a)
s[a]?s[a].p(r,t):(s[a]=$r(r),s[a].c(),s[a].m(n,null))}for(;a<s.length;a+=1)s[a].d(1)
s.length=o.length}},d(e){e&&re(t),me(s,e)}}}function Cr(e){let t,n,a,r
return{c(){t=oe("a"),n=oe("img"),he(n.src,a=A+"guilds/"+e[3].guild_id+"_mini.png")||de(n,"src",a),de(n,"alt","guild logo"),de(n,"class","svelte-2qtc6g"),de(t,"href",r=""+(ge+e[3].guild_id))},m(e,a){ne(e,t,a),le(t,n)},p(e,o){1&o&&!he(n.src,a=A+"guilds/"+e[3].guild_id+"_mini.png")&&de(n,"src",a),1&o&&r!==(r=""+(ge+e[3].guild_id))&&de(t,"href",r)},d(e){e&&re(t)}}}function $r(e){let t,n,a,r,o,s,i,l,c,u,f,d,m,p=e[3].name+"",h=e[4]+"",g=e[3].guild_id&&Cr(e)
return{c(){t=oe("tr"),n=oe("td"),n.textContent=`${e[6]+1}`,a=fe(),r=oe("td"),g&&g.c(),o=fe(),s=oe("td"),i=oe("a"),l=se(p),u=fe(),f=oe("td"),d=se(h),m=fe(),de(i,"href",c=""+(pe+e[3].name)),de(t,"class","svelte-2qtc6g")},m(e,c){ne(e,t,c),le(t,n),le(t,a),le(t,r),g&&g.m(r,null),le(t,o),le(t,s),le(s,i),le(i,l),le(t,u),le(t,f),le(f,d),le(t,m)},p(e,t){e[3].guild_id?g?g.p(e,t):(g=Cr(e),g.c(),g.m(r,null)):g&&(g.d(1),g=null),1&t&&p!==(p=e[3].name+"")&&ce(l,p),1&t&&c!==(c=""+(pe+e[3].name))&&de(i,"href",c),1&t&&h!==(h=e[4]+"")&&ce(d,h)},d(e){e&&re(t),g&&g.d()}}}function Lr(e){let t
return{c(){t=se("Loading...")},m(e,n){ne(e,t,n)},p:ae,d(e){e&&re(t)}}}function Dr(e){let t,n,a={ctx:e,current:null,token:null,hasCatch:!0,pending:Lr,then:kr,catch:br,value:2,error:7}
return Vt(n=e[0],a),{c(){t=te(),a.block.c()},m(e,n){ne(e,t,n),a.block.m(e,a.anchor=n),a.mount=()=>t.parentNode,a.anchor=t},p(t,[r]){e=t,a.ctx=e,1&r&&n!==(n=e[0])&&Vt(n,a)||Mt(a,e,r)},i:ae,o:ae,d(e){e&&re(t),a.block.d(e),a.token=null,a=null}}}function Vr(e,t,n){let{promise:a}=t
return e.$$set=e=>{"promise"in e&&n(0,a=e.promise)},[a]}class Mr extends X{constructor(e){super(),Z(this,e,Vr,Dr,ee,{promise:0})}}let xr=0
const Ar=()=>({promise:J(hr)})
function Sr(){c("NewMap","GlobalTop")
const e=a("world-event-contrib")
var t
t=e,xr?xr.$set(Ar()):xr=new Mr({props:Ar(),target:t}),$(e).dialog({title:"Top 100 Event Contributers",minWidth:300,height:300,zIndex:9999})}function Nr(e){$(`#actionList li.creature-${e.toString()} a.create-group`).hide()}const Hr=["hideChampionsGroup","hideElitesGroup","hideSEGroup","hideTitanGroup","hideLegendaryGroup"]
function Br(e,t){var n
b(e)&&(n=t+1,$.subscribe(U,s(Nr,n)),Nr(t+1))}function Tr(e,t,n){const a=e.slice()
return a[9]=t[n].msg,a[10]=t[n].type,a[11]=t[n].count,a}function Er(e){let t,n,a,r=e[11]+""
return{c(){t=oe("div"),n=se("x"),a=se(r),de(t,"class","count svelte-1t9oc1")},m(e,r){ne(e,t,r),le(t,n),le(t,a)},p(e,t){1&t&&r!==(r=e[11]+"")&&ce(a,r)},d(e){e&&re(t)}}}function Gr(e,t){let n,a,r,o,s,i,l,c=t[9]+"",u=t[11]>1&&Er(t)
function f(){return t[3](t[9])}return{key:e,first:null,c(){n=oe("div"),a=se(c),r=fe(),u&&u.c(),o=fe(),de(n,"class",s="fsh-message "+t[10]+" svelte-1t9oc1"),this.first=n},m(e,t){ne(e,n,t),le(n,a),le(n,r),u&&u.m(n,null),le(n,o),i||(l=ke(n,"click",f),i=!0)},p(e,r){t=e,1&r&&c!==(c=t[9]+"")&&ce(a,c),t[11]>1?u?u.p(t,r):(u=Er(t),u.c(),u.m(n,o)):u&&(u.d(1),u=null),1&r&&s!==(s="fsh-message "+t[10]+" svelte-1t9oc1")&&de(n,"class",s)},d(e){e&&re(n),u&&u.d(),i=!1,l()}}}function Pr(e){let t,n=[],a=new Map,r=ue(e[1](e[0]))
const o=e=>e[9]
for(let t=0;t<r.length;t+=1){let s=Tr(e,r,t),i=o(s)
a.set(i,n[t]=Gr(i,s))}return{c(){for(let e=0;e<n.length;e+=1)n[e].c()
t=te()},m(e,a){for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,a)
ne(e,t,a)},p(e,[s]){7&s&&(r=ue(e[1](e[0])),n=ve(n,s,o,1,e,r,a,t.parentNode,be,Gr,t,Tr))},i:ae,o:ae,d(e){e&&re(t)
for(let t=0;t<n.length;t+=1)n[t].d(e)}}}function jr(e,t,n){let a=[]
const r=window.$("#messageCenter").data().hcsWorldMessageCenter,o=function*(){for(let e=0;;e++)yield e}()
function s(){r._reposition()}function i(e){n(0,a=a.filter((({msg:t})=>t!==e))),s()}r._displayMessage=async function(e,t,r=3e3){const i=o.next().value
n(0,a=[...a,{msg:e,type:t,expire:i}]),setTimeout((()=>{n(0,a=a.filter((({expire:e})=>e!==i)))}),r),await ye(),s()}
return[a,e=>xt(e,"msg").map((({msg:t,type:n})=>({msg:t,type:n,count:e.filter((({msg:e})=>e===t)).length}))),i,e=>i(e)]}class Rr extends X{constructor(e){super(),Z(this,e,jr,Pr,ee,{})}}let _r=0
function Fr(e){_r[e.name]?_r[e.name].seen&&(_r[e.name].seen+=1):(_r[e.name]={seen:1},function(e,t){t.creature_class=e.creature_class,t.image_id=e.image_id,t.level=Number(e.level),t.type=e.type}(e,_r[e.name]))}function Ir(e,t,n){return t?e(t,n):n}function Or(e,t){const n=e||{}
return n.min=Ir(Math.min,n.min,t),n.max=Ir(Math.max,n.max,t),n}const Wr=["attack","armor","damage","defense","hp"]
function qr(e,t,n){const a=Or(t[n],Number(e[n]));(function(e,t){return!e||e.min!==t.min||e.max!==t.max})(t[n],a)&&(t[n]=a)}function Kr(e,t){e[t.name]=Or(e[t.name],Number(t.value))}function Yr(e){_r||(_r={}),Fr(e),function(e,t){Wr.forEach(s(qr,e,t))}(e,_r[e.name]),function(e,t){(function(e){return e.enhancements&&e.enhancements.length>0})(e)&&(t.enhancements=t.enhancements||{},e.enhancements.forEach(s(Kr,t.enhancements)))}(e,_r[e.name]),H("fsh_monsterLog",_r)}async function zr(){!function(e){_r=e||{}}(await S("fsh_monsterLog"))}const Ur=[]
function Qr(e){var n
Aa(e)||(n=e.response.data,t.showMonsterLog&&Yr(n))}function Jr(e,t){return e.id===t.id}async function Xr(e,t){if(6!==e.type||function(e){if(Ur.find(s(Jr,e.data)))return!0
Ur.push(e.data)}(e))return
Qr(await Ta(e.data.id,t))}function Zr(){t.showMonsterLog&&(GameData.actions().forEach(Xr),c("NewMap","MonsterLog"))}let eo=""
const to=()=>eo
function no(){return At({subcmd:"scouttower"})}function ao(e,[t,n,a]){const r=e.insertCell(-1)
return r.colSpan=t,a&&(r.className="header"),o(r,n()),r}function ro(e,t,n){const a=e.insertRow(-1)
return n&&(a.className="fshBlue"),function(e,t){t.forEach(s(ao,e))}(a,t),a}function oo(e,t){ro(e,t[0],t[1])}function so(e,t){t.forEach(s(oo,e))}let io=0,lo=0,co=0,uo=0,fo=0,mo=0,po=0,ho=0
const go=()=>io,vo=()=>po
function bo(){io=Fn("Current"),lo=Fn("Kills"),co=Fn("Member"),uo=Fn("% of Total"),fo=Fn("Status"),mo=Fn("Titan HP"),po=Fn("Total"),ho=Fn("Your Guild")}let ko=0,yo=0,wo=0,Co=0,$o=0,Lo=0,Do=0,Vo=0,Mo=0
const xo=()=>ko,Ao=()=>yo,So=()=>wo,No=()=>Co,Ho=()=>$o,Bo=()=>Lo,To=()=>Do,Eo=()=>Vo,Go=()=>Mo
function Po(){ko=ft({innerHTML:"&nbsp;"}),yo=ft({innerHTML:"&nbsp;"}),wo=ft(),Co=ft(),$o=ft(),Lo=ft(),Do=ft(),Vo=ft(),Mo=ft()}let jo=0
const Ro=()=>jo
function _o(){for(;jo.rows.length>8;)jo.deleteRow(8)}function Fo(e){const t=ft()
return o(t,e),dt(t,"%"),t}const Io=[[[5,xo,!0],[1,Ao,!0]]],Oo=[[[2,()=>mo,!0],[4,()=>ho,!0]]],Wo=[[[2,function(){const e=ft()
return o(e,So()),dt(e,"/"),o(e,No()),e}],[4,Ho]]],qo=()=>[[[2,go,!0],[4,s(Fo,Bo())]],!0],Ko=()=>[[[2,vo,!0],[4,s(Fo,To())]],!0],Yo=[[[2,()=>fo,!0],[4,Eo]],!0],zo=[[[2,()=>co,!0],[2,()=>lo,!0],[2,()=>uo,!0]]]
let Uo=0,Qo=0,Jo=""
const Xo=()=>Qo,Zo=()=>Jo
function es(){Qo=null,Uo&&!B("fshHide",Uo)&&(ut(Uo,!0),we("&nbsp;",ko),we("&nbsp;",yo),r("",wo),r("",Co),r("",$o),r("",Lo),r("",Do),we("",Vo),we("",Mo),_o())}function ts(e){return 0===e.type&&(Qo=e.base_creature_id,Jo=`(${e.x},${e.y})`,!0)}function ns(){if(Uo)ut(Uo,!1)
else{const e=a("actionContainer")
Uo=n({className:"fshActionBox titanInfo"}),Po(),jo=St({className:"fshCenter"}),bo(),so(jo,[Io,Oo,Wo,qo(),Ko(),Yo,[[[6,Go]]],zo]),o(Uo,Ro()),o(e,Uo)}}function as(e){return e<=0?'<span class="fshGreen cooldown">No active cooldown</span>':`<span class="fshMaroon cooldown">Cooldown until: ${function(e){const t=new Date(Ce()+1e3*e)
return`${Tt(t.getHours())}:${Tt(t.getMinutes())} ${Tt(t.getDate())}/${$e[t.getMonth()]}/${t.getFullYear()}`}(e)}</span>`}function rs(e){return pt(Bt(e.max_hp-e.current_hp,e.kills),2)}function os(e){return pt(100*e.kills/e.max_hp,2)}function ss(e){!function(e){[[Ht(e.creature.name),xo],[Zo(),Ao],[e.current_hp,So],[e.max_hp,No],[e.kills,Ho],[rs(e),Bo],[os(e),To]].forEach((([e,t])=>r(e,t())))}(e),we(function(e){return Nt(e.kills,e.max_hp,e.current_hp)}(e),Eo()),we(as(e.cooldown),Go())}function is(e,t){return[[[2,()=>Fn(t.player.name)],[2,()=>Fn(t.kills.toString())],[2,()=>Fn(`${pt(100*t.kills/e.kills,2)}%`)]]]}function ls(e){return e.realm&&e.creature.base_id===Xo()&&e.realm===to()}function cs(e){const t=e.find(ls)
t&&(ss(t),function(e){if(_o(),!e.contributors)return
const t=e.contributors.map(s(is,e))
so(Ro(),t)}(t))}let us=null
const fs=e=>e?.s&&kt(e.r),ds=e=>t.showTitanInfo&&kt(e)&&e.some(ts)
async function ms(){!function(e,t){fs(t)&&(cs(t.r),ds(GameData.realm().dynamic)?us=window.setTimeout(e,3e4):es())}(ms,await J(no))}function ps(e){us&&(window.clearTimeout(us),us=null),ds(e)?(ns(),ms()):es()}function hs(e){var t
e.dynamic&&(t=e.name,eo=t,ps(e.dynamic))}function gs(e,t){t.realm?.name&&hs(t.realm)}function vs(e,t,n){const a=e.slice()
return a[5]=t[n],a[7]=n,a}function bs(e){let t,n=e[1](e[7])+""
return{c(){t=se(n)},m(e,n){ne(e,t,n)},p:ae,d(e){e&&re(t)}}}function ks(e){let t,n,a,r
return n=new Gt({props:{$$slots:{default:[bs]},$$scope:{ctx:e}}}),n.$on("click",(function(...t){return e[3](e[5],e[7],...t)})),{c(){t=oe("li"),He(n.$$.fragment),a=fe()},m(e,o){ne(e,t,o),Be(n,t,null),le(t,a),r=!0},p(t,a){e=t
const r={}
256&a&&(r.$$scope={dirty:a,ctx:e}),n.$set(r)},i(e){r||(Me(n.$$.fragment,e),r=!0)},o(e){Se(n.$$.fragment,e),r=!1},d(e){e&&re(t),Te(n)}}}function ys(e){let t,n,a=ue(Ve(16,e[0])),r=[]
for(let t=0;t<a.length;t+=1)r[t]=ks(vs(e,a,t))
const o=e=>Se(r[e],1,1,(()=>{r[e]=null}))
return{c(){t=oe("ul")
for(let e=0;e<r.length;e+=1)r[e].c()
de(t,"class","svelte-1k3xw12")},m(e,a){ne(e,t,a)
for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(t,null)
n=!0},p(e,[n]){if(7&n){let s
for(a=ue(Ve(16,e[0])),s=0;s<a.length;s+=1){const o=vs(e,a,s)
r[s]?(r[s].p(o,n),Me(r[s],1)):(r[s]=ks(o),r[s].c(),Me(r[s],1),r[s].m(t,null))}for(xe(),s=a.length;s<r.length;s+=1)o(s)
Ae()}},i(e){if(!n){for(let e=0;e<a.length;e+=1)Me(r[e])
n=!0}},o(e){r=r.filter(Boolean)
for(let e=0;e<r.length;e+=1)Se(r[e])
n=!1},d(e){e&&re(t),me(r,e)}}}function ws(e,t,n){const a=Ne()
let{members:r=[]}=t
const o=e=>`Buff ${Ee[e]} 16`
function s(e,t,n){n.target.blur(),Et(`${Ge}&players=${e.join(",")}`,"fsQuickBuff",618,1e3,",scrollbars"),a("buffBatch",o(t))}return e.$$set=e=>{"members"in e&&n(0,r=e.members)},[r,o,s,(e,t,n)=>s(e,t,n)]}class Cs extends X{constructor(e){super(),Z(this,e,ws,ys,ee,{members:0})}}function $s(e,t){return e>10*t||e<t?e:10*t}const Ls=[["levelValue","level"],["attackValue","attack"],["attackBonus","bonus_attack"],["defenseValue","defense"],["defenseBonus","bonus_defense"],["armorValue","armor"],["armorBonus","bonus_armor"],["damageValue","damage"],["damageBonus","bonus_damage"],["hpValue","hp"],["hpBonus","bonus_hp"],["killStreakValue","killstreak"]]
function Ds(e,t,n){e[n[0]]=Number(t[n[1]])}const Vs=[["counterAttackLevel","Counter Attack"],["doublerLevel","Doubler"],["deathDealerLevel","Death Dealer"],["darkCurseLevel","Dark Curse"],["holyFlameLevel","Holy Flame"],["constitutionLevel","Constitution"],["sanctuaryLevel","Sanctuary"],["flinchLevel","Flinch"],["nightmareVisageLevel","Nightmare Visage"],["superEliteSlayerLevel","Super Elite Slayer"],["fortitudeLevel","Fortitude"],["chiStrikeLevel","Chi Strike"],["terrorizeLevel","Terrorize"],["barricadeLevel","Barricade"],["reignOfTerrorLevel","Reign Of Terror"],["anchoredLevel","Anchored"],["severeConditionLevel","Severe Condition"],["entrenchLevel","Entrench"],["cloakLevel","Cloak"]]
function Ms(e,t,n){e[n[0]]=t[n[1]]||0}function xs(e){if(!e._skills)return
const t=Pt(e._skills),n={}
return function(e,t){Ls.forEach(s(Ds,e,t))}(n,e),function(e,t){Vs.forEach(s(Ms,e,t))}(n,t),n.superEliteSlayerMultiplier=mt(.002*n.superEliteSlayerLevel,2),_t(n.armorValue)&&function(e){e.attackValue=$s(e.attackBonus,e.levelValue),e.defenseValue=$s(e.defenseBonus,e.levelValue),e.armorValue=$s(e.armorBonus,e.levelValue),e.damageValue=$s(e.damageBonus,e.levelValue),e.hpValue=e.hpBonus}(n),n}const As=je(["statusStore","Done."])
let Ss=[]
const Ns=Pe(As,((e,t)=>{const n=Ss.find((([t])=>t===e[0]))
n?[,n[1]]=e:Ss=[...Ss,e]
const a=Ss.find((([,e])=>"Done."!==e))
t(a?.[1]??"Done.")})),Hs=je(0)
const Bs=Pe(Hs,((e,t)=>{!async function(e,t){if(!e)return
As.set(["relicStore","Processing defending guild relics ... "])
const n=await Ft(e)
if(!n?.r?.relics)return void As.set(["relicStore","AJAX Error"])
const a=n.r.relics.length,r=1===a?1.5:mt(1-a/10,2)
t({noOfRelics:a,relicMultiplier:r,leadDefenderBonus:`${String(100*r)}%`}),As.set(["relicStore","Done."])}(e,t)})),Ts=je([])
const Es=Pe(Ts,((e,t)=>{!async function(e,t){if(!e.length)return
As.set(["defendersStore","Processing defending group stats ... "])
const n=[]
await Rt(e.map((async(e,a)=>{const r=await jt(e)
n.push([a,xs(r)]),t(n)}))),As.set(["defendersStore","Done."])}(e,t)})),Gs=Pe(Es,((e,t)=>{const n=e?.find((([e])=>0===e))
n&&t(n[1])})),Ps=(e,t,n)=>Math.ceil(n*(0===t?e:Re))
function js(e,t,[n,a]){return{armorValue:t.armorValue+Ps(e,n,a.armorValue),attackValue:t.attackValue+Ps(e,n,a.attackValue),damageValue:t.damageValue+Ps(e,n,a.damageValue),cloaked:t.cloaked+(a.cloakLevel?1:0),defenseValue:t.defenseValue+Ps(e,n,a.defenseValue),hpValue:t.hpValue+Ps(e,n,a.hpValue)}}const Rs=Pe([Bs,Es],(([e,t],n)=>{if(!e?.relicMultiplier||!t?.length)return
const a=t?.reduce(s(js,e.relicMultiplier),{armorValue:0,attackValue:0,damageValue:0,cloaked:0,defenseValue:0,hpValue:0})
n(a)})),_s=je(0),Fs=e=>e.members[0].name===GameData.player().username
async function Is(e,t){if(!e)return
As.set(["groupStore","Processing attacking group stats ... "])
const n=await async function(){const e=await qt()
return e?.r?.find(Fs)?.id}(),a=n&&await async function(e){const t=await It(e)
return Kt(t?.r?.attributes)}(n),r=a&&await async function(e){const t=await Ot(),n=Wt(t)
return e?.map(((e,t)=>e-n[t]))}(a)
r&&t({attack:r[0],defense:r[1],armor:r[2],hp:r[3],damage:r[4]}),As.set(["groupStore","Done."])}const Os=Pe(_s,((e,t)=>{Is(e,t)})),Ws=(e,t,n)=>Math.ceil(e*_e(t,0)*n),qs=(e,t)=>Ws(e,t,.0025),Ks=(e,t)=>Ws(e,t,.001),Ys=Ks,zs=Ks,Us=Ks,Qs=Ks,Js=Ks,Xs=(e,t)=>Math.ceil(e*(1+.001*_e(t,0))),Zs=(e,t)=>Math.ceil(e*(1-t*Fe)),ei=je([]),ti=Pe(ei,((e,t)=>{e&&t(Pt(e))})),ni=Pe([ti,Os],(([e,t],n)=>{if(!e||!t)return
const a=Xs(t.defense,e.Constitution),r=t.hp+Ys(a,e.Fortitude)
n({dmgWithChiStrike:t.damage+zs(r,e["Chi Strike"]),defWithConst:a,hpWithFortitude:r,nmv:qs(t.attack,e["Nightmare Visage"]),sanctuary:Us(t.armor,e.Sanctuary)})}))
const ai=Pe([ni,Gs,Os],(function([e,t,n],a){if(!e||!t||!n)return
const r=n.attack-e.nmv,o=Qs(r,t.flinchLevel),s=Js(e.dmgWithChiStrike,t.terrorizeLevel)
a({attack:r-o,defense:e.defWithConst+e.nmv,armor:n.armor+e.sanctuary,hp:e.hpWithFortitude,damage:e.dmgWithChiStrike-s})}))
const ri=Pe([Gs,Rs],(([e,t],n)=>{if(!e||!t)return
const a=qs(t.attackValue,e.nightmareVisageLevel),r=Xs(t.defenseValue,e.constitutionLevel)
!function([e,t,n,a,r,o]){n({attackWithNmv:t.attackValue-a,chiStrike:e.chiStrikeLevel,cloak:e.cloakLevel?"Yes":"No",dmgWithChiStrike:t.damageValue+zs(o,e.chiStrikeLevel),defWithConst:r,hpWithFortitude:o,nmv:a,sanctuary:Us(t.armorValue,e.sanctuaryLevel)})}([e,t,n,a,r,t.hpValue+Ys(r,e.fortitudeLevel)])}))
const oi=Pe([ti,ri,Rs],(function([e,t,n],a){if(!e||!t||!n)return
const r=Qs(t.attackWithNmv,e.Flinch),o=t.defWithConst+t.nmv,s=Js(t.dmgWithChiStrike,e.Terrorize)
a({attack:t.attackWithNmv-r,dc225:Zs(o,225),dc175:Zs(o,175),defense:o,armor:n.armorValue+t.sanctuary,hp:t.hpWithFortitude,damage:t.dmgWithChiStrike-s})})),si=Pe(Bs,((e,t)=>{t({noOfRelics:e?.noOfRelics??"",leadDefenderBonus:e?.leadDefenderBonus??""})})),ii=Pe(Gs,((e,t)=>{if(!e)return t("")
e.cloakLevel?t("Yes"):t("No")})),li=Pe(Rs,((e,t)=>{t({armorValue:e?.armorValue??"",attackValue:e?.attackValue??"",damageValue:e?.damageValue??"",cloaked:e?.cloaked??"",defenseValue:e?.defenseValue??"",hpValue:e?.hpValue??""})})),ci=Pe(Es,((e,t)=>{t(e?.length??"")})),ui=Pe(oi,((e,t)=>{t({attack:e?.attack??"",dc225:e?.dc225??"",dc175:e?.dc175??"",defense:e?.defense??"",armor:e?.armor??"",hp:e?.hp??"",damage:e?.damage??""})})),fi=e=>({attack:e?.attack??"",defense:e?.defense??"",armor:e?.armor??"",hp:e?.hp??"",damage:e?.damage??""}),di=Pe(Os,((e,t)=>{t(fi(e))})),mi=Pe(ai,((e,t)=>{t(fi(e))}))
function pi(e,t,n){const a=e.slice()
return a[6]=t[n].id,a[7]=t[n].username,a}function hi(e){let t,n,a,r,o=e[7]+""
return{c(){t=oe("a"),n=se(o),r=se(" "),de(t,"href",a=""+(Ie+e[6])),de(t,"class","svelte-3priew")},m(e,a){ne(e,t,a),le(t,n),ne(e,r,a)},p(e,r){1&r&&o!==(o=e[7]+"")&&ce(n,o),1&r&&a!==(a=""+(Ie+e[6]))&&de(t,"href",a)},d(e){e&&(re(t),re(r))}}}function gi(e){let t,n,a,r=(e[0].length||"")+"",o=ue(e[0]),s=[]
for(let t=0;t<o.length;t+=1)s[t]=hi(pi(e,o,t))
return{c(){t=se(r),n=se(" Offline guild members not at relic:\n"),a=oe("div")
for(let e=0;e<s.length;e+=1)s[e].c()
de(a,"class","missing svelte-3priew")},m(e,r){ne(e,t,r),ne(e,n,r),ne(e,a,r)
for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(a,null)},p(e,[n]){if(1&n&&r!==(r=(e[0].length||"")+"")&&ce(t,r),1&n){let t
for(o=ue(e[0]),t=0;t<o.length;t+=1){const r=pi(e,o,t)
s[t]?s[t].p(r,n):(s[t]=hi(r),s[t].c(),s[t].m(a,null))}for(;t<s.length;t+=1)s[t].d(1)
s.length=o.length}},i:ae,o:ae,d(e){e&&(re(t),re(n),re(a)),me(s,e)}}}function vi(e,t,n){let{members:a=[]}=t,r=[]
const o=[({username:e})=>!a.includes(e),({last_login:e})=>e,({last_login:e})=>e<We(),({last_login:e})=>e>qe(),({level:e})=>e<400||e>421,({level:e})=>e<441||e>450],s=e=>o.every((t=>t(e))),i=({username:e},{username:t})=>Oe(e,t)
return Hs.subscribe((e=>{!async function(e){const t=await Yt(e)
kt(t)&&n(0,r=t.filter(s).sort(i))}(e)})),e.$$set=e=>{"members"in e&&n(1,a=e.members)},[r,a]}class bi extends X{constructor(e){super(),Z(this,e,vi,gi,ee,{members:1})}}function ki(e){let t,n,a
return n=new Cs({props:{members:e[10]}}),n.$on("buffBatch",e[11]),{c(){t=oe("div"),He(n.$$.fragment),de(t,"class","buff-links svelte-2rn368")},m(e,r){ne(e,t,r),Be(n,t,null),a=!0},p:ae,i(e){a||(Me(n.$$.fragment,e),a=!0)},o(e){Se(n.$$.fragment,e),a=!1},d(e){e&&re(t),Te(n)}}}function yi(e){let t,n,a,r,o,s,i,l
return{c(){t=oe("div"),t.textContent="Processing",n=fe(),a=oe("div"),r=se(e[2]),o=fe(),s=oe("div"),s.textContent="Assumptions",i=fe(),l=oe("div"),l.textContent="Above calculations include Constitution, Fortitude, Nightmare Visage,\n        Chi Strike, Sanctuary, Terrorize and Flinch bonus calculations (in that\n        order) on both the defending group and attacking group.",de(t,"class","b-top svelte-2rn368"),de(a,"class","proc-stat svelte-2rn368"),de(s,"class","b-top svelte-2rn368"),de(l,"class","assume svelte-2rn368")},m(e,c){ne(e,t,c),ne(e,n,c),ne(e,a,c),le(a,r),ne(e,o,c),ne(e,s,c),ne(e,i,c),ne(e,l,c)},p(e,t){4&t&&ce(r,e[2])},d(e){e&&(re(t),re(n),re(a),re(o),re(s),re(i),re(l))}}}function wi(e){let t,n,a
return{c(){t=oe("button"),t.textContent="Fetch Stats",de(t,"class","custombutton"),de(t,"type","button")},m(r,o){ne(r,t,o),n||(a=ke(t,"click",e[12]),n=!0)},p:ae,d(e){e&&re(t),n=!1,a()}}}function Ci(e){let t,n,a,r,o,s,i,l,c,u,f,d,m,p,h,g,v,b,k,y,w,C,$,L,D,V,M,x,A,S,N,H,B,T,E,G,P,j,R,_,F,I,O,W,q,K,Y,z,U,Q,J,X,Z,ee,te,ae,ie,ue,me,pe,he,ge,ve,be,ke,ye,we,Ce,$e,Le,De,Ve,xe,Ae,Ne,Ee,Ge,Pe,je,Re,_e,Fe,Ie,Oe,We,qe,Ke,Ye,ze,Ue,Qe,Je,Xe,Ze,et,tt,nt,at,rt,ot,st,it,lt,ct,ut,ft,dt,mt,pt,ht,gt,vt,bt,kt,yt,wt,Ct,$t,Lt,Dt,Vt,Mt,xt,At,St,Nt,Ht,Bt,Tt,Et,Gt,Pt,jt,Rt,_t,Ft,It,Ot,Wt,qt,Kt,Yt,zt,Ut,Qt,Jt,Xt,Zt,en,tn,nn,an,rn,on,sn=e[3].noOfRelics+"",ln=e[3].leadDefenderBonus+"",cn=e[5].attackValue+"",un=e[6].attack+"",fn=e[5].defenseValue+"",dn=e[6].defense+"",mn=e[5].armorValue+"",pn=e[6].armor+"",hn=e[5].damageValue+"",gn=e[6].damage+"",vn=e[5].hpValue+"",bn=e[6].hp+"",kn=e[5].cloaked+"",yn=e[6].dc225+"",wn=e[6].dc175+"",Cn=e[8].attack+"",$n=e[9].attack+"",Ln=e[8].defense+"",Dn=e[9].defense+"",Vn=e[8].armor+"",Mn=e[9].armor+"",xn=e[8].damage+"",An=e[9].damage+"",Sn=e[8].hp+"",Nn=e[9].hp+""
return rn=new bi({props:{members:e[10]}}),{c(){t=oe("div"),n=oe("div"),n.textContent="Defending Guild Stats",a=fe(),r=oe("div"),o=oe("div"),o.textContent="Relic Count:",s=fe(),i=oe("div"),l=se(sn),c=fe(),u=oe("div"),u.textContent="Lead Defender Bonus:",f=fe(),d=oe("div"),m=se(ln),p=fe(),h=oe("div"),h.textContent="Lead Defender Cloaked:",g=fe(),v=oe("div"),b=se(e[4]),k=fe(),y=oe("div"),y.textContent="Other Defender Stats",w=fe(),C=oe("div"),$=oe("div"),$.textContent="Raw Attack:",L=fe(),D=oe("div"),V=se(cn),M=fe(),x=oe("div"),x.textContent="Attack w/ buffs:",A=fe(),S=oe("div"),N=se(un),H=fe(),B=oe("div"),B.textContent="Raw Defense:",T=fe(),E=oe("div"),G=se(fn),P=fe(),j=oe("div"),j.textContent="Defense w/buffs:",R=fe(),_=oe("div"),F=se(dn),I=fe(),O=oe("div"),O.textContent="Raw Armor:",W=fe(),q=oe("div"),K=se(mn),Y=fe(),z=oe("div"),z.textContent="Armor w/ buffs:",U=fe(),Q=oe("div"),J=se(pn),X=fe(),Z=oe("div"),Z.textContent="Raw Damage:",ee=fe(),te=oe("div"),ae=se(hn),ie=fe(),ue=oe("div"),ue.textContent="Damage w/ buffs:",me=fe(),pe=oe("div"),he=se(gn),ge=fe(),ve=oe("div"),ve.textContent="Raw HP:",be=fe(),ke=oe("div"),ye=se(vn),we=fe(),Ce=oe("div"),Ce.textContent="HP w/ buffs:",$e=fe(),Le=oe("div"),De=se(bn),Ve=fe(),xe=oe("div"),xe.textContent="Cloaked:",Ae=fe(),Ne=oe("div"),Ee=se(kn),Ge=fe(),Pe=oe("div"),Pe.textContent="Processed:",je=fe(),Re=oe("div"),_e=se(e[7]),Fe=fe(),Ie=oe("div"),Oe=oe("div"),Oe.textContent="Adjusted Defense Values",We=fe(),qe=oe("div"),Ke=oe("div"),Ke.textContent="DC225:",Ye=fe(),ze=oe("div"),Ue=se(yn),Qe=fe(),Je=oe("div"),Je.textContent="DC175:",Xe=fe(),Ze=oe("div"),et=se(wn),tt=fe(),nt=oe("div"),nt.textContent="Â ",at=fe(),rt=oe("div"),rt.textContent="Attacking Group Stats",ot=fe(),st=oe("div"),it=oe("div"),it.textContent="Raw Group Attack:",lt=fe(),ct=oe("div"),ut=se(Cn),ft=fe(),dt=oe("div"),dt.textContent="Group Attack w/ buffs:",mt=fe(),pt=oe("div"),ht=se($n),gt=fe(),vt=oe("div"),vt.textContent="Raw Group Defense:",bt=fe(),kt=oe("div"),yt=se(Ln),wt=fe(),Ct=oe("div"),Ct.textContent="Group Defense w/ buffs:",$t=fe(),Lt=oe("div"),Dt=se(Dn),Vt=fe(),Mt=oe("div"),Mt.textContent="Raw Group Armor:",xt=fe(),At=oe("div"),St=se(Vn),Nt=fe(),Ht=oe("div"),Ht.textContent="Group Armor w/ buffs:",Bt=fe(),Tt=oe("div"),Et=se(Mn),Gt=fe(),Pt=oe("div"),Pt.textContent="Raw Group Damage:",jt=fe(),Rt=oe("div"),_t=se(xn),Ft=fe(),It=oe("div"),It.textContent="Group Damage w/ buffs:",Ot=fe(),Wt=oe("div"),qt=se(An),Kt=fe(),Yt=oe("div"),Yt.textContent="Raw Group HP:",zt=fe(),Ut=oe("div"),Qt=se(Sn),Jt=fe(),Xt=oe("div"),Xt.textContent="Group HP w/ buffs:",Zt=fe(),en=oe("div"),tn=se(Nn),nn=fe(),an=oe("div"),He(rn.$$.fragment),de(n,"class","b-top svelte-2rn368"),de(o,"class","svelte-2rn368"),de(i,"class","svelte-2rn368"),de(u,"class","svelte-2rn368"),de(d,"class","svelte-2rn368"),de(h,"class","svelte-2rn368"),de(v,"class","svelte-2rn368"),de(r,"class","stat-grid svelte-2rn368"),de(y,"class","b-top svelte-2rn368"),de($,"class","svelte-2rn368"),de(D,"class","svelte-2rn368"),de(x,"class","svelte-2rn368"),de(S,"class","svelte-2rn368"),de(B,"class","svelte-2rn368"),de(E,"class","svelte-2rn368"),de(j,"class","svelte-2rn368"),de(_,"class","svelte-2rn368"),de(O,"class","svelte-2rn368"),de(q,"class","svelte-2rn368"),de(z,"class","svelte-2rn368"),de(Q,"class","svelte-2rn368"),de(Z,"class","svelte-2rn368"),de(te,"class","svelte-2rn368"),de(ue,"class","svelte-2rn368"),de(pe,"class","svelte-2rn368"),de(ve,"class","svelte-2rn368"),de(ke,"class","svelte-2rn368"),de(Ce,"class","svelte-2rn368"),de(Le,"class","svelte-2rn368"),de(xe,"class","svelte-2rn368"),de(Ne,"class","svelte-2rn368"),de(Pe,"class","svelte-2rn368"),de(Re,"class","svelte-2rn368"),de(C,"class","stat-grid svelte-2rn368"),de(t,"class","middle svelte-2rn368"),de(Oe,"class","b-top svelte-2rn368"),de(Ke,"class","svelte-2rn368"),de(ze,"class","svelte-2rn368"),de(Je,"class","svelte-2rn368"),de(Ze,"class","svelte-2rn368"),de(nt,"class","svelte-2rn368"),de(qe,"class","stat-grid svelte-2rn368"),de(rt,"class","b-top svelte-2rn368"),de(it,"class","svelte-2rn368"),de(ct,"class","svelte-2rn368"),de(dt,"class","svelte-2rn368"),de(pt,"class","svelte-2rn368"),de(vt,"class","svelte-2rn368"),de(kt,"class","svelte-2rn368"),de(Ct,"class","svelte-2rn368"),de(Lt,"class","svelte-2rn368"),de(Mt,"class","svelte-2rn368"),de(At,"class","svelte-2rn368"),de(Ht,"class","svelte-2rn368"),de(Tt,"class","svelte-2rn368"),de(Pt,"class","svelte-2rn368"),de(Rt,"class","svelte-2rn368"),de(It,"class","svelte-2rn368"),de(Wt,"class","svelte-2rn368"),de(Yt,"class","svelte-2rn368"),de(Ut,"class","svelte-2rn368"),de(Xt,"class","svelte-2rn368"),de(en,"class","svelte-2rn368"),de(st,"class","stat-grid svelte-2rn368"),de(Ie,"class","right svelte-2rn368"),de(an,"class","bottom b-top svelte-2rn368")},m(e,re){ne(e,t,re),le(t,n),le(t,a),le(t,r),le(r,o),le(r,s),le(r,i),le(i,l),le(r,c),le(r,u),le(r,f),le(r,d),le(d,m),le(r,p),le(r,h),le(r,g),le(r,v),le(v,b),le(t,k),le(t,y),le(t,w),le(t,C),le(C,$),le(C,L),le(C,D),le(D,V),le(C,M),le(C,x),le(C,A),le(C,S),le(S,N),le(C,H),le(C,B),le(C,T),le(C,E),le(E,G),le(C,P),le(C,j),le(C,R),le(C,_),le(_,F),le(C,I),le(C,O),le(C,W),le(C,q),le(q,K),le(C,Y),le(C,z),le(C,U),le(C,Q),le(Q,J),le(C,X),le(C,Z),le(C,ee),le(C,te),le(te,ae),le(C,ie),le(C,ue),le(C,me),le(C,pe),le(pe,he),le(C,ge),le(C,ve),le(C,be),le(C,ke),le(ke,ye),le(C,we),le(C,Ce),le(C,$e),le(C,Le),le(Le,De),le(C,Ve),le(C,xe),le(C,Ae),le(C,Ne),le(Ne,Ee),le(C,Ge),le(C,Pe),le(C,je),le(C,Re),le(Re,_e),ne(e,Fe,re),ne(e,Ie,re),le(Ie,Oe),le(Ie,We),le(Ie,qe),le(qe,Ke),le(qe,Ye),le(qe,ze),le(ze,Ue),le(qe,Qe),le(qe,Je),le(qe,Xe),le(qe,Ze),le(Ze,et),le(qe,tt),le(qe,nt),le(Ie,at),le(Ie,rt),le(Ie,ot),le(Ie,st),le(st,it),le(st,lt),le(st,ct),le(ct,ut),le(st,ft),le(st,dt),le(st,mt),le(st,pt),le(pt,ht),le(st,gt),le(st,vt),le(st,bt),le(st,kt),le(kt,yt),le(st,wt),le(st,Ct),le(st,$t),le(st,Lt),le(Lt,Dt),le(st,Vt),le(st,Mt),le(st,xt),le(st,At),le(At,St),le(st,Nt),le(st,Ht),le(st,Bt),le(st,Tt),le(Tt,Et),le(st,Gt),le(st,Pt),le(st,jt),le(st,Rt),le(Rt,_t),le(st,Ft),le(st,It),le(st,Ot),le(st,Wt),le(Wt,qt),le(st,Kt),le(st,Yt),le(st,zt),le(st,Ut),le(Ut,Qt),le(st,Jt),le(st,Xt),le(st,Zt),le(st,en),le(en,tn),ne(e,nn,re),ne(e,an,re),Be(rn,an,null),on=!0},p(e,t){(!on||8&t)&&sn!==(sn=e[3].noOfRelics+"")&&ce(l,sn),(!on||8&t)&&ln!==(ln=e[3].leadDefenderBonus+"")&&ce(m,ln),(!on||16&t)&&ce(b,e[4]),(!on||32&t)&&cn!==(cn=e[5].attackValue+"")&&ce(V,cn),(!on||64&t)&&un!==(un=e[6].attack+"")&&ce(N,un),(!on||32&t)&&fn!==(fn=e[5].defenseValue+"")&&ce(G,fn),(!on||64&t)&&dn!==(dn=e[6].defense+"")&&ce(F,dn),(!on||32&t)&&mn!==(mn=e[5].armorValue+"")&&ce(K,mn),(!on||64&t)&&pn!==(pn=e[6].armor+"")&&ce(J,pn),(!on||32&t)&&hn!==(hn=e[5].damageValue+"")&&ce(ae,hn),(!on||64&t)&&gn!==(gn=e[6].damage+"")&&ce(he,gn),(!on||32&t)&&vn!==(vn=e[5].hpValue+"")&&ce(ye,vn),(!on||64&t)&&bn!==(bn=e[6].hp+"")&&ce(De,bn),(!on||32&t)&&kn!==(kn=e[5].cloaked+"")&&ce(Ee,kn),(!on||128&t)&&ce(_e,e[7]),(!on||64&t)&&yn!==(yn=e[6].dc225+"")&&ce(Ue,yn),(!on||64&t)&&wn!==(wn=e[6].dc175+"")&&ce(et,wn),(!on||256&t)&&Cn!==(Cn=e[8].attack+"")&&ce(ut,Cn),(!on||512&t)&&$n!==($n=e[9].attack+"")&&ce(ht,$n),(!on||256&t)&&Ln!==(Ln=e[8].defense+"")&&ce(yt,Ln),(!on||512&t)&&Dn!==(Dn=e[9].defense+"")&&ce(Dt,Dn),(!on||256&t)&&Vn!==(Vn=e[8].armor+"")&&ce(St,Vn),(!on||512&t)&&Mn!==(Mn=e[9].armor+"")&&ce(Et,Mn),(!on||256&t)&&xn!==(xn=e[8].damage+"")&&ce(_t,xn),(!on||512&t)&&An!==(An=e[9].damage+"")&&ce(qt,An),(!on||256&t)&&Sn!==(Sn=e[8].hp+"")&&ce(Qt,Sn),(!on||512&t)&&Nn!==(Nn=e[9].hp+"")&&ce(tn,Nn)},i(e){on||(Me(rn.$$.fragment,e),on=!0)},o(e){Se(rn.$$.fragment,e),on=!1},d(e){e&&(re(t),re(Fe),re(Ie),re(nn),re(an)),Te(rn)}}}function $i(e){let t,n,a,r,o,s=e[0].is_owner&&ki(e)
function i(e,t){return e[1]?yi:wi}let l=i(e),c=l(e),u=e[1]&&Ci(e)
return{c(){t=oe("div"),n=oe("div"),s&&s.c(),a=fe(),c.c(),r=fe(),u&&u.c(),de(n,"class","left svelte-2rn368"),de(t,"class","body svelte-2rn368")},m(e,i){ne(e,t,i),le(t,n),s&&s.m(n,null),le(n,a),c.m(n,null),le(t,r),u&&u.m(t,null),o=!0},p(e,[r]){e[0].is_owner?s?(s.p(e,r),1&r&&Me(s,1)):(s=ki(e),s.c(),Me(s,1),s.m(n,a)):s&&(xe(),Se(s,1,1,(()=>{s=null})),Ae()),l===(l=i(e))&&c?c.p(e,r):(c.d(1),c=l(e),c&&(c.c(),c.m(n,null))),e[1]?u?(u.p(e,r),2&r&&Me(u,1)):(u=Ci(e),u.c(),Me(u,1),u.m(t,null)):u&&(xe(),Se(u,1,1,(()=>{u=null})),Ae())},i(e){o||(Me(s),Me(u),o=!0)},o(e){Se(s),Se(u),o=!1},d(e){e&&re(t),s&&s.d(),c.d(),u&&u.d()}}}function Li(e,t,n){let a,r,o,s,i,l,u,f
Ke(e,Ns,(e=>n(2,a=e))),Ke(e,si,(e=>n(3,r=e))),Ke(e,ii,(e=>n(4,o=e))),Ke(e,li,(e=>n(5,s=e))),Ke(e,ui,(e=>n(6,i=e))),Ke(e,ci,(e=>n(7,l=e))),Ke(e,di,(e=>n(8,u=e))),Ke(e,mi,(e=>n(9,f=e)))
let{relicData:d={}}=t
const m=d.defenders.map((e=>e.player_name))
let p=!1
return Ye((()=>{n(1,p=!1),Hs.set(0),Ts.set([]),_s.set(0),ei.set([])})),e.$$set=e=>{"relicData"in e&&n(0,d=e.relicData)},[d,p,a,r,o,s,i,l,u,f,m,function(e){c("relic",e.detail)},function(){c("relic","fetchStats"),n(1,p=!0),Hs.set(d.controlled_by.guild_id),Ts.set(m),_s.set(GameData.player().hasGroup),ei.set(GameData.player().buffs)}]}class Di extends X{constructor(e){super(),Z(this,e,Li,$i,ee,{relicData:0})}}let Vi=0
function Mi(e,t){var n,r
t?.response?.data?.defenders?.length>0&&(n=a("dialog-relic"),r=t.response.data,Vi&&Vi.$destroy(),Vi=new Di({props:{relicData:r},target:n}))}function xi(e,t){"ACT_REPAIR"===t&&GameData.fetch(Qe+f+Je+Xe)}let Ai=!1
function Si(e,t,n,a,r,o,s,i,l){return e.beginPath(),e.arc(o+i/2,s+l/2,i/6,0,2*Math.PI,!1),e.fillStyle=this.color,e.fill(),e.lineWidth=1,e.strokeStyle="black",e.stroke(),!0}function Ni(){if(!Ai){const e=GameController.Realm.footprintTexture
e.color=b("footprintColor"),e.Draw=Si,Ai=!0}}function Hi(){GameController?.Realm?.footprintTexture&&(Ni(),$.unsubscribe("fixed.realm",Hi))}let Bi=0
function Ti(e){$("#statbar-gold").css("background-color",e)}function Ei(){$("#HelperSendTotal").html(ht(b("currentGoldSentTotal"))),Number(GameData.player().gold)>Bi?Ti("red"):Ti("inherit")}function Gi(){Bi=b("goldAmount"),$("#statbar-gold-tooltip-general").append(`<dt class="stat-gold-sendTo">Send To:</dt><dd id="HelperSendTo">${b("goldRecipient")}</dd><dt class="stat-gold-sendAmt">Amount:</dt><dd id="HelperSendAmt">${ht(Bi)}</dd><dt class="stat-gold-sendTo">Send?</dt><dd><input id="HelperSendGold" value="Send!" class="custombutton" type="submit"><input type="hidden" id="xc" value=""</dd><dt class="stat-gold-sendTotal">Total Sent:</dt><dd id="HelperSendTotal">${ht(b("currentGoldSentTotal"))}</dd>`),$("#HelperSendGold").on("click",tt),Ei(),$.subscribe(nt,Ei)}let Pi=0,ji=0,Ri=0,_i=0,Fi=0,Ii=0
async function Oi(){const e=await Sa({a:14,d:0,id:Pi.id,item_id:Pi.itemId}),t=e.response.response,n=e.response.msg
let a=n
if(0!==t){const e=n.indexOf("<");-1!==e&&(a=n.substring(0,e))}else a=`You purchased ${e.response.data.name} for ${ht(e.response.data.cost)} gold.`
i(Ii,`${a}<br>`)}async function Wi(){const e=Ut(Fi.value)
e&&(c("NewMap","quickBuy"),await Rt(zt(e,Oi)),GameData.doAction(14,3,{id:Pi.id,item_id:Pi.itemId},0),Ri.close())}function qi(){_i?r("",Ii):function(){_i=n({className:"fshClear",textContent:"Select how many to quick-buy:"}),Fi=wt({id:"buyAmount",className:"fshNumberInput",min:1,max:99,value:1,type:"number"}),o(_i,Fi)
const e=bt({textContent:"Quick-buy"})
l(e,Wi),o(_i,e),Ii=n(),o(_i,Ii),o(ji,_i)}()}function Ki(e,t){Pi=t,ji=ji||a("shopDialogConfirm"),ji&&(Ri=Ri||$(ji).data("hcsWorldDialogShopConfirm"),Ri&&qi())}function Yi(e){let t,n
return{c(){t=oe("div"),n=se(e[0]),de(t,"id","tp-overlay"),de(t,"class","svelte-1lrosbw")},m(e,a){ne(e,t,a),le(t,n)},p(e,t){1&t&&ce(n,e[0])},d(e){e&&re(t)}}}function zi(e){let t,n=e[1]&&Yi(e)
return{c(){n&&n.c(),t=te()},m(e,a){n&&n.m(e,a),ne(e,t,a)},p(e,[a]){e[1]?n?n.p(e,a):(n=Yi(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:ae,o:ae,d(e){e&&re(t),n&&n.d(e)}}}function Ui(e,t,n){let{tpButton:a}=t,r=0,o=0,s=!1
function i(){const e=GameData.player().teleportCooldown
n(0,r=e-ot()+o),r>0||(clearInterval(s),n(1,s=!1),a.classList.remove("cooldown"))}return window.$.subscribe("stats.player",i),window.$.subscribe(rt,(function(e,t){o=ot(),i(),s||0!==t.response.response||n(1,s=setInterval((()=>{i()}),1e3))})),e.$$set=e=>{"tpButton"in e&&n(2,a=e.tpButton)},[r,s,a]}class Qi extends X{constructor(e){super(),Z(this,e,Ui,zi,ee,{tpButton:2})}}function Ji(e){return e.numberOfCreatureHitsTillDead-e.numberOfHitsRequired<=1?", dies on miss":", survives a miss"}function Xi(e,t){return"-"===t?e:"-"===e||e>t?"-":e}const Zi=[[e=>"-"===e.playerHits&&"-"===e.creatureHits,()=>"Unresolved"],[e=>"-"===e.playerHits,()=>"Player dies"],[e=>1===e.playerHits,e=>`Player 1 hits${Ji(e)}`],[e=>e.playerHits>1,e=>`Player > 1 hits${Ji(e)}`]]
function el(e,t){return t[0](e)}function tl(e){e.playerHits=Xi(e.numberOfHitsRequired,e.numberOfCreatureHitsTillDead),e.creatureHits=Xi(e.numberOfCreatureHitsTillDead,e.numberOfHitsRequired),e.fightStatus=function(e){const t=Zi.find(s(el,e))
return t?t[1](e):"Unknown"}(e)}function nl(e,t,n){return e.callback.groupExists?t:n}function al(e,t,n,a){t>0&&(e.extraNotes+=`${n} = ${Math.floor(a*t*.001)}<br>`)}const rl=e=>nl(e,e.callback.groupArmorValue,e.player.armorValue)
function ol(e){e.creatureHitByHowMuch>=0?function(e){const t=e.generalVariable*e.creature.damage
t<e.overallArmorValue?e.numberOfCreatureHitsTillDead=e.overallHPValue:e.numberOfCreatureHitsTillDead=Math.ceil(e.overallHPValue/(t-e.overallArmorValue))}(e):e.numberOfCreatureHitsTillDead="-"}function sl(e){!function(e){const t=rl(e)
e.overallArmorValue=t+Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}(e),function(e){al(e,e.player.sanctuaryLevel,"Sanc Bonus Armor",e.player.armorValue)}(e),function(e){e.terrorizeEffect=Math.floor(e.creature.damage*e.player.terrorizeLevel*.001)}(e),function(e){e.player.terrorizeLevel>0&&(e.extraNotes+=`Terrorize Creature Damage Effect = ${-1*e.terrorizeEffect}<br>`)}(e),e.creature.damage-=e.terrorizeEffect,function(e){e.creatureDamageDone=Math.ceil(e.generalVariable*e.creature.damage-e.overallArmorValue+e.overallHPValue)}(e),ol(e)}const il=e=>nl(e,e.callback.groupAttackValue,e.player.attackValue)
function ll(e){return Math.floor(e.creature.defense*e.player.darkCurseLevel*Fe)}function cl(e){const t=il(e)
e.player.darkCurseLevel>0&&(e.extraNotes+=`DC Bonus Attack = ${ll(e)}<br>`),e.nightmareVisageAttackMovedToDefense=Math.floor((t+e.counterAttackBonusAttack)*e.player.nightmareVisageLevel*.0025),e.player.nightmareVisageLevel>0&&(e.extraNotes+=`NMV Attack moved to Defense = ${e.nightmareVisageAttackMovedToDefense}<br>`),e.overallAttackValue=t+e.counterAttackBonusAttack-e.nightmareVisageAttackMovedToDefense,e.hitByHowMuch=function(e){const t=e.creature.defense-ll(e)
return 3===e.combatEvaluatorBias?e.overallAttackValue-Math.ceil(t)-50:e.overallAttackValue-Math.ceil(e.attackVariable*t)}(e)}const ul=(e,t,n)=>Math.max(Math.ceil((e-t+1)/n/.0025),0)
function fl(e){e.lowestCALevelToStillHit=ul(e.counterAttackBonusAttack,e.hitByHowMuch,e.player.attackValue),e.lowestCALevelToStillKill=ul(e.counterAttackBonusDamage,e.damageDone,e.player.damageValue)}function dl(e){fl(e),e.lowestFeasibleCALevel=Math.max(e.lowestCALevelToStillHit,e.lowestCALevelToStillKill),e.extraNotes+=`Lowest CA to still 1-hit this creature = ${e.lowestFeasibleCALevel}<br>`,0!==e.lowestFeasibleCALevel&&function(e){e.extraAttackAtLowestFeasibleCALevel=Math.floor(.0025*e.player.attackValue*e.lowestFeasibleCALevel),e.extraDamageAtLowestFeasibleCALevel=Math.floor(.0025*e.player.damageValue*e.lowestFeasibleCALevel),e.extraNotes+=`Extra CA Att/Dam at this lowered CA level = ${e.extraAttackAtLowestFeasibleCALevel} / ${e.extraDamageAtLowestFeasibleCALevel}<br>`}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel=function(e){return e.player.counterAttackLevel>0?Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.lowestFeasibleCALevel):0}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel<e.extraStaminaPerHit?e.extraNotes+=`Extra Stam Used at this lowered CA level = ${e.extraStaminaPerHitAtLowestFeasibleCALevel}<br>`:e.extraNotes+="No reduction of stam used at the lower CA level<br>"}function ml(e,t,n){e[t]>203?e.extraNotes+=`Even with CA203 you cannot ${n} this creature<br>`:0!==e[t]&&(e.extraNotes+=`You need a minimum of CA${e[t]} to ${n} this creature<br>`)}function pl(e){(function(e){return e.player.counterAttackLevel>0&&1===e.numberOfHitsRequired})(e)&&dl(e),function(e){return"-"===e.numberOfHitsRequired||1!==e.numberOfHitsRequired}(e)&&function(e){fl(e),ml(e,"lowestCALevelToStillHit","hit"),ml(e,"lowestCALevelToStillKill","1-hit kill")}(e)}const hl=e=>nl(e,e.callback.groupHPValue,e.player.hpValue)
const gl=e=>nl(e,e.callback.groupDamageValue,e.player.damageValue)+e.deathDealerBonusDamage+e.counterAttackBonusDamage+e.holyFlameBonusDamage+e.chiStrikeExtraDamage,vl=e=>Math.floor(e.overallDamageValue-(e.generalVariable*e.creature.armor+e.hpVariable*e.creature.hp))
function bl(e){if(function(e){const t=hl(e),{fortitudeLevel:n}=e.player
e.fortitudeExtraHPs=Math.floor(t*n*.001),n>0&&(e.extraNotes+=`Fortitude Bonus HP = ${e.fortitudeExtraHPs}<br>`),e.overallHPValue=t+e.fortitudeExtraHPs}(e),function(e){const{chiStrikeLevel:t}=e.player
e.chiStrikeExtraDamage=Math.floor(e.overallHPValue*t*.001),t>0&&(e.extraNotes+=`Chi Strike Bonus Damage = ${e.chiStrikeExtraDamage}<br>`)}(e),e.overallDamageValue=gl(e),e.damageDone=vl(e),e.hitByHowMuch>0){let t=1
e.overallDamageValue>=e.generalVariable*e.creature.armor&&(t=e.overallDamageValue-e.generalVariable*e.creature.armor),e.numberOfHitsRequired=Math.ceil(e.hpVariable*e.creature.hp/t)}else e.numberOfHitsRequired="-"}const kl=e=>nl(e,e.callback.groupDefenseValue,e.player.defenseValue),yl=e=>Math.floor(kl(e)*e.player.constitutionLevel*.001)
const wl=e=>e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue
function Cl(e){e.overallDefenseValue=kl(e)+yl(e)+e.nightmareVisageAttackMovedToDefense,function(e){e.player.constitutionLevel>0&&(e.extraNotes+=`Constitution Bonus Defense = ${yl(e)}<br>`)}(e),function(e){al(e,e.player.flinchLevel,"Flinch Bonus Attack Reduction",e.creature.attack)}(e),e.creatureHitByHowMuch=Math.floor(e.attackVariable*wl(e)),3===e.combatEvaluatorBias&&(e.creatureHitByHowMuch=Math.floor(wl(e)-50))}function $l(e){e.extraNotes="",function(e){e.player.superEliteSlayerLevel>0&&(e.extraNotes+=`SES Stat Reduction Multiplier = ${e.player.superEliteSlayerMultiplier}<br>`)}(e),function(e){e.holyFlameBonusDamage=0,"Undead"===e.creature.class&&(e.holyFlameBonusDamage=Math.max(Math.floor((e.player.damageValue-e.creature.armor)*e.player.holyFlameLevel*.002),0),e.player.holyFlameLevel>0&&(e.extraNotes+=`HF Bonus Damage = ${e.holyFlameBonusDamage}<br>`))}(e),function(e){e.deathDealerBonusDamage=Math.floor(e.player.damageValue*(Math.min(.01*Math.floor(e.player.killStreakValue/5)*e.player.deathDealerLevel,20)/100))}(e),function(e){e.counterAttackBonusAttack=Math.floor(.0025*e.player.attackValue*e.player.counterAttackLevel),e.counterAttackBonusDamage=Math.floor(.0025*e.player.damageValue*e.player.counterAttackLevel)}(e),function(e){e.extraStaminaPerHit=0,e.player.counterAttackLevel>0&&(e.extraStaminaPerHit=Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.player.counterAttackLevel))}(e),function(e){e.player.deathDealerLevel>0&&(e.extraNotes+=`DD Bonus Damage = ${e.deathDealerBonusDamage}<br>`)}(e),function(e){e.player.counterAttackLevel>0&&(e.extraNotes+=`CA Bonus Attack/Damage = ${e.counterAttackBonusAttack} / ${e.counterAttackBonusDamage}<br>CA Extra Stam Used = ${e.extraStaminaPerHit}<br>`)}(e)}const Ll=e=>e.creatureHitByHowMuch>=0?"Yes":"No",Dl=e=>e.hitByHowMuch>0?"Yes":"No",Vl=e=>`<span style="color:#333333">${e}</span>`,Ml=e=>`<tr>${e}</tr>`,xl=(e,t)=>`<td${t%2?"":' class="fshRight"'}>${e}</td>`,Al=e=>Ml(e.map(xl).join("")),Sl=e=>Ml(`<td bgcolor="#CD9E4B" colspan="4" align="center">${(e=>e.callback.groupExists?"Group ":"")(e)}Combat Evaluation</td>`),Nl=e=>Al([Vl("Will I hit it?"),Dl(e),Vl("Extra Attack:"),`( ${e.hitByHowMuch} )`]),Hl=e=>Al([Vl("# Hits to kill it?"),e.numberOfHitsRequired,Vl("Extra Damage:"),`( ${e.damageDone} )`]),Bl=e=>Al([Vl("Will I be hit?"),Ll(e),Vl("Extra Defense:"),`( ${-1*e.creatureHitByHowMuch} )`]),Tl=e=>Al([Vl("# Hits to kill me?"),e.numberOfCreatureHitsTillDead,Vl("Extra Armor + HP:"),`( ${-1*e.creatureDamageDone} )`]),El=e=>Al([Vl("# Player Hits?"),e.playerHits,Vl("# Creature Hits?"),e.creatureHits]),Gl=e=>Ml(`${xl(Vl("Fight Status:"),0)}<td colspan="3"><span>${e.fightStatus}</span></td>`),Pl=e=>Ml(`${xl(Vl("Notes:"),0)}<td colspan="3"><span style="font-size:x-small;">${e.extraNotes}</span></td>`)
let jl=0,Rl=0,_l=0
function Fl(){return cr(Rl)?"Remove from do not kill list":"Add to the do not kill list"}function Il(){r(Fl(),_l)}function Ol(){c("NewMap","doNotKillLink")
const e=t.doNotKillList.indexOf(Rl);-1===e?t.doNotKillList.push(Rl):t.doNotKillList.splice(e,1),Il(),D("doNotKillList",t.doNotKillList.join()),fr()}function Wl(){_l?Il():function(){_l=bt({className:"fshBl",textContent:Fl()})
const e=n({className:"description",innerHTML:'<span class="ui-helper-hidden-accessible"><input type="text"></span>'})
o(e,_l),o(jl,e),l(_l,Ol)}()}function ql(e,t){!function(e){if(!jl){const t=P("body",e)
1===t.length&&([jl]=t)}}(t),jl&&(Rl=W(e),Wl())}let Kl=0,Yl=0,zl=0,Ul=0
function Ql(){zl||(Yl||(Yl=n(),o(Kl,Yl),o(Kl,n({innerHTML:'<span class="fshFooter">*Does include CA, DD, HF, DC, Flinch, Super Elite Slayer, NMV, Sanctuary, Constitution, Fortitude, Chi Strike and Terrorize (if active) and allow for randomness (1.1053). Constitution, NMV, Fortitude and Chi Strike apply to group stats.</span>'}))),zl=n(),o(Yl,zl))}function Jl(e){Ql(),we(e,zl)}function Xl(e){Ul||(Ql(),Ul=n(),o(Yl,Ul)),we(e,Ul)}function Zl(e,t){const n={name:e.name,class:e.creature_class,attack:Number(e.attack),defense:Number(e.defense),armor:Number(e.armor),damage:Number(e.damage),hp:Number(e.hp)}
return function(e,t,n){3===n&&(t.attack-=Math.ceil(t.attack*e),t.defense-=Math.ceil(t.defense*e),t.armor-=Math.ceil(t.armor*e),t.damage-=Math.ceil(t.damage*e),t.hp-=Math.ceil(t.hp*e))}(t,n,e.type),n}function ec(e,n,a){const r={}
r.callback=a,r.player=xs(n),function(e){e.combatEvaluatorBias=t.combatEvaluatorBias,e.attackVariable=1.1053,e.generalVariable=t.generalVariable,e.hpVariable=t.hpVariable}(r),r.creature=Zl(e.response.data,r.player.superEliteSlayerMultiplier),function(e){var t
t=e,[$l,cl,bl,Cl,sl,tl,pl].forEach((e=>e(t)))}(r),r.evaluatorHTML=function(e){return`<table width="100%"><tbody>${Sl(e)}${Nl(e)}${Hl(e)}${Bl(e)}${Tl(e)}${El(e)}${Gl(e)}${Pl(e)}</tbody></table>`}(r),a.groupExists?Xl(r.evaluatorHTML):Jl(r.evaluatorHTML)}function tc(e){return e.members[0].name===u()}async function nc(e,t,n){if(n){!function(e,t,n){if(!n.r?.attributes)return
const a=n.r.attributes
ec(e,t,{groupExists:!0,groupAttackValue:a[0].value,groupDefenseValue:a[1].value,groupArmorValue:a[2].value,groupDamageValue:a[3].value,groupHPValue:a[4].value})}(e,t,await It(n))}}async function ac(e,t){const n=function(e){if(kt(e.r))return e.r.find(tc)?.id}(await qt())
nc(e,t,n)}async function rc(e,t){if(Kl||(Kl=a("dialog-viewcreature")),Kl&&(Jl(""),Xl(""),t?.response?.data)){ql(t.response.data.name,Kl)
const e=await Qt(!0)
e?._skills&&function(e,t){e.player.hasGroup&&ac(e,t),ec(e,t,{groupExists:!1})}(t,e)}}let oc=0
function sc(e){const t=P("verbs",e)
1===t.length&&it(t[0])}function ic(){if(!oc)return
const e=a("actionList")
q("player",e).forEach(sc)}const lc="showHuntingBuffs"
function cc(){return`${Xt(lc)} ${Zt("enabledHuntingMode")}<select name="enabledHuntingMode"><option value="1"${en(t.enabledHuntingMode,"1")}>${t.buffsName}</option><option value="2"${en(t.enabledHuntingMode,"2")}>${t.buffs2Name}</option><option value="3"${en(t.enabledHuntingMode,"3")}>${t.buffs3Name}</option></select>`}let uc=0,fc=""
const dc=()=>uc,mc=()=>fc
function pc(){const e=[null,[t.buffs,t.buffsName],[t.buffs2,t.buffs2Name],[t.buffs3,t.buffs3Name]][t.enabledHuntingMode]
kt(e)&&([uc,fc]=e)}function hc(e){"enabledHuntingMode"===e.target.name&&(c("NewMap","toggleEnabledHuntingMode"),t.enabledHuntingMode=e.target.value,D("enabledHuntingMode",t.enabledHuntingMode),pc(),GameData.fetch(f))}function gc(e){c("NewMap","togglePref"),t[e]=!t[e],D(e,t[e])}const vc={hideSubLvlCreature:function(){gc("hideSubLvlCreature"),GameData.fetch(Xe)},hidePlayerActions:function(){c("NewMap","toggleHidePlayerActions"),oc=!oc,D("hidePlayerActions",oc),GameData.fetch(Xe)},showCreatureInfo:()=>gc("showCreatureInfo"),showHuntingBuffs:function(){gc("showHuntingBuffs"),GameData.fetch(f)},showMonsterLog:()=>gc("showMonsterLog"),showTitanInfo:function(){gc("showTitanInfo"),ps(GameData.realm().dynamic)},showBuffInfo:function(){gc("showBuffInfo"),_n()}}
function bc(e){const t=vc[e.target.name]
z(t)&&(e.target.blur(),t(e))}function kc(){const e=a("worldPage")
if(!e)return
const t=n({className:"fshCenter fshFten"}),r=n({id:"fshWorldPrefs",innerHTML:`${Xt("showCreatureInfo")}&nbsp;&nbsp;${Xt("showMonsterLog")}&nbsp;&nbsp;${Xt("showTitanInfo")}&nbsp;&nbsp;${Xt("showBuffInfo")}<br>${Xt("hideSubLvlCreature")}&nbsp;&nbsp;${Xt("hidePlayerActions")}&nbsp;&nbsp;${cc()}`})
l(r,bc),v(r,"change",hc),o(t,r)
const s=n()
return o(t,s),o(e,t),s}const yc=[{generalVariable:1.1053,hpVariable:1.1},{generalVariable:1.1,hpVariable:1.053},{generalVariable:1.053,hpVariable:1},{generalVariable:1.1053,hpVariable:1}]
function wc(){var e
t.combatEvaluatorBias=b("combatEvaluatorBias"),t.generalVariable=(e=t.combatEvaluatorBias,yc[e]?yc[e].generalVariable:1.1053),t.hpVariable=function(e){return yc[e]?yc[e].hpVariable:1.1}(t.combatEvaluatorBias)}function Cc(e,t){return e[t.name]=!0,e}function $c(e,t,n){return e[W(n)]||t.push(n),t}function Lc(e){we("",e)}function Dc(e,t){const n=t.b.reduce(Cc,{}),a=dc().reduce(s($c,n),[])
a.length>0?function(e,t){we(`You are missing some ${mc()} hunting buffs<br>(${t.join(", ")})`,e)}(e,a):Lc(e)}function Vc(e,n,a){dc()&&function(e,n){t.showHuntingBuffs?Dc(e,n):Lc(e)}(e,a)}function Mc(e,t){return 6!==t.type||(0!==t.data.creature_type||t.data.level>=e)}function xc(e){const t=E(e)
return t?.actions?.length?(t.actions=t.actions.filter(s(Mc,function(e){return e.realm?.minlevel||GameData.realm().minlevel}(t))),lt(t)):e}function Ac(e,n){t.hideSubLvlCreature&&function(e){return e.data?.d&&tn(e.data.d,Xe)}(n)&&(e.dataFilter=xc)}function Sc(e){t[e[0]]=Jt(e[1])}function Nc(e){t[e]=Jt(e)}function Hc(){[["buffs","huntingBuffs"],["buffs2","huntingBuffs2"],["buffs3","huntingBuffs3"]].forEach(Sc),["doNotKillList"].forEach(Nc)}function Bc(e){t[e[0]]=b(e[1])}function Tc(e){t[e]=b(e)}function Ec(){[["buffsName","huntingBuffsName"],["buffs2Name","huntingBuffs2Name"],["buffs3Name","huntingBuffs3Name"],["showHuntingBuffs","showHuntingBuffs"]].forEach(Bc),["enabledHuntingMode","hideSubLvlCreature","showTitanInfo","showBuffInfo","showMonsterLog","showCreatureInfo"].forEach(Tc)}const Gc=[function(){let e=0
window.requestAnimationFrame=t=>{const n=window.performance.now(),a=Math.max(e+16,n)
return e=a,setTimeout((()=>{t(e)}),a-n)},window.cancelAnimationFrame=clearTimeout},function(){wc(),Hc(),Ec()
const e=kc()
$.ajaxPrefilter("JSON",Ac),t.hideSubLvlCreature&&GameData.fetch(Xe),function(e){pc()
const n=s(Vc,e)
$.subscribe(d,n),t.showHuntingBuffs&&window.initialGameData&&n(null,{b:window.initialGameData.player.buffs})}(e),oc=b("hidePlayerActions"),$.subscribe(U,ic),ic()},function(){Ze(),et()&&Gi()},function(){$.subscribe(st,rc)},function(){Hr.forEach(Br)},function(){b("enableCreatureColoring")&&o(document.body,Dt("#actionList .creature-1 {color: green;}\n#actionList .creature-2 {color: yellow;}\n#actionList .creature-3 {color: red;}"))},function(){$.subscribe(U,fr),fr(),function(){const e=GameData.doAction
GameData.doAction=pr(e)}()},function(){zr(),$.subscribe("-1-success.action-response 4-success.action-response 5-success.action-response 25-success.action-response",Zr),Zr()},function(){$.subscribe(Ue,xi)},async function(){if(b("keepLogs")){!function(e){e&&($a=e),$.subscribe(N,xa)}(await S("fsh_combatLog"))}},function(){window.initialGameData&&gs(0,window.initialGameData),$.subscribe(`${Le} ${De}`,gs)},function(){$.subscribe(at,Ki)},function(){$.subscribe(ze,Mi)},function(){$("#messageCenter").worldMessageCenter({offset:"0 60"})},function(){k("#mapTooltip")},function(){ca(),$.subscribe(p,ua),$.subscribe(h,fa)},function(){_n(),$.subscribe(`${d} ${m}`,_n)},function(){v(a("actionList"),"mouseover",lr)},function(){const{body:e}=document
v(e,"keydown",ya),v(e,"keyup",wa)},function(){const e=$("#world-event-badge")
e.length&&(e.off(),l(e[0],Sr))},function(){const e=x(".actionListHeaderButton.teleport")
!function(e,t){new Qi({target:e,props:t})}(e,{tpButton:e})},function(){var e
b("messageStack")&&(e=a("messageCenter"),new Rr({target:e}))},function(){GameController?.Realm?.footprintTexture?Ni():$.subscribe("fixed.realm",Hi)}]
function Pc(){e(Gc)}export{Pc as default}
//# sourceMappingURL=newMap-DHFCpW90.js.map
