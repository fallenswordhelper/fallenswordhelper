import{e}from"./executeAll-DIAWIge1.js"
import{ag as t,m as a,g as n,a9 as r,i as o,c as s,v as l,o as i,s as c,aD as u,aF as f,aG as d,aH as m,aI as p,aJ as h,y as g,b as v,ai as b,aK as w,aL as k,aM as y,aN as C,aO as L,ae as V,k as D,aC as M,q as x,aP as A,aQ as S,aR as N,aS as H,D as B,aT as T,aU as q,aV as E,aW as G,aX as P,aY as j,aZ as F,a_ as _,a$ as R,b0 as O,b1 as I,aj as W,a8 as K,b2 as Y,b3 as U,b4 as z,a as Q,$ as J,S as X,L as Z,M as ee,am as te,T as ae,_ as ne,a0 as re,O as oe,a3 as se,b5 as le,U as ie,a4 as ce,N as ue,P as fe,Q as de,b6 as me,b7 as pe,b8 as he,b9 as ge,Z as ve,X as be,a5 as we,ba as ke,d as ye,ap as Ce,bb as $e,bc as Le,bd as Ve,E as De,be as Me,bf as xe,bg as Ae,bh as Se,bi as Ne,bj as He,bk as Be,bl as Te,bm as qe,bn as Ee,bo as Ge,bp as Pe,bq as je,br as Fe,bs as _e,bt as Re,bu as Oe,bv as Ie,bw as We,bx as Ke,by as Ye,bz as Ue,bA as ze,bB as Qe,bC as Je,bD as Xe,bE as Ze,bF as et,bG as tt,bH as at,bI as nt,bJ as rt,bK as ot,bL as st,bM as lt,ah as it}from"./calfSystem-Dr91xfiU.js"
import{i as ct}from"./insertElementAfter-BtlU64wY.js"
import{t as ut}from"./toggleForce-br4z9gGd.js"
import{c as ft}from"./createSpan-DOXOkWJm.js"
import{i as dt}from"./insertTextBeforeEnd-Cp6tWrD_.js"
import{r as mt,a as pt}from"./roundToString-Hif1MLyB.js"
import{a as ht}from"./addCommas-C_h2HN8s.js"
import{d as gt,q as vt}from"./quickbuffSuccess-Ceu8YqfO.js"
import{c as bt}from"./createButton-D9sMfFbm.js"
import{i as wt}from"./isArray-eVldfhw1.js"
import{o as kt}from"./openQuickBuffById-D_7hBQoI.js"
import{c as yt}from"./createInput-CXxpqnZV.js"
import{c as Ct}from"./createLabel-Bea8ij54.js"
import{r as $t}from"./rnd-D_QmA-Fa.js"
import{v as Lt}from"./valueText-CHBSBeIq.js"
import{c as Vt}from"./createStyle-DbZ95tCv.js"
import{h as Dt,u as Mt}from"./await_block-BURScWZB.js"
import{u as xt}from"./uniq-z3ueDz-E.js"
import{g as At}from"./guild-CPwxUxeX.js"
import{c as St}from"./createTable-Dhwu_wtK.js"
import{g as Nt,t as Ht,a as Bt}from"./getTitanString-DvEb_zLX.js"
import{p as Tt}from"./padZ-DFV6JBPu.js"
import{f as qt}from"./fshOpen-AuKioUPF.js"
import{L as Et}from"./LinkButton-CSIDWINj.js"
import{r as Gt}from"./reduceBuffArray-Diy1E3zc.js"
import{p as Pt}from"./profile-C9UMZecS.js"
import{a as jt}from"./all-YfMtr2SN.js"
import{n as Ft}from"./numberIsNaN-CGkd1jiA.js"
import{r as _t}from"./reliclist-BpDf2bs8.js"
import{d as Rt}from"./daGroupStats-fPh-_ywN.js"
import{d as Ot,m as It}from"./mercEffect-CeGHacGZ.js"
import{d as Wt}from"./daViewGroups-C5H_1ArI.js"
import{a as Kt}from"./attribsToArray-D9XpJSw6.js"
import{g as Yt}from"./guildMembers-COz4FQhN.js"
import{r as Ut}from"./remainingPages-BzskAxSU.js"
import{t as zt}from"./testQuant-CUL735o8.js"
import{m as Qt}from"./myStats-tUv5EA-j.js"
import{s as Jt}from"./shouldBeArray-CVxYkf7k.js"
import{s as Xt,j as Zt}from"./simpleCheckbox-Bwko9K2v.js"
import{i as ea}from"./isSelected-BWnMzKlW.js"
import{b as ta}from"./bitwiseAnd-C5gmj-aX.js"
import"./buffReportParser-DNzLG8Ld.js"
import"./buffObj-BIwiFUIW.js"
import"./guildGroups-DVAHykl6.js"
import"./view-CkaIvDAe.js"
import"./intValue-C7nTQec1.js"
import"./csvSplit-DqenIMuc.js"
import"./isChecked-D_0do7nT.js"
let aa=0
function na(e){return e}function ra(e){if(function(e){return t.showBuffInfo&&e.some(na)}(e))return function(){if(aa)ut(aa,!1)
else{aa=a({className:"fshActionBox",innerHTML:"<div></div><div></div><div></div><div></div><div></div>"})
const e=n("actionContainer")
ct(aa,e.children[2])}return aa}()
aa&&ut(aa,!0)}function oa(e,t,a,n){t&&(e.className=t),r(a,e)
const s=ft()
return o(e,s),dt(e,n),s}let sa=0,la=0
function ia(e,t){sa?ut(sa,!1):function(e){sa=e.children[3],la=oa(sa,"fshBlue","CA "," active")}(e),r(t.level,la)}function ca(e,t){t?ia(e,t):sa&&ut(sa,!0)}let ua=0,fa=0
function da(e,t){ua?ut(ua,!1):function(e){ua=e.children[4],fa=oa(ua,"fshRed","Doubler "," active")}(e),r(t.level,fa)}function ma(e,t){t?da(e,t):ua&&ut(ua,!0)}let pa=0,ha=0
function ga(e,t,a){pa?ut(pa,!1):function(e){pa=e.children[2],ha=oa(pa,"","Damage bonus: ","%")}(e),r(function(e,t){if(e){const a=Math.min(.01*Math.round(Math.floor(t/5)*Number(e.level)),20)
return mt(a,2).toString()}return"0"}(t,Number(a)),ha)}function va(e,t,a){t?ga(e,t,a):pa&&ut(pa,!0)}let ba=0,wa=0
function ka(e,t){ba?ut(ba,!1):function(e){ba=e.children[1],wa=oa(ba,"","Kill Streak: ","")}(e),function(e,t){r(ht(e),t)}(t,wa)}function ya(e,t,a,n){t||a?ka(e,n):ba&&ut(ba,!0)}function Ca(e,t){return t.name===e}function $a(e){const{buffs:t}=GameData.player()
if(t)return t.find(s(Ca,e))}const La=["red","orange","yellow"]
let Va=0,Da=0
async function Ma(){if(c("NewMap","recastClick"),$a("Summon Shield Imp"))return
!function(e){vt(e)&&GameData.fetch(f)}(await gt([u()],[55]))}const xa=["imp-0","imp-1","imp-1"]
function Aa(e,t){Va?ut(Va,!1):function(e){[Va]=e.children,r("Shield Imps Remaining: ",Va),Da=ft(),o(Va,Da),l(Va,"&nbsp;")
const t=bt({className:"xSmallLink",textContent:"Recast"})
o(Va,t),i(t,Ma)}(e)
const a=function(e){return e?Number(e.stack):0}(t)
Va.className=function(e){return xa[e]??"fshGreen"}(a),r(a,Da)}function Sa(e,t,a){t||a?Aa(e,t):Va&&ut(Va,!0)}function Na(e){return 0===e.type}let Ha=0,Ba=0,Ta=0,qa=0,Ea=0,Ga=0
function Pa(){Ha=$a("Death Dealer"),Ba=$a("Doubler"),Ta=$a("Counter Attack"),qa=$a("Summon Shield Imp"),Ea=function(){const{dynamic:e}=GameData.realm()
return wt(e)&&e.some(Na)}(),Ga=GameData.player().killStreak}function ja(){!function(){const e=$("#actionlist-shield-imp")
1===e.length&&e.css("background-color",La[e.text()]||"#ad8043")}(),Pa()
const e=ra([Ha,Ba,Ta,qa,Ea])
e&&(Sa(e,qa,Ha),ya(e,Ha,Ea,Ga),va(e,Ha,Ga),ca(e,Ta),ma(e,Ba))}function Fa(e){return ft({textContent:e})}function _a(){window.GameController&&GameController.Realm&&!GameController.Realm.footprintTileList&&(GameController.Realm.footprintTileList=[])}function Ra(e,t,a){return Ct({className:`fshCurveEle fshCurveLbl fshPoint tip-static ${e}`,dataset:{tipped:t},htmlFor:a})}function Oa(e){const t=a({className:"fshToggle"}),n=yt({checked:e.prefVal,id:e.checkId,type:"checkbox"})
o(t,n)
const r=Ra(e.onClass,e.onTip,e.checkId)
o(t,r)
const s=Ra(e.offClass,e.offTip,e.checkId)
return o(t,s),o(e.worldName,t),n}let Ia=0,Wa=0,Ka=0,Ya=0,Ua=0,za=0,Qa=0,Ja=0,Xa=0
const Za=e=>Fa(e?e.toString():"?")
function en(e,t,n){const r=a({textContent:`${t} Lvl: `})
o(r,n),o(e,r)}function tn(e,t,a){const n=bt({className:`fshCurveEle fshCurveBtn fshPoint tip-static ${e}`,dataset:{tipped:t}})
return o(a,n),n}function an(e){!function(e){const t=a({className:"fshFsty"})
Wa=Za(GameData.realm().minlevel),en(t,"Min",Wa),Ka=Za(GameData.player().level),en(t,"Your",Ka),o(e,t)}(e),Ya=tn("fshFormGroup","Quick Create Attack Group",e),Ua=tn("fshQuickBuff","Open Quick Buff Popup",e),za=tn("fshRealmMap","Open Realm Map",e),Qa=tn("fshTempleOne","Search map in Ultimate FSG",e)}function nn(){an(Ia),function(e){if(b("showSpeakerOnWorld")){const t=b("playNewMessageSound")
Ja=Oa({prefVal:t,checkId:"fshSoundCheck",onClass:"soundOn",onTip:"Turn Off Sound when you have a new log message",offClass:"soundOff",offTip:"Turn On Sound when you have a new log message",worldName:e})}}(Ia),function(e){const a=t.huntingMode
Xa=Oa({prefVal:a,checkId:"fshHuntCheck",onClass:"huntOn",onTip:"Hunting mode is ON",offClass:"huntOff",offTip:"Hunting mode is OFF",worldName:e})}(Ia)}const rn=[[()=>Ja,function(){c("NewMap","toggleSound"),V("playNewMessageSound",!b("playNewMessageSound"))}],[()=>Xa,function(){c("NewMap","toggleHuntMode"),t.huntingMode=!t.huntingMode,V("huntingMode",t.huntingMode)}]],on=[[()=>Ya,function(e){c("NewMap","doFormGroup"),w(e),GameData.doAction(12,401,{},0)}],[()=>Ua,function(){c("NewMap","openQuickBuff"),kt(k())}],[()=>za,function(){c("NewMap","openRealmMap"),window.open(`${y+C}map`,"fsMap")}],[()=>Qa,function(){c("NewMap","openUfsgMap")
const e=GameData.realm()
window.open(`${L}realms${C}view&realm_id=${e.id}`,"mapUfsg")}]]
function sn(e,t){const{target:a}=t,[,n]=e.find((([e])=>e()===a))??[]
n&&(a.blur(),n(a))}function ln(e){return s(sn,e)}function cn(){Ia||(Ia=a({className:"fshCurveContainer",id:"fshWorldButtonContainer"}),nn(),i(Ia,ln(on)),v(Ia,"change",ln(rn)),g(Ia,n("worldCoord")))}function un(e,t){Wa&&t.b.minlevel&&(_a(),r(t.b.minlevel,Wa))}function fn(e,t){Ka&&r(t.b,Ka)}const dn=["NORMAL","CHAMPION","ELITE","SUPER ELITE","TITAN","LEGENDARY"],mn=`url("${A}ui/world/icon_action_attack_`
let pn=!1
function hn(e){return x(".verb.attack",e)}function gn(e){const t=dn.indexOf(e.toUpperCase())
return D(`#actionList .actionListItem.creature.creature-${t}`)}function vn(e){e.classList.remove("attack-1","attack-2","attack-3","attack-4","attack-5","attack-6","attack-7","attack-8"),e.style.backgroundImage=""}function bn(e,t){null!==e&&(e.classList.add(`attack-${t+1}`),e.style.backgroundImage=`${mn}${t+1}.png")`)}function wn(e){const t=["LEGENDARY","NORMAL"].flatMap(gn),a=gn("CHAMPION"),[n,r]=e?[t,a]:[a,t]
n.map(hn).filter((e=>null!==e)).forEach(vn),r.slice(0,8).map(hn).forEach(bn)}function kn(e){if(!e.altKey||!e.shiftKey||"INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName)return
if(pn||wn(!0),pn=!0,!/(?:Digit|Numpad)[1-8]/.test(e.code))return
const t=gn("CHAMPION"),a=parseInt(e.code.slice(-1),10)-1
a<t.length&&function(e){const t=hn(e)
t&&(c("NewMap","ChampionAttack"),M(t))}(t[a])}function yn(e){!pn||e.ctrlKey&&e.shiftKey||(pn=!1,wn(!1))}const Cn=["Breaker","Protection","Master Thief","Protect Gold","Disarm","Duelist","Thievery","Master Blacksmith","Master Crafter","Fury Caster","Master Inventor","Sustain"]
let $n=[],Ln=0
function Vn(e){54!==e.id&&26!==e.id||(Ln.player.buffs[e.id]=parseInt(e.level,10))}function Dn(e){-1===Cn.indexOf(e.name)&&(Ln.player.enhancements[e.name]=e.value)}function Mn(e){Ln={},Ln.combat=e.response.data,Ln.combat.inventory_id&&(Ln.combat.drop=Ln.combat.item.id),Ln.player={},Ln.player.buffs={},Ln.player.enhancements={},function(e){e.player.buffs&&e.player.buffs.forEach(Vn)}(e),function(e){e.player.enhancements&&e.player.enhancements.forEach(Dn)}(e),Ln.time=e.time,$n.push(Ln),H("fsh_combatLog",$n)}function xn(e,t){0===t.response.response&&Mn(t)}function An(e){return!e?.response?.data}async function Sn(e){const t=await T({cache:!1,url:"fetchdata.php",data:{...e,fshrnd:$t()},dataType:"text"})
return q(t)??{response:{msg:"Server Error",response:1}}}const Nn=[]
const Hn=(e,t)=>e===Number(t.response.data.id)
function Bn(e,t){e(t)}async function Tn(e,t){const a=Nn.find(s(Hn,e))
if(a)return function(e){return new Promise((t=>{E(3,Bn,[t,e])}))}(a)
const n=await Sn({a:1,d:0,id:e,passback:t})
return function(e){An(e)||Nn.push(e)}(n),n}let qn=0,En=0,Gn=0,Pn=0,jn=0,Fn=0
const _n=()=>qn,Rn=()=>En,On=()=>Gn,In=()=>Pn,Wn=()=>jn,Kn=()=>Fn
function Yn(e,t){return Lt(G(t,e))}function Un(){var e
qn=GameData.player().level,e=n("statbar-character-tooltip-stats"),Gn=Yn(e,P),En=Yn(e,j),jn=Yn(e,F),Pn=Yn(e,_),Fn=Yn(e,R)}const zn=e=>`<td>${e}:&nbsp;</td>`,Qn=e=>`<td width="40%">${e}</td>`
function Jn([e,t,a,n,r]){return[zn(e),Qn(`${t} (your ${a}:<span class="${n}">${r()}</span>)`)]}function Xn(e){return["<tr>",...e,"</tr>"].join("")}function Zn(e,t){return Xn([...Jn(e),...Jn(t)])}const er='<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Enhancements</td></tr>'
function tr(e){return`<tr><td colspan="2">${e.name}:</td><td colspan="2">${e.value}</td></tr>`}function ar(e,t,a){return function(e){return`<table><tr><td><img src="${A}creatures/${e.image_id}.png" height="200" width="200"></td><td rowspan="2"><table width="400"><tr><td class="header" colspan="4" class="fshCenter">Statistics</td></tr>`}(e)+function(e,t){return Xn([zn("Class"),Qn(e.creature_class),...Jn(["Level",e.level,"level",t,_n])])}(e,a)+function(e){return Zn(["Attack",e.attack,"defense","fshYellow",Rn],["Defense",e.defense,"attack","fshYellow",On])}(e)+function(e){return Zn(["Armor",e.armor,"damage","fshYellow",In],["Damage",e.damage,"armor","fshYellow",Wn])}(e)+function(e,t){return Xn([zn("HP"),Qn(`${e.hp} (your HP:<span class="fshYellow">${Kn()}</span>)(1H: <span class="fshRed">${t}</span>)`),zn("Gold"),Qn(e.gold)])}(e,t)+er+function(e){return 0===e.enhancements.length?'<tr><td colspan="4">[no enhancements]</td></tr>':e.enhancements.map(tr).join("")}(e)+function(e){return`<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Description</td></tr><tr><td colspan="4">${e.description}</td></tr><tr><td colspan="4" height="5"></td></tr></table></td></tr><tr><td class="fshCenter"><b>${e.name}</b></td></tr></table>`}(e)}function nr(e){if(!An(e))return function(e){const a=Math.ceil(e.hp*t.hpVariable+e.armor*t.generalVariable)
let n="fshYellow"
return Un(),_n()>e.level&&(n="fshRed"),ar(e,a,n)}(e.response.data)}const rr=["verb","view","tip-static"]
async function or(e,t){const a=function(e){return O(e.parentNode.children).indexOf(e)}(e),n=await Tn(GameData.actions()[a].data.id,a)
An(n)||function(e,t){const a=nr(t)
e.set("content.text",a)}(t,n)}function sr(e,t){c("NewMap","CreatureInfo"),e.classList.add("fshTip")
var a
const n=(a="Loading...",$(e).qtip({overwrite:!0,show:{event:"mouseover",ready:!0},style:{classes:"qtip-tipsy qtip-custom"},position:{my:"center right",at:"center left",effect:!1,viewport:$(window)},content:{text:a},hide:{effect:!1}})).qtip("api")
n&&or(t,n)}function lr(e,t){return a=e,rr.every((e=>B(e,a)))&&!B("fshTip",e)&&B("creature",t)
var a}function ir(e){if(!t.showCreatureInfo)return
const{target:a}=e,n=a.parentNode.parentNode.parentNode
lr(a,n)&&sr(a,n)}function cr(e){return t.doNotKillList.includes(I(e))}function ur(e){e.classList.toggle("fshBlue",cr(K(e)))}function fr(){const e=n("actionList")
W("creature",e).forEach(ur)}function dr(e){const t=GameData.actions()[e]
if(t)return function(e,t){if(cr(e))return c("NewMap","creatureOnList"),n("actionList").children[t].children[0].children[1].classList.remove("loading"),!0}(t.data.name,e)}const mr={2:function(e){return function(t,a,n,r){dr(n.passback)||e(t,a,n,r)}}}
function pr(e){return function(t,a,n,r){const o=mr[t];(function(e){return e&&U(e)})(o)&&function(e){return Y(e)||0===e}(r)?o(e)(t,a,n,r):e(t,a,n,r)}}function hr(){return e={subcmd:"contrib"},Q({cmd:"globalquests",...e})
var e}function gr(e){e[1]=e[2].r}function vr(e,t,a){const n=e.slice()
return n[3]=t[a].player,n[4]=t[a].value,n[6]=a,n}function br(e){let t,a,n=e[7].message+""
return{c(){t=oe("p"),a=se(n),le(t,"color","red")},m(e,n){ae(e,t,n),ie(t,a)},p(e,t){1&t&&n!==(n=e[7].message+"")&&ce(a,n)},d(e){e&&re(t)}}}function wr(e){let t,a
function n(e,a){return 1&a&&(t=null),null==t&&(t=!!wt(e[1])),t?yr:kr}gr(e)
let r=n(e,-1),o=r(e)
return{c(){o.c(),a=te()},m(e,t){o.m(e,t),ae(e,a,t)},p(e,t){gr(e),r===(r=n(e,t))&&o?o.p(e,t):(o.d(1),o=r(e),o&&(o.c(),o.m(a.parentNode,a)))},d(e){e&&re(a),o.d(e)}}}function kr(e){let t
return{c(){t=se("Server Error")},m(e,a){ae(e,t,a)},p:ne,d(e){e&&re(t)}}}function yr(e){let t,a,n,r=ue(e[1]),o=[]
for(let t=0;t<r.length;t+=1)o[t]=$r(vr(e,r,t))
return{c(){t=oe("table"),a=oe("tr"),a.innerHTML='<td class="header"></td> <td class="header"></td> <td class="header">Username</td> <td class="header">Kills</td>',n=fe()
for(let e=0;e<o.length;e+=1)o[e].c()
de(a,"class","svelte-1p6satm"),de(t,"id","world-event-contrib-table"),de(t,"class","svelte-1p6satm")},m(e,r){ae(e,t,r),ie(t,a),ie(t,n)
for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,null)},p(e,a){if(1&a){let n
for(r=ue(e[1]),n=0;n<r.length;n+=1){const s=vr(e,r,n)
o[n]?o[n].p(s,a):(o[n]=$r(s),o[n].c(),o[n].m(t,null))}for(;n<o.length;n+=1)o[n].d(1)
o.length=r.length}},d(e){e&&re(t),me(o,e)}}}function Cr(e){let t,a,n,r
return{c(){t=oe("a"),a=oe("img"),he(a.src,n=A+"guilds/"+e[3].guild_id+"_mini.png")||de(a,"src",n),de(a,"alt","guild logo"),de(a,"class","svelte-1p6satm"),de(t,"href",r=""+(ge+e[3].guild_id))},m(e,n){ae(e,t,n),ie(t,a)},p(e,o){1&o&&!he(a.src,n=A+"guilds/"+e[3].guild_id+"_mini.png")&&de(a,"src",n),1&o&&r!==(r=""+(ge+e[3].guild_id))&&de(t,"href",r)},d(e){e&&re(t)}}}function $r(e){let t,a,n,r,o,s,l,i,c,u,f,d,m,p=e[3].name+"",h=e[4]+"",g=e[3].guild_id&&Cr(e)
return{c(){t=oe("tr"),a=oe("td"),a.textContent=`${e[6]+1}`,n=fe(),r=oe("td"),g&&g.c(),o=fe(),s=oe("td"),l=oe("a"),i=se(p),u=fe(),f=oe("td"),d=se(h),m=fe(),de(l,"href",c=""+(pe+e[3].name)),de(t,"class","svelte-1p6satm")},m(e,c){ae(e,t,c),ie(t,a),ie(t,n),ie(t,r),g&&g.m(r,null),ie(t,o),ie(t,s),ie(s,l),ie(l,i),ie(t,u),ie(t,f),ie(f,d),ie(t,m)},p(e,t){e[3].guild_id?g?g.p(e,t):(g=Cr(e),g.c(),g.m(r,null)):g&&(g.d(1),g=null),1&t&&p!==(p=e[3].name+"")&&ce(i,p),1&t&&c!==(c=""+(pe+e[3].name))&&de(l,"href",c),1&t&&h!==(h=e[4]+"")&&ce(d,h)},d(e){e&&re(t),g&&g.d()}}}function Lr(e){let t
return{c(){t=se("Loading...")},m(e,a){ae(e,t,a)},p:ne,d(e){e&&re(t)}}}function Vr(e){let t,a,n={ctx:e,current:null,token:null,hasCatch:!0,pending:Lr,then:wr,catch:br,value:2,error:7}
return Dt(a=e[0],n),{c(){t=te(),n.block.c()},m(e,a){ae(e,t,a),n.block.m(e,n.anchor=a),n.mount=()=>t.parentNode,n.anchor=t},p(t,[r]){e=t,n.ctx=e,1&r&&a!==(a=e[0])&&Dt(a,n)||Mt(n,e,r)},i:ne,o:ne,d(e){e&&re(t),n.block.d(e),n.token=null,n=null}}}function Dr(e,t,a){let{promise:n}=t
return e.$$set=e=>{"promise"in e&&a(0,n=e.promise)},[n]}class Mr extends X{constructor(e){super(),Z(this,e,Dr,Vr,ee,{promise:0})}}let xr=0
const Ar=()=>({promise:J(hr)})
function Sr(){c("NewMap","GlobalTop")
const e=n("world-event-contrib")
var t
t=e,xr?xr.$set(Ar()):xr=new Mr({props:Ar(),target:t}),$(e).dialog({title:"Top 100 Event Contributers",minWidth:300,height:300,zIndex:9999})}function Nr(e){$(`#actionList li.creature-${e.toString()} a.create-group`).hide()}const Hr=["hideChampionsGroup","hideElitesGroup","hideSEGroup","hideTitanGroup","hideLegendaryGroup"]
function Br(e,t){var a
b(e)&&(a=t+1,$.subscribe(z,s(Nr,a)),Nr(t+1))}function Tr(e,t,a){const n=e.slice()
return n[9]=t[a].msg,n[10]=t[a].type,n[11]=t[a].count,n}function qr(e){let t,a,n,r=e[11]+""
return{c(){t=oe("div"),a=se("x"),n=se(r),de(t,"class","count svelte-1leyf3b")},m(e,r){ae(e,t,r),ie(t,a),ie(t,n)},p(e,t){1&t&&r!==(r=e[11]+"")&&ce(n,r)},d(e){e&&re(t)}}}function Er(e,t){let a,n,r,o,s,l,i,c=t[9]+"",u=t[11]>1&&qr(t)
function f(){return t[3](t[9])}return{key:e,first:null,c(){a=oe("div"),n=se(c),r=fe(),u&&u.c(),o=fe(),de(a,"class",s="fsh-message "+t[10]+" svelte-1leyf3b"),this.first=a},m(e,t){ae(e,a,t),ie(a,n),ie(a,r),u&&u.m(a,null),ie(a,o),l||(i=be(a,"click",f),l=!0)},p(e,r){t=e,1&r&&c!==(c=t[9]+"")&&ce(n,c),t[11]>1?u?u.p(t,r):(u=qr(t),u.c(),u.m(a,o)):u&&(u.d(1),u=null),1&r&&s!==(s="fsh-message "+t[10]+" svelte-1leyf3b")&&de(a,"class",s)},d(e){e&&re(a),u&&u.d(),l=!1,i()}}}function Gr(e){let t,a=[],n=new Map,r=ue(e[1](e[0]))
const o=e=>e[9]
for(let t=0;t<r.length;t+=1){let s=Tr(e,r,t),l=o(s)
n.set(l,a[t]=Er(l,s))}return{c(){for(let e=0;e<a.length;e+=1)a[e].c()
t=te()},m(e,n){for(let t=0;t<a.length;t+=1)a[t]&&a[t].m(e,n)
ae(e,t,n)},p(e,[s]){7&s&&(r=ue(e[1](e[0])),a=ve(a,s,o,1,e,r,n,t.parentNode,we,Er,t,Tr))},i:ne,o:ne,d(e){e&&re(t)
for(let t=0;t<a.length;t+=1)a[t].d(e)}}}function Pr(e,t,a){let n=[]
const r=window.$("#messageCenter").data().hcsWorldMessageCenter,o=function*(){for(let e=0;;e++)yield e}()
function s(){r._reposition()}function l(e){a(0,n=n.filter((({msg:t})=>t!==e))),s()}r._displayMessage=async function(e,t,r=3e3){const l=o.next().value
a(0,n=[...n,{msg:e,type:t,expire:l}]),setTimeout((()=>{a(0,n=n.filter((({expire:e})=>e!==l)))}),r),await ke(),s()}
return[n,e=>xt(e,"msg").map((({msg:t,type:a})=>({msg:t,type:a,count:e.filter((({msg:e})=>e===t)).length}))),l,e=>l(e)]}class jr extends X{constructor(e){super(),Z(this,e,Pr,Gr,ee,{})}}let Fr=0
function _r(e){Fr[e.name]?Fr[e.name].seen&&(Fr[e.name].seen+=1):(Fr[e.name]={seen:1},function(e,t){t.creature_class=e.creature_class,t.image_id=e.image_id,t.level=Number(e.level),t.type=e.type}(e,Fr[e.name]))}function Rr(e,t,a){return t?e(t,a):a}function Or(e,t){const a=e||{}
return a.min=Rr(Math.min,a.min,t),a.max=Rr(Math.max,a.max,t),a}const Ir=["attack","armor","damage","defense","hp"]
function Wr(e,t,a){const n=Or(t[a],Number(e[a]));(function(e,t){return!e||e.min!==t.min||e.max!==t.max})(t[a],n)&&(t[a]=n)}function Kr(e,t){e[t.name]=Or(e[t.name],Number(t.value))}function Yr(e){Fr||(Fr={}),_r(e),function(e,t){Ir.forEach(s(Wr,e,t))}(e,Fr[e.name]),function(e,t){(function(e){return e.enhancements&&e.enhancements.length>0})(e)&&(t.enhancements=t.enhancements||{},e.enhancements.forEach(s(Kr,t.enhancements)))}(e,Fr[e.name]),H("fsh_monsterLog",Fr)}async function Ur(){!function(e){Fr=e||{}}(await S("fsh_monsterLog"))}const zr=[]
function Qr(e){var a
An(e)||(a=e.response.data,t.showMonsterLog&&Yr(a))}function Jr(e,t){return e.id===t.id}async function Xr(e,t){if(6!==e.type||function(e){if(zr.find(s(Jr,e.data)))return!0
zr.push(e.data)}(e))return
Qr(await Tn(e.data.id,t))}function Zr(){t.showMonsterLog&&(GameData.actions().forEach(Xr),c("NewMap","MonsterLog"))}let eo=""
const to=()=>eo
function ao(){return At({subcmd:"scouttower"})}function no(e,[t,a,n]){const r=e.insertCell(-1)
return r.colSpan=t,n&&(r.className="header"),o(r,a()),r}function ro(e,t,a){const n=e.insertRow(-1)
return a&&(n.className="fshBlue"),function(e,t){t.forEach(s(no,e))}(n,t),n}function oo(e,t){ro(e,t[0],t[1])}function so(e,t){t.forEach(s(oo,e))}let lo=0,io=0,co=0,uo=0,fo=0,mo=0,po=0,ho=0
const go=()=>lo,vo=()=>io,bo=()=>co,wo=()=>uo,ko=()=>fo,yo=()=>mo,Co=()=>po,$o=()=>ho
function Lo(){lo=Fa("Current"),io=Fa("Kills"),co=Fa("Member"),uo=Fa("% of Total"),fo=Fa("Status"),mo=Fa("Titan HP"),po=Fa("Total"),ho=Fa("Your Guild")}let Vo=0,Do=0,Mo=0,xo=0,Ao=0,So=0,No=0,Ho=0,Bo=0
const To=()=>Vo,qo=()=>Do,Eo=()=>Mo,Go=()=>xo,Po=()=>Ao,jo=()=>So,Fo=()=>No,_o=()=>Ho,Ro=()=>Bo
function Oo(){Vo=ft({innerHTML:"&nbsp;"}),Do=ft({innerHTML:"&nbsp;"}),Mo=ft(),xo=ft(),Ao=ft(),So=ft(),No=ft(),Ho=ft(),Bo=ft()}let Io=0
const Wo=()=>Io
function Ko(){for(;Io.rows.length>8;)Io.deleteRow(8)}function Yo(){const e=ft()
return o(e,Eo()),dt(e,"/"),o(e,Go()),e}function Uo(e){const t=ft()
return o(t,e),dt(t,"%"),t}let zo=0,Qo=0,Jo=""
const Xo=()=>Qo,Zo=()=>Jo
function es(){Qo=null,zo&&!B("fshHide",zo)&&(ut(zo,!0),ye("&nbsp;",Vo),ye("&nbsp;",Do),r("",Mo),r("",xo),r("",Ao),r("",So),r("",No),ye("",Ho),ye("",Bo),Ko())}function ts(e){return 0===e.type&&(Qo=e.base_creature_id,Jo=`(${e.x},${e.y})`,!0)}function as(){if(zo)ut(zo,!1)
else{const e=n("actionContainer")
zo=a({className:"fshActionBox titanInfo"}),Oo(),Io=St({className:"fshCenter"}),Lo(),so(Io,[[[[5,To,!0],[1,qo,!0]]],[[[2,yo,!0],[4,$o,!0]]],[[[2,Yo],[4,Po]]],[[[2,go,!0],[4,s(Uo,jo())]],!0],[[[2,Co,!0],[4,s(Uo,Fo())]],!0],[[[2,ko,!0],[4,_o]],!0],[[[6,Ro]]],[[[2,bo,!0],[2,vo,!0],[2,wo,!0]]]]),o(zo,Wo()),o(e,zo)}}function ns(e){return e<=0?'<span class="fshGreen cooldown">No active cooldown</span>':`<span class="fshMaroon cooldown">Cooldown until: ${function(e){const t=new Date(Ce()+1e3*e)
return`${Tt(t.getHours())}:${Tt(t.getMinutes())} ${Tt(t.getDate())}/${$e[t.getMonth()]}/${t.getFullYear()}`}(e)}</span>`}function rs(e){return pt(Bt(e.max_hp-e.current_hp,e.kills),2)}function os(e){return pt(100*e.kills/e.max_hp,2)}function ss(e){!function(e){[[Ht(e.creature.name),To],[Zo(),qo],[e.current_hp,Eo],[e.max_hp,Go],[e.kills,Po],[rs(e),jo],[os(e),Fo]].forEach((([e,t])=>r(e,t())))}(e),ye(function(e){return Nt(e.kills,e.max_hp,e.current_hp)}(e),_o()),ye(ns(e.cooldown),Ro())}function ls(e,t){return[[[2,()=>Fa(t.player.name)],[2,()=>Fa(t.kills.toString())],[2,()=>Fa(`${pt(100*t.kills/e.kills,2)}%`)]]]}function is(e){return e.realm&&e.creature.base_id===Xo()&&e.realm===to()}function cs(e){const t=e.find(is)
t&&(ss(t),function(e){if(Ko(),!e.contributors)return
const t=e.contributors.map(s(ls,e))
so(Wo(),t)}(t))}let us=null
const fs=e=>e?.s&&wt(e.r),ds=e=>t.showTitanInfo&&wt(e)&&e.some(ts)
async function ms(){!function(e,t){fs(t)&&(cs(t.r),ds(GameData.realm().dynamic)?us=window.setTimeout(e,3e4):es())}(ms,await J(ao))}function ps(e){us&&(window.clearTimeout(us),us=null),ds(e)?(as(),ms()):es()}function hs(e){var t
e.dynamic&&(t=e.name,eo=t,ps(e.dynamic))}function gs(e,t){t.realm?.name&&hs(t.realm)}function vs(e,t,a){const n=e.slice()
return n[5]=t[a],n[7]=a,n}function bs(e){let t,a=e[1](e[7])+""
return{c(){t=se(a)},m(e,a){ae(e,t,a)},p:ne,d(e){e&&re(t)}}}function ws(e){let t,a,n,r
return a=new Et({props:{$$slots:{default:[bs]},$$scope:{ctx:e}}}),a.$on("click",(function(...t){return e[3](e[5],e[7],...t)})),{c(){t=oe("li"),He(a.$$.fragment),n=fe()},m(e,o){ae(e,t,o),Be(a,t,null),ie(t,n),r=!0},p(t,n){e=t
const r={}
256&n&&(r.$$scope={dirty:n,ctx:e}),a.$set(r)},i(e){r||(Me(a.$$.fragment,e),r=!0)},o(e){Se(a.$$.fragment,e),r=!1},d(e){e&&re(t),Te(a)}}}function ks(e){let t,a,n=ue(De(16,e[0])),r=[]
for(let t=0;t<n.length;t+=1)r[t]=ws(vs(e,n,t))
const o=e=>Se(r[e],1,1,(()=>{r[e]=null}))
return{c(){t=oe("ul")
for(let e=0;e<r.length;e+=1)r[e].c()
de(t,"class","svelte-1k3xw12")},m(e,n){ae(e,t,n)
for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(t,null)
a=!0},p(e,[a]){if(7&a){let s
for(n=ue(De(16,e[0])),s=0;s<n.length;s+=1){const o=vs(e,n,s)
r[s]?(r[s].p(o,a),Me(r[s],1)):(r[s]=ws(o),r[s].c(),Me(r[s],1),r[s].m(t,null))}for(xe(),s=n.length;s<r.length;s+=1)o(s)
Ae()}},i(e){if(!a){for(let e=0;e<n.length;e+=1)Me(r[e])
a=!0}},o(e){r=r.filter(Boolean)
for(let e=0;e<r.length;e+=1)Se(r[e])
a=!1},d(e){e&&re(t),me(r,e)}}}function ys(e,t,a){const n=Ne()
let{members:r=[]}=t
const o=e=>`Buff ${qe[e]} 16`
function s(e,t,a){a.target.blur(),qt(`${Ee}&players=${e.join(",")}`,"fsQuickBuff",618,1e3,",scrollbars"),n("buffBatch",o(t))}return e.$$set=e=>{"members"in e&&a(0,r=e.members)},[r,o,s,(e,t,a)=>s(e,t,a)]}class Cs extends X{constructor(e){super(),Z(this,e,ys,ks,ee,{members:0})}}function $s(e,t){return e>10*t||e<t?e:10*t}const Ls=[["levelValue","level"],["attackValue","attack"],["attackBonus","bonus_attack"],["defenseValue","defense"],["defenseBonus","bonus_defense"],["armorValue","armor"],["armorBonus","bonus_armor"],["damageValue","damage"],["damageBonus","bonus_damage"],["hpValue","hp"],["hpBonus","bonus_hp"],["killStreakValue","killstreak"]]
function Vs(e,t,a){e[a[0]]=Number(t[a[1]])}const Ds=[["counterAttackLevel","Counter Attack"],["doublerLevel","Doubler"],["deathDealerLevel","Death Dealer"],["darkCurseLevel","Dark Curse"],["holyFlameLevel","Holy Flame"],["constitutionLevel","Constitution"],["sanctuaryLevel","Sanctuary"],["flinchLevel","Flinch"],["nightmareVisageLevel","Nightmare Visage"],["superEliteSlayerLevel","Super Elite Slayer"],["fortitudeLevel","Fortitude"],["chiStrikeLevel","Chi Strike"],["terrorizeLevel","Terrorize"],["barricadeLevel","Barricade"],["reignOfTerrorLevel","Reign Of Terror"],["anchoredLevel","Anchored"],["severeConditionLevel","Severe Condition"],["entrenchLevel","Entrench"],["cloakLevel","Cloak"]]
function Ms(e,t,a){e[a[0]]=t[a[1]]||0}function xs(e){if(!e._skills)return
const t=Gt(e._skills),a={}
return function(e,t){Ls.forEach(s(Vs,e,t))}(a,e),function(e,t){Ds.forEach(s(Ms,e,t))}(a,t),a.superEliteSlayerMultiplier=mt(.002*a.superEliteSlayerLevel,2),Ft(a.armorValue)&&function(e){e.attackValue=$s(e.attackBonus,e.levelValue),e.defenseValue=$s(e.defenseBonus,e.levelValue),e.armorValue=$s(e.armorBonus,e.levelValue),e.damageValue=$s(e.damageBonus,e.levelValue),e.hpValue=e.hpBonus}(a),a}const As=Pe(["statusStore","Done."])
let Ss=[]
const Ns=Ge(As,((e,t)=>{const a=Ss.find((([t])=>t===e[0]))
a?[,a[1]]=e:Ss=[...Ss,e]
const n=Ss.find((([,e])=>"Done."!==e))
t(n?.[1]??"Done.")})),Hs=Pe(0)
const Bs=Ge(Hs,((e,t)=>{!async function(e,t){if(!e)return
As.set(["relicStore","Processing defending guild relics ... "])
const a=await _t(e)
if(!a?.r?.relics)return void As.set(["relicStore","AJAX Error"])
const n=a.r.relics.length,r=1===n?1.5:mt(1-n/10,2)
t({noOfRelics:n,relicMultiplier:r,leadDefenderBonus:`${String(100*r)}%`}),As.set(["relicStore","Done."])}(e,t)})),Ts=Pe([])
const qs=Ge(Ts,((e,t)=>{!async function(e,t){if(!e.length)return
As.set(["defendersStore","Processing defending group stats ... "])
const a=[]
await jt(e.map((async(e,n)=>{const r=await Pt(e)
a.push([n,xs(r)]),t(a)}))),As.set(["defendersStore","Done."])}(e,t)})),Es=Ge(qs,((e,t)=>{const a=e?.find((([e])=>0===e))
a&&t(a[1])})),Gs=(e,t,a)=>Math.ceil(a*(0===t?e:je))
function Ps(e,t,[a,n]){return{armorValue:t.armorValue+Gs(e,a,n.armorValue),attackValue:t.attackValue+Gs(e,a,n.attackValue),damageValue:t.damageValue+Gs(e,a,n.damageValue),cloaked:t.cloaked+(n.cloakLevel?1:0),defenseValue:t.defenseValue+Gs(e,a,n.defenseValue),hpValue:t.hpValue+Gs(e,a,n.hpValue)}}const js=Ge([Bs,qs],(([e,t],a)=>{if(!e?.relicMultiplier||!t?.length)return
const n=t?.reduce(s(Ps,e.relicMultiplier),{armorValue:0,attackValue:0,damageValue:0,cloaked:0,defenseValue:0,hpValue:0})
a(n)})),Fs=Pe(0),_s=e=>e.members[0].name===GameData.player().username
async function Rs(e,t){if(!e)return
As.set(["groupStore","Processing attacking group stats ... "])
const a=await async function(){const e=await Wt()
return e?.r?.find(_s)?.id}(),n=a&&await async function(e){const t=await Rt(e)
return Kt(t?.r?.attributes)}(a),r=n&&await async function(e){const t=await Ot(),a=It(t)
return e?.map(((e,t)=>e-a[t]))}(n)
r&&t({attack:r[0],defense:r[1],armor:r[2],hp:r[3],damage:r[4]}),As.set(["groupStore","Done."])}const Os=Ge(Fs,((e,t)=>{Rs(e,t)})),Is=(e,t,a)=>Math.ceil(e*Fe(t,0)*a),Ws=(e,t)=>Is(e,t,.0025),Ks=(e,t)=>Is(e,t,.001),Ys=Ks,Us=Ks,zs=Ks,Qs=Ks,Js=Ks,Xs=(e,t)=>Math.ceil(e*(1+.001*Fe(t,0))),Zs=(e,t)=>Math.ceil(e*(1-t*_e)),el=Pe([]),tl=Ge(el,((e,t)=>{e&&t(Gt(e))})),al=Ge([tl,Os],(([e,t],a)=>{if(!e||!t)return
const n=Xs(t.defense,e.Constitution),r=Ys(n,e.Fortitude),o=t.hp+r,s=Us(o,e["Chi Strike"])
a({dmgWithChiStrike:t.damage+s,defWithConst:n,hpWithFortitude:o,nmv:Ws(t.attack,e["Nightmare Visage"]),sanctuary:zs(t.armor,e.Sanctuary)})}))
const nl=Ge([al,Es,Os],(function([e,t,a],n){if(!e||!t||!a)return
const r=a.attack-e.nmv,o=Qs(r,t.flinchLevel),s=Js(e.dmgWithChiStrike,t.terrorizeLevel)
n({attack:r-o,defense:e.defWithConst+e.nmv,armor:a.armor+e.sanctuary,hp:e.hpWithFortitude,damage:e.dmgWithChiStrike-s})})),rl=Ge([Es,js],(([e,t],a)=>{if(!e||!t)return
const n=Ws(t.attackValue,e.nightmareVisageLevel),r=Xs(t.defenseValue,e.constitutionLevel),o=Ys(r,e.fortitudeLevel),s=t.hpValue+o,l=Us(s,e.chiStrikeLevel),i=t.damageValue+l
a({attackWithNmv:t.attackValue-n,chiStrike:e.chiStrikeLevel,cloak:e.cloakLevel?"Yes":"No",dmgWithChiStrike:i,defWithConst:r,hpWithFortitude:s,nmv:n,sanctuary:zs(t.armorValue,e.sanctuaryLevel)})}))
const ol=Ge([tl,rl,js],(function([e,t,a],n){if(!e||!t||!a)return
const r=Qs(t.attackWithNmv,e.Flinch),o=t.defWithConst+t.nmv,s=Js(t.dmgWithChiStrike,e.Terrorize)
n({attack:t.attackWithNmv-r,dc225:Zs(o,225),dc175:Zs(o,175),defense:o,armor:a.armorValue+t.sanctuary,hp:t.hpWithFortitude,damage:t.dmgWithChiStrike-s})})),sl=Ge(Bs,((e,t)=>{t({noOfRelics:e?.noOfRelics??"",leadDefenderBonus:e?.leadDefenderBonus??""})})),ll=Ge(Es,((e,t)=>{if(!e)return t("")
e.cloakLevel?t("Yes"):t("No")})),il=Ge(js,((e,t)=>{t({armorValue:e?.armorValue??"",attackValue:e?.attackValue??"",damageValue:e?.damageValue??"",cloaked:e?.cloaked??"",defenseValue:e?.defenseValue??"",hpValue:e?.hpValue??""})})),cl=Ge(qs,((e,t)=>{t(e?.length??"")})),ul=Ge(ol,((e,t)=>{t({attack:e?.attack??"",dc225:e?.dc225??"",dc175:e?.dc175??"",defense:e?.defense??"",armor:e?.armor??"",hp:e?.hp??"",damage:e?.damage??""})})),fl=e=>({attack:e?.attack??"",defense:e?.defense??"",armor:e?.armor??"",hp:e?.hp??"",damage:e?.damage??""}),dl=Ge(Os,((e,t)=>{t(fl(e))})),ml=Ge(nl,((e,t)=>{t(fl(e))}))
function pl(e,t,a){const n=e.slice()
return n[6]=t[a].id,n[7]=t[a].username,n}function hl(e){let t,a,n,r,o=e[7]+""
return{c(){t=oe("a"),a=se(o),r=se(" "),de(t,"href",n=""+(Re+e[6])),de(t,"class","svelte-3priew")},m(e,n){ae(e,t,n),ie(t,a),ae(e,r,n)},p(e,r){1&r&&o!==(o=e[7]+"")&&ce(a,o),1&r&&n!==(n=""+(Re+e[6]))&&de(t,"href",n)},d(e){e&&(re(t),re(r))}}}function gl(e){let t,a,n,r=(e[0].length||"")+"",o=ue(e[0]),s=[]
for(let t=0;t<o.length;t+=1)s[t]=hl(pl(e,o,t))
return{c(){t=se(r),a=se(" Offline guild members not at relic:\n"),n=oe("div")
for(let e=0;e<s.length;e+=1)s[e].c()
de(n,"class","missing svelte-3priew")},m(e,r){ae(e,t,r),ae(e,a,r),ae(e,n,r)
for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(n,null)},p(e,[a]){if(1&a&&r!==(r=(e[0].length||"")+"")&&ce(t,r),1&a){let t
for(o=ue(e[0]),t=0;t<o.length;t+=1){const r=pl(e,o,t)
s[t]?s[t].p(r,a):(s[t]=hl(r),s[t].c(),s[t].m(n,null))}for(;t<s.length;t+=1)s[t].d(1)
s.length=o.length}},i:ne,o:ne,d(e){e&&(re(t),re(a),re(n)),me(s,e)}}}function vl(e,t,a){let{members:n=[]}=t,r=[]
const o=[({username:e})=>!n.includes(e),({last_login:e})=>e,({last_login:e})=>e<Ie(),({last_login:e})=>e>We(),({level:e})=>e<400||e>421,({level:e})=>e<441||e>450],s=e=>o.every((t=>t(e))),l=({username:e},{username:t})=>Oe(e,t)
return Hs.subscribe((e=>{!async function(e){const t=await Yt(e)
wt(t)&&a(0,r=t.filter(s).sort(l))}(e)})),e.$$set=e=>{"members"in e&&a(1,n=e.members)},[r,n]}class bl extends X{constructor(e){super(),Z(this,e,vl,gl,ee,{members:1})}}function wl(e){let t,a,n
return a=new Cs({props:{members:e[10]}}),a.$on("buffBatch",e[11]),{c(){t=oe("div"),He(a.$$.fragment),de(t,"class","buff-links svelte-1qul0wc")},m(e,r){ae(e,t,r),Be(a,t,null),n=!0},p:ne,i(e){n||(Me(a.$$.fragment,e),n=!0)},o(e){Se(a.$$.fragment,e),n=!1},d(e){e&&re(t),Te(a)}}}function kl(e){let t,a,n,r,o,s,l,i
return{c(){t=oe("div"),t.textContent="Processing",a=fe(),n=oe("div"),r=se(e[2]),o=fe(),s=oe("div"),s.textContent="Assumptions",l=fe(),i=oe("div"),i.textContent="Above calculations include Constitution, Fortitude, Nightmare Visage, Chi Strike, Sanctuary,\n        Terrorize and Flinch bonus calculations (in that order) on both the defending group and\n        attacking group.",de(t,"class","b-top svelte-1qul0wc"),de(n,"class","proc-stat svelte-1qul0wc"),de(s,"class","b-top svelte-1qul0wc"),de(i,"class","assume svelte-1qul0wc")},m(e,c){ae(e,t,c),ae(e,a,c),ae(e,n,c),ie(n,r),ae(e,o,c),ae(e,s,c),ae(e,l,c),ae(e,i,c)},p(e,t){4&t&&ce(r,e[2])},d(e){e&&(re(t),re(a),re(n),re(o),re(s),re(l),re(i))}}}function yl(e){let t,a,n
return{c(){t=oe("button"),t.textContent="Fetch Stats",de(t,"class","custombutton"),de(t,"type","button")},m(r,o){ae(r,t,o),a||(n=be(t,"click",e[12]),a=!0)},p:ne,d(e){e&&re(t),a=!1,n()}}}function Cl(e){let t,a,n,r,o,s,l,i,c,u,f,d,m,p,h,g,v,b,w,k,y,C,$,L,V,D,M,x,A,S,N,H,B,T,q,E,G,P,j,F,_,R,O,I,W,K,Y,U,z,Q,J,X,Z,ee,te,ne,le,ue,me,pe,he,ge,ve,be,we,ke,ye,Ce,$e,Le,Ve,De,xe,Ae,Ne,qe,Ee,Ge,Pe,je,Fe,_e,Re,Oe,Ie,We,Ke,Ye,Ue,ze,Qe,Je,Xe,Ze,et,tt,at,nt,rt,ot,st,lt,it,ct,ut,ft,dt,mt,pt,ht,gt,vt,bt,wt,kt,yt,Ct,$t,Lt,Vt,Dt,Mt,xt,At,St,Nt,Ht,Bt=e[3].noOfRelics+"",Tt=e[3].leadDefenderBonus+"",qt=e[5].attackValue+"",Et=e[6].attack+"",Gt=e[5].defenseValue+"",Pt=e[6].defense+"",jt=e[5].armorValue+"",Ft=e[6].armor+"",_t=e[5].damageValue+"",Rt=e[6].damage+"",Ot=e[5].hpValue+"",It=e[6].hp+"",Wt=e[5].cloaked+"",Kt=e[6].dc225+"",Yt=e[6].dc175+"",Ut=e[8].attack+"",zt=e[9].attack+"",Qt=e[8].defense+"",Jt=e[9].defense+"",Xt=e[8].armor+"",Zt=e[9].armor+"",ea=e[8].damage+"",ta=e[9].damage+"",aa=e[8].hp+"",na=e[9].hp+""
return Nt=new bl({props:{members:e[10]}}),{c(){t=oe("div"),a=oe("div"),a.textContent="Defending Guild Stats",n=fe(),r=oe("div"),o=oe("div"),o.textContent="Relic Count:",s=oe("div"),l=se(Bt),i=fe(),c=oe("div"),c.textContent="Lead Defender Bonus:",u=oe("div"),f=se(Tt),d=fe(),m=oe("div"),m.textContent="Lead Defender Cloaked:",p=oe("div"),h=se(e[4]),g=fe(),v=oe("div"),v.textContent="Other Defender Stats",b=fe(),w=oe("div"),k=oe("div"),k.textContent="Raw Attack:",y=oe("div"),C=se(qt),$=fe(),L=oe("div"),L.textContent="Attack w/ buffs:",V=oe("div"),D=se(Et),M=fe(),x=oe("div"),x.textContent="Raw Defense:",A=oe("div"),S=se(Gt),N=fe(),H=oe("div"),H.textContent="Defense w/buffs:",B=oe("div"),T=se(Pt),q=fe(),E=oe("div"),E.textContent="Raw Armor:",G=oe("div"),P=se(jt),j=fe(),F=oe("div"),F.textContent="Armor w/ buffs:",_=oe("div"),R=se(Ft),O=fe(),I=oe("div"),I.textContent="Raw Damage:",W=oe("div"),K=se(_t),Y=fe(),U=oe("div"),U.textContent="Damage w/ buffs:",z=oe("div"),Q=se(Rt),J=fe(),X=oe("div"),X.textContent="Raw HP:",Z=oe("div"),ee=se(Ot),te=fe(),ne=oe("div"),ne.textContent="HP w/ buffs:",le=oe("div"),ue=se(It),me=fe(),pe=oe("div"),pe.textContent="Cloaked:",he=oe("div"),ge=se(Wt),ve=fe(),be=oe("div"),be.textContent="Processed:",we=oe("div"),ke=se(e[7]),ye=fe(),Ce=oe("div"),$e=oe("div"),$e.textContent="Adjusted Defense Values",Le=fe(),Ve=oe("div"),De=oe("div"),De.textContent="DC225:",xe=oe("div"),Ae=se(Kt),Ne=fe(),qe=oe("div"),qe.textContent="DC175:",Ee=oe("div"),Ge=se(Yt),Pe=fe(),je=oe("div"),je.textContent="Â ",Fe=fe(),_e=oe("div"),_e.textContent="Attacking Group Stats",Re=fe(),Oe=oe("div"),Ie=oe("div"),Ie.textContent="Raw Group Attack:",We=oe("div"),Ke=se(Ut),Ye=fe(),Ue=oe("div"),Ue.textContent="Group Attack w/ buffs:",ze=oe("div"),Qe=se(zt),Je=fe(),Xe=oe("div"),Xe.textContent="Raw Group Defense:",Ze=oe("div"),et=se(Qt),tt=fe(),at=oe("div"),at.textContent="Group Defense w/ buffs:",nt=oe("div"),rt=se(Jt),ot=fe(),st=oe("div"),st.textContent="Raw Group Armor:",lt=oe("div"),it=se(Xt),ct=fe(),ut=oe("div"),ut.textContent="Group Armor w/ buffs:",ft=oe("div"),dt=se(Zt),mt=fe(),pt=oe("div"),pt.textContent="Raw Group Damage:",ht=oe("div"),gt=se(ea),vt=fe(),bt=oe("div"),bt.textContent="Group Damage w/ buffs:",wt=oe("div"),kt=se(ta),yt=fe(),Ct=oe("div"),Ct.textContent="Raw Group HP:",$t=oe("div"),Lt=se(aa),Vt=fe(),Dt=oe("div"),Dt.textContent="Group HP w/ buffs:",Mt=oe("div"),xt=se(na),At=fe(),St=oe("div"),He(Nt.$$.fragment),de(a,"class","b-top svelte-1qul0wc"),de(o,"class","svelte-1qul0wc"),de(s,"class","svelte-1qul0wc"),de(c,"class","svelte-1qul0wc"),de(u,"class","svelte-1qul0wc"),de(m,"class","svelte-1qul0wc"),de(p,"class","svelte-1qul0wc"),de(r,"class","stat-grid svelte-1qul0wc"),de(v,"class","b-top svelte-1qul0wc"),de(k,"class","svelte-1qul0wc"),de(y,"class","svelte-1qul0wc"),de(L,"class","svelte-1qul0wc"),de(V,"class","svelte-1qul0wc"),de(x,"class","svelte-1qul0wc"),de(A,"class","svelte-1qul0wc"),de(H,"class","svelte-1qul0wc"),de(B,"class","svelte-1qul0wc"),de(E,"class","svelte-1qul0wc"),de(G,"class","svelte-1qul0wc"),de(F,"class","svelte-1qul0wc"),de(_,"class","svelte-1qul0wc"),de(I,"class","svelte-1qul0wc"),de(W,"class","svelte-1qul0wc"),de(U,"class","svelte-1qul0wc"),de(z,"class","svelte-1qul0wc"),de(X,"class","svelte-1qul0wc"),de(Z,"class","svelte-1qul0wc"),de(ne,"class","svelte-1qul0wc"),de(le,"class","svelte-1qul0wc"),de(pe,"class","svelte-1qul0wc"),de(he,"class","svelte-1qul0wc"),de(be,"class","svelte-1qul0wc"),de(we,"class","svelte-1qul0wc"),de(w,"class","stat-grid svelte-1qul0wc"),de(t,"class","middle svelte-1qul0wc"),de($e,"class","b-top svelte-1qul0wc"),de(De,"class","svelte-1qul0wc"),de(xe,"class","svelte-1qul0wc"),de(qe,"class","svelte-1qul0wc"),de(Ee,"class","svelte-1qul0wc"),de(je,"class","svelte-1qul0wc"),de(Ve,"class","stat-grid svelte-1qul0wc"),de(_e,"class","b-top svelte-1qul0wc"),de(Ie,"class","svelte-1qul0wc"),de(We,"class","svelte-1qul0wc"),de(Ue,"class","svelte-1qul0wc"),de(ze,"class","svelte-1qul0wc"),de(Xe,"class","svelte-1qul0wc"),de(Ze,"class","svelte-1qul0wc"),de(at,"class","svelte-1qul0wc"),de(nt,"class","svelte-1qul0wc"),de(st,"class","svelte-1qul0wc"),de(lt,"class","svelte-1qul0wc"),de(ut,"class","svelte-1qul0wc"),de(ft,"class","svelte-1qul0wc"),de(pt,"class","svelte-1qul0wc"),de(ht,"class","svelte-1qul0wc"),de(bt,"class","svelte-1qul0wc"),de(wt,"class","svelte-1qul0wc"),de(Ct,"class","svelte-1qul0wc"),de($t,"class","svelte-1qul0wc"),de(Dt,"class","svelte-1qul0wc"),de(Mt,"class","svelte-1qul0wc"),de(Oe,"class","stat-grid svelte-1qul0wc"),de(Ce,"class","right svelte-1qul0wc"),de(St,"class","bottom b-top svelte-1qul0wc")},m(e,re){ae(e,t,re),ie(t,a),ie(t,n),ie(t,r),ie(r,o),ie(r,s),ie(s,l),ie(r,i),ie(r,c),ie(r,u),ie(u,f),ie(r,d),ie(r,m),ie(r,p),ie(p,h),ie(t,g),ie(t,v),ie(t,b),ie(t,w),ie(w,k),ie(w,y),ie(y,C),ie(w,$),ie(w,L),ie(w,V),ie(V,D),ie(w,M),ie(w,x),ie(w,A),ie(A,S),ie(w,N),ie(w,H),ie(w,B),ie(B,T),ie(w,q),ie(w,E),ie(w,G),ie(G,P),ie(w,j),ie(w,F),ie(w,_),ie(_,R),ie(w,O),ie(w,I),ie(w,W),ie(W,K),ie(w,Y),ie(w,U),ie(w,z),ie(z,Q),ie(w,J),ie(w,X),ie(w,Z),ie(Z,ee),ie(w,te),ie(w,ne),ie(w,le),ie(le,ue),ie(w,me),ie(w,pe),ie(w,he),ie(he,ge),ie(w,ve),ie(w,be),ie(w,we),ie(we,ke),ae(e,ye,re),ae(e,Ce,re),ie(Ce,$e),ie(Ce,Le),ie(Ce,Ve),ie(Ve,De),ie(Ve,xe),ie(xe,Ae),ie(Ve,Ne),ie(Ve,qe),ie(Ve,Ee),ie(Ee,Ge),ie(Ve,Pe),ie(Ve,je),ie(Ce,Fe),ie(Ce,_e),ie(Ce,Re),ie(Ce,Oe),ie(Oe,Ie),ie(Oe,We),ie(We,Ke),ie(Oe,Ye),ie(Oe,Ue),ie(Oe,ze),ie(ze,Qe),ie(Oe,Je),ie(Oe,Xe),ie(Oe,Ze),ie(Ze,et),ie(Oe,tt),ie(Oe,at),ie(Oe,nt),ie(nt,rt),ie(Oe,ot),ie(Oe,st),ie(Oe,lt),ie(lt,it),ie(Oe,ct),ie(Oe,ut),ie(Oe,ft),ie(ft,dt),ie(Oe,mt),ie(Oe,pt),ie(Oe,ht),ie(ht,gt),ie(Oe,vt),ie(Oe,bt),ie(Oe,wt),ie(wt,kt),ie(Oe,yt),ie(Oe,Ct),ie(Oe,$t),ie($t,Lt),ie(Oe,Vt),ie(Oe,Dt),ie(Oe,Mt),ie(Mt,xt),ae(e,At,re),ae(e,St,re),Be(Nt,St,null),Ht=!0},p(e,t){(!Ht||8&t)&&Bt!==(Bt=e[3].noOfRelics+"")&&ce(l,Bt),(!Ht||8&t)&&Tt!==(Tt=e[3].leadDefenderBonus+"")&&ce(f,Tt),(!Ht||16&t)&&ce(h,e[4]),(!Ht||32&t)&&qt!==(qt=e[5].attackValue+"")&&ce(C,qt),(!Ht||64&t)&&Et!==(Et=e[6].attack+"")&&ce(D,Et),(!Ht||32&t)&&Gt!==(Gt=e[5].defenseValue+"")&&ce(S,Gt),(!Ht||64&t)&&Pt!==(Pt=e[6].defense+"")&&ce(T,Pt),(!Ht||32&t)&&jt!==(jt=e[5].armorValue+"")&&ce(P,jt),(!Ht||64&t)&&Ft!==(Ft=e[6].armor+"")&&ce(R,Ft),(!Ht||32&t)&&_t!==(_t=e[5].damageValue+"")&&ce(K,_t),(!Ht||64&t)&&Rt!==(Rt=e[6].damage+"")&&ce(Q,Rt),(!Ht||32&t)&&Ot!==(Ot=e[5].hpValue+"")&&ce(ee,Ot),(!Ht||64&t)&&It!==(It=e[6].hp+"")&&ce(ue,It),(!Ht||32&t)&&Wt!==(Wt=e[5].cloaked+"")&&ce(ge,Wt),(!Ht||128&t)&&ce(ke,e[7]),(!Ht||64&t)&&Kt!==(Kt=e[6].dc225+"")&&ce(Ae,Kt),(!Ht||64&t)&&Yt!==(Yt=e[6].dc175+"")&&ce(Ge,Yt),(!Ht||256&t)&&Ut!==(Ut=e[8].attack+"")&&ce(Ke,Ut),(!Ht||512&t)&&zt!==(zt=e[9].attack+"")&&ce(Qe,zt),(!Ht||256&t)&&Qt!==(Qt=e[8].defense+"")&&ce(et,Qt),(!Ht||512&t)&&Jt!==(Jt=e[9].defense+"")&&ce(rt,Jt),(!Ht||256&t)&&Xt!==(Xt=e[8].armor+"")&&ce(it,Xt),(!Ht||512&t)&&Zt!==(Zt=e[9].armor+"")&&ce(dt,Zt),(!Ht||256&t)&&ea!==(ea=e[8].damage+"")&&ce(gt,ea),(!Ht||512&t)&&ta!==(ta=e[9].damage+"")&&ce(kt,ta),(!Ht||256&t)&&aa!==(aa=e[8].hp+"")&&ce(Lt,aa),(!Ht||512&t)&&na!==(na=e[9].hp+"")&&ce(xt,na)},i(e){Ht||(Me(Nt.$$.fragment,e),Ht=!0)},o(e){Se(Nt.$$.fragment,e),Ht=!1},d(e){e&&(re(t),re(ye),re(Ce),re(At),re(St)),Te(Nt)}}}function $l(e){let t,a,n,r,o,s=e[0].is_owner&&wl(e)
function l(e,t){return e[1]?kl:yl}let i=l(e),c=i(e),u=e[1]&&Cl(e)
return{c(){t=oe("div"),a=oe("div"),s&&s.c(),n=fe(),c.c(),r=fe(),u&&u.c(),de(a,"class","left svelte-1qul0wc"),de(t,"class","body svelte-1qul0wc")},m(e,l){ae(e,t,l),ie(t,a),s&&s.m(a,null),ie(a,n),c.m(a,null),ie(t,r),u&&u.m(t,null),o=!0},p(e,[r]){e[0].is_owner?s?(s.p(e,r),1&r&&Me(s,1)):(s=wl(e),s.c(),Me(s,1),s.m(a,n)):s&&(xe(),Se(s,1,1,(()=>{s=null})),Ae()),i===(i=l(e))&&c?c.p(e,r):(c.d(1),c=i(e),c&&(c.c(),c.m(a,null))),e[1]?u?(u.p(e,r),2&r&&Me(u,1)):(u=Cl(e),u.c(),Me(u,1),u.m(t,null)):u&&(xe(),Se(u,1,1,(()=>{u=null})),Ae())},i(e){o||(Me(s),Me(u),o=!0)},o(e){Se(s),Se(u),o=!1},d(e){e&&re(t),s&&s.d(),c.d(),u&&u.d()}}}function Ll(e,t,a){let n,r,o,s,l,i,u,f
Ke(e,Ns,(e=>a(2,n=e))),Ke(e,sl,(e=>a(3,r=e))),Ke(e,ll,(e=>a(4,o=e))),Ke(e,il,(e=>a(5,s=e))),Ke(e,ul,(e=>a(6,l=e))),Ke(e,cl,(e=>a(7,i=e))),Ke(e,dl,(e=>a(8,u=e))),Ke(e,ml,(e=>a(9,f=e)))
let{relicData:d={}}=t
const m=d.defenders.map((e=>e.player_name))
let p=!1
return Ye((()=>{a(1,p=!1),Hs.set(0),Ts.set([]),Fs.set(0),el.set([])})),e.$$set=e=>{"relicData"in e&&a(0,d=e.relicData)},[d,p,n,r,o,s,l,i,u,f,m,function(e){c("relic",e.detail)},function(){c("relic","fetchStats"),a(1,p=!0),Hs.set(d.controlled_by.guild_id),Ts.set(m),Fs.set(GameData.player().hasGroup),el.set(GameData.player().buffs)}]}class Vl extends X{constructor(e){super(),Z(this,e,Ll,$l,ee,{relicData:0})}}let Dl=0
function Ml(e,t){var a,r
t?.response?.data?.defenders?.length>0&&(a=n("dialog-relic"),r=t.response.data,Dl&&Dl.$destroy(),Dl=new Vl({props:{relicData:r},target:a}))}function xl(e,t){"ACT_REPAIR"===t&&GameData.fetch(Qe+f+Je+Xe)}let Al=!1
function Sl(e,t,a,n,r,o,s,l,i){return e.beginPath(),e.arc(o+l/2,s+i/2,l/6,0,2*Math.PI,!1),e.fillStyle=this.color,e.fill(),e.lineWidth=1,e.strokeStyle="black",e.stroke(),!0}function Nl(){if(!Al){const e=GameController.Realm.footprintTexture
e.color=b("footprintColor"),e.Draw=Sl,Al=!0}}function Hl(){GameController?.Realm?.footprintTexture&&(Nl(),$.unsubscribe("fixed.realm",Hl))}let Bl=0
function Tl(e){$("#statbar-gold").css("background-color",e)}function ql(){$("#HelperSendTotal").html(ht(b("currentGoldSentTotal"))),Number(GameData.player().gold)>Bl?Tl("red"):Tl("inherit")}function El(){Bl=b("goldAmount"),$("#statbar-gold-tooltip-general").append(`<dt class="stat-gold-sendTo">Send To:</dt><dd id="HelperSendTo">${b("goldRecipient")}</dd><dt class="stat-gold-sendAmt">Amount:</dt><dd id="HelperSendAmt">${ht(Bl)}</dd><dt class="stat-gold-sendTo">Send?</dt><dd><input id="HelperSendGold" value="Send!" class="custombutton" type="submit"><input type="hidden" id="xc" value=""</dd><dt class="stat-gold-sendTotal">Total Sent:</dt><dd id="HelperSendTotal">${ht(b("currentGoldSentTotal"))}</dd>`),$("#HelperSendGold").on("click",tt),ql(),$.subscribe(at,ql)}let Gl=0,Pl=0,jl=0,Fl=0,_l=0,Rl=0
async function Ol(){const e=await Sn({a:14,d:0,id:Gl.id,item_id:Gl.itemId}),t=e.response.response,a=e.response.msg
let n=a
if(0!==t){const e=a.indexOf("<");-1!==e&&(n=a.substring(0,e))}else n=`You purchased ${e.response.data.name} for ${ht(e.response.data.cost)} gold.`
l(Rl,`${n}<br>`)}async function Il(){const e=zt(_l.value)
e&&(c("NewMap","quickBuy"),await jt(Ut(e,Ol)),GameData.doAction(14,3,{id:Gl.id,item_id:Gl.itemId},0),jl.close())}function Wl(){Fl?r("",Rl):function(){Fl=a({className:"fshClear",textContent:"Select how many to quick-buy:"}),_l=yt({id:"buyAmount",className:"fshNumberInput",min:1,max:99,value:1,type:"number"}),o(Fl,_l)
const e=bt({textContent:"Quick-buy"})
i(e,Il),o(Fl,e),Rl=a(),o(Fl,Rl),o(Pl,Fl)}()}function Kl(e,t){Gl=t,Pl=Pl||n("shopDialogConfirm"),Pl&&(jl=jl||$(Pl).data("hcsWorldDialogShopConfirm"),jl&&Wl())}function Yl(e){let t,a
return{c(){t=oe("div"),a=se(e[0]),de(t,"id","tp-overlay"),de(t,"class","svelte-dcwx64")},m(e,n){ae(e,t,n),ie(t,a)},p(e,t){1&t&&ce(a,e[0])},d(e){e&&re(t)}}}function Ul(e){let t,a=e[1]&&Yl(e)
return{c(){a&&a.c(),t=te()},m(e,n){a&&a.m(e,n),ae(e,t,n)},p(e,[n]){e[1]?a?a.p(e,n):(a=Yl(e),a.c(),a.m(t.parentNode,t)):a&&(a.d(1),a=null)},i:ne,o:ne,d(e){e&&re(t),a&&a.d(e)}}}function zl(e,t,a){let{tpButton:n}=t,r=0,o=0,s=!1
function l(){const e=GameData.player().teleportCooldown
a(0,r=e-ot()+o),r>0||(clearInterval(s),a(1,s=!1),n.classList.remove("cooldown"))}return window.$.subscribe("stats.player",l),window.$.subscribe(rt,(function(e,t){o=ot(),l(),s||0!==t.response.response||a(1,s=setInterval((()=>{l()}),1e3))})),e.$$set=e=>{"tpButton"in e&&a(2,n=e.tpButton)},[r,s,n]}class Ql extends X{constructor(e){super(),Z(this,e,zl,Ul,ee,{tpButton:2})}}function Jl(e){return e.numberOfCreatureHitsTillDead-e.numberOfHitsRequired<=1?", dies on miss":", survives a miss"}function Xl(e,t){return"-"===t?e:"-"===e||e>t?"-":e}const Zl=[[e=>"-"===e.playerHits&&"-"===e.creatureHits,()=>"Unresolved"],[e=>"-"===e.playerHits,()=>"Player dies"],[e=>1===e.playerHits,e=>`Player 1 hits${Jl(e)}`],[e=>e.playerHits>1,e=>`Player > 1 hits${Jl(e)}`]]
function ei(e,t){return t[0](e)}function ti(e){e.playerHits=Xl(e.numberOfHitsRequired,e.numberOfCreatureHitsTillDead),e.creatureHits=Xl(e.numberOfCreatureHitsTillDead,e.numberOfHitsRequired),e.fightStatus=function(e){const t=Zl.find(s(ei,e))
return t?t[1](e):"Unknown"}(e)}function ai(e,t,a){return e.callback.groupExists?t:a}function ni(e,t,a,n){t>0&&(e.extraNotes+=`${a} = ${Math.floor(n*t*.001)}<br>`)}const ri=e=>ai(e,e.callback.groupArmorValue,e.player.armorValue)
function oi(e){e.creatureHitByHowMuch>=0?function(e){const t=e.generalVariable*e.creature.damage
t<e.overallArmorValue?e.numberOfCreatureHitsTillDead=e.overallHPValue:e.numberOfCreatureHitsTillDead=Math.ceil(e.overallHPValue/(t-e.overallArmorValue))}(e):e.numberOfCreatureHitsTillDead="-"}function si(e){!function(e){const t=ri(e)
e.overallArmorValue=t+Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}(e),function(e){ni(e,e.player.sanctuaryLevel,"Sanc Bonus Armor",e.player.armorValue)}(e),function(e){e.terrorizeEffect=Math.floor(e.creature.damage*e.player.terrorizeLevel*.001)}(e),function(e){e.player.terrorizeLevel>0&&(e.extraNotes+=`Terrorize Creature Damage Effect = ${-1*e.terrorizeEffect}<br>`)}(e),e.creature.damage-=e.terrorizeEffect,function(e){e.creatureDamageDone=Math.ceil(e.generalVariable*e.creature.damage-e.overallArmorValue+e.overallHPValue)}(e),oi(e)}const li=e=>ai(e,e.callback.groupAttackValue,e.player.attackValue)
function ii(e){return Math.floor(e.creature.defense*e.player.darkCurseLevel*_e)}function ci(e){const t=li(e)
e.player.darkCurseLevel>0&&(e.extraNotes+=`DC Bonus Attack = ${ii(e)}<br>`),e.nightmareVisageAttackMovedToDefense=Math.floor((t+e.counterAttackBonusAttack)*e.player.nightmareVisageLevel*.0025),e.player.nightmareVisageLevel>0&&(e.extraNotes+=`NMV Attack moved to Defense = ${e.nightmareVisageAttackMovedToDefense}<br>`),e.overallAttackValue=t+e.counterAttackBonusAttack-e.nightmareVisageAttackMovedToDefense,e.hitByHowMuch=function(e){const t=e.creature.defense-ii(e)
return 3===e.combatEvaluatorBias?e.overallAttackValue-Math.ceil(t)-50:e.overallAttackValue-Math.ceil(e.attackVariable*t)}(e)}const ui=(e,t,a)=>Math.max(Math.ceil((e-t+1)/a/.0025),0)
function fi(e){e.lowestCALevelToStillHit=ui(e.counterAttackBonusAttack,e.hitByHowMuch,e.player.attackValue),e.lowestCALevelToStillKill=ui(e.counterAttackBonusDamage,e.damageDone,e.player.damageValue)}function di(e){fi(e),e.lowestFeasibleCALevel=Math.max(e.lowestCALevelToStillHit,e.lowestCALevelToStillKill),e.extraNotes+=`Lowest CA to still 1-hit this creature = ${e.lowestFeasibleCALevel}<br>`,0!==e.lowestFeasibleCALevel&&function(e){e.extraAttackAtLowestFeasibleCALevel=Math.floor(.0025*e.player.attackValue*e.lowestFeasibleCALevel),e.extraDamageAtLowestFeasibleCALevel=Math.floor(.0025*e.player.damageValue*e.lowestFeasibleCALevel),e.extraNotes+=`Extra CA Att/Dam at this lowered CA level = ${e.extraAttackAtLowestFeasibleCALevel} / ${e.extraDamageAtLowestFeasibleCALevel}<br>`}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel=function(e){return e.player.counterAttackLevel>0?Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.lowestFeasibleCALevel):0}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel<e.extraStaminaPerHit?e.extraNotes+=`Extra Stam Used at this lowered CA level = ${e.extraStaminaPerHitAtLowestFeasibleCALevel}<br>`:e.extraNotes+="No reduction of stam used at the lower CA level<br>"}function mi(e,t,a){e[t]>203?e.extraNotes+=`Even with CA203 you cannot ${a} this creature<br>`:0!==e[t]&&(e.extraNotes+=`You need a minimum of CA${e[t]} to ${a} this creature<br>`)}function pi(e){(function(e){return e.player.counterAttackLevel>0&&1===e.numberOfHitsRequired})(e)&&di(e),function(e){return"-"===e.numberOfHitsRequired||1!==e.numberOfHitsRequired}(e)&&function(e){fi(e),mi(e,"lowestCALevelToStillHit","hit"),mi(e,"lowestCALevelToStillKill","1-hit kill")}(e)}const hi=e=>ai(e,e.callback.groupHPValue,e.player.hpValue),gi=e=>ai(e,e.callback.groupDamageValue,e.player.damageValue)
function vi(e){if(function(e){const t=hi(e),{fortitudeLevel:a}=e.player
e.fortitudeExtraHPs=Math.floor(t*a*.001),a>0&&(e.extraNotes+=`Fortitude Bonus HP = ${e.fortitudeExtraHPs}<br>`),e.overallHPValue=t+e.fortitudeExtraHPs}(e),function(e){const{chiStrikeLevel:t}=e.player
e.chiStrikeExtraDamage=Math.floor(e.overallHPValue*t*.001),t>0&&(e.extraNotes+=`Chi Strike Bonus Damage = ${e.chiStrikeExtraDamage}<br>`)}(e),e.overallDamageValue=gi(e)+e.deathDealerBonusDamage+e.counterAttackBonusDamage+e.holyFlameBonusDamage+e.chiStrikeExtraDamage,e.damageDone=Math.floor(e.overallDamageValue-(e.generalVariable*e.creature.armor+e.hpVariable*e.creature.hp)),e.hitByHowMuch>0){let t=1
e.overallDamageValue>=e.generalVariable*e.creature.armor&&(t=e.overallDamageValue-e.generalVariable*e.creature.armor),e.numberOfHitsRequired=Math.ceil(e.hpVariable*e.creature.hp/t)}else e.numberOfHitsRequired="-"}const bi=e=>ai(e,e.callback.groupDefenseValue,e.player.defenseValue),wi=e=>Math.floor(bi(e)*e.player.constitutionLevel*.001)
const ki=e=>e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue
function yi(e){e.overallDefenseValue=bi(e)+wi(e)+e.nightmareVisageAttackMovedToDefense,function(e){e.player.constitutionLevel>0&&(e.extraNotes+=`Constitution Bonus Defense = ${wi(e)}<br>`)}(e),function(e){ni(e,e.player.flinchLevel,"Flinch Bonus Attack Reduction",e.creature.attack)}(e),e.creatureHitByHowMuch=Math.floor(e.attackVariable*ki(e)),3===e.combatEvaluatorBias&&(e.creatureHitByHowMuch=Math.floor(ki(e)-50))}function Ci(e){e.extraNotes="",function(e){e.player.superEliteSlayerLevel>0&&(e.extraNotes+=`SES Stat Reduction Multiplier = ${e.player.superEliteSlayerMultiplier}<br>`)}(e),function(e){e.holyFlameBonusDamage=0,"Undead"===e.creature.class&&(e.holyFlameBonusDamage=Math.max(Math.floor((e.player.damageValue-e.creature.armor)*e.player.holyFlameLevel*.002),0),e.player.holyFlameLevel>0&&(e.extraNotes+=`HF Bonus Damage = ${e.holyFlameBonusDamage}<br>`))}(e),function(e){e.deathDealerBonusDamage=Math.floor(e.player.damageValue*(Math.min(.01*Math.floor(e.player.killStreakValue/5)*e.player.deathDealerLevel,20)/100))}(e),function(e){e.counterAttackBonusAttack=Math.floor(.0025*e.player.attackValue*e.player.counterAttackLevel),e.counterAttackBonusDamage=Math.floor(.0025*e.player.damageValue*e.player.counterAttackLevel)}(e),function(e){e.extraStaminaPerHit=0,e.player.counterAttackLevel>0&&(e.extraStaminaPerHit=Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.player.counterAttackLevel))}(e),function(e){e.player.deathDealerLevel>0&&(e.extraNotes+=`DD Bonus Damage = ${e.deathDealerBonusDamage}<br>`)}(e),function(e){e.player.counterAttackLevel>0&&(e.extraNotes+=`CA Bonus Attack/Damage = ${e.counterAttackBonusAttack} / ${e.counterAttackBonusDamage}<br>CA Extra Stam Used = ${e.extraStaminaPerHit}<br>`)}(e)}const $i=e=>e.creatureHitByHowMuch>=0?"Yes":"No",Li=e=>e.hitByHowMuch>0?"Yes":"No",Vi=e=>`<span style="color:#333333">${e}</span>`,Di=e=>`<tr>${e}</tr>`,Mi=(e,t)=>`<td${t%2?"":' class="fshRight"'}>${e}</td>`,xi=e=>Di(e.map(Mi).join("")),Ai=e=>Di(`<td bgcolor="#CD9E4B" colspan="4" align="center">${(e=>e.callback.groupExists?"Group ":"")(e)}Combat Evaluation</td>`),Si=e=>xi([Vi("Will I hit it?"),Li(e),Vi("Extra Attack:"),`( ${e.hitByHowMuch} )`]),Ni=e=>xi([Vi("# Hits to kill it?"),e.numberOfHitsRequired,Vi("Extra Damage:"),`( ${e.damageDone} )`]),Hi=e=>xi([Vi("Will I be hit?"),$i(e),Vi("Extra Defense:"),`( ${-1*e.creatureHitByHowMuch} )`]),Bi=e=>xi([Vi("# Hits to kill me?"),e.numberOfCreatureHitsTillDead,Vi("Extra Armor + HP:"),`( ${-1*e.creatureDamageDone} )`]),Ti=e=>xi([Vi("# Player Hits?"),e.playerHits,Vi("# Creature Hits?"),e.creatureHits]),qi=e=>Di(`${Mi(Vi("Fight Status:"),0)}<td colspan="3"><span>${e.fightStatus}</span></td>`),Ei=e=>Di(`${Mi(Vi("Notes:"),0)}<td colspan="3"><span style="font-size:x-small;">${e.extraNotes}</span></td>`)
let Gi=0,Pi=0,ji=0
function Fi(){return cr(Pi)?"Remove from do not kill list":"Add to the do not kill list"}function _i(){r(Fi(),ji)}function Ri(){c("NewMap","doNotKillLink")
const e=t.doNotKillList.indexOf(Pi);-1===e?t.doNotKillList.push(Pi):t.doNotKillList.splice(e,1),_i(),V("doNotKillList",t.doNotKillList.join()),fr()}function Oi(){ji?_i():function(){ji=bt({className:"fshBl",textContent:Fi()})
const e=a({className:"description",innerHTML:'<span class="ui-helper-hidden-accessible"><input type="text"></span>'})
o(e,ji),o(Gi,e),i(ji,Ri)}()}function Ii(e,t){!function(e){if(!Gi){const t=G("body",e)
1===t.length&&([Gi]=t)}}(t),Gi&&(Pi=I(e),Oi())}let Wi=0,Ki=0,Yi=0,Ui=0
function zi(){Yi||(Ki||(Ki=a(),o(Wi,Ki),o(Wi,a({innerHTML:'<span class="fshFooter">*Does include CA, DD, HF, DC, Flinch, Super Elite Slayer, NMV, Sanctuary, Constitution, Fortitude, Chi Strike and Terrorize (if active) and allow for randomness (1.1053). Constitution, NMV, Fortitude and Chi Strike apply to group stats.</span>'}))),Yi=a(),o(Ki,Yi))}function Qi(e){zi(),ye(e,Yi)}function Ji(e){Ui||(zi(),Ui=a(),o(Ki,Ui)),ye(e,Ui)}function Xi(e,t){const a={name:e.name,class:e.creature_class,attack:Number(e.attack),defense:Number(e.defense),armor:Number(e.armor),damage:Number(e.damage),hp:Number(e.hp)}
return function(e,t,a){3===a&&(t.attack-=Math.ceil(t.attack*e),t.defense-=Math.ceil(t.defense*e),t.armor-=Math.ceil(t.armor*e),t.damage-=Math.ceil(t.damage*e),t.hp-=Math.ceil(t.hp*e))}(t,a,e.type),a}function Zi(e,a,n){const r={}
r.callback=n,r.player=xs(a),function(e){e.combatEvaluatorBias=t.combatEvaluatorBias,e.attackVariable=1.1053,e.generalVariable=t.generalVariable,e.hpVariable=t.hpVariable}(r),r.creature=Xi(e.response.data,r.player.superEliteSlayerMultiplier),function(e){var t
t=e,[Ci,ci,vi,yi,si,ti,pi].forEach((e=>e(t)))}(r),r.evaluatorHTML=function(e){return`<table width="100%"><tbody>${Ai(e)}${Si(e)}${Ni(e)}${Hi(e)}${Bi(e)}${Ti(e)}${qi(e)}${Ei(e)}</tbody></table>`}(r),n.groupExists?Ji(r.evaluatorHTML):Qi(r.evaluatorHTML)}function ec(e){return e.members[0].name===u()}async function tc(e,t,a){if(a){!function(e,t,a){if(!a.r?.attributes)return
const n=a.r.attributes
Zi(e,t,{groupExists:!0,groupAttackValue:n[0].value,groupDefenseValue:n[1].value,groupArmorValue:n[2].value,groupDamageValue:n[3].value,groupHPValue:n[4].value})}(e,t,await Rt(a))}}async function ac(e,t){const a=function(e){if(wt(e.r))return e.r.find(ec)?.id}(await Wt())
tc(e,t,a)}async function nc(e,t){if(Wi||(Wi=n("dialog-viewcreature")),Wi&&(Qi(""),Ji(""),t?.response?.data)){Ii(t.response.data.name,Wi)
const e=await Qt(!0)
e&&function(e,t){e.player.hasGroup&&ac(e,t),Zi(e,t,{groupExists:!1})}(t,e)}}let rc=0
function oc(e){const t=G("verbs",e)
1===t.length&&lt(t[0])}function sc(){if(!rc)return
const e=n("actionList")
W("player",e).forEach(oc)}const lc="showHuntingBuffs"
function ic(){return`${Xt(lc)} ${Zt("enabledHuntingMode")}<select name="enabledHuntingMode"><option value="1"${ea(t.enabledHuntingMode,"1")}>${t.buffsName}</option><option value="2"${ea(t.enabledHuntingMode,"2")}>${t.buffs2Name}</option><option value="3"${ea(t.enabledHuntingMode,"3")}>${t.buffs3Name}</option></select>`}let cc=0,uc=""
const fc=()=>cc,dc=()=>uc
function mc(){const e=[null,[t.buffs,t.buffsName],[t.buffs2,t.buffs2Name],[t.buffs3,t.buffs3Name]][t.enabledHuntingMode]
wt(e)&&([cc,uc]=e)}function pc(e){"enabledHuntingMode"===e.target.name&&(c("NewMap","toggleEnabledHuntingMode"),t.enabledHuntingMode=e.target.value,V("enabledHuntingMode",t.enabledHuntingMode),mc(),GameData.fetch(f))}function hc(e){c("NewMap","togglePref"),t[e]=!t[e],V(e,t[e])}const gc={hideSubLvlCreature:function(){hc("hideSubLvlCreature"),GameData.fetch(Xe)},hidePlayerActions:function(){c("NewMap","toggleHidePlayerActions"),rc=!rc,V("hidePlayerActions",rc),GameData.fetch(Xe)},showCreatureInfo:()=>hc("showCreatureInfo"),showHuntingBuffs:function(){hc("showHuntingBuffs"),GameData.fetch(f)},showMonsterLog:()=>hc("showMonsterLog"),showTitanInfo:function(){hc("showTitanInfo"),ps(GameData.realm().dynamic)},showBuffInfo:function(){hc("showBuffInfo"),ja()}}
function vc(e){const t=gc[e.target.name]
U(t)&&(e.target.blur(),t(e))}function bc(){const e=n("worldPage")
if(!e)return
const t=a({className:"fshCenter fshFten"}),r=a({id:"fshWorldPrefs",innerHTML:`${Xt("showCreatureInfo")}&nbsp;&nbsp;${Xt("showMonsterLog")}&nbsp;&nbsp;${Xt("showTitanInfo")}&nbsp;&nbsp;${Xt("showBuffInfo")}<br>${Xt("hideSubLvlCreature")}&nbsp;&nbsp;${Xt("hidePlayerActions")}&nbsp;&nbsp;${ic()}`})
i(r,vc),v(r,"change",pc),o(t,r)
const s=a()
return o(t,s),o(e,t),s}const wc=[{generalVariable:1.1053,hpVariable:1.1},{generalVariable:1.1,hpVariable:1.053},{generalVariable:1.053,hpVariable:1},{generalVariable:1.1053,hpVariable:1}]
function kc(){var e
t.combatEvaluatorBias=b("combatEvaluatorBias"),t.generalVariable=(e=t.combatEvaluatorBias,wc[e]?wc[e].generalVariable:1.1053),t.hpVariable=function(e){return wc[e]?wc[e].hpVariable:1.1}(t.combatEvaluatorBias)}function yc(e,t){return e[t.name]=!0,e}function Cc(e,t,a){return e[I(a)]||t.push(a),t}function $c(e){ye("",e)}function Lc(e,t){const a=t.b.reduce(yc,{}),n=fc().reduce(s(Cc,a),[])
n.length>0?function(e,t){ye(`You are missing some ${dc()} hunting buffs<br>(${t.join(", ")})`,e)}(e,n):$c(e)}function Vc(e,a,n){fc()&&function(e,a){t.showHuntingBuffs?Lc(e,a):$c(e)}(e,n)}function Dc(e,t){return 6!==t.type||(0!==t.data.creature_type||t.data.level>=e)}function Mc(e){const t=q(e)
return t?.actions?.length?(t.actions=t.actions.filter(s(Dc,function(e){return e.realm?.minlevel||GameData.realm().minlevel}(t))),it(t)):e}function xc(e,a){t.hideSubLvlCreature&&function(e){return e.data?.d&&ta(e.data.d,Xe)}(a)&&(e.dataFilter=Mc)}function Ac(e){t[e[0]]=Jt(e[1])}function Sc(e){t[e]=Jt(e)}function Nc(){[["buffs","huntingBuffs"],["buffs2","huntingBuffs2"],["buffs3","huntingBuffs3"]].forEach(Ac),["doNotKillList"].forEach(Sc)}function Hc(e){t[e[0]]=b(e[1])}function Bc(e){t[e]=b(e)}function Tc(){[["buffsName","huntingBuffsName"],["buffs2Name","huntingBuffs2Name"],["buffs3Name","huntingBuffs3Name"],["showHuntingBuffs","showHuntingBuffs"]].forEach(Hc),["enabledHuntingMode","hideSubLvlCreature","showTitanInfo","showBuffInfo","showMonsterLog","showCreatureInfo"].forEach(Bc)}const qc=[function(){let e=0
window.requestAnimationFrame=t=>{const a=window.performance.now(),n=Math.max(e+16,a)
return e=n,setTimeout((()=>{t(e)}),n-a)},window.cancelAnimationFrame=clearTimeout},function(){kc(),Nc(),Tc()
const e=bc()
$.ajaxPrefilter("JSON",xc),t.hideSubLvlCreature&&GameData.fetch(Xe),function(e){mc()
const a=s(Vc,e)
$.subscribe(d,a),t.showHuntingBuffs&&window.initialGameData&&a(null,{b:window.initialGameData.player.buffs})}(e),rc=b("hidePlayerActions"),$.subscribe(z,sc),sc()},function(){Ze(),et()&&El()},function(){$.subscribe(st,nc)},function(){Hr.forEach(Br)},function(){b("enableCreatureColoring")&&o(document.body,Vt("#actionList .creature-1 {color: green;}\n#actionList .creature-2 {color: yellow;}\n#actionList .creature-3 {color: red;}"))},function(){$.subscribe(z,fr),fr(),function(){const e=GameData.doAction
GameData.doAction=pr(e)}()},function(){Ur(),$.subscribe("-1-success.action-response 4-success.action-response 5-success.action-response 25-success.action-response",Zr),Zr()},function(){$.subscribe(ze,xl)},async function(){if(b("keepLogs")){!function(e){e&&($n=e),$.subscribe(N,xn)}(await S("fsh_combatLog"))}},function(){window.initialGameData&&gs(0,window.initialGameData),$.subscribe(`${Le} ${Ve}`,gs)},function(){$.subscribe(nt,Kl)},function(){$.subscribe(Ue,Ml)},function(){$("#messageCenter").worldMessageCenter({offset:"0 60"})},function(){w("#mapTooltip")},function(){cn(),$.subscribe(p,un),$.subscribe(h,fn)},function(){ja(),$.subscribe(`${d} ${m}`,ja)},function(){v(n("actionList"),"mouseover",ir)},function(){const{body:e}=document
v(e,"keydown",kn),v(e,"keyup",yn)},function(){const e=$("#world-event-badge")
e.length&&(e.off(),i(e[0],Sr))},function(){const e=x(".actionListHeaderButton.teleport")
!function(e,t){new Ql({target:e,props:t})}(e,{tpButton:e})},function(){var e
b("messageStack")&&(e=n("messageCenter"),new jr({target:e}))},function(){GameController?.Realm?.footprintTexture?Nl():$.subscribe("fixed.realm",Hl)}]
function Ec(){e(qc)}export{Ec as default}
//# sourceMappingURL=newMap-BxOi84RZ.js.map
