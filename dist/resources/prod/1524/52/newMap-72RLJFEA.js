import{a as na,b as aa}from"./chunk-BAKVTS2P.js";import{a as ia}from"./chunk-CTVLOTVB.js";import"./chunk-DQ6IGZNR.js";import{a as ta}from"./chunk-KPXYE5CG.js";import{a as ct}from"./chunk-WVONP736.js";import{a as ra,b as oa}from"./chunk-ZJ4NSBE5.js";import{a as Xn,b as Zn}from"./chunk-IAAYYESM.js";import{a as ea}from"./chunk-34F34WXS.js";import{a as Jn}from"./chunk-EZE2YRHE.js";import{b as Qn}from"./chunk-UL36IO5A.js";import{a as Yn}from"./chunk-4LQP4WWY.js";import"./chunk-N4OIN76M.js";import"./chunk-GYR7K7WR.js";import{a as mt}from"./chunk-HSNA5MO6.js";import{a as Wn}from"./chunk-SLMRGUSK.js";import{a as Kn}from"./chunk-CISSZBW2.js";import"./chunk-EMG72XW6.js";import{a as Ft}from"./chunk-S7SMEPY4.js";import"./chunk-EBRZ3EK7.js";import{a as qn}from"./chunk-SLTIA5WB.js";import{a as Ot}from"./chunk-ZUIOPUQB.js";import{a as c}from"./chunk-HZT465UH.js";import{a as Pn}from"./chunk-4ULJLJ75.js";import"./chunk-J65VR5DR.js";import{a as ft}from"./chunk-ATFXUHX5.js";import{a as On}from"./chunk-NYSXQY3D.js";import{a as ut}from"./chunk-NMCSNKGX.js";import{a as _n}from"./chunk-2WVMNN2D.js";import{a as Pt}from"./chunk-QVPQVVGB.js";import"./chunk-2YMNRK2B.js";import{a as Un,b as zn,c as jn}from"./chunk-FFVITVOA.js";import"./chunk-2ICPYDYS.js";import"./chunk-MLOBOIWO.js";import{a as Hn}from"./chunk-M47QAWF4.js";import"./chunk-KZNUAJBN.js";import{a as le,b as tt}from"./chunk-GRTAEGGX.js";import{a as H}from"./chunk-RUMWLVS5.js";import{a as Vn}from"./chunk-HWWGRBHI.js";import{a as it}from"./chunk-C6PMUDSE.js";import"./chunk-DIZBX4UQ.js";import{a as O}from"./chunk-AFSUXK4V.js";import{a as nt,b as at}from"./chunk-QB2MZ562.js";import{a as Nn}from"./chunk-VJBO2VAE.js";import"./chunk-QTYJVNMC.js";import{f as J}from"./chunk-KFGNPQDV.js";import"./chunk-BEXBLZFZ.js";import{a as $n}from"./chunk-YUAU63KG.js";import{a as Rn}from"./chunk-5VQHDDXC.js";import{a as m}from"./chunk-7UPJBGX2.js";import{a as K}from"./chunk-LMD2PV2P.js";import{a as lt}from"./chunk-NGWVGVXB.js";import{a as Gn}from"./chunk-RJZW6ANB.js";import"./chunk-7VGIJKO6.js";import"./chunk-VR7FVJYV.js";import{a as Zo}from"./chunk-ERNA6O2Z.js";import{a as kn}from"./chunk-PEKO7VJA.js";import{a as Je,b as Rt}from"./chunk-ZMUSZ47M.js";import{a as fe}from"./chunk-G5RZKOR2.js";import{a as _}from"./chunk-GSZMCZFV.js";import{a as Ln}from"./chunk-XWTR3Y3Q.js";import{a as F}from"./chunk-5KEZZSV2.js";import{a as h}from"./chunk-BP3EKJNE.js";import"./chunk-QBOLKUGJ.js";import{a as Mn}from"./chunk-AYNHL3OP.js";import{a as ot}from"./chunk-VJAGIPNW.js";import{a as rt}from"./chunk-2UNPHM4E.js";import"./chunk-77BSQLWR.js";import{a as be}from"./chunk-LHQC5J6O.js";import{a as X}from"./chunk-MHKH5FC5.js";import"./chunk-CJDJXL2F.js";import{a as Y}from"./chunk-BLRY34YR.js";import"./chunk-CIFA6X4K.js";import{a as Sn}from"./chunk-PSQKPSME.js";import"./chunk-24KPH7IM.js";import{a as l}from"./chunk-3J2YA6B7.js";import"./chunk-SDA4FQMK.js";import"./chunk-T6BAO7XX.js";import{a as ue}from"./chunk-KCQPJD5H.js";import{a as Bn}from"./chunk-ZZZQT54L.js";import{a as P}from"./chunk-EZHOHKGC.js";import"./chunk-R23QVEJA.js";import{a as Xe}from"./chunk-VXC5XTE7.js";import{a as T}from"./chunk-ML7SUXNI.js";import{a as S}from"./chunk-XY4KZRCS.js";import{a as M}from"./chunk-5IIHJLHJ.js";import"./chunk-5M4Z4TNO.js";import{a as Ae}from"./chunk-C3UZY667.js";import{a}from"./chunk-UAOZMKLO.js";import{a as f}from"./chunk-OLMGIENV.js";import"./chunk-TICG7NTW.js";import"./chunk-7VZZ35FX.js";import"./chunk-EWDLMFWA.js";import{a as Fn}from"./chunk-H7LEI34Q.js";import{a as st}from"./chunk-MZ7GLTZN.js";import{a as In}from"./chunk-NR4PY7IS.js";import"./chunk-WKK2D5SI.js";import{a as Tn}from"./chunk-CVQ7E5PW.js";import{a as x}from"./chunk-KN5ZC5BT.js";import{a as w}from"./chunk-DUQP22PP.js";import{a as L}from"./chunk-NDCVQHVH.js";import{a as se}from"./chunk-3Q2VMWIC.js";import"./chunk-ZOSMVBRJ.js";import{a as i}from"./chunk-ZJNDZYVS.js";import"./chunk-OUMBZBCQ.js";import{a as et}from"./chunk-RL27SC3C.js";import{a as bn}from"./chunk-KCBAQFJY.js";import{a as Ze}from"./chunk-DM72I4Z3.js";import{a as An}from"./chunk-Y2LZWOTV.js";import{b as d}from"./chunk-I7LLJIV6.js";import{a as o}from"./chunk-6SHDCONG.js";import{a as Cn}from"./chunk-BWOLSDKS.js";import{$ as fn,Aa as Dn,Ba as wn,Ca as En,I as tn,L as rn,La as Ye,N as on,V as nn,W as ie,X as ze,Y as an,Z as ln,_ as sn,aa as un,ba as mn,c as Ue,ca as cn,da as dn,ea as je,fa as pn,ga as hn,ha as gn,i as ae,ja as yn,ka as R,la as Qe,ma as k,n as $t,v as en,ya as vn,za as xn}from"./chunk-RLOFFV7B.js";import{b as ne}from"./chunk-XYKKLBWK.js";import{a as s}from"./chunk-BOMGPUDJ.js";var Z;function Ei(e){return e}function Ci(e){return o.showBuffInfo&&e.some(Ei)}function ki(){if(Z)c(Z,!1);else{Z=f({className:"fshActionBox",innerHTML:"<div></div><div></div><div></div><div></div><div></div><div></div>"});let e=i("actionContainer");Wn(Z,e.children[2])}return Z}function Bi(){Z&&c(Z,!0)}function _t(e){if(Ci(e))return ki();Bi()}var V,Kt;function Si(e){V=e.children[3],V.className="fshBlue",l("CA ",V),Kt=m(),a(V,Kt),H(V," active")}function Ai(e,t){V?c(V,!1):Si(e),l(t.level,Kt)}function bi(){V&&c(V,!0)}function qt(e,t){t?Ai(e,t):bi()}var N,Wt;function Li(e){N=e.children[4],N.className="fshRed",l("Doubler ",N),Wt=m(),a(N,Wt),H(N," active")}function Ti(e,t){N?c(N,!1):Li(e),l(t.level,Wt)}function Hi(){N&&c(N,!0)}function Ut(e,t){t?Ti(e,t):Hi()}var q,zt;function Mi(e){q=e.children[2],l("Damage bonus: ",q),zt=m(),a(q,zt),H(q,"%")}function Vi(e,t){if(e){let r=Math.min(Math.round(Math.floor(t/5)*Number(e.level))*.01,20);return le(r,2).toString()}return"0"}function Ni(e,t,r){q?c(q,!1):Mi(e),l(Vi(t,Number(r)),zt)}function Gi(){q&&c(q,!0)}function jt(e,t,r){t?Ni(e,t,r):Gi()}function u(e,t){l(O(e),t)}var ee,Qt;function Ii(e){ee=e.children[1],l("Kill Streak: ",ee),Qt=m(),a(ee,Qt)}function $i(e,t){ee?c(ee,!1):Ii(e),u(t,Qt)}function Ri(){ee&&c(ee,!0)}function Yt(e,t,r,n){t||r?$i(e,n):Ri()}function Pi(e,t){return t.name===e}function W(e){let{buffs:t}=GameData.player();if(t)return t.find(s(Pi,e))}function Xt(){let e=GameData.player().teleportCooldown;return e>1&&e}var Fi=["red","orange","yellow"];function Jt(){let e=$("#actionlist-shield-imp");e.length===1&&e.css("background-color",Fi[e.text()]||"#ad8043")}var A,Zt;function Oi(e){aa(e)&&GameData.fetch(R)}function _i(){W("Summon Shield Imp")||na([F()],[55]).then(Oi)}function Ki(e){return e?Number(e.stack):0}var qi=["imp-0","imp-1","imp-1"];function Wi(e){return qi[e]||"fshGreen"}function Ui(e){A=e.children[0],l("Shield Imps Remaining: ",A),Zt=m(),a(A,Zt),Y(A,"&nbsp;");let t=m({className:"xSmallLink",textContent:"Recast"});a(A,t),w(t,_i)}function zi(e,t){A?c(A,!1):Ui(e);let r=Ki(t);A.className=Wi(r),l(r,Zt)}function ji(){A&&c(A,!0)}function er(e,t,r){t||r?zi(e,t):ji()}function Qi(e){return e.type===0}function tr(){let{dynamic:e}=GameData.realm();return T(e)&&e.some(Qi)}function y(e){return m({textContent:e})}var te,dt,la;function Yi(e,t){te=e.children[5],l("Teleport Cooldown: ",te),dt=y(t.toString()),a(te,dt)}function Xi(e,t){te?c(te,!1):Yi(e,t)}function Ji(){te&&c(te,!0)}function sa(){let e=Math.max(Math.ceil((la-Date.now())/1e3),0);l(e,dt),e>0&&setTimeout(sa,500)}function fa(e){dt&&(la=Date.now()+e*1e3,sa())}function ua(e,t){t?Xi(e,t):Ji()}var Le,rr,or,nr,ar,ir,lr;function Zi(){Le=W("Death Dealer"),rr=W("Doubler"),or=W("Counter Attack"),nr=W("Summon Shield Imp"),ar=Xt(),ir=tr(),lr=GameData.player().killStreak}function sr(){Jt(),Zi();let e=_t([Le,rr,or,nr,ar,ir]);e&&(er(e,nr,Le),Yt(e,Le,ir,lr),jt(e,Le,lr),qt(e,or),Ut(e,rr),ua(e,ar))}function el(e,t){fa(t.player.teleportCooldown)}function ma(){sr(),$.subscribe(`${ze} ${an}`,sr),$.subscribe(gn,el)}function ca(){o.showBuffInfo=!o.showBuffInfo,h("showBuffInfo",o.showBuffInfo),sr()}function tl(){return window.GameController&&GameController.Realm&&!GameController.Realm.footprintTileList}function fr(){tl()&&(GameController.Realm.footprintTileList=[])}function da(e,t,r){return Mn({className:`fshCurveEle fshCurveLbl fshPoint tip-static ${e}`,dataset:{tipped:t},htmlFor:r})}function pt(e){let t=f({className:"fshToggle"}),r=rt({checked:e.prefVal,id:e.checkId,type:"checkbox"});a(t,r);let n=da(e.onClass,e.onTip,e.checkId);a(t,n);let g=da(e.offClass,e.offTip,e.checkId);return a(t,g),a(e.worldName,t),r}var U,ht,gt,pa,ha,ga,ya,va,xa;function rl(e){be(e),GameData.doAction(12,401,{},0)}function ol(){Gn(F())}function nl(){window.open(`${rn+$t}map`,"fsMap")}function al(){let e=GameData.realm();window.open(`${nn}realms${$t}view&realm_id=${e.id}`,"mapUfsg")}function il(){h("playNewMessageSound",!d("playNewMessageSound"))}function ll(){o.huntingMode=!o.huntingMode,h("huntingMode",o.huntingMode)}function sl(){return f({className:"fshCurveContainer",id:"fshWorldButtonContainer"})}function Da(e){return e?e.toString():"?"}function fl(){let e=f({textContent:"Min Lvl: "});return ht=y(Da(GameData.realm().minlevel)),a(e,ht),e}function ul(){let e=f({textContent:"Your Lvl: "});return gt=y(Da(GameData.player().level)),a(e,gt),e}function ml(e){let t=f({className:"fshFsty"});a(t,fl()),a(t,ul()),a(e,t)}function yt(e,t,r){let n=K({className:`fshCurveEle fshCurveBtn fshPoint tip-static ${e}`,dataset:{tipped:t}});return a(r,n),n}function cl(e){ml(e),pa=yt("fshFormGroup","Quick Create Attack Group",e),ha=yt("fshQuickBuff","Open Quick Buff Popup",e),ga=yt("fshRealmMap","Open Realm Map",e),ya=yt("fshTempleOne","Search map in Ultimate FSG",e)}function dl(e){if(d("showSpeakerOnWorld")){let t=d("playNewMessageSound");va=pt({prefVal:t,checkId:"fshSoundCheck",onClass:"soundOn",onTip:"Turn Off Sound when you have a new log message",offClass:"soundOff",offTip:"Turn On Sound when you have a new log message",worldName:e})}}function pl(e){let t=o.huntingMode;xa=pt({prefVal:t,checkId:"fshHuntCheck",onClass:"huntOn",onTip:"Hunting mode is ON",offClass:"huntOff",offTip:"Hunting mode is OFF",worldName:e})}function hl(){cl(U),dl(U),pl(U)}var gl=[[e=>e===va,il],[e=>e===xa,ll]],yl=[[e=>e===pa,rl],[e=>e===ha,ol],[e=>e===ga,nl],[e=>e===ya,al]];function vl(){w(U,Ft(yl)),L(U,"change",Ft(gl))}function xl(){U||(U=sl(),hl(),vl(),ot(U,i("worldCoord")))}function Dl(e,t){ht&&t.b.minlevel&&(fr(),l(t.b.minlevel,ht))}function wl(e,t){gt&&l(t.b,gt)}function ur(){xl(),$.subscribe(mn,Dl),$.subscribe(ln,wl)}var El=["NORMAL","CHAMPION","ELITE","SUPER ELITE","TITAN","LEGENDARY"],vt=!1;function mr(e){return _(".verb.attack",e)}function cr(e){let t=El.indexOf(e.toUpperCase());return et(`#actionList .actionListItem.creature.creature-${t}`)}function wa(e){let t=["LEGENDARY","NORMAL"].flatMap(cr),r=cr("CHAMPION"),[n,g]=e?[t,r]:[r,t],v=`url("${ne}ui/world/icon_action_attack_`;n.map(mr).filter(D=>D!==null).forEach(D=>{D.classList.remove("attack-1","attack-2","attack-3","attack-4","attack-5","attack-6","attack-7","attack-8"),D.style.backgroundImage=""}),g.slice(0,8).map(mr).forEach((D,We)=>{D!==null&&(D.classList.add(`attack-${We+1}`),D.style.backgroundImage=`${v}${We+1}.png")`)})}function Cl(e){if(!e.ctrlKey||!e.shiftKey||e.target.tagName==="INPUT"||e.target.tagName==="TEXTAREA"||(vt||wa(!0),vt=!0,!e.code.match(/(Digit|Numpad)[1-8]/)))return;let t=cr("CHAMPION"),r=parseInt(e.code.slice(-1),10)-1;if(r<t.length){let n=mr(t[r]);n!==null&&(se("world","ChampionAttack"),n.click())}}function kl(e){vt&&(!e.ctrlKey||!e.shiftKey)&&(vt=!1,wa(!1))}function dr(){let e=Sn("body")[0];L(e,"keydown",Cl),L(e,"keyup",kl)}var Bl=["Breaker","Protection","Master Thief","Protect Gold","Disarm","Duelist","Thievery","Master Blacksmith","Master Crafter","Fury Caster","Master Inventor","Sustain"],pr=[],C;function Sl(e){(e.id===54||e.id===26)&&(C.player.buffs[e.id]=parseInt(e.level,10))}function Al(e){Bl.indexOf(e.name)===-1&&(C.player.enhancements[e.name]=e.value)}function bl(e){e.player.buffs&&e.player.buffs.forEach(Sl)}function Ll(e){e.player.enhancements&&e.player.enhancements.forEach(Al)}function Tl(e,t){C={},C.combat=t.response.data,C.combat.inventory_id&&(C.combat.drop=C.combat.item.id),C.player={},C.player.buffs={},C.player.enhancements={},bl(t),Ll(t),C.time=t.time,pr.push(C),at("fsh_combatLog",pr)}function Hl(e,t){t.response.response===0&&Tl(e,t)}function Ml(e){e&&(pr=e),$.subscribe(je,Hl)}function hr(){d("keepLogs")&&nt("fsh_combatLog").then(Ml)}function re(e){return o.doNotKillList.includes(e.trim())}function Vl(e){e.classList.toggle("fshBlue",re(An(e)))}function me(){let e=i("actionList");ut("creature",e).forEach(Vl)}function Nl(e,t){if(re(e))return i("actionList").children[t].children[0].children[1].classList.remove("loading"),!0}function Gl(e){let t=GameData.actions()[e];if(t)return Nl(t.data.name,e)}function Il(e){return function(r,n,g,v){Gl(g.passback)||e(r,n,g,v)}}var $l={2:Il};function Rl(e){return Cn(e)||e===0}function Pl(e){return e&&Xe(e)}function Fl(e){return function(r,n,g,v){let D=$l[r];Pl(D)&&Rl(v)?D(e)(r,n,g,v):e(r,n,g,v)}}function gr(){let e=GameData.doAction;GameData.doAction=Fl(e)}function yr(){$.subscribe(ie,me),me(),gr()}function vr(e){return Fn({cmd:"toprated",subcmd:e})}async function Ol(e){let r=(await vr("globalquest")).r.list,n='<table id="world-event-contrib-table" style="width: 270px;"><tr><td class="header"></td><td class="header"></td><td class="header">Username</td><td class="header">Kills</td></tr>',g=r.length;for(let v=0;v<g;v++)n+=`<tr style="border-top:1px solid #CD9E4B;"><td>${v+1}</td><td><a href="${tn}${r[v].guild.id}"><img src="${ne}guilds/${r[v].guild.id}_mini.png" width="16" height="16"></a></td><td><a href="${on}${r[v].player.name}">${r[v].player.name}</a></td><td>${r[v].value}</td></tr>`;n+="</table>",x(n,e)}function _l(){let e=i("world-event-contrib");x("Loading...",e),Ol(e),$(e).dialog({title:"Top 100 Event Contributers",minWidth:300,height:300,zIndex:9999})}function xr(){let e=$("#world-event-badge");!e.length||(e.off(),w(e[0],_l))}function Kl(e){return e.response&&e.response.msg&&e.response.msg.startsWith("Creature did not exist at that location")}function ql(e){Kl(e)&&GameData.fetch(Qe+k)}function Wl(e){e.remove()}function Ul(e,t){ql(t),et(".creature-4 > .quickCombat > .verbs").forEach(Wl)}function Dr(){$.subscribe(je,Ul)}function G(e){return!e||!e.response||!e.response.data}var Ea='<table class="relicT relicS"><thead><tr><th colspan="2">Adjusted defense values</th></tr></thead><tbody><tr><td>DC225:</td><td id="DC225">0</td></tr><tr><td>DC175:</td><td id="DC175">0</td></tr><tr><td colspan="2">&nbsp;</td></tr></tbody><thead><tr><th colspan="2">Attacking Group Stats</th></tr></thead><tbody><tr><td>Raw Group Attack:</td><td class="fshGrey" id="GroupAttack"></td></tr><tr><td>Group Attack w/ buffs:</td><td id="GroupAttackBuffed"></td></tr><tr><td>Raw Group Defense:</td><td class="fshGrey" id="GroupDefense"></td></tr><tr><td>Group Defense w/ buffs:</td><td id="GroupDefenseBuffed"></td></tr><tr><td>Raw Group Armor:</td><td class="fshGrey" id="GroupArmor"></td></tr><tr><td>Group Armor w/ buffs:</td><td id="GroupArmorBuffed"></td></tr><tr><td>Raw Group Damage:</td><td class="fshGrey" id="GroupDamage"></td></tr><tr><td>Group Damage w/ buffs:</td><td id="GroupDamageBuffed"></td></tr><tr><td>Raw Group HP:</td><td class="fshGrey" id="GroupHP"></td></tr><tr><td>Group HP w/ buffs:</td><td id="GroupHPBuffed"></td></tr></tbody></table>',Ca='<table class="relicT relicS"><thead><tr><th colspan="2">Defending Guild Stats</th></tr></thead><tbody><tr><td>Relic Count:</td><td id="relicCount">0</td></tr><tr><td>Lead Defender Bonus:</td><td id="LDPercentage">0</td></tr><tr><td>Lead Defender Cloaked:</td><td id="LDCloaked">No</td></tr></tbody><thead><tr><th colspan="2">Other Defender Stats</th></tr></thead><tbody><tr><td>Raw Attack:</td><td class="fshGrey" id="attackValue">0</td></tr><tr><td>Attack w/ buffs:</td><td id="attackValueBuffed">0</td></tr><tr><td>Raw Defense:</td><td class="fshGrey" id="defenseValue">0</td></tr><tr><td>Defense w/buffs:</td><td id="defenseValueBuffed">0</td></tr><tr><td>Raw Armor:</td><td class="fshGrey" id="armorValue">0</td></tr><tr><td>Armor w/ buffs:</td><td id="armorValueBuffed">0</td></tr><tr><td>Raw Damage:</td><td class="fshGrey" id="damageValue">0</td></tr><tr><td>Damage w/ buffs:</td><td id="damageValueBuffed">0</td></tr><tr><td>Raw HP:</td><td class="fshGrey" id="hpValue">0</td></tr><tr><td>HP w/ buffs:</td><td id="hpValueBuffed">0</td></tr><tr><td>Cloaked:</td><td id="defendersCloaked">0</td></tr><tr><td>Processed:</td><td id="defendersProcessed">0</td></tr></tbody></table>',ka='<table class="relicT"><thead><tr><th colspan="2">Processing</th></tr></thead><tbody><tr><td class="fshGreen" colspan="2" id="ProcessingStatus">Parsing defending guild stats ...</td></tr></tbody><thead><tr><th colspan="2">Assumptions</th></tr></thead><tbody><tr><td colspan="2" class="fshGrey">Above calculations include Constitution, Fortitude, Nightmare Visage, Chi Strike, Sanctuary, Terrorize and Flinch bonus calculations (in that order) on both the defending group and attacking group.</td></tr></tbody></table>';var I,ce,de,pe;function zl(e){return e.player_name}function jl(e){pe=e.defenders.map(zl)}function Ql(){I?x("",I):I=f({className:"body"})}function Yl(e){ce=f({className:"fshFloatLeft fshRelicLeftDiv"}),a(I,ce),e.is_owner&&a(ce,Xn(pe)),de=K({className:"custombutton",textContent:"Fetch Stats"}),a(ce,de)}function Ba(e){jl(e),Ql(),Yl(e);let t=i("dialog-relic");a(t,I)}var b,Sa,Aa,wr,Er,Cr,kr,xt,Br,Sr,Ar,br,Lr,Tr,Hr,Mr,Vr,Nr,Gr,Ir,$r,Rr,Pr,Fr,Or,_r,Kr,qr,Wr,Ur,z,Xl=[e=>e!=="lastUpdate",e=>!pe.includes(e),e=>b[e].last_login,e=>Number(b[e].last_login)<Sa,e=>Number(b[e].last_login)>Aa,e=>b[e].level<400||b[e].level>421,e=>b[e].level<441||b[e].level>450];function Jl(e,t){return t(e)}function Zl(e){return Xl.every(s(Jl,e))}function es(e){return`<a href="${en}${b[e].id}">${e}</a>`}function ts(e){b=e,Sa=Rt-120,Aa=Rt-604800;let t=Tn(b).filter(Zl).map(es);Y(I,`<div class="fshFloatLeft fshRelicLowDiv"><table class="relicT"><thead><tr><th>${t.length.toString()} Offline guild members not at relic:</th></tr></thead><tbody><tr><td>${t.join(" ")}</td></tr></tbody></table></div>`)}function rs(){wr=i("relicCount"),Er=i("LDPercentage"),Cr=i("LDCloaked"),kr=i("attackValue"),xt=i("attackValueBuffed"),Br=i("defenseValue"),Sr=i("defenseValueBuffed"),Ar=i("armorValue"),br=i("armorValueBuffed"),Lr=i("damageValue"),Tr=i("damageValueBuffed"),Hr=i("hpValue"),Mr=i("hpValueBuffed"),Vr=i("defendersCloaked"),Nr=i("defendersProcessed")}function os(){Gr=i("DC225"),Ir=i("DC175"),$r=i("GroupAttack"),Rr=i("GroupAttackBuffed"),Pr=i("GroupDefense"),Fr=i("GroupDefenseBuffed"),Or=i("GroupArmor"),_r=i("GroupArmorBuffed"),Kr=i("GroupDamage"),qr=i("GroupDamageBuffed"),Wr=i("GroupHP"),Ur=i("GroupHPBuffed")}function ba(e){lt(de);let t=d("hideRelicOffline");e.is_owner&&!t&&Yn(!0).then(ts),Y(ce,ka),z=i("ProcessingStatus");let r=f({className:"fshFloatLeft fshRelicMidDiv",innerHTML:Ca});a(I,r),rs();let n=f({className:"fshFloatLeft fshRelicRightDiv",innerHTML:Ea});a(I,n),os()}var Dt;function ns(e){return e===1?1.5:le(1-e/10,2)}function La(e){let t=S(e),n=bn('#pCC img[src*="/relics/"]',t).length;l(n,wr),Dt=ns(n),l(`${String(Dt*100)}%`,Er)}function wt(e,t){return e>t*10||e<t?e:t*10}function as(e){e.attackValue=wt(e.attackBonus,e.levelValue),e.defenseValue=wt(e.defenseBonus,e.levelValue),e.armorValue=wt(e.armorBonus,e.levelValue),e.damageValue=wt(e.damageBonus,e.levelValue),e.hpValue=e.hpBonus}var is=[["levelValue","level"],["attackValue","attack"],["attackBonus","bonus_attack"],["defenseValue","defense"],["defenseBonus","bonus_defense"],["armorValue","armor"],["armorBonus","bonus_armor"],["damageValue","damage"],["damageBonus","bonus_damage"],["hpValue","hp"],["hpBonus","bonus_hp"],["killStreakValue","killstreak"]];function ls(e,t,r){e[r[0]]=Number(t[r[1]])}function ss(e,t){is.forEach(s(ls,e,t))}var fs=[["counterAttackLevel","Counter Attack"],["doublerLevel","Doubler"],["deathDealerLevel","Death Dealer"],["darkCurseLevel","Dark Curse"],["holyFlameLevel","Holy Flame"],["constitutionLevel","Constitution"],["sanctuaryLevel","Sanctuary"],["flinchLevel","Flinch"],["nightmareVisageLevel","Nightmare Visage"],["superEliteSlayerLevel","Super Elite Slayer"],["fortitudeLevel","Fortitude"],["chiStrikeLevel","Chi Strike"],["terrorizeLevel","Terrorize"],["barricadeLevel","Barricade"],["reignOfTerrorLevel","Reign Of Terror"],["anchoredLevel","Anchored"],["severeConditionLevel","Severe Condition"],["entrenchLevel","Entrench"],["cloakLevel","Cloak"]];function us(e,t,r){e[r[0]]=t[r[1]]||0}function ms(e,t){fs.forEach(s(us,e,t))}function he(e){if(!e)return;let t=ct(e._skills),r={};return ss(r,e),ms(r,t),r.superEliteSlayerMultiplier=le(.002*r.superEliteSlayerLevel,2),Ln(r.armorValue)&&as(r),r}var ge,Et,Te,ye,He,Ct,Me,zr,jr,E,p,oe;function cs(){p.attack-=oe.attack,p.defense-=oe.defense,p.armor-=oe.armor,p.damage-=oe.damage,p.hp-=oe.hp}function Ve(e){return Math.round(e*Dt)}function ds(){ge+=Ve(E.attackValue),Te+=Ve(E.defenseValue),ye+=Ve(E.armorValue),He+=Ve(E.damageValue),Me+=Ve(E.hpValue)}function Ta(){u(ge,kr),u(Te,Br),u(ye,Ar),u(He,Lr),u(Me,Hr),l(zr,Vr),jr+=1,l(jr,Nr)}function ps(){u(p.attack,$r),u(p.defense,Pr),u(p.armor,Or),u(p.damage,Kr),u(p.hp,Wr)}function hs(e){return Math.ceil(p.attack*(P(e["Nightmare Visage"],0)*.0025))}function gs(){let e=Math.ceil(p.attack*E.flinchLevel*.001);u(p.attack-e,Rr)}function ys(e){return Math.ceil(p.defense*(1+P(e.Constitution,0)*.001))}function vs(e,t){u(t+e,Fr)}function xs(e){u(p.armor+Math.floor(p.armor*P(e.Sanctuary,0)*.001),_r)}function Ds(e,t){return Math.ceil(t*P(e.Fortitude,0)*.001)}function ws(e){u(p.hp+e,Ur)}function Es(e,t){let r=Math.ceil((p.hp+t)*P(e["Chi Strike"],0)*.001),n=Math.ceil(p.damage*E.terrorizeLevel*.001);u(p.damage+r-n,qr)}function Cs(e){let t=hs(e);p.attack-=t,gs();let r=ys(e);vs(t,r),xs(e);let n=Ds(e,r);ws(n),Es(e,n)}function ks(e){let t=Math.ceil(Et*P(e.Flinch,0)*.001);u(Et-t,xt)}function Bs(e){let t=Math.ceil(Ct*P(e.Terrorize,0)*.001);u(Ct-t,Tr)}function Ss(){l("Processing attacking group stats ... ",z),oe&&cs(),ps();let e=ct(GameData.player().buffs);Cs(e),ks(e),Bs(e),l("Done.",z)}function As(){return Math.ceil(ge*(E.nightmareVisageLevel*.0025))}function bs(){return Math.ceil(Te*(1+E.constitutionLevel*.001))}function Ls(e){Et=ge-e,u(Et,xt)}function Ha(e){return 1-e*Ye}function Ts(e,t){let r=t+e;u(r,Sr),u(Math.ceil(r*Ha(225)),Gr),u(Math.ceil(r*Ha(175)),Ir)}function Hs(){u(ye+Math.floor(ye*E.sanctuaryLevel*.001),br)}function Ms(e){return Math.ceil(e*E.fortitudeLevel*.001)}function Vs(e){Ct=He+Math.ceil(e*E.chiStrikeLevel*.001),u(Ct)}function Ns(){E.cloakLevel!==0&&l("Yes",Cr)}function Ma(){l("Processing defending guild stats ... ",z),ds(),Ta();let e=As();Ls(e);let t=bs();Ts(e,t),Hs();let r=Me+Ms(t);u(r,Mr),Vs(r),Ns(),GameData.player().hasGroup&&p?Ss():l("Done.",z)}function Va(e){let t=he(e);ge+=Math.round(t.attackValue*ae),Te+=Math.round(t.defenseValue*ae),ye+=Math.round(t.armorValue*ae),He+=Math.round(t.damageValue*ae),Me+=Math.round(t.hpValue*ae),t.cloakLevel!==0&&(zr+=1),Ta()}function Na(e){E=he(e)}function Ga(e){p=e}function Ia(e){oe=e}function $a(){ge=0,Te=0,ye=0,He=0,Me=0,zr=0,jr=0}var Ne;function Gs(e){l(e.message,z)}function Is(e){return e.parentNode.parentNode.previousElementSibling.previousElementSibling.innerHTML.indexOf('"#000099"')!==-1}function $s(e){let t=e.previousElementSibling.href,r=[Zn(t).then(Ga)];return Is(e)&&r.push(ea().then(Ia)),r}function Rs(e){let t=S(e),r=_('#pCC a[href*="confirmDisband"]',t);if(!r)return;let n=$s(r);return On(n)}function Ps(){return M({cmd:"guild",subcmd:"groups"}).then(Rs)}function Fs(){return M({cmd:"guild",subcmd:"view",guild_id:Ne.controlled_by.guild_id}).then(La)}function Os(e,t){return t===0?Ot(e).then(Na):Ot(e).then(Va).catch(Gs)}function _s(){return pe.map(Os)}function Ks(){let e=[Fs()];return GameData.player().hasGroup&&e.push(Ps()),e=e.concat(_s()),e}function qs(){ba(Ne),$a();let e=Ks();ft(e,Ma)}function Ws(e,t){G(t)||(Ne=t.response.data,Ne.defenders.length>0&&(Ba(Ne),Zo(de,"click",qs)))}function Qr(){$.subscribe(pn,Ws)}function Ge(e){return In({cache:!1,url:"fetchdata.php",data:st(e,{fshrnd:Qn()}),dataType:"json"})}var Ra=[];function Us(e){return G(e)||Ra.push(e),e}function zs(e,t){return e===Number(t.response.data.id)}function js(e,t){e(t)}function Qs(e){return new Promise(t=>{Bn(3,js,[t,e])})}function Ie(e,t){let r=Ra.find(s(zs,e));return r?Qs(r):Ge({a:1,id:e,passback:t}).then(Us)}var kt,Yr,Xr,Jr,Zr,eo;function $e(e,t){return Nn(fe(t,e))}function Ys(e){Xr=$e(e,xn),Yr=$e(e,vn),Zr=$e(e,wn),Jr=$e(e,Dn),eo=$e(e,En)}function Pa(){kt=GameData.player().level,Ys(i("statbar-character-tooltip-stats"))}function Xs(e){return`<table><tr><td><img src="${ne}creatures/${e.image_id}.png" height="200" width="200"></td><td rowspan="2"><table width="400"><tr><td class="header" colspan="4" class="fshCenter">Statistics</td></tr>`}function Js(e,t){return`<tr><td>Class:&nbsp;</td><td width="40%">${e.creature_class}</td><td>Level:&nbsp;</td><td width="40%">${e.level} (your level:<span class="${t}">${kt}</span>)</td></tr>`}function Zs(e){return`<tr><td>Attack:&nbsp;</td><td width="40%">${e.attack} (your defense:<span class="fshYellow">${Yr}</span>)</td><td>Defense:&nbsp;</td><td width="40%">${e.defense} (your attack:<span class="fshYellow">${Xr}</span>)</td></tr>`}function ef(e){return`<tr><td>Armor:&nbsp;</td><td width="40%">${e.armor} (your damage:<span class="fshYellow">${Jr}</span>)</td><td>Damage:&nbsp;</td><td width="40%">${e.damage} (your armor:<span class="fshYellow">${Zr}</span>)</td></tr>`}function tf(e,t){return`<tr><td>HP:&nbsp;</td><td width="40%">${e.hp} (your HP:<span class="fshYellow">${eo}</span>)(1H: <span class="fshRed">${t}</span>)</td><td>Gold:&nbsp;</td><td width="40%">${e.gold}</td></tr>`}var rf='<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Enhancements</td></tr>';function of(e){return`<tr><td colspan="2">${e.name}:</td><td colspan="2">${e.value}</td></tr>`}function nf(e){return e.enhancements.length===0?'<tr><td colspan="4">[no enhancements]</td></tr>':e.enhancements.map(of).join("")}function af(e){return`<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Description</td></tr><tr><td colspan="4">${e.description}</td></tr><tr><td colspan="4" height="5"></td></tr></table></td></tr><tr><td class="fshCenter"><b>${e.name}</b></td></tr></table>`}function lf(e,t,r){return Xs(e)+Js(e,r)+Zs(e)+ef(e)+tf(e,t)+rf+nf(e)+af(e)}function sf(e){let t=Math.ceil(e.hp*o.hpVariable+e.armor*o.generalVariable),r="fshYellow";return Pa(),kt>e.level&&(r="fshRed"),lf(e,t,r)}function to(e){if(!G(e))return sf(e.response.data)}var ff=["verb","view","tip-static"];function uf(e,t){$(e).qtip({overwrite:!0,show:{event:"mouseover",ready:!0},style:{classes:"qtip-tipsy qtip-custom"},position:{my:"center right",at:"center left",effect:!1,viewport:$(window)},content:{text:t},hide:{effect:!1}})}function mf(e){return Ze(e.parentNode.children).indexOf(e)}function cf(e,t){let r=to(t);e.set("content.text",r)}function df(e,t,r){return Ie(GameData.actions()[e].data.id,e).then(s(cf,r)),"Loading..."}function pf(e,t){se("NewMap","CreatureInfo");let r=mf(t);e.classList.add("fshTip"),uf(e,s(df,r))}function hf(e,t){return Kn(ff,e)&&!Ae("fshTip",e)&&Ae("creature",t)}function gf(e){if(!o.showCreatureInfo)return;let{target:t}=e,r=t.parentNode.parentNode.parentNode;hf(t,r)&&pf(t,r)}function ro(){L(i("actionList"),"mouseover",gf)}var B;function yf(e,t){t.creature_class=e.creature_class,t.image_id=e.image_id,t.level=Number(e.level),t.type=e.type}function vf(e){B[e.name]?B[e.name].seen&&(B[e.name].seen+=1):(B[e.name]={seen:1},yf(e,B[e.name]))}function Fa(e,t,r){return t?e(t,r):r}function Oa(e,t){let r=e||{};return r.min=Fa(Math.min,r.min,t),r.max=Fa(Math.max,r.max,t),r}var xf=["attack","armor","damage","defense","hp"];function Df(e,t){return!e||e.min!==t.min||e.max!==t.max}function wf(e,t,r){let n=Oa(t[r],Number(e[r]));Df(t[r],n)&&(t[r]=n)}function Ef(e,t){xf.forEach(s(wf,e,t))}function Cf(e){return e.enhancements&&e.enhancements.length>0}function kf(e,t){e[t.name]=Oa(e[t.name],Number(t.value))}function Bf(e,t){Cf(e)&&(t.enhancements=t.enhancements||{},e.enhancements.forEach(s(kf,t.enhancements)))}function Sf(e){B||(B={}),vf(e),Ef(e,B[e.name]),Bf(e,B[e.name]),at("fsh_monsterLog",B)}function _a(e){o.showMonsterLog&&Sf(e)}function Af(e){B=e||{}}function Ka(){nt("fsh_monsterLog").then(Af)}var qa=[];function bf(e){G(e)||(se("NewMap","MonsterLog"),_a(e.response.data))}function Lf(e,t){return e.id===t.id}function Tf(e){if(qa.find(s(Lf,e.data)))return!0;qa.push(e.data)}function Hf(e,t){e.type!==6||Tf(e)||Ie(e.data.id,t).then(bf)}function Wa(){o.showMonsterLog&&GameData.actions().forEach(Hf)}function oo(){Ka(),$.subscribe("-1-success.action-response 4-success.action-response 5-success.action-response 25-success.action-response",Wa),Wa()}function no(){return mt({subcmd:"scouttower"})}function Mf(e){let t=e.split(/[: /[]/);return new Date(Number(t[4]),Ue.indexOf(t[3]),Number(t[2]),Number(t[0]),Number(t[1]))}function Vf(e){let t=X(e[1]);return t==="No active cooldown"?0:Math.ceil((Mf(t.slice(16))-Je)/1e3)}function Nf(e){let t=e[0].cells[0].children[0];return{base_id:Number(t.src.match(/s\/(\w+)\.p/)[1].slice(0,-32)),name:t.title}}function Gf(e){return{cooldown:Vf(e),creature:Nf(e),kills:Number(X(e[0].cells[3]))}}function If(e){let t=X(e[0].cells[1]);if(t!=="n/a"){let r=X(e[0].cells[2]).match(/(\d+)\/(\d+)/);return{realm:t,current_hp:Number(r[1]),max_hp:Number(r[2])}}}function $f(e){let t=e[2].cells[0].children;if(t.length===1)return{contributors:$n(t[0].rows,3,0).map(n=>({kills:Number(X(n.cells[1])),player:{name:X(n.cells[0])}}))}}function Rf(e){return{...Gf(e),...If(e),...$f(e)}}function Pf(e){let t=S(e),r=_('table[width="500"]',t);if(!r)return{s:!1};let n=Ze(r.rows).filter((v,D,We)=>D!==0&&D<We.length-1&&(D-1)%6<3);return{r:_n(3,n).map(Rf),s:!0}}function ao(){return M({cmd:"guild",subcmd:"scouttower"}).then(Pf)}function io(){return ue(no,ao)}function Ff(e,[t,r,n]){let g=e.insertCell(-1);return g.colSpan=t,n&&(g.className="header"),a(g,r),g}function Of(e,t){t.forEach(s(Ff,e))}function _f(e,t,r){let n=e.insertRow(-1);return r&&(n.className="fshBlue"),Of(n,t),n}function Kf(e,t){_f(e,t[0],t[1])}function Re(e,t){t.forEach(s(Kf,e))}var lo;function Ua(e){lo=e}var so,fo,uo,mo,co,po,ho,go;function qf(){so=y("Current"),fo=y("Kills"),uo=y("Member"),mo=y("% of Total")}function Wf(){co=y("Status"),po=y("Titan HP"),ho=y("Total"),go=y("Your Guild")}function za(){qf(),Wf()}var ve,xe,De,we,Ee,Ce,ke;function ja(){ve=m(),xe=m(),De=m(),we=m(),Ee=m(),Ce=m(),ke=m()}function Qa(){l("",ve),l("",xe),l("",De),l("",we),l("",Ee),x("",Ce),x("",ke)}var j;function Bt(){for(;j.rows.length>7;)j.deleteRow(7)}function Uf(){let e=m();return a(e,ve),H(e,"/"),a(e,xe),e}function Ya(e){let t=m();return a(t,e),H(t,"%"),t}function Xa(){j=Rn({className:"fshCenter"}),za(),Re(j,[[[[2,po,!0],[4,go,!0]]],[[[2,Uf()],[4,De]]],[[[2,so,!0],[4,Ya(we)]],!0],[[[2,ho,!0],[4,Ya(Ee)]],!0],[[[2,co,!0],[4,Ce]],!0],[[[6,ke]]],[[[2,uo,!0],[2,fo,!0],[2,mo,!0]]]])}var Q,St;function yo(){St=null,Q&&!Ae("fshHide",Q)&&(c(Q,!0),Qa(),Bt())}function Ja(e){return e.type===0?(St=e.base_creature_id,!0):!1}function Za(){if(Q)c(Q,!1);else{let e=i("actionContainer");Q=f({className:"fshActionBox titanInfo"}),ja(),Xa(),a(Q,j),a(e,Q)}}function zf(e){let t=new Date(Je+e*1e3);return`${it(t.getHours())}:${it(t.getMinutes())} ${it(t.getDate())}/${Ue[t.getMonth()]}/${t.getFullYear()}`}function jf(e){return e<=0?'<span class="fshGreen cooldown">No active cooldown</span>':`<span class="fshMaroon cooldown">Cooldown until: ${zf(e)}</span>`}function Qf(e){return tt(ra(e.max_hp-e.current_hp,e.kills),2)}function Yf(e){return tt(e.kills*100/e.max_hp,2)}function Xf(e){return oa(e.kills,e.max_hp,e.current_hp)}function Jf(e){e.forEach(([t,r])=>{l(t,r)})}function Zf(e){Jf([[e.current_hp,ve],[e.max_hp,xe],[e.kills,De],[Qf(e),we],[Yf(e),Ee]]),x(Xf(e),Ce),x(jf(e.cooldown),ke)}function eu(e,t){return[[[2,y(t.player.name)],[2,y(t.kills.toString())],[2,y(`${tt(t.kills*100/e.kills,2)}%`)]]]}function tu(e){if(Bt(),!e.contributors)return;let t=e.contributors.map(s(eu,e));Re(j,t)}function ru(e){return e.realm&&e.creature.base_id===St&&e.realm===lo}function vo(e){let t=e.find(ru);t&&(Zf(t),tu(t))}var At;function ou(){At&&(window.clearTimeout(At),At=null)}function nu(e){return e&&e.s&&T(e.r)}function ei(e){return o.showTitanInfo&&T(e)&&e.some(Ja)}function au(e,t){!nu(t)||(vo(t.r),ei(GameData.realm().dynamic)?At=window.setTimeout(e,3e4):yo())}function ti(){io().then(s(au,ti))}function ri(e){ou(),ei(e)?(Za(),ti()):yo()}function oi(e){e.dynamic&&(Ua(e.name),ri(e.dynamic))}function ni(){o.showTitanInfo=!o.showTitanInfo,h("showTitanInfo",o.showTitanInfo),ri(GameData.realm().dynamic)}function iu(e){return e.realm&&e.realm.name}function ai(e,t){iu(t)&&oi(t.realm)}function xo(){window.initialGameData&&ai(null,window.initialGameData),$.subscribe(`${cn} ${hn}`,ai)}var Do;function ii(e){$("#statbar-gold").css("background-color",e)}function li(){$("#HelperSendTotal").html(O(d("currentGoldSentTotal"))),Number(GameData.player().gold)>Do?ii("red"):ii("inherit")}function lu(){return`<dt class="stat-gold-sendTo">Send To:</dt><dd id="HelperSendTo">${d("goldRecipient")}</dd><dt class="stat-gold-sendAmt">Amount:</dt><dd id="HelperSendAmt">${O(Do)}</dd><dt class="stat-gold-sendTo">Send?</dt><dd><input id="HelperSendGold" value="Send!" class="custombutton" type="submit"><input type="hidden" id="xc" value=""</dd><dt class="stat-gold-sendTotal">Total Sent:</dt><dd id="HelperSendTotal">${O(d("currentGoldSentTotal"))}</dd>`}function su(){Do=d("goldAmount"),$("#statbar-gold-tooltip-general").append(lu()),$("#HelperSendGold").on("click",jn),li(),$.subscribe(sn,li)}function wo(){zn(),Un&&su()}var Pe,Fe,bt,Be,Eo,Co,Lt;function fu(){return Ge({a:14,d:0,id:Pe.id,item_id:Pe.itemId})}function uu(e){let t=e.response.response,r=e.response.msg,n;if(t!==0){let g=r.indexOf("<");g!==-1?n=r.substring(0,g):n=r}else n=`You purchased ${e.response.data.name} for ${O(e.response.data.cost)} gold.`;Y(Lt,`${n}<br>`)}function mu(){GameData.doAction(14,3,{id:Pe.id,item_id:Pe.itemId},0),bt.close()}function cu(){let e=Hn(Eo.value);if(!e)return;let t=[];for(let r=1;r<e;r+=1)t.push(fu().then(uu));ft(t,mu)}function du(){Be=f({className:"fshClear",textContent:"Select how many to quick-buy:"}),Eo=rt({id:"buyAmount",className:"fshNumberInput",min:1,max:99,value:1,type:"number"}),a(Be,Eo),Co=K({textContent:"Quick-buy"}),w(Co,cu),a(Be,Co),Lt=f(),a(Be,Lt),a(Fe,Be)}function pu(){return Fe||i("shopDialogConfirm")}function hu(){return bt||$(Fe).data("hcsWorldDialogShopConfirm")}function gu(){Be?l("",Lt):du()}function yu(e,t){Pe=t,Fe=pu(),!!Fe&&(bt=hu(),bt&&gu())}function ko(){$.subscribe(fn,yu)}function vu(e){let t=S(e),r=Jn(t);return{r:{attributes:[{value:r.attack},{value:r.defense},{value:r.armor},{value:r.damage},{value:r.hp}]}}}function Bo(e){return M({cmd:"guild",subcmd:"groups",subcmd2:"viewstats",group_id:e}).then(vu)}function Oe(e){return mt(st({subcmd:"groups"},e))}function So(e){return Oe({subcmd2:"viewstats",group_id:e})}function Ao(e){return ue(So,Bo,e)}function bo(){return Oe({subcmd2:"view"})}function xu(e){let t=S(e),r=_('#pCC img[src$="disband.png"]',t);return r?{r:[{id:Number(r.parentNode.href.match(/\((\d+)\)/)[1]),members:[{name:F()}]}]}:{}}function Lo(){return M({cmd:"guild",subcmd:"groups"}).then(xu)}function To(){return ue(bo,Lo)}function si(e){return e.numberOfCreatureHitsTillDead-e.numberOfHitsRequired<=1?", dies on miss":", survives a miss"}function Du(e){return e.numberOfHitsRequired==="-"||e.numberOfHitsRequired>e.numberOfCreatureHitsTillDead}function wu(e){return e.numberOfCreatureHitsTillDead==="-"?e.numberOfHitsRequired:Du(e)?"-":e.numberOfHitsRequired}function Eu(e){return e.numberOfCreatureHitsTillDead==="-"||e.numberOfCreatureHitsTillDead>e.numberOfHitsRequired}function Cu(e){return e.numberOfHitsRequired==="-"?e.numberOfCreatureHitsTillDead:Eu(e)?"-":e.numberOfCreatureHitsTillDead}var ku=[[e=>e.playerHits==="-"&&e.creatureHits==="-",()=>"Unresolved"],[e=>e.playerHits==="-",()=>"Player dies"],[e=>e.playerHits===1,e=>`Player 1 hits${si(e)}`],[e=>e.playerHits>1,e=>`Player > 1 hits${si(e)}`]];function Bu(e,t){return t[0](e)}function Su(e){let t=ku.find(s(Bu,e));return t?t[1](e):"Unknown"}function Ho(e){e.playerHits=wu(e),e.creatureHits=Cu(e),e.fightStatus=Su(e)}function Au(e){return e.callback.groupExists?e.callback.groupArmorValue:e.player.armorValue}function bu(e){let t=Au(e);e.overallArmorValue=t+Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}function Lu(e){e.player.sanctuaryLevel>0&&(e.extraNotes+=`Sanc Bonus Armor = ${Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}<br>`)}function Tu(e){e.terrorizeEffect=Math.floor(e.creature.damage*e.player.terrorizeLevel*.001)}function Hu(e){e.player.terrorizeLevel>0&&(e.extraNotes+=`Terrorize Creature Damage Effect = ${e.terrorizeEffect*-1}<br>`)}function Mu(e){e.creatureDamageDone=Math.ceil(e.generalVariable*e.creature.damage-e.overallArmorValue+e.overallHPValue)}function Vu(e){let t=e.generalVariable*e.creature.damage;t<e.overallArmorValue?e.numberOfCreatureHitsTillDead=e.overallHPValue:e.numberOfCreatureHitsTillDead=Math.ceil(e.overallHPValue/(t-e.overallArmorValue))}function Nu(e){e.creatureHitByHowMuch>=0?Vu(e):e.numberOfCreatureHitsTillDead="-"}function Mo(e){bu(e),Lu(e),Tu(e),Hu(e),e.creature.damage-=e.terrorizeEffect,Mu(e),Nu(e)}function Gu(e){return e.callback.groupExists?e.callback.groupAttackValue:e.player.attackValue}function fi(e){return Math.floor(e.creature.defense*e.player.darkCurseLevel*Ye)}function Iu(e){let t=e.creature.defense-fi(e);return e.combatEvaluatorBias===3?e.overallAttackValue-Math.ceil(t)-50:e.overallAttackValue-Math.ceil(e.attackVariable*t)}function Vo(e){let t=Gu(e);e.player.darkCurseLevel>0&&(e.extraNotes+=`DC Bonus Attack = ${fi(e)}<br>`),e.nightmareVisageAttackMovedToDefense=Math.floor((t+e.counterAttackBonusAttack)*e.player.nightmareVisageLevel*.0025),e.player.nightmareVisageLevel>0&&(e.extraNotes+=`NMV Attack moved to Defense = ${e.nightmareVisageAttackMovedToDefense}<br>`),e.overallAttackValue=t+e.counterAttackBonusAttack-e.nightmareVisageAttackMovedToDefense,e.hitByHowMuch=Iu(e)}function $u(e){return e.player.counterAttackLevel>0&&e.numberOfHitsRequired===1}function ui(e){e.lowestCALevelToStillHit=Math.max(Math.ceil((e.counterAttackBonusAttack-e.hitByHowMuch+1)/e.player.attackValue/.0025),0),e.lowestCALevelToStillKill=Math.max(Math.ceil((e.counterAttackBonusDamage-e.damageDone+1)/e.player.damageValue/.0025),0)}function Ru(e){return e.player.counterAttackLevel>0?Math.ceil((1+e.player.doublerLevel/50)*.0025*e.lowestFeasibleCALevel):0}function Pu(e){e.extraAttackAtLowestFeasibleCALevel=Math.floor(e.player.attackValue*.0025*e.lowestFeasibleCALevel),e.extraDamageAtLowestFeasibleCALevel=Math.floor(e.player.damageValue*.0025*e.lowestFeasibleCALevel),e.extraNotes+=`Extra CA Att/Dam at this lowered CA level = ${e.extraAttackAtLowestFeasibleCALevel} / ${e.extraDamageAtLowestFeasibleCALevel}<br>`}function Fu(e){ui(e),e.lowestFeasibleCALevel=Math.max(e.lowestCALevelToStillHit,e.lowestCALevelToStillKill),e.extraNotes+=`Lowest CA to still 1-hit this creature = ${e.lowestFeasibleCALevel}<br>`,e.lowestFeasibleCALevel!==0&&Pu(e),e.extraStaminaPerHitAtLowestFeasibleCALevel=Ru(e),e.extraStaminaPerHitAtLowestFeasibleCALevel<e.extraStaminaPerHit?e.extraNotes+=`Extra Stam Used at this lowered CA level = ${e.extraStaminaPerHitAtLowestFeasibleCALevel}<br>`:e.extraNotes+="No reduction of stam used at the lower CA level<br>"}function Ou(e){return e.numberOfHitsRequired==="-"||e.numberOfHitsRequired!==1}function _u(e){e.lowestCALevelToStillHit>175?e.extraNotes+="Even with CA175 you cannot hit this creature<br>":e.lowestCALevelToStillHit!==0&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillHit} to hit this creature<br>`)}function Ku(e){e.lowestCALevelToStillKill>175?e.extraNotes+="Even with CA175 you cannot 1-hit kill this creature<br>":e.lowestCALevelToStillKill!==0&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillKill} to 1-hit kill this creature<br>`)}function qu(e){ui(e),_u(e),Ku(e)}function No(e){$u(e)&&Fu(e),Ou(e)&&qu(e)}function Wu(e){return e.callback.groupExists?e.callback.groupHPValue:e.player.hpValue}function Uu(e){return e.callback.groupExists?e.callback.groupDamageValue:e.player.damageValue}function zu(e){let t=Wu(e),{fortitudeLevel:r}=e.player;e.fortitudeExtraHPs=Math.floor(t*r*.001),r>0&&(e.extraNotes+=`Fortitude Bonus HP = ${e.fortitudeExtraHPs}<br>`),e.overallHPValue=t+e.fortitudeExtraHPs}function ju(e){let{chiStrikeLevel:t}=e.player;e.chiStrikeExtraDamage=Math.floor(e.overallHPValue*t*.001),t>0&&(e.extraNotes+=`Chi Strike Bonus Damage = ${e.chiStrikeExtraDamage}<br>`)}function Go(e){zu(e),ju(e);let t=Uu(e);if(e.overallDamageValue=t+e.deathDealerBonusDamage+e.counterAttackBonusDamage+e.holyFlameBonusDamage+e.chiStrikeExtraDamage,e.damageDone=Math.floor(e.overallDamageValue-(e.generalVariable*e.creature.armor+e.hpVariable*e.creature.hp)),e.hitByHowMuch>0){let r=1;e.overallDamageValue>=e.generalVariable*e.creature.armor&&(r=e.overallDamageValue-e.generalVariable*e.creature.armor),e.numberOfHitsRequired=Math.ceil(e.hpVariable*e.creature.hp/r)}else e.numberOfHitsRequired="-"}function Io(e){return e.callback.groupExists?e.callback.groupDefenseValue:e.player.defenseValue}function Qu(e){e.player.constitutionLevel>0&&(e.extraNotes+=`Constitution Bonus Defense = ${Math.floor(Io(e)*e.player.constitutionLevel*.001)}<br>`)}function Yu(e){e.player.flinchLevel>0&&(e.extraNotes+=`Flinch Bonus Attack Reduction = ${Math.floor(e.creature.attack*e.player.flinchLevel*.001)}<br>`)}function $o(e){e.overallDefenseValue=Io(e)+Math.floor(Io(e)*e.player.constitutionLevel*.001)+e.nightmareVisageAttackMovedToDefense,Qu(e),Yu(e),e.creatureHitByHowMuch=Math.floor(e.attackVariable*e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue),e.combatEvaluatorBias===3&&(e.creatureHitByHowMuch=Math.floor(e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue-50))}function Xu(e){e.player.superEliteSlayerLevel>0&&(e.extraNotes+=`SES Stat Reduction Multiplier = ${e.player.superEliteSlayerMultiplier}<br>`)}function Ju(e){e.holyFlameBonusDamage=0,e.creature.class==="Undead"&&(e.holyFlameBonusDamage=Math.max(Math.floor((e.player.damageValue-e.creature.armor)*e.player.holyFlameLevel*.002),0),e.player.holyFlameLevel>0&&(e.extraNotes+=`HF Bonus Damage = ${e.holyFlameBonusDamage}<br>`))}function Zu(e){e.deathDealerBonusDamage=Math.floor(e.player.damageValue*(Math.min(Math.floor(e.player.killStreakValue/5)*.01*e.player.deathDealerLevel,20)/100))}function em(e){e.counterAttackBonusAttack=Math.floor(e.player.attackValue*.0025*e.player.counterAttackLevel),e.counterAttackBonusDamage=Math.floor(e.player.damageValue*.0025*e.player.counterAttackLevel)}function tm(e){e.extraStaminaPerHit=0,e.player.counterAttackLevel>0&&(e.extraStaminaPerHit=Math.ceil((1+e.player.doublerLevel/50)*.0025*e.player.counterAttackLevel))}function rm(e){e.player.deathDealerLevel>0&&(e.extraNotes+=`DD Bonus Damage = ${e.deathDealerBonusDamage}<br>`)}function om(e){e.player.counterAttackLevel>0&&(e.extraNotes+=`CA Bonus Attack/Damage = ${e.counterAttackBonusAttack} / ${e.counterAttackBonusDamage}<br>CA Extra Stam Used = ${e.extraStaminaPerHit}<br>`)}function Ro(e){e.extraNotes="",Xu(e),Ju(e),Zu(e),em(e),tm(e),rm(e),om(e)}function nm(e){return e.callback.groupExists?"Group ":""}function am(e){return`<tr><td bgcolor="#CD9E4B" colspan="4" align="center">${nm(e)}Combat Evaluation</td></tr>`}function im(e){return e.hitByHowMuch>0?"Yes":"No"}function lm(e){return`<tr><td align="right"><span style="color:#333333">Will I hit it? </td><td align="left">${im(e)}</td><td align="right"><span style="color:#333333">Extra Attack: </td><td align="left">( ${e.hitByHowMuch} )</td></tr>`}function sm(e){return`<tr><td align="right"><span style="color:#333333"># Hits to kill it? </td><td align="left">${e.numberOfHitsRequired}</td><td align="right"><span style="color:#333333">Extra Damage: </td><td align="left">( ${e.damageDone} )</td></tr>`}function fm(e){return e.creatureHitByHowMuch>=0?"Yes":"No"}function um(e){return`<tr><td align="right"><span style="color:#333333">Will I be hit? </td><td align="left">${fm(e)}</td><td align="right"><span style="color:#333333">Extra Defense: </td><td align="left">( ${-1*e.creatureHitByHowMuch} )</td></tr>`}function mm(e){return`<tr><td align="right"><span style="color:#333333"># Hits to kill me? </td><td align="left">${e.numberOfCreatureHitsTillDead}</td><td align="right"><span style="color:#333333">Extra Armor + HP: </td><td align="left">( ${-1*e.creatureDamageDone} )</td></tr>`}function cm(e){return`<tr><td align="right"><span style="color:#333333"># Player Hits? </td><td align="left">${e.playerHits}</td><td align="right"><span style="color:#333333"># Creature Hits? </td><td align="left">${e.creatureHits}</td></tr>`}function dm(e){return`<tr><td align="right"><span style="color:#333333">Fight Status: </span></td><td align="left" colspan="3"><span>${e.fightStatus}</span></td></tr>`}function pm(e){return`<tr><td align="right"><span style="color:#333333">Notes: </span></td><td align="left" colspan="3"><span style="font-size:x-small;">${e.extraNotes}</span></td></tr>`}function Po(e){return`<table width="100%"><tbody>${am(e)}${lm(e)}${sm(e)}${um(e)}${mm(e)}${cm(e)}${dm(e)}${pm(e)}</tbody></table>`}var Tt,Ht,_e;function hm(e){if(!Tt){let t=fe("body",e);t.length===1&&([Tt]=t)}}function mi(){return re(Ht)?"Remove from do not kill list":"Add to the do not kill list"}function ci(){l(mi(),_e)}function gm(){let e=o.doNotKillList.indexOf(Ht);e===-1?o.doNotKillList.push(Ht):o.doNotKillList.splice(e,1),ci(),h("doNotKillList",o.doNotKillList.join()),me()}function ym(){_e=K({className:"fshBl",textContent:mi(),type:"button"});let e=f({className:"description",innerHTML:'<span class="ui-helper-hidden-accessible"><input type="text"></span>'});a(e,_e),a(Tt,e),w(_e,gm)}function vm(){_e?ci():ym()}function Fo(e,t){hm(t),Tt&&(Ht=e.trim(),vm())}var Se,Ke,Mt,Vt;function xm(){Se||(Se=i("dialog-viewcreature"))}function Dm(){Ke||(Ke=f(),a(Se,Ke),a(Se,f({innerHTML:'<span class="fshFooter">*Does include CA, DD, HF, DC, Flinch, Super Elite Slayer, NMV, Sanctuary, Constitution, Fortitude, Chi Strike and Terrorize (if active) and allow for randomness (1.1053). Constitution, NMV, Fortitude and Chi Strike apply to group stats.</span>'})))}function di(){Mt||(Dm(),Mt=f(),a(Ke,Mt))}function wm(){Vt||(di(),Vt=f(),a(Ke,Vt))}function pi(e){di(),x(e,Mt)}function hi(e){wm(),x(e,Vt)}function Em(e,t,r){r===3&&(t.attack-=Math.ceil(t.attack*e),t.defense-=Math.ceil(t.defense*e),t.armor-=Math.ceil(t.armor*e),t.damage-=Math.ceil(t.damage*e),t.hp-=Math.ceil(t.hp*e))}function Cm(e,t){let r={name:e.name,class:e.creature_class,attack:Number(e.attack),defense:Number(e.defense),armor:Number(e.armor),damage:Number(e.damage),hp:Number(e.hp)};return Em(t,r,e.type),r}function km(e){e.combatEvaluatorBias=o.combatEvaluatorBias,e.attackVariable=1.1053,e.generalVariable=o.generalVariable,e.hpVariable=o.hpVariable}function Bm(e){Ro(e),Vo(e),Go(e),$o(e),Mo(e),Ho(e),No(e)}function gi(e,t,r){let n={};n.callback=r,n.player=he(t),km(n),n.creature=Cm(e.response.data,n.player.superEliteSlayerMultiplier),Bm(n),n.evaluatorHTML=Po(n),r.groupExists?hi(n.evaluatorHTML):pi(n.evaluatorHTML)}function Sm(e){return e.members[0].name===F()}function Am(e){if(T(e.r))return e.r.find(Sm).id}function bm(e,t,r){if(!r.r||!r.r.attributes)return;let n=r.r.attributes;gi(e,t,{groupExists:!0,groupAttackValue:n[0].value,groupDefenseValue:n[1].value,groupArmorValue:n[2].value,groupDamageValue:n[3].value,groupHPValue:n[4].value})}function Lm(e,t,r){r&&Ao(r).then(s(bm,e,t))}function Tm(e,t){To().then(Am).then(s(Lm,e,t))}function Hm(e,t){e.player.hasGroup&&Tm(e,t),gi(e,t,{groupExists:!1})}function Mm(e){return e.response&&e.response.data}function Vm(e,t){xm(),!!Se&&(pi(""),hi(""),Mm(t)&&(Fo(t.response.data.name,Se),qn(!0).then(s(Hm,t))))}function Oo(){$.subscribe(dn,Vm)}var Nt,_o;function Gt(){let e=[null,[o.buffs,o.buffsName],[o.buffs2,o.buffs2Name],[o.buffs3,o.buffs3Name]][o.enabledHuntingMode];T(e)&&([Nt,_o]=e)}function Ko(e){e.target.name==="enabledHuntingMode"&&(o.enabledHuntingMode=e.target.value,h("enabledHuntingMode",o.enabledHuntingMode),Gt(),GameData.fetch(R))}var qe;function yi(){qe=!qe,h("hidePlayerActions",qe),GameData.fetch(k)}function Nm(e){let t=fe("verbs",e);t.length===1&&lt(t[0])}function vi(){if(!qe)return;let e=i("actionList");ut("player",e).forEach(Nm)}function xi(){qe=d("hidePlayerActions"),$.subscribe(ie,vi),vi()}function qo(){o.showCreatureInfo=!o.showCreatureInfo,h("showCreatureInfo",o.showCreatureInfo)}function Wo(){o.showBuffs=!o.showBuffs,h("showHuntingBuffs",o.showBuffs),GameData.fetch(R)}function Uo(){o.showMonsterLog=!o.showMonsterLog,h("showMonsterLog",o.showMonsterLog)}function zo(){o.hideSubLvlCreature=!o.hideSubLvlCreature,h("hideSubLvlCreature",o.hideSubLvlCreature),GameData.fetch(k)}function Gm(){return f({id:"fshWorldPrefs",innerHTML:`${J("showCreatureInfo")}&nbsp;&nbsp;${J("showMonsterLog")}&nbsp;&nbsp;${J("showTitanInfo")}&nbsp;&nbsp;${J("showBuffInfo")}<br>${J("hideSubLvlCreature")}&nbsp;&nbsp;${J("hidePlayerActions")}&nbsp;&nbsp;${ia()}`})}var Im={hideSubLvlCreature:zo,hidePlayerActions:yi,showCreatureInfo:qo,showHuntingBuffs:Wo,showMonsterLog:Uo,showTitanInfo:ni,showBuffInfo:ca};function $m(e){let t=Im[e.target.name];Xe(t)&&(e.target.blur(),t(e))}function jo(){let e=f({className:"fshCenter fshFten"}),t=Gm();w(t,$m),L(t,"change",Ko),a(e,t);let r=f();a(e,r);let n=i("worldContainerBelow").children[0];return ot(e,n),r}function Rm(e,t){return e[t.name]=!0,e}function Pm(e,t,r){return e[r.trim()]||t.push(r),t}function Fm(e,t){x(`You are missing some ${_o} hunting buffs<br>(${t.join(", ")})`,e)}function Di(e){x("",e)}function Om(e,t){let r=t.b.reduce(Rm,{}),n=Nt.reduce(s(Pm,r),[]);n.length>0?Fm(e,n):Di(e)}function _m(e,t,r){o.showBuffs?Om(e,r):Di(e)}function Km(e,t,r){Nt&&_m(e,t,r)}function Qo(e){Gt();let t=s(Km,e);$.subscribe(ze,t),o.showBuffs&&window.initialGameData&&t(null,{b:window.initialGameData.player.buffs})}var It=[{generalVariable:1.1053,hpVariable:1.1},{generalVariable:1.1,hpVariable:1.053},{generalVariable:1.053,hpVariable:1},{generalVariable:1.1053,hpVariable:1}];function qm(e){return It[e]?It[e].generalVariable:1.1053}function Wm(e){return It[e]?It[e].hpVariable:1.1}function Yo(){o.combatEvaluatorBias=d("combatEvaluatorBias"),o.generalVariable=qm(o.combatEvaluatorBias),o.hpVariable=Wm(o.combatEvaluatorBias)}function Um(e){return!e||!e.actions||e.actions.length===0}function zm(e,t){return t.type===6?t.data.creature_type!==0||t.data.level>=e:!0}function jm(e){return e.realm&&e.realm.minlevel||GameData.realm().minlevel}function Qm(e){let t=kn(e);return Um(t)?e:(t.actions=t.actions.filter(s(zm,jm(t))),JSON.stringify(t))}function Ym(e){return e.data&&e.data.d&&ta(e.data.d,k)}function Xm(e,t){o.hideSubLvlCreature&&Ym(t)&&(e.dataFilter=Qm)}function Xo(){$.ajaxPrefilter("JSON",Xm),o.hideSubLvlCreature&&GameData.fetch(k)}function Jm(e){o[e[0]]=Pt(e[1])}function Zm(){[["buffs","huntingBuffs"],["buffs2","huntingBuffs2"],["buffs3","huntingBuffs3"]].forEach(Jm)}function ec(e){o[e]=Pt(e)}function tc(){["doNotKillList"].forEach(ec)}function rc(){Zm(),tc()}function oc(e){o[e[0]]=d(e[1])}function nc(){[["buffsName","huntingBuffsName"],["buffs2Name","huntingBuffs2Name"],["buffs3Name","huntingBuffs3Name"],["showBuffs","showHuntingBuffs"]].forEach(oc)}function ac(e){o[e]=d(e)}function ic(){["enabledHuntingMode","hideSubLvlCreature","showTitanInfo","showBuffInfo","showMonsterLog","showCreatureInfo"].forEach(ac)}function lc(){nc(),ic()}function sc(){rc(),lc()}function Jo(){Yo(),sc();let e=jo();Xo(),Qo(e),xi()}function wi(e){$(`#actionList li.creature-${e.toString()} a.create-group`).hide()}function fc(e){$.subscribe(ie,s(wi,e))}var uc=["hideChampionsGroup","hideElitesGroup","hideSEGroup","hideTitanGroup","hideLegendaryGroup"];function mc(e,t){d(e)&&(fc(t+1),wi(t+1))}function cc(){uc.forEach(mc)}function dc(){a(document.body,Vn(`#actionList .creature-1 {color: green;}
#actionList .creature-2 {color: yellow;}
#actionList .creature-3 {color: red;}`))}function pc(){d("enableCreatureColoring")&&dc()}function hc(e,t){t==="ACT_REPAIR"&&GameData.fetch(yn+R+Qe+k)}function gc(){$.subscribe(un,hc)}function yc(){$("#messageCenter").worldMessageCenter({offset:"0 60"})}function vc(){be("#mapTooltip")}function xc(e){be(e.target)}function Dc(){w(i("buffList"),xc)}var wc=[Jo,wo,Oo,cc,pc,yr,oo,gc,hr,xo,ko,Qr,yc,vc,ur,ma,Dc,ro,dr];function Ec(){Pn(wc),o.userIsDev&&(Dr(),xr())}export{Ec as default};
//# sourceMappingURL=newMap-72RLJFEA.js.map
