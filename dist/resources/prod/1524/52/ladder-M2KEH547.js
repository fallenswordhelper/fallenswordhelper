import{a as Q}from"./chunk-UXV2NLWD.js";import{a as G}from"./chunk-IOU44YWS.js";import"./chunk-YABOFWFI.js";import{B as y,C as F,D as J,E as K,a as s,b as U,c as Y,d as v,e as u,f as m,h as p,j as z,k as I,l as A,n as g}from"./chunk-2G2XWC65.js";import{a as S}from"./chunk-ZMUSZ47M.js";import{a as b}from"./chunk-GSZMCZFV.js";import{a as x}from"./chunk-QBOLKUGJ.js";import"./chunk-GEYLGSBT.js";import"./chunk-XTK4EVWH.js";import{a as N}from"./chunk-3J2YA6B7.js";import{a as L}from"./chunk-KCQPJD5H.js";import{a as H}from"./chunk-ML7SUXNI.js";import{a as w}from"./chunk-XY4KZRCS.js";import{a as f}from"./chunk-5IIHJLHJ.js";import"./chunk-5M4Z4TNO.js";import"./chunk-7VZZ35FX.js";import"./chunk-EWDLMFWA.js";import{a as B}from"./chunk-H7LEI34Q.js";import{a as W}from"./chunk-MZ7GLTZN.js";import"./chunk-NR4PY7IS.js";import"./chunk-WKK2D5SI.js";import"./chunk-CVQ7E5PW.js";import{a as M}from"./chunk-KN5ZC5BT.js";import"./chunk-NDCVQHVH.js";import{a as E}from"./chunk-3Q2VMWIC.js";import"./chunk-ZOSMVBRJ.js";import"./chunk-ZJNDZYVS.js";import"./chunk-OUMBZBCQ.js";import{b as d}from"./chunk-I7LLJIV6.js";import"./chunk-6SHDCONG.js";import"./chunk-BWOLSDKS.js";import{ra as T}from"./chunk-RLOFFV7B.js";import"./chunk-XYKKLBWK.js";import"./chunk-BOMGPUDJ.js";function te(e){return{c:s,m:s,p:s,d:s}}function ne(e){let t=x(e[0]),n,r=t&&X(e);return{c(){r&&r.c(),n=I()},m(o,i){r&&r.m(o,i),u(o,n,i)},p(o,i){i&1&&(t=x(o[0])),t?r?r.p(o,i):(r=X(o),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},d(o){r&&r.d(o),o&&m(n)}}}function X(e){let t,n,r,o,i,a={ctx:e,current:null,token:null,hasCatch:!1,pending:ie,then:oe,catch:re};return y(i=e[1],a),{c(){t=p("tr"),n=p("td"),n.innerHTML='<span data-tooltip="Ticking this box opts you in to the PVP Ladder, unticking it will remove you from the PVP Ladder." class="svelte-1quw1g">PvP Ladder Opt-in:</span>',r=z(),o=p("td"),a.block.c(),g(n,"class","svelte-1quw1g"),g(o,"class","svelte-1quw1g")},m(l,c){u(l,t,c),v(t,n),v(t,r),v(t,o),a.block.m(o,a.anchor=null),a.mount=()=>o,a.anchor=null},p(l,c){e=l,a.ctx=e,c&2&&i!==(i=e[1])&&y(i,a)||F(a,e,c)},d(l){l&&m(t),a.block.d(),a.token=null,a=null}}}function re(e){return{c:s,m:s,p:s,d:s}}function oe(e){let t,n,r;return{c(){t=p("input"),g(t,"type","checkbox")},m(o,i){u(o,t,i),t.checked=e[0],n||(r=[A(t,"change",e[6]),A(t,"click",e[3])],n=!0)},p(o,i){i&1&&(t.checked=o[0])},d(o){o&&m(t),n=!1,U(r)}}}function ie(e){let t;return{c(){t=p("div"),t.innerHTML='<span class="fshSpinner fshSpinner12 svelte-1quw1g"></span>',g(t,"class","svelte-1quw1g")},m(n,r){u(n,t,r)},p:s,d(n){n&&m(t)}}}function se(e){return{c:s,m:s,p:s,d:s}}function ae(e){let t,n,r={ctx:e,current:null,token:null,hasCatch:!1,pending:se,then:ne,catch:te,value:7};return y(n=e[2](),r),{c(){t=I(),r.block.c()},m(o,i){u(o,t,i),r.block.m(o,r.anchor=i),r.mount=()=>t.parentNode,r.anchor=t},p(o,[i]){e=o,F(r,e,i)},i:s,o:s,d(o){o&&m(t),r.block.d(o),r.token=null,r=null}}}function le(e,t,n){let{isOnLadder:r}=t,{toggleLadder:o}=t,i;async function a(){n(0,i=await r())}let l;function c(){n(0,i=!i),n(1,l=o(i)),E("ladder","opt in/out")}function ee(){i=this.checked,n(0,i)}return e.$$set=k=>{"isOnLadder"in k&&n(4,r=k.isOnLadder),"toggleLadder"in k&&n(5,o=k.toggleLadder)},[i,l,a,c,r,o,ee]}var Z=class extends K{constructor(t){super();J(this,t,le,ae,Y,{isOnLadder:4,toggleLadder:5})}},$=Z;function _(e){return B(W({cmd:"settings"},e))}function C(e){return _({subcmd:"flags",flags:e.map(t=>t?1:0)})}var ce=["ui_preference_11","ui_preference_15","disable_wordcensor","ui_preference_30","ui_preference_21","ui_preference_33","ui_preference_23"];function ue(e,t){let n=new FormData(e);return n.append("pvp_ladder",t),Object.fromEntries(n.entries())}function me(e,t){let n=new FormData(e);return ce.forEach((r,o)=>n.set(r,t[o+1])),Object.fromEntries(n.entries())}async function R(e){let t=await f({cmd:"settings"}),n=w(t),r=ue(n.forms[0],e[0]),o=me(n.forms[2],e);return await Promise.all([r,o].map(i=>f(i))),{s:!0}}function D(e){return L(C,R,e)}var pe=[{name:"ca_default",id:54},{name:"sc_default",id:101},{name:"nv_default",id:60},{name:"barricade_default",id:98}];function de(e){let t=e.getAll("blockedSkillList[]").map(n=>({id:parseInt(n,10),blocked:!0,level:0}));return pe.forEach(n=>{let r=t.findIndex(o=>o.id===t.id);r===-1?t.push({id:parseInt(n.id,10),blocked:!1,level:e.get(n.name)}):t[r].level=e.get(n.name)}),t}function fe(e){return[...e.entries()].filter(n=>n[0].startsWith("discardPref")).map(n=>({id:parseInt(n[0][n[0].length-1],10),action:parseInt(n[1],10)}))}function ge(e){return[e[0].get("pvp_ladder")==="1",e[2].get("ui_preference_11")==="1",e[2].get("ui_preference_15")==="1",e[2].get("disable_wordcensor")==="1",e[2].get("ui_preference_30")==="1",e[2].get("ui_preference_21")==="1",e[2].get("ui_preference_33")==="1",e[2].get("ui_preference_23")==="1"]}function _e(e){return{s:!0,r:{skills:de(e[4]),item_drop_rarity:fe(e[1]),flags:ge(e),min_group_join_level:parseInt(e[0].get("min_group_level"),10),item_drop_discard_level:parseInt(e[1].get("auto_discard_level"),10),player_block_type:parseInt(e[2].get("block_level"),10)}}}async function O(){let e=await f({cmd:"settings"});if(!e)return{s:!1,e:{message:"Could not connect to FS servers",code:1}};let n=[...w(e).forms].map(r=>new FormData(r));return _e(n)}function P(){return _({subcmd:"view"})}function V(){return L(P,O)}var h;async function he(){return h=(await V()).r?.flags,h?.[0]}async function ke(e){if(H(h))return h[0]=e,D(h)}function be(e){return new $({props:{toggleLadder:ke,isOnLadder:he},target:e})}function q(){if(d("optInOnLadderPage")){let e=b("#pCC table tbody");be(e)}}function we(e){let t=Math.floor((S-e)/6e4),n=Math.floor(t/60);return t%=60,`${Q(n," hours, ")+t} mins`}function Le(){let e=d(T);return e<S-48*60*60*1e3?'<span class="fshLink tip-static" data-tipped="FSH has not seen the last ladder reset.<br>You can find it in your log if you qualified<br>or Tavern Rumours.">???</span>':we(e)}function ve(e){let t=e.insertCell(-1);t.height=25,N("Last Reset:",t)}function ye(e){let t=e.insertCell(-1);t.align="right",M(Le(),t)}function xe(){let e=b("#pCC table");if(!e)return;let t=e.insertRow(-1);ve(t),ye(t)}function j(){d("trackLadderReset")&&xe()}function Se(){G(),j(),q()}export{Se as default};
//# sourceMappingURL=ladder-M2KEH547.js.map
