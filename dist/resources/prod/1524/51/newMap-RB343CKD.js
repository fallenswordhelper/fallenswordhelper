import{a as oa,b as na}from"./chunk-UXKBB4K5.js";import{a as aa}from"./chunk-42FNNMVQ.js";import"./chunk-SJXC75LV.js";import{a as ea}from"./chunk-INGZUBGK.js";import{a as mt}from"./chunk-HS6E5DNX.js";import{a as ta,b as ra}from"./chunk-K3QIZWIO.js";import{a as Yn,b as Jn}from"./chunk-N5SMIC6D.js";import{a as Zn}from"./chunk-RDSWNSJU.js";import{a as Xn}from"./chunk-5MTOGYKL.js";import{b as zn}from"./chunk-5Q55R5KV.js";import{a as Qn}from"./chunk-FLYB2WHA.js";import"./chunk-4MY6H7X5.js";import{a as ut}from"./chunk-S32GZNLH.js";import{a as qn}from"./chunk-I6LPG6MF.js";import{a as _n}from"./chunk-ACP5V6R7.js";import"./chunk-RIBB3TW7.js";import{a as Pt}from"./chunk-ZXPHHW3A.js";import"./chunk-FIJTOABK.js";import{a as Kn}from"./chunk-N4EMINS2.js";import{a as Ft}from"./chunk-4V44BINA.js";import{a as c}from"./chunk-B5ZQ56HE.js";import{a as Rn}from"./chunk-XP6TKRLY.js";import"./chunk-QNPSGVM3.js";import{a as st}from"./chunk-KC3JUT6W.js";import{a as Fn}from"./chunk-YW6SRUBN.js";import{a as ft}from"./chunk-NHXMBUTR.js";import{a as On}from"./chunk-EMRQXJIT.js";import{a as Rt}from"./chunk-4SHO4X2Z.js";import"./chunk-D7QZUQTE.js";import{a as Wn,b as Un,c as jn}from"./chunk-5D7XS6WC.js";import"./chunk-F3D3J6RM.js";import"./chunk-45LL44ZG.js";import{a as Tn}from"./chunk-BJG2K66W.js";import"./chunk-LLWNE4EE.js";import{a as le,b as et}from"./chunk-EVJ3735L.js";import{a as H}from"./chunk-BXDTTZDJ.js";import{a as Mn}from"./chunk-BW5PH5NQ.js";import{a as at}from"./chunk-NIOXVTNG.js";import"./chunk-YIGSER4T.js";import{a as O}from"./chunk-OJFIHZIB.js";import{a as ot,b as nt}from"./chunk-BF7TG5EL.js";import{a as Vn}from"./chunk-33B54EL4.js";import"./chunk-KWIXRSMY.js";import{f as J}from"./chunk-ORMKR3OV.js";import"./chunk-FS3TKOQM.js";import{a as $n}from"./chunk-CPUCL5KC.js";import{a as In}from"./chunk-PQ3EMI2B.js";import{a as m}from"./chunk-X5ZSXFJV.js";import{a as K}from"./chunk-633OEY6F.js";import{a as it}from"./chunk-MF5UI2DL.js";import{a as Nn}from"./chunk-E7MKAKV7.js";import"./chunk-V3H5BBPU.js";import"./chunk-OFZ4M2H7.js";import{a as Cn}from"./chunk-ULKY3I7L.js";import{a as kn}from"./chunk-TVG77EME.js";import{a as Xe,b as It}from"./chunk-6MUFX5NS.js";import{a as fe}from"./chunk-WDK5KJW5.js";import{a as _}from"./chunk-VYP6BYDA.js";import{a as Ln}from"./chunk-RGN4RGGV.js";import{a as F}from"./chunk-6VZYKCGK.js";import{a as h}from"./chunk-D6BL5IS3.js";import"./chunk-NIO7Y7L5.js";import{a as Hn}from"./chunk-2XZ4ALI2.js";import{a as rt}from"./chunk-LVNLH6ER.js";import{a as tt}from"./chunk-ZZS3NLOT.js";import"./chunk-57PZ6XJI.js";import{a as Le}from"./chunk-KF3ZZECL.js";import{a as X}from"./chunk-AN443625.js";import"./chunk-UICWONBW.js";import{a as Y}from"./chunk-ZLI5KJBW.js";import"./chunk-EUBCJC2U.js";import{a as Bn}from"./chunk-UWAT3VA7.js";import"./chunk-7GAPHNBH.js";import{a as l}from"./chunk-GVLE3LCU.js";import"./chunk-YYZHVDZH.js";import"./chunk-VI3RZM5G.js";import{a as ue}from"./chunk-WV4YXE4F.js";import{a as En}from"./chunk-6HK7Y3PF.js";import{a as R}from"./chunk-22YAZV3W.js";import"./chunk-WBUJCSKW.js";import{a as Ue}from"./chunk-ND3XCMOS.js";import{a as b}from"./chunk-74YALW75.js";import{a as S}from"./chunk-WPRJK6Q2.js";import{a as M}from"./chunk-PJ32ASZ7.js";import"./chunk-F5QOVYT2.js";import{a as Ae}from"./chunk-CT4SVZHO.js";import{a}from"./chunk-R5ZZQ5HH.js";import{a as f}from"./chunk-XQ3ZEJ26.js";import"./chunk-PO34EML4.js";import"./chunk-QFSH2B2J.js";import"./chunk-2PFHY365.js";import{a as Pn}from"./chunk-ZDFDMUO4.js";import{a as lt}from"./chunk-2V5OQ7JE.js";import{a as Gn}from"./chunk-GGKSIQST.js";import"./chunk-JSWEJZHY.js";import{a as bn}from"./chunk-JZLUF437.js";import{a as v}from"./chunk-4OJTKSB2.js";import{a as w}from"./chunk-G3O526VI.js";import{a as T}from"./chunk-GHQYBWLT.js";import{a as se}from"./chunk-N2KVYLIG.js";import"./chunk-PKDG64MH.js";import{a as i}from"./chunk-2B42SRXB.js";import"./chunk-3IGXKFMQ.js";import{a as Ze}from"./chunk-GLHEJYH7.js";import{a as An}from"./chunk-EPYDL6MF.js";import{a as Je}from"./chunk-TDNJGM62.js";import{a as Sn}from"./chunk-TP7JP7VV.js";import{b as d}from"./chunk-HAINOYE5.js";import{a as o}from"./chunk-AN5TC666.js";import{a as Jo}from"./chunk-B7PLPUHK.js";import{$ as sn,Aa as xn,Ba as Dn,Ca as wn,I as en,L as tn,N as rn,V as on,W as ie,X as ze,Y as nn,Z as an,_ as ln,aa as fn,ba as un,c as je,ca as mn,da as cn,ea as Qe,fa as dn,ga as pn,ha as hn,i as ae,ja as gn,ka as P,la as Ye,ma as k,n as $t,v as Zo,ya as yn,za as vn}from"./chunk-YNXRNCRL.js";import{b as ne}from"./chunk-7DPOBF7C.js";import{a as s}from"./chunk-DEDCEYVR.js";var Z;function xi(e){return e}function Di(e){return o.showBuffInfo&&e.some(xi)}function wi(){if(Z)c(Z,!1);else{Z=f({className:"fshActionBox",innerHTML:"<div></div><div></div><div></div><div></div><div></div><div></div>"});let e=i("actionContainer");qn(Z,e.children[2])}return Z}function Ei(){Z&&c(Z,!0)}function Ot(e){if(Di(e))return wi();Ei()}var V,_t;function Ci(e){V=e.children[3],V.className="fshBlue",l("CA ",V),_t=m(),a(V,_t),H(V," active")}function ki(e,t){V?c(V,!1):Ci(e),l(t.level,_t)}function Bi(){V&&c(V,!0)}function Kt(e,t){t?ki(e,t):Bi()}var N,qt;function Si(e){N=e.children[4],N.className="fshRed",l("Doubler ",N),qt=m(),a(N,qt),H(N," active")}function Ai(e,t){N?c(N,!1):Si(e),l(t.level,qt)}function Li(){N&&c(N,!0)}function Wt(e,t){t?Ai(e,t):Li()}var q,Ut;function bi(e){q=e.children[2],l("Damage bonus: ",q),Ut=m(),a(q,Ut),H(q,"%")}function Ti(e,t){if(e){let r=Math.min(Math.round(Math.floor(t/5)*Number(e.level))*.01,20);return le(r,2).toString()}return"0"}function Hi(e,t,r){q?c(q,!1):bi(e),l(Ti(t,Number(r)),Ut)}function Mi(){q&&c(q,!0)}function jt(e,t,r){t?Hi(e,t,r):Mi()}function u(e,t){l(O(e),t)}var ee,zt;function Vi(e){ee=e.children[1],l("Kill Streak: ",ee),zt=m(),a(ee,zt)}function Ni(e,t){ee?c(ee,!1):Vi(e),u(t,zt)}function Gi(){ee&&c(ee,!0)}function Qt(e,t,r,n){t||r?Ni(e,n):Gi()}function $i(e,t){return t.name===e}function W(e){let{buffs:t}=GameData.player();if(t)return t.find(s($i,e))}function Yt(){let e=GameData.player().teleportCooldown;return e>1&&e}var Ii=["red","orange","yellow"];function Xt(){let e=$("#actionlist-shield-imp");e.length===1&&e.css("background-color",Ii[e.text()]||"#ad8043")}var A,Jt;function Ri(e){na(e)&&GameData.fetch(P)}function Pi(){W("Summon Shield Imp")||oa([F()],[55]).then(Ri)}function Fi(e){return e?Number(e.stack):0}var Oi=["imp-0","imp-1","imp-1"];function _i(e){return Oi[e]||"fshGreen"}function Ki(e){A=e.children[0],l("Shield Imps Remaining: ",A),Jt=m(),a(A,Jt),Y(A,"&nbsp;");let t=m({className:"xSmallLink",textContent:"Recast"});a(A,t),w(t,Pi)}function qi(e,t){A?c(A,!1):Ki(e);let r=Fi(t);A.className=_i(r),l(r,Jt)}function Wi(){A&&c(A,!0)}function Zt(e,t,r){t||r?qi(e,t):Wi()}function Ui(e){return e.type===0}function er(){let{dynamic:e}=GameData.realm();return b(e)&&e.some(Ui)}function g(e){return m({textContent:e})}var te,ct,ia;function ji(e,t){te=e.children[5],l("Teleport Cooldown: ",te),ct=g(t.toString()),a(te,ct)}function zi(e,t){te?c(te,!1):ji(e,t)}function Qi(){te&&c(te,!0)}function la(){let e=Math.max(Math.ceil((ia-Date.now())/1e3),0);l(e,ct),e>0&&setTimeout(la,500)}function sa(e){ct&&(ia=Date.now()+e*1e3,la())}function fa(e,t){t?zi(e,t):Qi()}var be,tr,rr,or,nr,ar,ir;function Yi(){be=W("Death Dealer"),tr=W("Doubler"),rr=W("Counter Attack"),or=W("Summon Shield Imp"),nr=Yt(),ar=er(),ir=GameData.player().killStreak}function lr(){Xt(),Yi();let e=Ot([be,tr,rr,or,nr,ar]);e&&(Zt(e,or,be),Qt(e,be,ar,ir),jt(e,be,ir),Kt(e,rr),Wt(e,tr),fa(e,nr))}function Xi(e,t){sa(t.player.teleportCooldown)}function ua(){lr(),$.subscribe(`${ze} ${nn}`,lr),$.subscribe(hn,Xi)}function ma(){o.showBuffInfo=!o.showBuffInfo,h("showBuffInfo",o.showBuffInfo),lr()}var Ji=["NORMAL","CHAMPION","ELITE","SUPER ELITE","TITAN","LEGENDARY"],dt=!1;function sr(e){return _(".verb.attack",e)}function fr(e){let t=Ji.indexOf(e.toUpperCase());return Ze(`#actionList .actionListItem.creature.creature-${t}`)}function ca(e){let t=["LEGENDARY","NORMAL"].flatMap(fr),r=fr("CHAMPION"),[n,x]=e?[t,r]:[r,t],y=`url("${ne}ui/world/icon_action_attack_`;n.map(sr).filter(D=>D!==null).forEach(D=>{D.classList.remove("attack-1","attack-2","attack-3","attack-4","attack-5","attack-6","attack-7","attack-8"),D.style.backgroundImage=""}),x.slice(0,8).map(sr).forEach((D,We)=>{D!==null&&(D.classList.add(`attack-${We+1}`),D.style.backgroundImage=`${y}${We+1}.png")`)})}function Zi(e){if(!e.ctrlKey||!e.shiftKey||e.target.tagName==="INPUT"||e.target.tagName==="TEXTAREA"||(dt||ca(!0),dt=!0,!e.code.match(/(Digit|Numpad)[1-8]/)))return;let t=fr("CHAMPION"),r=parseInt(e.code.slice(-1),10)-1;if(r<t.length){let n=sr(t[r]);n!==null&&(se("world","ChampionAttack"),n.click())}}function el(e){dt&&(!e.ctrlKey||!e.shiftKey)&&(dt=!1,ca(!1))}function ur(){let e=Bn("body")[0];T(e,"keydown",Zi),T(e,"keyup",el)}var tl=["Breaker","Protection","Master Thief","Protect Gold","Disarm","Duelist","Thievery","Master Blacksmith","Master Crafter","Fury Caster","Master Inventor","Sustain"],mr=[],C;function rl(e){(e.id===54||e.id===26)&&(C.player.buffs[e.id]=parseInt(e.level,10))}function ol(e){tl.indexOf(e.name)===-1&&(C.player.enhancements[e.name]=e.value)}function nl(e){e.player.buffs&&e.player.buffs.forEach(rl)}function al(e){e.player.enhancements&&e.player.enhancements.forEach(ol)}function il(e,t){C={},C.combat=t.response.data,C.combat.inventory_id&&(C.combat.drop=C.combat.item.id),C.player={},C.player.buffs={},C.player.enhancements={},nl(t),al(t),C.time=t.time,mr.push(C),nt("fsh_combatLog",mr)}function ll(e,t){t.response.response===0&&il(e,t)}function sl(e){e&&(mr=e),$.subscribe(Qe,ll)}function cr(){d("keepLogs")&&ot("fsh_combatLog").then(sl)}function re(e){return o.doNotKillList.includes(e.trim())}function fl(e){e.classList.toggle("fshBlue",re(Sn(e)))}function me(){let e=i("actionList");ft("creature",e).forEach(fl)}function ul(e,t){if(re(e))return i("actionList").children[t].children[0].children[1].classList.remove("loading"),!0}function ml(e){let t=GameData.actions()[e];if(t)return ul(t.data.name,e)}function cl(e){return function(r,n,x,y){ml(x.passback)||e(r,n,x,y)}}var dl={2:cl};function pl(e){return Jo(e)||e===0}function hl(e){return e&&Ue(e)}function gl(e){return function(r,n,x,y){let D=dl[r];hl(D)&&pl(y)?D(e)(r,n,x,y):e(r,n,x,y)}}function dr(){let e=GameData.doAction;GameData.doAction=gl(e)}function pr(){$.subscribe(ie,me),me(),dr()}function hr(e){return Pn({cmd:"toprated",subcmd:e})}async function yl(e){let r=(await hr("globalquest")).r.list,n='<table id="world-event-contrib-table" style="width: 270px;"><tr><td class="header"></td><td class="header"></td><td class="header">Username</td><td class="header">Kills</td></tr>',x=r.length;for(let y=0;y<x;y++)n+=`<tr style="border-top:1px solid #CD9E4B;"><td>${y+1}</td><td><a href="${en}${r[y].guild.id}"><img src="${ne}guilds/${r[y].guild.id}_mini.png" width="16" height="16"></a></td><td><a href="${rn}${r[y].player.name}">${r[y].player.name}</a></td><td>${r[y].value}</td></tr>`;n+="</table>",v(n,e)}function vl(){let e=i("world-event-contrib");v("Loading...",e),yl(e),$(e).dialog({title:"Top 100 Event Contributers",minWidth:300,height:300,zIndex:9999})}function gr(){let e=$("#world-event-badge");!e.length||(e.off(),w(e[0],vl))}function xl(e){return e.response&&e.response.msg&&e.response.msg.startsWith("Creature did not exist at that location")}function Dl(e){xl(e)&&GameData.fetch(Ye+k)}function wl(e){e.remove()}function El(e,t){Dl(t),Ze(".creature-4 > .quickCombat > .verbs").forEach(wl)}function yr(){$.subscribe(Qe,El)}function Cl(){return window.GameController&&GameController.Realm&&!GameController.Realm.footprintTileList}function vr(){Cl()&&(GameController.Realm.footprintTileList=[])}function da(e,t,r){return Hn({className:`fshCurveEle fshCurveLbl fshPoint tip-static ${e}`,dataset:{tipped:t},htmlFor:r})}function pt(e){let t=f({className:"fshToggle"}),r=tt({checked:e.prefVal,id:e.checkId,type:"checkbox"});a(t,r);let n=da(e.onClass,e.onTip,e.checkId);a(t,n);let x=da(e.offClass,e.offTip,e.checkId);return a(t,x),a(e.worldName,t),r}var U,ht,gt,pa,ha,ga,ya,va,xa;function kl(e){Le(e),GameData.doAction(12,401,{},0)}function Bl(){Nn(F())}function Sl(){window.open(`${tn+$t}map`,"fsMap")}function Al(){let e=GameData.realm();window.open(`${on}realms${$t}view&realm_id=${e.id}`,"mapUfsg")}function Ll(){h("playNewMessageSound",!d("playNewMessageSound"))}function bl(){o.huntingMode=!o.huntingMode,h("huntingMode",o.huntingMode)}function Tl(){return f({className:"fshCurveContainer",id:"fshWorldButtonContainer"})}function Da(e){return e?e.toString():"?"}function Hl(){let e=f({textContent:"Min Lvl: "});return ht=g(Da(GameData.realm().minlevel)),a(e,ht),e}function Ml(){let e=f({textContent:"Your Lvl: "});return gt=g(Da(GameData.player().level)),a(e,gt),e}function Vl(e){let t=f({className:"fshFsty"});a(t,Hl()),a(t,Ml()),a(e,t)}function yt(e,t,r){let n=K({className:`fshCurveEle fshCurveBtn fshPoint tip-static ${e}`,dataset:{tipped:t}});return a(r,n),n}function Nl(e){Vl(e),pa=yt("fshFormGroup","Quick Create Attack Group",e),ha=yt("fshQuickBuff","Open Quick Buff Popup",e),ga=yt("fshRealmMap","Open Realm Map",e),ya=yt("fshTempleOne","Search map in Ultimate FSG",e)}function Gl(e){if(d("showSpeakerOnWorld")){let t=d("playNewMessageSound");va=pt({prefVal:t,checkId:"fshSoundCheck",onClass:"soundOn",onTip:"Turn Off Sound when you have a new log message",offClass:"soundOff",offTip:"Turn On Sound when you have a new log message",worldName:e})}}function $l(e){let t=o.huntingMode;xa=pt({prefVal:t,checkId:"fshHuntCheck",onClass:"huntOn",onTip:"Hunting mode is ON",offClass:"huntOff",offTip:"Hunting mode is OFF",worldName:e})}function Il(){Nl(U),Gl(U),$l(U)}var Rl=[[e=>e===va,Ll],[e=>e===xa,bl]],Pl=[[e=>e===pa,kl],[e=>e===ha,Bl],[e=>e===ga,Sl],[e=>e===ya,Al]];function Fl(){w(U,Pt(Pl)),T(U,"change",Pt(Rl))}function Ol(){U||(U=Tl(),Il(),Fl(),rt(U,i("worldCoord")))}function _l(e,t){ht&&t.b.minlevel&&(vr(),l(t.b.minlevel,ht))}function Kl(e,t){gt&&l(t.b,gt)}function xr(){Ol(),$.subscribe(un,_l),$.subscribe(an,Kl)}function G(e){return!e||!e.response||!e.response.data}var wa='<table class="relicT relicS"><thead><tr><th colspan="2">Adjusted defense values</th></tr></thead><tbody><tr><td>DC225:</td><td id="DC225">0</td></tr><tr><td>DC175:</td><td id="DC175">0</td></tr><tr><td colspan="2">&nbsp;</td></tr></tbody><thead><tr><th colspan="2">Attacking Group Stats</th></tr></thead><tbody><tr><td>Raw Group Attack:</td><td class="fshGrey" id="GroupAttack"></td></tr><tr><td>Group Attack w/ buffs:</td><td id="GroupAttackBuffed"></td></tr><tr><td>Raw Group Defense:</td><td class="fshGrey" id="GroupDefense"></td></tr><tr><td>Group Defense w/ buffs:</td><td id="GroupDefenseBuffed"></td></tr><tr><td>Raw Group Armor:</td><td class="fshGrey" id="GroupArmor"></td></tr><tr><td>Group Armor w/ buffs:</td><td id="GroupArmorBuffed"></td></tr><tr><td>Raw Group Damage:</td><td class="fshGrey" id="GroupDamage"></td></tr><tr><td>Group Damage w/ buffs:</td><td id="GroupDamageBuffed"></td></tr><tr><td>Raw Group HP:</td><td class="fshGrey" id="GroupHP"></td></tr><tr><td>Group HP w/ buffs:</td><td id="GroupHPBuffed"></td></tr></tbody></table>',Ea='<table class="relicT relicS"><thead><tr><th colspan="2">Defending Guild Stats</th></tr></thead><tbody><tr><td>Relic Count:</td><td id="relicCount">0</td></tr><tr><td>Lead Defender Bonus:</td><td id="LDPercentage">0</td></tr><tr><td>Lead Defender Cloaked:</td><td id="LDCloaked">No</td></tr></tbody><thead><tr><th colspan="2">Other Defender Stats</th></tr></thead><tbody><tr><td>Raw Attack:</td><td class="fshGrey" id="attackValue">0</td></tr><tr><td>Attack w/ buffs:</td><td id="attackValueBuffed">0</td></tr><tr><td>Raw Defense:</td><td class="fshGrey" id="defenseValue">0</td></tr><tr><td>Defense w/buffs:</td><td id="defenseValueBuffed">0</td></tr><tr><td>Raw Armor:</td><td class="fshGrey" id="armorValue">0</td></tr><tr><td>Armor w/ buffs:</td><td id="armorValueBuffed">0</td></tr><tr><td>Raw Damage:</td><td class="fshGrey" id="damageValue">0</td></tr><tr><td>Damage w/ buffs:</td><td id="damageValueBuffed">0</td></tr><tr><td>Raw HP:</td><td class="fshGrey" id="hpValue">0</td></tr><tr><td>HP w/ buffs:</td><td id="hpValueBuffed">0</td></tr><tr><td>Cloaked:</td><td id="defendersCloaked">0</td></tr><tr><td>Processed:</td><td id="defendersProcessed">0</td></tr></tbody></table>',Ca='<table class="relicT"><thead><tr><th colspan="2">Processing</th></tr></thead><tbody><tr><td class="fshGreen" colspan="2" id="ProcessingStatus">Parsing defending guild stats ...</td></tr></tbody><thead><tr><th colspan="2">Assumptions</th></tr></thead><tbody><tr><td colspan="2" class="fshGrey">Above calculations include Constitution, Fortitude, Nightmare Visage, Chi Strike, Sanctuary, Terrorize and Flinch bonus calculations (in that order) on both the defending group and attacking group.</td></tr></tbody></table>';var I,ce,de,pe;function ql(e){return e.player_name}function Wl(e){pe=e.defenders.map(ql)}function Ul(){I?v("",I):I=f({className:"body"})}function jl(e){ce=f({className:"fshFloatLeft fshRelicLeftDiv"}),a(I,ce),e.is_owner&&a(ce,Yn(pe)),de=K({className:"custombutton",textContent:"Fetch Stats"}),a(ce,de)}function ka(e){Wl(e),Ul(),jl(e);let t=i("dialog-relic");a(t,I)}var L,Ba,Sa,Dr,wr,Er,Cr,vt,kr,Br,Sr,Ar,Lr,br,Tr,Hr,Mr,Vr,Nr,Gr,$r,Ir,Rr,Pr,Fr,Or,_r,Kr,qr,Wr,j,zl=[e=>e!=="lastUpdate",e=>!pe.includes(e),e=>L[e].last_login,e=>Number(L[e].last_login)<Ba,e=>Number(L[e].last_login)>Sa,e=>L[e].level<400||L[e].level>421,e=>L[e].level<441||L[e].level>450];function Ql(e,t){return t(e)}function Yl(e){return zl.every(s(Ql,e))}function Xl(e){return`<a href="${Zo}${L[e].id}">${e}</a>`}function Jl(e){L=e,Ba=It-120,Sa=It-604800;let t=bn(L).filter(Yl).map(Xl);Y(I,`<div class="fshFloatLeft fshRelicLowDiv"><table class="relicT"><thead><tr><th>${t.length.toString()} Offline guild members not at relic:</th></tr></thead><tbody><tr><td>${t.join(" ")}</td></tr></tbody></table></div>`)}function Zl(){Dr=i("relicCount"),wr=i("LDPercentage"),Er=i("LDCloaked"),Cr=i("attackValue"),vt=i("attackValueBuffed"),kr=i("defenseValue"),Br=i("defenseValueBuffed"),Sr=i("armorValue"),Ar=i("armorValueBuffed"),Lr=i("damageValue"),br=i("damageValueBuffed"),Tr=i("hpValue"),Hr=i("hpValueBuffed"),Mr=i("defendersCloaked"),Vr=i("defendersProcessed")}function es(){Nr=i("DC225"),Gr=i("DC175"),$r=i("GroupAttack"),Ir=i("GroupAttackBuffed"),Rr=i("GroupDefense"),Pr=i("GroupDefenseBuffed"),Fr=i("GroupArmor"),Or=i("GroupArmorBuffed"),_r=i("GroupDamage"),Kr=i("GroupDamageBuffed"),qr=i("GroupHP"),Wr=i("GroupHPBuffed")}function Aa(e){it(de);let t=d("hideRelicOffline");e.is_owner&&!t&&Qn(!0).then(Jl),Y(ce,Ca),j=i("ProcessingStatus");let r=f({className:"fshFloatLeft fshRelicMidDiv",innerHTML:Ea});a(I,r),Zl();let n=f({className:"fshFloatLeft fshRelicRightDiv",innerHTML:wa});a(I,n),es()}var xt;function ts(e){return e===1?1.5:le(1-e/10,2)}function La(e){let t=S(e),n=An('#pCC img[src*="/relics/"]',t).length;l(n,Dr),xt=ts(n),l(`${String(xt*100)}%`,wr)}function Dt(e,t){return e>t*10||e<t?e:t*10}function rs(e){e.attackValue=Dt(e.attackBonus,e.levelValue),e.defenseValue=Dt(e.defenseBonus,e.levelValue),e.armorValue=Dt(e.armorBonus,e.levelValue),e.damageValue=Dt(e.damageBonus,e.levelValue),e.hpValue=e.hpBonus}var os=[["levelValue","level"],["attackValue","attack"],["attackBonus","bonus_attack"],["defenseValue","defense"],["defenseBonus","bonus_defense"],["armorValue","armor"],["armorBonus","bonus_armor"],["damageValue","damage"],["damageBonus","bonus_damage"],["hpValue","hp"],["hpBonus","bonus_hp"],["killStreakValue","killstreak"]];function ns(e,t,r){e[r[0]]=Number(t[r[1]])}function as(e,t){os.forEach(s(ns,e,t))}var is=[["counterAttackLevel","Counter Attack"],["doublerLevel","Doubler"],["deathDealerLevel","Death Dealer"],["darkCurseLevel","Dark Curse"],["holyFlameLevel","Holy Flame"],["constitutionLevel","Constitution"],["sanctuaryLevel","Sanctuary"],["flinchLevel","Flinch"],["nightmareVisageLevel","Nightmare Visage"],["superEliteSlayerLevel","Super Elite Slayer"],["fortitudeLevel","Fortitude"],["chiStrikeLevel","Chi Strike"],["terrorizeLevel","Terrorize"],["barricadeLevel","Barricade"],["reignOfTerrorLevel","Reign Of Terror"],["anchoredLevel","Anchored"],["severeConditionLevel","Severe Condition"],["entrenchLevel","Entrench"],["cloakLevel","Cloak"]];function ls(e,t,r){e[r[0]]=t[r[1]]||0}function ss(e,t){is.forEach(s(ls,e,t))}function he(e){if(!e)return;let t=mt(e._skills),r={};return as(r,e),ss(r,t),r.superEliteSlayerMultiplier=le(.002*r.superEliteSlayerLevel,2),Ln(r.armorValue)&&rs(r),r}var ge,wt,Te,ye,He,Et,Me,Ur,jr,E,p,oe;function fs(){p.attack-=oe.attack,p.defense-=oe.defense,p.armor-=oe.armor,p.damage-=oe.damage,p.hp-=oe.hp}function Ve(e){return Math.round(e*xt)}function us(){ge+=Ve(E.attackValue),Te+=Ve(E.defenseValue),ye+=Ve(E.armorValue),He+=Ve(E.damageValue),Me+=Ve(E.hpValue)}function ba(){u(ge,Cr),u(Te,kr),u(ye,Sr),u(He,Lr),u(Me,Tr),l(Ur,Mr),jr+=1,l(jr,Vr)}function ms(){u(p.attack,$r),u(p.defense,Rr),u(p.armor,Fr),u(p.damage,_r),u(p.hp,qr)}function cs(e){return Math.ceil(p.attack*(R(e["Nightmare Visage"],0)*.0025))}function ds(){let e=Math.ceil(p.attack*E.flinchLevel*.001);u(p.attack-e,Ir)}function ps(e){return Math.ceil(p.defense*(1+R(e.Constitution,0)*.001))}function hs(e,t){u(t+e,Pr)}function gs(e){u(p.armor+Math.floor(p.armor*R(e.Sanctuary,0)*.001),Or)}function ys(e,t){return Math.ceil(t*R(e.Fortitude,0)*.001)}function vs(e){u(p.hp+e,Wr)}function xs(e,t){let r=Math.ceil((p.hp+t)*R(e["Chi Strike"],0)*.001),n=Math.ceil(p.damage*E.terrorizeLevel*.001);u(p.damage+r-n,Kr)}function Ds(e){let t=cs(e);p.attack-=t,ds();let r=ps(e);hs(t,r),gs(e);let n=ys(e,r);vs(n),xs(e,n)}function ws(e){let t=Math.ceil(wt*R(e.Flinch,0)*.001);u(wt-t,vt)}function Es(e){let t=Math.ceil(Et*R(e.Terrorize,0)*.001);u(Et-t,br)}function Cs(){l("Processing attacking group stats ... ",j),oe&&fs(),ms();let e=mt(GameData.player().buffs);Ds(e),ws(e),Es(e),l("Done.",j)}function ks(){return Math.ceil(ge*(E.nightmareVisageLevel*.0025))}function Bs(){return Math.ceil(Te*(1+E.constitutionLevel*.001))}function Ss(e){wt=ge-e,u(wt,vt)}function As(e,t){let r=t+e;u(r,Br),u(Math.ceil(r*.55),Nr),u(Math.ceil(r*.65),Gr)}function Ls(){u(ye+Math.floor(ye*E.sanctuaryLevel*.001),Ar)}function bs(e){return Math.ceil(e*E.fortitudeLevel*.001)}function Ts(e){Et=He+Math.ceil(e*E.chiStrikeLevel*.001),u(Et)}function Hs(){E.cloakLevel!==0&&l("Yes",Er)}function Ta(){l("Processing defending guild stats ... ",j),us(),ba();let e=ks();Ss(e);let t=Bs();As(e,t),Ls();let r=Me+bs(t);u(r,Hr),Ts(r),Hs(),GameData.player().hasGroup&&p?Cs():l("Done.",j)}function Ha(e){let t=he(e);ge+=Math.round(t.attackValue*ae),Te+=Math.round(t.defenseValue*ae),ye+=Math.round(t.armorValue*ae),He+=Math.round(t.damageValue*ae),Me+=Math.round(t.hpValue*ae),t.cloakLevel!==0&&(Ur+=1),ba()}function Ma(e){E=he(e)}function Va(e){p=e}function Na(e){oe=e}function Ga(){ge=0,Te=0,ye=0,He=0,Me=0,Ur=0,jr=0}var Ne;function Ms(e){l(e.message,j)}function Vs(e){return e.parentNode.parentNode.previousElementSibling.previousElementSibling.innerHTML.indexOf('"#000099"')!==-1}function Ns(e){let t=e.previousElementSibling.href,r=[Jn(t).then(Va)];return Vs(e)&&r.push(Zn().then(Na)),r}function Gs(e){let t=S(e),r=_('#pCC a[href*="confirmDisband"]',t);if(!r)return;let n=Ns(r);return Fn(n)}function $s(){return M({cmd:"guild",subcmd:"groups"}).then(Gs)}function Is(){return M({cmd:"guild",subcmd:"view",guild_id:Ne.controlled_by.guild_id}).then(La)}function Rs(e,t){return t===0?Ft(e).then(Ma):Ft(e).then(Ha).catch(Ms)}function Ps(){return pe.map(Rs)}function Fs(){let e=[Is()];return GameData.player().hasGroup&&e.push($s()),e=e.concat(Ps()),e}function Os(){Aa(Ne),Ga();let e=Fs();st(e,Ta)}function _s(e,t){G(t)||(Ne=t.response.data,Ne.defenders.length>0&&(ka(Ne),Cn(de,"click",Os)))}function zr(){$.subscribe(dn,_s)}var Qr;function $a(e){$("#statbar-gold").css("background-color",e)}function Ia(){$("#HelperSendTotal").html(O(d("currentGoldSentTotal"))),Number(GameData.player().gold)>Qr?$a("red"):$a("inherit")}function Ks(){return`<dt class="stat-gold-sendTo">Send To:</dt><dd id="HelperSendTo">${d("goldRecipient")}</dd><dt class="stat-gold-sendAmt">Amount:</dt><dd id="HelperSendAmt">${O(Qr)}</dd><dt class="stat-gold-sendTo">Send?</dt><dd><input id="HelperSendGold" value="Send!" class="custombutton" type="submit"><input type="hidden" id="xc" value=""</dd><dt class="stat-gold-sendTotal">Total Sent:</dt><dd id="HelperSendTotal">${O(d("currentGoldSentTotal"))}</dd>`}function qs(){Qr=d("goldAmount"),$("#statbar-gold-tooltip-general").append(Ks()),$("#HelperSendGold").on("click",jn),Ia(),$.subscribe(ln,Ia)}function Yr(){Un(),Wn&&qs()}function Ge(e){return Gn({cache:!1,url:"fetchdata.php",data:lt(e,{fshrnd:zn()}),dataType:"json"})}var Ra=[];function Ws(e){return G(e)||Ra.push(e),e}function Us(e,t){return e===Number(t.response.data.id)}function js(e,t){e(t)}function zs(e){return new Promise(t=>{En(3,js,[t,e])})}function $e(e,t){let r=Ra.find(s(Us,e));return r?zs(r):Ge({a:1,id:e,passback:t}).then(Ws)}var Ct,Xr,Jr,Zr,eo,to;function Ie(e,t){return Vn(fe(t,e))}function Qs(e){Jr=Ie(e,vn),Xr=Ie(e,yn),eo=Ie(e,Dn),Zr=Ie(e,xn),to=Ie(e,wn)}function Pa(){Ct=GameData.player().level,Qs(i("statbar-character-tooltip-stats"))}function Ys(e){return`<table><tr><td><img src="${ne}creatures/${e.image_id}.png" height="200" width="200"></td><td rowspan="2"><table width="400"><tr><td class="header" colspan="4" class="fshCenter">Statistics</td></tr>`}function Xs(e,t){return`<tr><td>Class:&nbsp;</td><td width="40%">${e.creature_class}</td><td>Level:&nbsp;</td><td width="40%">${e.level} (your level:<span class="${t}">${Ct}</span>)</td></tr>`}function Js(e){return`<tr><td>Attack:&nbsp;</td><td width="40%">${e.attack} (your defense:<span class="fshYellow">${Xr}</span>)</td><td>Defense:&nbsp;</td><td width="40%">${e.defense} (your attack:<span class="fshYellow">${Jr}</span>)</td></tr>`}function Zs(e){return`<tr><td>Armor:&nbsp;</td><td width="40%">${e.armor} (your damage:<span class="fshYellow">${Zr}</span>)</td><td>Damage:&nbsp;</td><td width="40%">${e.damage} (your armor:<span class="fshYellow">${eo}</span>)</td></tr>`}function ef(e,t){return`<tr><td>HP:&nbsp;</td><td width="40%">${e.hp} (your HP:<span class="fshYellow">${to}</span>)(1H: <span class="fshRed">${t}</span>)</td><td>Gold:&nbsp;</td><td width="40%">${e.gold}</td></tr>`}var tf='<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Enhancements</td></tr>';function rf(e){return`<tr><td colspan="2">${e.name}:</td><td colspan="2">${e.value}</td></tr>`}function of(e){return e.enhancements.length===0?'<tr><td colspan="4">[no enhancements]</td></tr>':e.enhancements.map(rf).join("")}function nf(e){return`<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Description</td></tr><tr><td colspan="4">${e.description}</td></tr><tr><td colspan="4" height="5"></td></tr></table></td></tr><tr><td class="fshCenter"><b>${e.name}</b></td></tr></table>`}function af(e,t,r){return Ys(e)+Xs(e,r)+Js(e)+Zs(e)+ef(e,t)+tf+of(e)+nf(e)}function lf(e){let t=Math.ceil(e.hp*o.hpVariable+e.armor*o.generalVariable),r="fshYellow";return Pa(),Ct>e.level&&(r="fshRed"),af(e,t,r)}function ro(e){if(!G(e))return lf(e.response.data)}var sf=["verb","view","tip-static"];function ff(e,t){$(e).qtip({overwrite:!0,show:{event:"mouseover",ready:!0},style:{classes:"qtip-tipsy qtip-custom"},position:{my:"center right",at:"center left",effect:!1,viewport:$(window)},content:{text:t},hide:{effect:!1}})}function uf(e){return Je(e.parentNode.children).indexOf(e)}function mf(e,t){let r=ro(t);e.set("content.text",r)}function cf(e,t,r){return $e(GameData.actions()[e].data.id,e).then(s(mf,r)),"Loading..."}function df(e,t){se("NewMap","CreatureInfo");let r=uf(t);e.classList.add("fshTip"),ff(e,s(cf,r))}function pf(e,t){return _n(sf,e)&&!Ae("fshTip",e)&&Ae("creature",t)}function hf(e){if(!o.showCreatureInfo)return;let{target:t}=e,r=t.parentNode.parentNode.parentNode;pf(t,r)&&df(t,r)}function oo(){T(i("actionList"),"mouseover",hf)}function no(){return ut({subcmd:"scouttower"})}function gf(e){let t=e.split(/[: /[]/);return new Date(Number(t[4]),je.indexOf(t[3]),Number(t[2]),Number(t[0]),Number(t[1]))}function yf(e){let t=X(e[1]);return t==="No active cooldown"?0:Math.ceil((gf(t.slice(16))-Xe)/1e3)}function vf(e){let t=e[0].cells[0].children[0];return{base_id:Number(t.src.match(/s\/(\w+)\.p/)[1].slice(0,-32)),name:t.title}}function xf(e){return{cooldown:yf(e),creature:vf(e),kills:Number(X(e[0].cells[3]))}}function Df(e){let t=X(e[0].cells[1]);if(t!=="n/a"){let r=X(e[0].cells[2]).match(/(\d+)\/(\d+)/);return{realm:t,current_hp:Number(r[1]),max_hp:Number(r[2])}}}function wf(e){let t=e[2].cells[0].children;if(t.length===1)return{contributors:$n(t[0].rows,3,0).map(n=>({kills:Number(X(n.cells[1])),player:{name:X(n.cells[0])}}))}}function Ef(e){return{...xf(e),...Df(e),...wf(e)}}function Cf(e){let t=S(e),r=_('table[width="500"]',t);if(!r)return{s:!1};let n=Je(r.rows).filter((y,D,We)=>D!==0&&D<We.length-1&&(D-1)%6<3);return{r:On(3,n).map(Ef),s:!0}}function ao(){return M({cmd:"guild",subcmd:"scouttower"}).then(Cf)}function io(){return ue(no,ao)}function kf(e,t){let r=e.insertCell(-1);return[r.colSpan]=t,t[2]&&(r.className="header"),a(r,t[1]),r}function Bf(e,t){t.forEach(s(kf,e))}function Sf(e,t,r){let n=e.insertRow(-1);return r&&(n.className="fshBlue"),Bf(n,t),n}function Af(e,t){Sf(e,t[0],t[1])}function Re(e,t){t.forEach(s(Af,e))}var lo;function Fa(e){lo=e}var so,fo,uo,mo,co,po,ho,go;function Lf(){so=g("Current"),fo=g("Kills"),uo=g("Member"),mo=g("% of Total")}function bf(){co=g("Status"),po=g("Titan HP"),ho=g("Total"),go=g("Your Guild")}function Oa(){Lf(),bf()}var ve,xe,De,we,Ee,Ce,ke;function _a(){ve=m(),xe=m(),De=m(),we=m(),Ee=m(),Ce=m(),ke=m()}function Ka(){l("",ve),l("",xe),l("",De),l("",we),l("",Ee),v("",Ce),v("",ke)}var z;function kt(){for(;z.rows.length>7;)z.deleteRow(7)}function Tf(){let e=m();return a(e,ve),H(e,"/"),a(e,xe),e}function qa(e){let t=m();return a(t,e),H(t,"%"),t}function Wa(){z=In({className:"fshCenter"}),Oa(),Re(z,[[[[2,po,!0],[4,go,!0]]],[[[2,Tf()],[4,De]]],[[[2,so,!0],[4,qa(we)]],!0],[[[2,ho,!0],[4,qa(Ee)]],!0],[[[2,co,!0],[4,Ce]],!0],[[[6,ke]]],[[[2,uo,!0],[2,fo,!0],[2,mo,!0]]]])}var Q,Bt;function yo(){Bt=null,Q&&!Ae("fshHide",Q)&&(c(Q,!0),Ka(),kt())}function Ua(e){return e.type===0?(Bt=e.base_creature_id,!0):!1}function ja(){if(Q)c(Q,!1);else{let e=i("actionContainer");Q=f({className:"fshActionBox titanInfo"}),_a(),Wa(),a(Q,z),a(e,Q)}}function Hf(e){let t=new Date(Xe+e*1e3);return`${at(t.getHours())}:${at(t.getMinutes())} ${at(t.getDate())}/${je[t.getMonth()]}/${t.getFullYear()}`}function Mf(e){return e<=0?'<span class="fshGreen cooldown">No active cooldown</span>':`<span class="fshMaroon cooldown">Cooldown until: ${Hf(e)}</span>`}function Vf(e){return et(ta(e.max_hp-e.current_hp,e.kills),2)}function Nf(e){return et(e.kills*100/e.max_hp,2)}function Gf(e){return ra(e.kills,e.max_hp,e.current_hp)}function $f(e){e.forEach(([t,r])=>{l(t,r)})}function If(e){$f([[e.current_hp,ve],[e.max_hp,xe],[e.kills,De],[Vf(e),we],[Nf(e),Ee]]),v(Gf(e),Ce),v(Mf(e.cooldown),ke)}function Rf(e,t){return[[[2,g(t.player.name)],[2,g(t.kills.toString())],[2,g(`${et(t.kills*100/e.kills,2)}%`)]]]}function Pf(e){if(kt(),!e.contributors)return;let t=e.contributors.map(s(Rf,e));Re(z,t)}function Ff(e){return e.realm&&e.creature.base_id===Bt&&e.realm===lo}function vo(e){let t=e.find(Ff);t&&(If(t),Pf(t))}var St;function Of(){St&&(window.clearTimeout(St),St=null)}function _f(e){return e&&e.s&&b(e.r)}function za(e){return o.showTitanInfo&&b(e)&&e.some(Ua)}function Kf(e,t){!_f(t)||(vo(t.r),za(GameData.realm().dynamic)?St=window.setTimeout(e,3e4):yo())}function Qa(){io().then(s(Kf,Qa))}function Ya(e){Of(),za(e)?(ja(),Qa()):yo()}function Xa(e){e.dynamic&&(Fa(e.name),Ya(e.dynamic))}function Ja(){o.showTitanInfo=!o.showTitanInfo,h("showTitanInfo",o.showTitanInfo),Ya(GameData.realm().dynamic)}function qf(e){return e.realm&&e.realm.name}function Za(e,t){qf(t)&&Xa(t.realm)}function xo(){window.initialGameData&&Za(null,window.initialGameData),$.subscribe(`${mn} ${pn}`,Za)}var Pe,Fe,At,Be,Do,wo,Lt;function Wf(){return Ge({a:14,d:0,id:Pe.id,item_id:Pe.itemId})}function Uf(e){let t=e.response.response,r=e.response.msg,n;if(t!==0){let x=r.indexOf("<");x!==-1?n=r.substring(0,x):n=r}else n=`You purchased ${e.response.data.name} for ${O(e.response.data.cost)} gold.`;Y(Lt,`${n}<br>`)}function jf(){GameData.doAction(14,3,{id:Pe.id,item_id:Pe.itemId},0),At.close()}function zf(){let e=Tn(Do.value);if(!e)return;let t=[];for(let r=1;r<e;r+=1)t.push(Wf().then(Uf));st(t,jf)}function Qf(){Be=f({className:"fshClear",textContent:"Select how many to quick-buy:"}),Do=tt({id:"buyAmount",className:"fshNumberInput",min:1,max:99,value:1,type:"number"}),a(Be,Do),wo=K({textContent:"Quick-buy"}),w(wo,zf),a(Be,wo),Lt=f(),a(Be,Lt),a(Fe,Be)}function Yf(){return Fe||i("shopDialogConfirm")}function Xf(){return At||$(Fe).data("hcsWorldDialogShopConfirm")}function Jf(){Be?l("",Lt):Qf()}function Zf(e,t){Pe=t,Fe=Yf(),!!Fe&&(At=Xf(),At&&Jf())}function Eo(){$.subscribe(sn,Zf)}var B;function eu(e,t){t.creature_class=e.creature_class,t.image_id=e.image_id,t.level=Number(e.level),t.type=e.type}function tu(e){B[e.name]?B[e.name].seen&&(B[e.name].seen+=1):(B[e.name]={seen:1},eu(e,B[e.name]))}function ei(e,t,r){return t?e(t,r):r}function ti(e,t){let r=e||{};return r.min=ei(Math.min,r.min,t),r.max=ei(Math.max,r.max,t),r}var ru=["attack","armor","damage","defense","hp"];function ou(e,t){return!e||e.min!==t.min||e.max!==t.max}function nu(e,t,r){let n=ti(t[r],Number(e[r]));ou(t[r],n)&&(t[r]=n)}function au(e,t){ru.forEach(s(nu,e,t))}function iu(e){return e.enhancements&&e.enhancements.length>0}function lu(e,t){e[t.name]=ti(e[t.name],Number(t.value))}function su(e,t){iu(e)&&(t.enhancements=t.enhancements||{},e.enhancements.forEach(s(lu,t.enhancements)))}function fu(e){B||(B={}),tu(e),au(e,B[e.name]),su(e,B[e.name]),nt("fsh_monsterLog",B)}function ri(e){o.showMonsterLog&&fu(e)}function uu(e){B=e||{}}function oi(){ot("fsh_monsterLog").then(uu)}var ni=[];function mu(e){G(e)||(se("NewMap","MonsterLog"),ri(e.response.data))}function cu(e,t){return e.id===t.id}function du(e){if(ni.find(s(cu,e.data)))return!0;ni.push(e.data)}function pu(e,t){e.type!==6||du(e)||$e(e.data.id,t).then(mu)}function ai(){o.showMonsterLog&&GameData.actions().forEach(pu)}function Co(){oi(),$.subscribe("-1-success.action-response 4-success.action-response 5-success.action-response 25-success.action-response",ai),ai()}function hu(e){let t=S(e),r=Xn(t);return{r:{attributes:[{value:r.attack},{value:r.defense},{value:r.armor},{value:r.damage},{value:r.hp}]}}}function ko(e){return M({cmd:"guild",subcmd:"groups",subcmd2:"viewstats",group_id:e}).then(hu)}function Oe(e){return ut(lt({subcmd:"groups"},e))}function Bo(e){return Oe({subcmd2:"viewstats",group_id:e})}function So(e){return ue(Bo,ko,e)}function Ao(){return Oe({subcmd2:"view"})}function gu(e){let t=S(e),r=_('#pCC img[src$="disband.png"]',t);return r?{r:[{id:Number(r.parentNode.href.match(/\((\d+)\)/)[1]),members:[{name:F()}]}]}:{}}function Lo(){return M({cmd:"guild",subcmd:"groups"}).then(gu)}function bo(){return ue(Ao,Lo)}function ii(e){return e.numberOfCreatureHitsTillDead-e.numberOfHitsRequired<=1?", dies on miss":", survives a miss"}function yu(e){return e.numberOfHitsRequired==="-"||e.numberOfHitsRequired>e.numberOfCreatureHitsTillDead}function vu(e){return e.numberOfCreatureHitsTillDead==="-"?e.numberOfHitsRequired:yu(e)?"-":e.numberOfHitsRequired}function xu(e){return e.numberOfCreatureHitsTillDead==="-"||e.numberOfCreatureHitsTillDead>e.numberOfHitsRequired}function Du(e){return e.numberOfHitsRequired==="-"?e.numberOfCreatureHitsTillDead:xu(e)?"-":e.numberOfCreatureHitsTillDead}var wu=[[e=>e.playerHits==="-"&&e.creatureHits==="-",()=>"Unresolved"],[e=>e.playerHits==="-",()=>"Player dies"],[e=>e.playerHits===1,e=>`Player 1 hits${ii(e)}`],[e=>e.playerHits>1,e=>`Player > 1 hits${ii(e)}`]];function Eu(e,t){return t[0](e)}function Cu(e){let t=wu.find(s(Eu,e));return t?t[1](e):"Unknown"}function To(e){e.playerHits=vu(e),e.creatureHits=Du(e),e.fightStatus=Cu(e)}function ku(e){return e.callback.groupExists?e.callback.groupArmorValue:e.player.armorValue}function Bu(e){let t=ku(e);e.overallArmorValue=t+Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}function Su(e){e.player.sanctuaryLevel>0&&(e.extraNotes+=`Sanc Bonus Armor = ${Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}<br>`)}function Au(e){e.terrorizeEffect=Math.floor(e.creature.damage*e.player.terrorizeLevel*.001)}function Lu(e){e.player.terrorizeLevel>0&&(e.extraNotes+=`Terrorize Creature Damage Effect = ${e.terrorizeEffect*-1}<br>`)}function bu(e){e.creatureDamageDone=Math.ceil(e.generalVariable*e.creature.damage-e.overallArmorValue+e.overallHPValue)}function Tu(e){let t=e.generalVariable*e.creature.damage;t<e.overallArmorValue?e.numberOfCreatureHitsTillDead=e.overallHPValue:e.numberOfCreatureHitsTillDead=Math.ceil(e.overallHPValue/(t-e.overallArmorValue))}function Hu(e){e.creatureHitByHowMuch>=0?Tu(e):e.numberOfCreatureHitsTillDead="-"}function Ho(e){Bu(e),Su(e),Au(e),Lu(e),e.creature.damage-=e.terrorizeEffect,bu(e),Hu(e)}function Mu(e){return e.callback.groupExists?e.callback.groupAttackValue:e.player.attackValue}function Vu(e){let t=e.creature.defense-e.creature.defense*e.player.darkCurseLevel*.002;return e.combatEvaluatorBias===3?e.overallAttackValue-Math.ceil(t)-50:e.overallAttackValue-Math.ceil(e.attackVariable*t)}function Mo(e){let t=Mu(e);e.player.darkCurseLevel>0&&(e.extraNotes+=`DC Bonus Attack = ${Math.floor(e.creature.defense*e.player.darkCurseLevel*.002)}<br>`),e.nightmareVisageAttackMovedToDefense=Math.floor((t+e.counterAttackBonusAttack)*e.player.nightmareVisageLevel*.0025),e.player.nightmareVisageLevel>0&&(e.extraNotes+=`NMV Attack moved to Defense = ${e.nightmareVisageAttackMovedToDefense}<br>`),e.overallAttackValue=t+e.counterAttackBonusAttack-e.nightmareVisageAttackMovedToDefense,e.hitByHowMuch=Vu(e)}function Nu(e){return e.player.counterAttackLevel>0&&e.numberOfHitsRequired===1}function li(e){e.lowestCALevelToStillHit=Math.max(Math.ceil((e.counterAttackBonusAttack-e.hitByHowMuch+1)/e.player.attackValue/.0025),0),e.lowestCALevelToStillKill=Math.max(Math.ceil((e.counterAttackBonusDamage-e.damageDone+1)/e.player.damageValue/.0025),0)}function Gu(e){return e.player.counterAttackLevel>0?Math.ceil((1+e.player.doublerLevel/50)*.0025*e.lowestFeasibleCALevel):0}function $u(e){e.extraAttackAtLowestFeasibleCALevel=Math.floor(e.player.attackValue*.0025*e.lowestFeasibleCALevel),e.extraDamageAtLowestFeasibleCALevel=Math.floor(e.player.damageValue*.0025*e.lowestFeasibleCALevel),e.extraNotes+=`Extra CA Att/Dam at this lowered CA level = ${e.extraAttackAtLowestFeasibleCALevel} / ${e.extraDamageAtLowestFeasibleCALevel}<br>`}function Iu(e){li(e),e.lowestFeasibleCALevel=Math.max(e.lowestCALevelToStillHit,e.lowestCALevelToStillKill),e.extraNotes+=`Lowest CA to still 1-hit this creature = ${e.lowestFeasibleCALevel}<br>`,e.lowestFeasibleCALevel!==0&&$u(e),e.extraStaminaPerHitAtLowestFeasibleCALevel=Gu(e),e.extraStaminaPerHitAtLowestFeasibleCALevel<e.extraStaminaPerHit?e.extraNotes+=`Extra Stam Used at this lowered CA level = ${e.extraStaminaPerHitAtLowestFeasibleCALevel}<br>`:e.extraNotes+="No reduction of stam used at the lower CA level<br>"}function Ru(e){return e.numberOfHitsRequired==="-"||e.numberOfHitsRequired!==1}function Pu(e){e.lowestCALevelToStillHit>175?e.extraNotes+="Even with CA175 you cannot hit this creature<br>":e.lowestCALevelToStillHit!==0&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillHit} to hit this creature<br>`)}function Fu(e){e.lowestCALevelToStillKill>175?e.extraNotes+="Even with CA175 you cannot 1-hit kill this creature<br>":e.lowestCALevelToStillKill!==0&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillKill} to 1-hit kill this creature<br>`)}function Ou(e){li(e),Pu(e),Fu(e)}function Vo(e){Nu(e)&&Iu(e),Ru(e)&&Ou(e)}function _u(e){return e.callback.groupExists?e.callback.groupHPValue:e.player.hpValue}function Ku(e){return e.callback.groupExists?e.callback.groupDamageValue:e.player.damageValue}function qu(e){let t=_u(e),{fortitudeLevel:r}=e.player;e.fortitudeExtraHPs=Math.floor(t*r*.001),r>0&&(e.extraNotes+=`Fortitude Bonus HP = ${e.fortitudeExtraHPs}<br>`),e.overallHPValue=t+e.fortitudeExtraHPs}function Wu(e){let{chiStrikeLevel:t}=e.player;e.chiStrikeExtraDamage=Math.floor(e.overallHPValue*t*.001),t>0&&(e.extraNotes+=`Chi Strike Bonus Damage = ${e.chiStrikeExtraDamage}<br>`)}function No(e){qu(e),Wu(e);let t=Ku(e);if(e.overallDamageValue=t+e.deathDealerBonusDamage+e.counterAttackBonusDamage+e.holyFlameBonusDamage+e.chiStrikeExtraDamage,e.damageDone=Math.floor(e.overallDamageValue-(e.generalVariable*e.creature.armor+e.hpVariable*e.creature.hp)),e.hitByHowMuch>0){let r=1;e.overallDamageValue>=e.generalVariable*e.creature.armor&&(r=e.overallDamageValue-e.generalVariable*e.creature.armor),e.numberOfHitsRequired=Math.ceil(e.hpVariable*e.creature.hp/r)}else e.numberOfHitsRequired="-"}function Go(e){return e.callback.groupExists?e.callback.groupDefenseValue:e.player.defenseValue}function Uu(e){e.player.constitutionLevel>0&&(e.extraNotes+=`Constitution Bonus Defense = ${Math.floor(Go(e)*e.player.constitutionLevel*.001)}<br>`)}function ju(e){e.player.flinchLevel>0&&(e.extraNotes+=`Flinch Bonus Attack Reduction = ${Math.floor(e.creature.attack*e.player.flinchLevel*.001)}<br>`)}function $o(e){e.overallDefenseValue=Go(e)+Math.floor(Go(e)*e.player.constitutionLevel*.001)+e.nightmareVisageAttackMovedToDefense,Uu(e),ju(e),e.creatureHitByHowMuch=Math.floor(e.attackVariable*e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue),e.combatEvaluatorBias===3&&(e.creatureHitByHowMuch=Math.floor(e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue-50))}function zu(e){e.player.superEliteSlayerLevel>0&&(e.extraNotes+=`SES Stat Reduction Multiplier = ${e.player.superEliteSlayerMultiplier}<br>`)}function Qu(e){e.holyFlameBonusDamage=0,e.creature.class==="Undead"&&(e.holyFlameBonusDamage=Math.max(Math.floor((e.player.damageValue-e.creature.armor)*e.player.holyFlameLevel*.002),0),e.player.holyFlameLevel>0&&(e.extraNotes+=`HF Bonus Damage = ${e.holyFlameBonusDamage}<br>`))}function Yu(e){e.deathDealerBonusDamage=Math.floor(e.player.damageValue*(Math.min(Math.floor(e.player.killStreakValue/5)*.01*e.player.deathDealerLevel,20)/100))}function Xu(e){e.counterAttackBonusAttack=Math.floor(e.player.attackValue*.0025*e.player.counterAttackLevel),e.counterAttackBonusDamage=Math.floor(e.player.damageValue*.0025*e.player.counterAttackLevel)}function Ju(e){e.extraStaminaPerHit=0,e.player.counterAttackLevel>0&&(e.extraStaminaPerHit=Math.ceil((1+e.player.doublerLevel/50)*.0025*e.player.counterAttackLevel))}function Zu(e){e.player.deathDealerLevel>0&&(e.extraNotes+=`DD Bonus Damage = ${e.deathDealerBonusDamage}<br>`)}function em(e){e.player.counterAttackLevel>0&&(e.extraNotes+=`CA Bonus Attack/Damage = ${e.counterAttackBonusAttack} / ${e.counterAttackBonusDamage}<br>CA Extra Stam Used = ${e.extraStaminaPerHit}<br>`)}function Io(e){e.extraNotes="",zu(e),Qu(e),Yu(e),Xu(e),Ju(e),Zu(e),em(e)}function tm(e){return e.callback.groupExists?"Group ":""}function rm(e){return`<tr><td bgcolor="#CD9E4B" colspan="4" align="center">${tm(e)}Combat Evaluation</td></tr>`}function om(e){return e.hitByHowMuch>0?"Yes":"No"}function nm(e){return`<tr><td align="right"><span style="color:#333333">Will I hit it? </td><td align="left">${om(e)}</td><td align="right"><span style="color:#333333">Extra Attack: </td><td align="left">( ${e.hitByHowMuch} )</td></tr>`}function am(e){return`<tr><td align="right"><span style="color:#333333"># Hits to kill it? </td><td align="left">${e.numberOfHitsRequired}</td><td align="right"><span style="color:#333333">Extra Damage: </td><td align="left">( ${e.damageDone} )</td></tr>`}function im(e){return e.creatureHitByHowMuch>=0?"Yes":"No"}function lm(e){return`<tr><td align="right"><span style="color:#333333">Will I be hit? </td><td align="left">${im(e)}</td><td align="right"><span style="color:#333333">Extra Defense: </td><td align="left">( ${-1*e.creatureHitByHowMuch} )</td></tr>`}function sm(e){return`<tr><td align="right"><span style="color:#333333"># Hits to kill me? </td><td align="left">${e.numberOfCreatureHitsTillDead}</td><td align="right"><span style="color:#333333">Extra Armor + HP: </td><td align="left">( ${-1*e.creatureDamageDone} )</td></tr>`}function fm(e){return`<tr><td align="right"><span style="color:#333333"># Player Hits? </td><td align="left">${e.playerHits}</td><td align="right"><span style="color:#333333"># Creature Hits? </td><td align="left">${e.creatureHits}</td></tr>`}function um(e){return`<tr><td align="right"><span style="color:#333333">Fight Status: </span></td><td align="left" colspan="3"><span>${e.fightStatus}</span></td></tr>`}function mm(e){return`<tr><td align="right"><span style="color:#333333">Notes: </span></td><td align="left" colspan="3"><span style="font-size:x-small;">${e.extraNotes}</span></td></tr>`}function Ro(e){return`<table width="100%"><tbody>${rm(e)}${nm(e)}${am(e)}${lm(e)}${sm(e)}${fm(e)}${um(e)}${mm(e)}</tbody></table>`}var bt,Tt,_e;function cm(e){if(!bt){let t=fe("body",e);t.length===1&&([bt]=t)}}function si(){return re(Tt)?"Remove from do not kill list":"Add to the do not kill list"}function fi(){l(si(),_e)}function dm(){let e=o.doNotKillList.indexOf(Tt);e===-1?o.doNotKillList.push(Tt):o.doNotKillList.splice(e,1),fi(),h("doNotKillList",o.doNotKillList.join()),me()}function pm(){_e=K({className:"fshBl",textContent:si(),type:"button"});let e=f({className:"description",innerHTML:'<span class="ui-helper-hidden-accessible"><input type="text"></span>'});a(e,_e),a(bt,e),w(_e,dm)}function hm(){_e?fi():pm()}function Po(e,t){cm(t),bt&&(Tt=e.trim(),hm())}var Se,Ke,Ht,Mt;function gm(){Se||(Se=i("dialog-viewcreature"))}function ym(){Ke||(Ke=f(),a(Se,Ke),a(Se,f({innerHTML:'<span class="fshFooter">*Does include CA, DD, HF, DC, Flinch, Super Elite Slayer, NMV, Sanctuary, Constitution, Fortitude, Chi Strike and Terrorize (if active) and allow for randomness (1.1053). Constitution, NMV, Fortitude and Chi Strike apply to group stats.</span>'})))}function ui(){Ht||(ym(),Ht=f(),a(Ke,Ht))}function vm(){Mt||(ui(),Mt=f(),a(Ke,Mt))}function mi(e){ui(),v(e,Ht)}function ci(e){vm(),v(e,Mt)}function xm(e,t,r){r===3&&(t.attack-=Math.ceil(t.attack*e),t.defense-=Math.ceil(t.defense*e),t.armor-=Math.ceil(t.armor*e),t.damage-=Math.ceil(t.damage*e),t.hp-=Math.ceil(t.hp*e))}function Dm(e,t){let r={name:e.name,class:e.creature_class,attack:Number(e.attack),defense:Number(e.defense),armor:Number(e.armor),damage:Number(e.damage),hp:Number(e.hp)};return xm(t,r,e.type),r}function wm(e){e.combatEvaluatorBias=o.combatEvaluatorBias,e.attackVariable=1.1053,e.generalVariable=o.generalVariable,e.hpVariable=o.hpVariable}function Em(e){Io(e),Mo(e),No(e),$o(e),Ho(e),To(e),Vo(e)}function di(e,t,r){let n={};n.callback=r,n.player=he(t),wm(n),n.creature=Dm(e.response.data,n.player.superEliteSlayerMultiplier),Em(n),n.evaluatorHTML=Ro(n),r.groupExists?ci(n.evaluatorHTML):mi(n.evaluatorHTML)}function Cm(e){return e.members[0].name===F()}function km(e){if(b(e.r))return e.r.find(Cm).id}function Bm(e,t,r){if(!r.r||!r.r.attributes)return;let n=r.r.attributes;di(e,t,{groupExists:!0,groupAttackValue:n[0].value,groupDefenseValue:n[1].value,groupArmorValue:n[2].value,groupDamageValue:n[3].value,groupHPValue:n[4].value})}function Sm(e,t,r){r&&So(r).then(s(Bm,e,t))}function Am(e,t){bo().then(km).then(s(Sm,e,t))}function Lm(e,t){e.player.hasGroup&&Am(e,t),di(e,t,{groupExists:!1})}function bm(e){return e.response&&e.response.data}function Tm(e,t){gm(),!!Se&&(mi(""),ci(""),bm(t)&&(Po(t.response.data.name,Se),Kn(!0).then(s(Lm,t))))}function Fo(){$.subscribe(cn,Tm)}var Vt,Oo;function Nt(){let e=[,[o.buffs,o.buffsName],[o.buffs2,o.buffs2Name],[o.buffs3,o.buffs3Name]][o.enabledHuntingMode];b(e)&&([Vt,Oo]=e)}function _o(e){e.target.name==="enabledHuntingMode"&&(o.enabledHuntingMode=e.target.value,h("enabledHuntingMode",o.enabledHuntingMode),Nt(),GameData.fetch(P))}var qe;function pi(){qe=!qe,h("hidePlayerActions",qe),GameData.fetch(k)}function Hm(e){let t=fe("verbs",e);t.length===1&&it(t[0])}function hi(){if(!qe)return;let e=i("actionList");ft("player",e).forEach(Hm)}function gi(){qe=d("hidePlayerActions"),$.subscribe(ie,hi),hi()}function Ko(){o.showCreatureInfo=!o.showCreatureInfo,h("showCreatureInfo",o.showCreatureInfo)}function qo(){o.showBuffs=!o.showBuffs,h("showHuntingBuffs",o.showBuffs),GameData.fetch(P)}function Wo(){o.showMonsterLog=!o.showMonsterLog,h("showMonsterLog",o.showMonsterLog)}function Uo(){o.hideSubLvlCreature=!o.hideSubLvlCreature,h("hideSubLvlCreature",o.hideSubLvlCreature),GameData.fetch(k)}function Mm(){return f({id:"fshWorldPrefs",innerHTML:`${J("showCreatureInfo")}&nbsp;&nbsp;${J("showMonsterLog")}&nbsp;&nbsp;${J("showTitanInfo")}&nbsp;&nbsp;${J("showBuffInfo")}<br>${J("hideSubLvlCreature")}&nbsp;&nbsp;${J("hidePlayerActions")}&nbsp;&nbsp;${aa()}`})}var Vm={hideSubLvlCreature:Uo,hidePlayerActions:pi,showCreatureInfo:Ko,showHuntingBuffs:qo,showMonsterLog:Wo,showTitanInfo:Ja,showBuffInfo:ma};function Nm(e){let t=Vm[e.target.name];Ue(t)&&(e.target.blur(),t(e))}function jo(){let e=f({className:"fshCenter fshFten"}),t=Mm();w(t,Nm),T(t,"change",_o),a(e,t);let r=f();a(e,r);let n=i("worldContainerBelow").children[0];return rt(e,n),r}function Gm(e,t){return e[t.name]=!0,e}function $m(e,t,r){return e[r.trim()]||t.push(r),t}function Im(e,t){v(`You are missing some ${Oo} hunting buffs<br>(${t.join(", ")})`,e)}function yi(e){v("",e)}function Rm(e,t){let r=t.b.reduce(Gm,{}),n=Vt.reduce(s($m,r),[]);n.length>0?Im(e,n):yi(e)}function Pm(e,t,r){o.showBuffs?Rm(e,r):yi(e)}function Fm(e,t,r){Vt&&Pm(e,t,r)}function zo(e){Nt();let t=s(Fm,e);$.subscribe(ze,t),o.showBuffs&&window.initialGameData&&t(null,{b:window.initialGameData.player.buffs})}var Gt=[{generalVariable:1.1053,hpVariable:1.1},{generalVariable:1.1,hpVariable:1.053},{generalVariable:1.053,hpVariable:1},{generalVariable:1.1053,hpVariable:1}];function Om(e){return Gt[e]?Gt[e].generalVariable:1.1053}function _m(e){return Gt[e]?Gt[e].hpVariable:1.1}function Qo(){o.combatEvaluatorBias=d("combatEvaluatorBias"),o.generalVariable=Om(o.combatEvaluatorBias),o.hpVariable=_m(o.combatEvaluatorBias)}function Km(e){return!e||!e.actions||e.actions.length===0}function qm(e,t){return t.type===6?t.data.creature_type!==0||t.data.level>=e:!0}function Wm(e){return e.realm&&e.realm.minlevel||GameData.realm().minlevel}function Um(e){let t=kn(e);return Km(t)?e:(t.actions=t.actions.filter(s(qm,Wm(t))),JSON.stringify(t))}function jm(e){return e.data&&e.data.d&&ea(e.data.d,k)}function zm(e,t){o.hideSubLvlCreature&&jm(t)&&(e.dataFilter=Um)}function Yo(){$.ajaxPrefilter("JSON",zm),o.hideSubLvlCreature&&GameData.fetch(k)}function Qm(e){o[e[0]]=Rt(e[1])}function Ym(){[["buffs","huntingBuffs"],["buffs2","huntingBuffs2"],["buffs3","huntingBuffs3"]].forEach(Qm)}function Xm(e){o[e]=Rt(e)}function Jm(){["doNotKillList"].forEach(Xm)}function Zm(){Ym(),Jm()}function ec(e){o[e[0]]=d(e[1])}function tc(){[["buffsName","huntingBuffsName"],["buffs2Name","huntingBuffs2Name"],["buffs3Name","huntingBuffs3Name"],["showBuffs","showHuntingBuffs"]].forEach(ec)}function rc(e){o[e]=d(e)}function oc(){["enabledHuntingMode","hideSubLvlCreature","showTitanInfo","showBuffInfo","showMonsterLog","showCreatureInfo"].forEach(rc)}function nc(){tc(),oc()}function ac(){Zm(),nc()}function Xo(){Qo(),ac();let e=jo();Yo(),zo(e),gi()}function vi(e){$(`#actionList li.creature-${e.toString()} a.create-group`).hide()}function ic(e){$.subscribe(ie,s(vi,e))}var lc=["hideChampionsGroup","hideElitesGroup","hideSEGroup","hideTitanGroup","hideLegendaryGroup"];function sc(e,t){d(e)&&(ic(t+1),vi(t+1))}function fc(){lc.forEach(sc)}function uc(){a(document.body,Mn(`#actionList .creature-1 {color: green;}
#actionList .creature-2 {color: yellow;}
#actionList .creature-3 {color: red;}`))}function mc(){d("enableCreatureColoring")&&uc()}function cc(e,t){t==="ACT_REPAIR"&&GameData.fetch(gn+P+Ye+k)}function dc(){$.subscribe(fn,cc)}function pc(){$("#messageCenter").worldMessageCenter({offset:"0 60"})}function hc(){Le("#mapTooltip")}function gc(e){Le(e.target)}function yc(){w(i("buffList"),gc)}var vc=[Xo,Yr,Fo,fc,mc,pr,Co,dc,cr,xo,Eo,zr,pc,hc,xr,ua,yc,oo,ur];function xc(){Rn(vc),o.userIsDev&&(yr(),gr())}export{xc as default};
//# sourceMappingURL=newMap-RB343CKD.js.map
