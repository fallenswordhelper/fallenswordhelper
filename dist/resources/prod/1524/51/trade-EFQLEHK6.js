import{a as p}from"./chunk-4RN55GHN.js";import{a as P}from"./chunk-I6LPG6MF.js";import{a as j,b as x}from"./chunk-V7V2OEA5.js";import"./chunk-VQFF4KEY.js";import{a as M}from"./chunk-L42JV3AT.js";import"./chunk-ABU7EFWZ.js";import"./chunk-2QCX6TSH.js";import"./chunk-QNPSGVM3.js";import{b as _,c as q}from"./chunk-PNLDJYS7.js";import{a as H}from"./chunk-633OEY6F.js";import{a as F}from"./chunk-MF5UI2DL.js";import{a as T}from"./chunk-TVG77EME.js";import{a as w}from"./chunk-WHAZT5VY.js";import"./chunk-UWKUUDVQ.js";import{a as y}from"./chunk-VYP6BYDA.js";import{a as b}from"./chunk-RGN4RGGV.js";import{a}from"./chunk-LVNLH6ER.js";import{a as O}from"./chunk-73DVOOSI.js";import{a as h}from"./chunk-57PZ6XJI.js";import"./chunk-ZLI5KJBW.js";import"./chunk-EUBCJC2U.js";import{a as A}from"./chunk-UWAT3VA7.js";import"./chunk-7GAPHNBH.js";import"./chunk-YYZHVDZH.js";import"./chunk-VI3RZM5G.js";import{a as $}from"./chunk-WV4YXE4F.js";import{a as i}from"./chunk-6HK7Y3PF.js";import{a as E}from"./chunk-22YAZV3W.js";import"./chunk-WBUJCSKW.js";import"./chunk-ND3XCMOS.js";import"./chunk-74YALW75.js";import"./chunk-WPRJK6Q2.js";import"./chunk-PJ32ASZ7.js";import"./chunk-F5QOVYT2.js";import{a as s}from"./chunk-CT4SVZHO.js";import{a as v}from"./chunk-R5ZZQ5HH.js";import{a as N}from"./chunk-XQ3ZEJ26.js";import"./chunk-PO34EML4.js";import"./chunk-QFSH2B2J.js";import{a as C}from"./chunk-2PFHY365.js";import"./chunk-ZDFDMUO4.js";import"./chunk-2V5OQ7JE.js";import"./chunk-GGKSIQST.js";import"./chunk-JSWEJZHY.js";import"./chunk-JZLUF437.js";import{a as m}from"./chunk-G3O526VI.js";import"./chunk-GHQYBWLT.js";import"./chunk-PKDG64MH.js";import{a as o}from"./chunk-2B42SRXB.js";import"./chunk-3IGXKFMQ.js";import{a as f}from"./chunk-GLHEJYH7.js";import"./chunk-EPYDL6MF.js";import"./chunk-TDNJGM62.js";import{a as L,b as d}from"./chunk-HAINOYE5.js";import{a as u}from"./chunk-AN5TC666.js";import"./chunk-B7PLPUHK.js";import{sa as l}from"./chunk-YNXRNCRL.js";import"./chunk-7DPOBF7C.js";import{a as c}from"./chunk-DEDCEYVR.js";var g;function W(){let e=o("item-div");if(!e){e=N({id:"item-div",className:"itemDiv"});let t=o("item-list"),n=A(l,t);for(;n.length;)n[0].classList.add("fshBlock"),v(e,n[0]);a(e,t)}return e}function Q(e,t,n){return e&&E(t,n)}function z(e,t,n){return!e&&!t&&!n}function G(e,t){t.children[0].lastElementChild.children[0].children[0].checked=!1;let n=s("fshHide",t),r=e==="folderid0",S=s(e,t);Q(n,r,S)&&(t.classList.remove("fshHide"),t.classList.add("fshBlock")),z(n,r,S)&&(t.classList.remove("fshBlock"),F(t))}function J(e){h(l,W()).forEach(c(G,e.target.id))}function K(e){e.target.nodeName==="SPAN"&&e.target.id.indexOf("folderid")!==-1&&J(e)}function U(e){return` &ensp;<span id="folderid${e[0]}" class="fshLink fshNoWrap" fid=${e[0]}>${e[1]}</span> `}function X(e){let t=p({id:"fshFolderSelect",innerHTML:`<td colspan=6><span id="folderid0" class="fshLink" fid=0>All</span> &ensp;<span id="folderid-1" class="fshLink" fid="-1">Main</span>${C(e).map(U).join("")}`});m(t,K);let n=o("item-list").parentNode.parentNode;O(n,'<tr id="fshShowSTs"><td align="center" colspan=6><label><input type="checkbox" id="itemsInSt" checked> Select items in ST</label></td></tr>'),a(t,n)}function Y(e,t){t.is_in_st&&e.classList.add("isInST")}function Z(e){let t=e.children[0].lastElementChild.children[0];if(!t)return;let n=t.children[0];if(!n)return;let r=g[n.getAttribute("value")];r&&(e.classList.add(`folderid${r.folder_id}`),g.fshHasST&&Y(e,r),n.classList.add(`itemid${r.item_id}`),n.classList.add(`itemtype${r.type}`))}function ee(e){let t=d("betaOptIn");t&&_("trade.processTrade"),g=e.items,h(l,o("item-list")).forEach(Z),X(e.folders),t&&q("trade.processTrade")}function te(e){i(3,ee,[e])}function k(){w()||M().then(te)}function I(e,t){return $(j,x,e,t)}async function ne(e,t){let n=await e;return console.log("promise data",n),n===null||n.s?I(t[0],t[1]):n}async function oe(){let e=y('form[name="sendItemForm"] [name="target_username"]'),n=await f('[name="sendItemList[]"]:checked').map(r=>[e.value,[r.value]]).reduce(ne,Promise.resolve(null));console.log("finalResult",n)}function B(){let e=y('form[name="sendItemForm"] input[value="Send"]'),t=H({className:"fshBl",id:"oneByOneBtn",textContent:"OneByOne",type:"button"});P(t,e),m(t,oe)}function re(e){let t=parseInt(o("fshSendHowMany").value,10);return b(t)?e.length:u.subcmd!=="-"?Math.min(100,t):t}function se(e,t){return e==="itemid-2"&&s("itemtype12",t)}function ie(e,t){return e==="itemid-1"||se(e,t)||s(e,t)}function me(){let e=o("itemsInSt");if(e)return e.checked}function ce(e,t){return e||!s("isInST",t)}function D(e){return e.children[0].lastElementChild.children[0].children[0]}function R(e,t){t.checked=e}function ae(e){R(!1,e)}function le(e){R(!0,e)}function de(e,t){t.filter(c(ce,me())).map(D).filter(c(ie,e)).slice(0,re(t)).forEach(le)}function fe(e){let t=o("item-div")||o("item-list"),n=f("table:not(.fshHide)",t);n.map(D).forEach(ae),de(e.target.id,n)}function pe(e){s("fshCheckAll",e.target)&&fe(e)}function V(e){return T(`[${e}]`)}function ue(){let e=d("sendClasses"),t=V(e);return t||V(L.sendClasses)}function he(e){return` &ensp;<span id="itemid${e[1]}" class="fshCheckAll fshLink fshNoWrap">${e[0]}</span>`}function ye(e){let t=p({id:"fshSelectMultiple",innerHTML:`<td colspan=6>Select:&ensp;<span id="itemid-1" class="fshCheckAll fshLink fshNoWrap">All Items</span> &ensp;<span id="itemid-2" class="fshCheckAll fshLink fshNoWrap">All Resources</span>${ue().map(he).join("")} &ensp;How&nbsp;many:<input id="fshSendHowMany" type="text" class="custominput fshHowMany" value="all"></td>`});m(t,pe),a(t,e.parentNode.parentNode)}function ge(){let e=o("item-list");!e||(i(3,k),i(3,ye,[e]),u.userIsDev&&i(3,B))}export{ge as default};
//# sourceMappingURL=trade-EFQLEHK6.js.map
