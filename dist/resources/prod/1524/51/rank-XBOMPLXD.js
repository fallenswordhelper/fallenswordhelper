import{a as $}from"./chunk-WXWO4HTU.js";import{a as G}from"./chunk-INGZUBGK.js";import{a as M}from"./chunk-NHC2FK3B.js";import{a as F}from"./chunk-FLYB2WHA.js";import{a as U}from"./chunk-S32GZNLH.js";import"./chunk-QNPSGVM3.js";import{a as q}from"./chunk-KC3JUT6W.js";import"./chunk-YW6SRUBN.js";import{a as H}from"./chunk-YPRXL3QQ.js";import"./chunk-F3D3J6RM.js";import{b as S}from"./chunk-EVJ3735L.js";import"./chunk-BF7TG5EL.js";import{a as D}from"./chunk-QCFPXMNH.js";import{a as v}from"./chunk-GCEMRPTW.js";import{a as I}from"./chunk-X5ZSXFJV.js";import"./chunk-OFZ4M2H7.js";import"./chunk-6MUFX5NS.js";import{a as V}from"./chunk-WHAZT5VY.js";import"./chunk-UWKUUDVQ.js";import{a as m}from"./chunk-VYP6BYDA.js";import"./chunk-RGN4RGGV.js";import{a as E}from"./chunk-6VZYKCGK.js";import{a as j}from"./chunk-VXT65ZUM.js";import{b as f}from"./chunk-MHANGBVH.js";import{a as T}from"./chunk-LVNLH6ER.js";import{a as P}from"./chunk-ZZS3NLOT.js";import"./chunk-57PZ6XJI.js";import{a as u}from"./chunk-ZLI5KJBW.js";import"./chunk-EUBCJC2U.js";import"./chunk-UWAT3VA7.js";import"./chunk-7GAPHNBH.js";import{a as d}from"./chunk-WV4YXE4F.js";import"./chunk-6HK7Y3PF.js";import"./chunk-22YAZV3W.js";import"./chunk-WBUJCSKW.js";import"./chunk-ND3XCMOS.js";import"./chunk-74YALW75.js";import{a as h}from"./chunk-WPRJK6Q2.js";import{a as i}from"./chunk-PJ32ASZ7.js";import"./chunk-F5QOVYT2.js";import{a as _}from"./chunk-R5ZZQ5HH.js";import"./chunk-PO34EML4.js";import"./chunk-QFSH2B2J.js";import{a as C}from"./chunk-2PFHY365.js";import"./chunk-ZDFDMUO4.js";import{a as L}from"./chunk-2V5OQ7JE.js";import"./chunk-GGKSIQST.js";import"./chunk-JSWEJZHY.js";import"./chunk-JZLUF437.js";import{a as l}from"./chunk-G3O526VI.js";import"./chunk-GHQYBWLT.js";import"./chunk-PKDG64MH.js";import"./chunk-2B42SRXB.js";import"./chunk-3IGXKFMQ.js";import{a as k}from"./chunk-GLHEJYH7.js";import"./chunk-EPYDL6MF.js";import{a as B}from"./chunk-TDNJGM62.js";import{a as p}from"./chunk-TP7JP7VV.js";import{b as A}from"./chunk-HAINOYE5.js";import"./chunk-AN5TC666.js";import"./chunk-B7PLPUHK.js";import"./chunk-YNXRNCRL.js";import"./chunk-7DPOBF7C.js";import{a}from"./chunk-DEDCEYVR.js";function s(t){return U(L({subcmd:"ranks"},t))}var z=t=>i({cmd:"guild",subcmd:"ranks",subcmd2:"add",rank_id:t}),J=t=>z(t.getAttribute("onclick").match(/[=](\d+)/)[1]),K=t=>k('input[name^="permission"]:checked',t).reduce((n,r)=>n+2**Number(r.name.match(/\[(\d+)\]/)[1]),0);function X(t){return{id:Number(m('input[name="rank_id"]',t).value),name:m('input[name="rank_name"]',t).value,permissions:K(t),tax:Number(m('input[name="rank_tax"]',t).value)}}function Y(t){let r=t.map(h).map(X);return{r:{0:r[0],ranks:r.slice(1)},s:!0}}function Z(t){let n=h(t),r=k('input[value="Edit"]',n);return q(r.map(J),Y)}function g(){return i({cmd:"guild",subcmd:"ranks"}).then(Z)}function x(){return d(s,g)}var tt=[[2,5],[4,4],[64,5],[256,.1],[512,.2],[4096,.5],[32768,.2],[524288,.1],[65536,5],[4194304,4]];function nt(t){return S(tt.filter(([n])=>G(t,n)).reduce((n,[,r])=>n+r-1,0)+t.toString(2).split("").map(Number).reduce(v,0),1)}function rt(t,n){let r=n.children[0],e=p(r.firstChild),o=t.find(c=>c&&c.name===e);o&&H(r,`<span class="fshBlue">(${nt(o.permissions)}) Tax:(${o.tax}%)</span> `)}function ot(t,n,r){r.s&&(t.forEach(a(rt,[r.r["0"]].concat(r.r.ranks))),n.classList.remove("fshSpinner"))}function et(t,n){let r=I({className:"fshBlock fshRelative fshSpinner fshSpinner12",style:{height:"15px",width:"136px"}});M(r,n),x().then(a(ot,t,r))}function at(t,n){let r=P({className:"custombutton",type:"button",value:"Get Rank Weightings"});l(r,a(et,t,r));let e=n.parentNode.parentNode;u(e,"&nbsp;"),_(e,r)}function w(t){let n=m('#pCC a[href*="=ranks&subcmd2=add"]');n&&at(t,n)}function R(t,n){return i({cmd:"guild",subcmd:"ranks",subcmd2:t,rank_id:n}).then(()=>({s:!0}))}function b(t,n){return s({subcmd2:t,rank_id:n})}function y(t,n){return d(b,R,t,n)}var N;function mt(t,n){return N>=Math.min(t.rowIndex,n)||n<1||n>t.parentNode.rows.length}function it(t){return t==="Up"?-1:2}function st(t){return t==="Up"?-22:22}function ct(t,n,r){let e=t.target.getAttribute("onclick").match(/rank_id=(\d+)/);y(j(t.target.value),e[1]);let o=n.parentNode.rows[r];T(n,o);let c=st(t.target.value);window.scrollBy(0,c),t.stopPropagation()}function ut(t){let n=t.target.parentNode.parentNode.parentNode,r=n.rowIndex+it(t.target.value);mt(n,r)||ct(t,n,r)}function ft(t){return["Up","Down"].includes(t.target.value)}function pt(t){ft(t)&&ut(t)}function W(){N&&A("ajaxifyRankControls")&&l(f,pt,!0)}function Q(t,n){n&&n[1].includes(E())&&(N=t.rowIndex)}function lt(){let t=f.lastElementChild.previousElementSibling;if(t.rows&&t.rows.length>7)return B(t.rows[7].children[0].children[0].rows)}function O(t,n){return n[0]===t}function dt(t){return t&&t[1].length>0}function kt(t,n){return t.rowIndex===1?"Guild Founder":p(n)}function ht(t,n){let r=n.children[0],e=kt(n,r),o=t.find(a(O,e));dt(o)&&(Q(n,o),u(r,` <span class="fshBlue">- ${o[1].join(", ")}</span>`))}function gt(t){let n=lt();n&&(D([5,3,n,1,a(ht,t)]),w(n),W())}function xt(t,n){let r=t.find(a(O,n[1].rank_name));return r?r[1].push(n[0]):t.push([n[1].rank_name,[n[0]]]),t}function wt(t){return C(t).filter($).reduce(xt,[])}function Rt(){V()||F(!1).then(wt).then(gt)}export{Rt as default};
//# sourceMappingURL=rank-XBOMPLXD.js.map
