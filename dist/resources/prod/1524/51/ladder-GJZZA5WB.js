import{a as Z}from"./chunk-24W5KOJU.js";import{a as Y}from"./chunk-P7LHWG3T.js";import"./chunk-OTX7UAN2.js";import{B as y,C,D as Q,E as X,a,b as z,c as J,d as v,e as u,f,h as m,j as K,k as F,l as A,n as g}from"./chunk-ZHHJEY5V.js";import{a as I}from"./chunk-6MUFX5NS.js";import{a as b}from"./chunk-VYP6BYDA.js";import{a as S}from"./chunk-NIO7Y7L5.js";import"./chunk-MHANGBVH.js";import"./chunk-UNW33QGP.js";import{a as G}from"./chunk-GVLE3LCU.js";import{a as L}from"./chunk-WV4YXE4F.js";import{a as M}from"./chunk-74YALW75.js";import{a as w}from"./chunk-WPRJK6Q2.js";import{a as p}from"./chunk-PJ32ASZ7.js";import"./chunk-F5QOVYT2.js";import"./chunk-QFSH2B2J.js";import"./chunk-2PFHY365.js";import{a as N}from"./chunk-ZDFDMUO4.js";import{a as B}from"./chunk-2V5OQ7JE.js";import"./chunk-GGKSIQST.js";import"./chunk-JSWEJZHY.js";import"./chunk-JZLUF437.js";import{a as W}from"./chunk-4OJTKSB2.js";import"./chunk-GHQYBWLT.js";import{a as U}from"./chunk-N2KVYLIG.js";import"./chunk-PKDG64MH.js";import"./chunk-2B42SRXB.js";import"./chunk-3IGXKFMQ.js";import{b as d}from"./chunk-HAINOYE5.js";import"./chunk-AN5TC666.js";import{a as x}from"./chunk-B7PLPUHK.js";import{ra as E}from"./chunk-YNXRNCRL.js";import"./chunk-7DPOBF7C.js";import"./chunk-DEDCEYVR.js";function re(e){return{c:a,m:a,p:a,d:a}}function oe(e){let t=S(e[0]),n,r=t&&$(e);return{c(){r&&r.c(),n=F()},m(o,s){r&&r.m(o,s),u(o,n,s)},p(o,s){s&1&&(t=S(o[0])),t?r?r.p(o,s):(r=$(o),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},d(o){r&&r.d(o),o&&f(n)}}}function $(e){let t,n,r,o,s,i={ctx:e,current:null,token:null,hasCatch:!1,pending:ae,then:ie,catch:se};return y(s=e[1],i),{c(){t=m("tr"),n=m("td"),n.innerHTML='<span data-tooltip="Ticking this box opts you in to the PVP Ladder, unticking it will remove you from the PVP Ladder." class="svelte-1quw1g">PvP Ladder Opt-in:</span>',r=K(),o=m("td"),i.block.c(),g(n,"class","svelte-1quw1g"),g(o,"class","svelte-1quw1g")},m(c,l){u(c,t,l),v(t,n),v(t,r),v(t,o),i.block.m(o,i.anchor=null),i.mount=()=>o,i.anchor=null},p(c,l){e=c,i.ctx=e,l&2&&s!==(s=e[1])&&y(s,i)||C(i,e,l)},d(c){c&&f(t),i.block.d(),i.token=null,i=null}}}function se(e){return{c:a,m:a,p:a,d:a}}function ie(e){let t,n,r;return{c(){t=m("input"),g(t,"type","checkbox")},m(o,s){u(o,t,s),t.checked=e[0],n||(r=[A(t,"change",e[6]),A(t,"click",e[3])],n=!0)},p(o,s){s&1&&(t.checked=o[0])},d(o){o&&f(t),n=!1,z(r)}}}function ae(e){let t;return{c(){t=m("div"),t.innerHTML='<span class="fshSpinner fshSpinner12 svelte-1quw1g"></span>',g(t,"class","svelte-1quw1g")},m(n,r){u(n,t,r)},p:a,d(n){n&&f(t)}}}function ce(e){return{c:a,m:a,p:a,d:a}}function le(e){let t,n,r={ctx:e,current:null,token:null,hasCatch:!1,pending:ce,then:oe,catch:re,value:7};return y(n=e[2](),r),{c(){t=F(),r.block.c()},m(o,s){u(o,t,s),r.block.m(o,r.anchor=s),r.mount=()=>t.parentNode,r.anchor=t},p(o,[s]){e=o,C(r,e,s)},i:a,o:a,d(o){o&&f(t),r.block.d(o),r.token=null,r=null}}}function ue(e,t,n){let{isOnLadder:r}=t,{toggleLadder:o}=t,s;async function i(){n(0,s=await r())}let c;function l(){n(0,s=!s),n(1,c=o(s)),U("ladder","opt in/out")}function ne(){s=this.checked,n(0,s)}return e.$$set=k=>{"isOnLadder"in k&&n(4,r=k.isOnLadder),"toggleLadder"in k&&n(5,o=k.toggleLadder)},[s,c,i,l,r,o,ne]}var ee=class extends X{constructor(t){super();Q(this,t,ue,le,J,{isOnLadder:4,toggleLadder:5})}},te=ee;function _(e){return N(B({cmd:"settings"},e))}function R(e){return _({subcmd:"flags",flags:e.map(t=>t?1:0)})}var fe=["ui_preference_11","ui_preference_15","disable_wordcensor","ui_preference_30","ui_preference_21","ui_preference_33","ui_preference_23"];function D(e){return x(e)?{s:!1,r:{e:"Could not connect to FS servers"}}:!1}async function me(e,t){let n=await e;if(!x(n)&&n!==!1)return n;let r=await p(t);return D(r)}async function de(){let e=await p({cmd:"settings"}),t=D(e);return t||e}function pe(e,t){let n=new FormData(e);return n.append("pvp_ladder",t),Object.fromEntries(n.entries())}function ge(e,t){let n=new FormData(e);return fe.forEach((r,o)=>n.set(r,t[o+1])),Object.fromEntries(n.entries())}async function O(e){let t=await de(),n=D(t);if(n)return n;let r=w(t),o=pe(r.forms[0],e[0]),s=ge(r.forms[2],e),i=await[o,s].reduce(me,Promise.resolve());return i===!1?{s:!0}:i}function P(e){return L(R,O,e)}var _e=[{name:"ca_default",id:54},{name:"sc_default",id:101},{name:"nv_default",id:60},{name:"barricade_default",id:98}];function he(e){let t=e.getAll("blockedSkillList[]").map(n=>({id:parseInt(n,10),blocked:!0,level:0}));return _e.forEach(n=>{let r=t.findIndex(o=>o.id===t.id);r===-1?t.push({id:parseInt(n.id,10),blocked:!1,level:e.get(n.name)}):t[r].level=e.get(n.name)}),t}function ke(e){return[...e.entries()].filter(n=>n[0].startsWith("discardPref")).map(n=>({id:parseInt(n[0][n[0].length-1],10),action:parseInt(n[1],10)}))}function be(e){return[e[0].get("pvp_ladder")==="1",e[2].get("ui_preference_11")==="1",e[2].get("ui_preference_15")==="1",e[2].get("disable_wordcensor")==="1",e[2].get("ui_preference_30")==="1",e[2].get("ui_preference_21")==="1",e[2].get("ui_preference_33")==="1",e[2].get("ui_preference_23")==="1"]}function we(e){return{s:!0,r:{skills:he(e[4]),item_drop_rarity:ke(e[1]),flags:be(e),min_group_join_level:parseInt(e[0].get("min_group_level"),10),item_drop_discard_level:parseInt(e[1].get("auto_discard_level"),10),player_block_type:parseInt(e[2].get("block_level"),10)}}}async function V(){let e=await p({cmd:"settings"});if(!e)return{s:!1,e:{message:"Could not connect to FS servers",code:1}};let n=[...w(e).forms].map(r=>new FormData(r));return we(n)}function q(){return _({subcmd:"view"})}function T(){return L(q,V)}var h;async function Le(){return h=(await T()).r?.flags,h?.[0]}async function ve(e){if(M(h))return h[0]=e,P(h)}function ye(e){return new te({props:{toggleLadder:ve,isOnLadder:Le},target:e})}function j(){if(d("optInOnLadderPage")){let e=b("#pCC table tbody");ye(e)}}function xe(e){let t=Math.floor((I-e)/6e4),n=Math.floor(t/60);return t%=60,`${Z(n," hours, ")+t} mins`}function Se(){let e=d(E);return e<I-48*60*60*1e3?'<span class="fshLink tip-static" data-tipped="FSH has not seen the last ladder reset.<br>You can find it in your log if you qualified<br>or Tavern Rumours.">???</span>':xe(e)}function Ie(e){let t=e.insertCell(-1);t.height=25,G("Last Reset:",t)}function Fe(e){let t=e.insertCell(-1);t.align="right",W(Se(),t)}function Ae(){let e=b("#pCC table");if(!e)return;let t=e.insertRow(-1);Ie(t),Fe(t)}function H(){d("trackLadderReset")&&Ae()}function Ce(){Y(),H(),j()}export{Ce as default};
//# sourceMappingURL=ladder-GJZZA5WB.js.map
