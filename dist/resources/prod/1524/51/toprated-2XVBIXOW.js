import{a as Z}from"./chunk-C4WCULZL.js";import{a as Y}from"./chunk-S32GZNLH.js";import{a as X}from"./chunk-X54ETEQC.js";import{a as K}from"./chunk-4V44BINA.js";import"./chunk-QNPSGVM3.js";import{a as J}from"./chunk-KC3JUT6W.js";import"./chunk-YW6SRUBN.js";import{a as M,b as O}from"./chunk-NM4URYPM.js";import{a as Q}from"./chunk-Y2JX5GQ6.js";import"./chunk-2WUGIKWH.js";import"./chunk-33B54EL4.js";import{b as F}from"./chunk-2MSFZ3SC.js";import"./chunk-KWIXRSMY.js";import"./chunk-CPUCL5KC.js";import{a as $}from"./chunk-X5ZSXFJV.js";import{a as q}from"./chunk-MF5UI2DL.js";import{a as D}from"./chunk-OFZ4M2H7.js";import{b as a}from"./chunk-6MUFX5NS.js";import{a as U}from"./chunk-UWKUUDVQ.js";import"./chunk-WDK5KJW5.js";import{a as L}from"./chunk-6VZYKCGK.js";import{b as n}from"./chunk-MHANGBVH.js";import"./chunk-LVNLH6ER.js";import{a as C}from"./chunk-ZZS3NLOT.js";import{a as B}from"./chunk-57PZ6XJI.js";import{a as z}from"./chunk-KF3ZZECL.js";import{a as l}from"./chunk-AN443625.js";import"./chunk-UICWONBW.js";import{a as S}from"./chunk-ZLI5KJBW.js";import"./chunk-EUBCJC2U.js";import{a as V}from"./chunk-UWAT3VA7.js";import"./chunk-7GAPHNBH.js";import{a as m}from"./chunk-WV4YXE4F.js";import"./chunk-ND3XCMOS.js";import{a as _}from"./chunk-74YALW75.js";import{a as R}from"./chunk-WPRJK6Q2.js";import{a as H}from"./chunk-PJ32ASZ7.js";import"./chunk-F5QOVYT2.js";import"./chunk-R5ZZQ5HH.js";import"./chunk-PO34EML4.js";import"./chunk-QFSH2B2J.js";import"./chunk-2PFHY365.js";import{a as W}from"./chunk-QVQPQPMX.js";import{a as j}from"./chunk-ZDFDMUO4.js";import"./chunk-2V5OQ7JE.js";import"./chunk-GGKSIQST.js";import"./chunk-JSWEJZHY.js";import"./chunk-JZLUF437.js";import{a as k}from"./chunk-G3O526VI.js";import"./chunk-GHQYBWLT.js";import{a as I}from"./chunk-N2KVYLIG.js";import"./chunk-PKDG64MH.js";import{a as b}from"./chunk-2B42SRXB.js";import"./chunk-3IGXKFMQ.js";import"./chunk-TDNJGM62.js";import"./chunk-TP7JP7VV.js";import{b as N}from"./chunk-HAINOYE5.js";import"./chunk-AN5TC666.js";import{a as A}from"./chunk-B7PLPUHK.js";import{h as G,sa as E}from"./chunk-YNXRNCRL.js";import"./chunk-7DPOBF7C.js";import{a as i}from"./chunk-DEDCEYVR.js";function f(e){return j({cmd:"findplayer",subcmd:"view",search_username:e})}function le(e){let t=e.last_login;return t||(t=0),{r:[{last_activity:Number(t),vl:e.virtual_level}],s:!0}}function s(e){return K(e).then(le)}function u(e){return m(f,s,e)}function c(e){return Y({subcmd:"view",guild_id:e})}function p(e){return m(c,Z,e)}function d(){return W({subcmd:"view"})}async function g(){let e=await H({cmd:"profile"}),t=R(e),r=b("stat-vl",t);if(!r)return{s:!1};let o=Number(l(r));return{r:{last_activity:0,virtual_level:o},s:!0}}function h(){return m(d,g)}function me(e){return e.rows[0].cells[0].children[0]?Number(G.exec(e.rows[0].cells[0].children[0].href)[1]):-1}function ae(e){return[e,l(e),me(e)]}function fe(e,t){return t[0]===e[2]}function se(e,t){let r=e.find(i(fe,t));return r?r[1].push(t):e.push([t[2],[t]]),e}function ue(e,t){return t[0]===e}function ce(e,t){let r=t[0];t[1].length<5&&(r=-1);let o=e.find(i(ue,r));return o?o[1]=o[1].concat(t[1]):e.push([r,t[1]]),e}function y(){return B(E,n).slice(4).map(ae).reduce(se,[]).reduce(ce,[])}function pe(e,t){return e?t[e]:t}function de(e,t,r){let o=pe(e,r);if(!t[o])return t[o]=!0,!0}function v(e,t){return e.filter(i(de,t,{}))}var P,ee,ge=[()=>P,e=>A(e)||e!==ee,(e,t)=>t.last_login>=a-604800,(e,t)=>t.virtual_level>=M(),(e,t)=>t.virtual_level<=O()];function he(e,t){return ge.every(r=>r(e,t))}function te(e,t,r){S(e.rows[0],`<td>${F({last_login:r.last_login})}</td>`),he(t,r)&&e.parentNode.parentNode.classList.add("lvlHighlight")}function re(){P=N("highlightPlayersNearMyLvl"),P&&(ee=D())}var w;function ie(){q(w)}function ne(e){z(e),w=$({className:"fshCurveContainer fshTopListSpinner",innerHTML:'<div class="fshCurveEle fshCurveLbl fshOldSpinner"></div>'}),e.parentNode.replaceChild(w,e)}function x(e,t){te(e[0],e[2],{last_login:String(t.last_activity),virtual_level:t.vl})}function ye(e,t){return t.name===e[1]}function ve(e,t){let r=e.find(i(ye,t));r&&x(t,r)}function Pe(e,t){t&&t.s&&_(t.r)&&t.r.length>0&&x(e,t.r[0])}function we(e,t){t.s&&x(e,{last_activity:a-t.r.last_activity,vl:t.r.virtual_level})}function xe(e){return e[0]!==-1}function Te(e,t){return e.concat(t.members)}function _e(e,t){let r=v(t.r.ranks,"id").reduce(Te,[]);e[1].forEach(i(ve,r))}function Ae(e,t){t.s&&_e(e,t)}function Ge(e){return p(e[0]).then(i(Ae,e))}function oe(e){return e[0]===-1}function Ee(e){return e[1]!==L()?u(e[1]).then(i(Pe,e)):h().then(i(we,e))}function Ne(){let e=y(),t=e.filter(xe).map(Ge);e.find(oe)&&(t=t.concat(e.find(oe)[1].map(Ee))),J(t,ie)}function T(e){I("toprated","FindOnlinePlayers"),ne(e.target),re(),Ne()}function be(){let e=V("td",n)[0];e.children[0].className="fshTopListWrap";let t=C({id:"fshFindOnlinePlayers",className:"custombutton tip-static",type:"button",value:"Find Online Players",dataset:{tipped:"Fetch the online status of the top 250 players (warning ... takes a few seconds)."}});Q(e,t),k(t,T)}var Se=[()=>U(),()=>n,()=>n.children[0],()=>n.children[0].rows,()=>n.children[0].rows.length>2,()=>l(n.children[0].rows[1]).startsWith("Last Updated")];function Ve(){return Se.every(X)}function Be(){Ve()&&be()}export{Be as default};
//# sourceMappingURL=toprated-2XVBIXOW.js.map
