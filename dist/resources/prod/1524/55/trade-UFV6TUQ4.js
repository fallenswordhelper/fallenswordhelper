import{a as p}from"./chunk-CEVHBQFT.js";import{a as P}from"./chunk-D65MS542.js";import{a as x,b as j}from"./chunk-Q7KIVIXK.js";import"./chunk-KUBU4FUY.js";import{a as M}from"./chunk-SYBFMZDX.js";import"./chunk-TMJAPDRO.js";import{b as q,c as D}from"./chunk-F3MT6GZT.js";import"./chunk-TSMIPOI7.js";import"./chunk-R4CFGI6O.js";import{a as H}from"./chunk-RAXXQ6UC.js";import{a as w}from"./chunk-KDR3X5WK.js";import{a as L}from"./chunk-PPMECO73.js";import{a as $}from"./chunk-RT5GGQZO.js";import"./chunk-I3HDBAJB.js";import{a as y}from"./chunk-3IZSRBVW.js";import{a as b}from"./chunk-WKB7UAH3.js";import{a}from"./chunk-VVT2NY3X.js";import{a as F}from"./chunk-IYE3RCAT.js";import{a as h}from"./chunk-MF5BZBCN.js";import"./chunk-EQNCUII2.js";import"./chunk-5NIAUQBB.js";import{a as T}from"./chunk-FIYDSWPU.js";import"./chunk-3LVRLS3W.js";import{a as i}from"./chunk-4JORPG32.js";import"./chunk-OO7D5SQF.js";import{a as A}from"./chunk-CRUEJ3F6.js";import"./chunk-SKB75UHJ.js";import"./chunk-D6P46ZXI.js";import{a as s}from"./chunk-W5X6D6BY.js";import{a as v}from"./chunk-ZD6KR2JJ.js";import{a as N}from"./chunk-TV5KWDG5.js";import"./chunk-EXPYEXEP.js";import"./chunk-LJSNN3UL.js";import"./chunk-375QMJKQ.js";import{a as O}from"./chunk-ZACGLTFX.js";import"./chunk-QJQL33BB.js";import"./chunk-FMNM33OL.js";import"./chunk-DPUM55LY.js";import"./chunk-CJ5MYL4D.js";import"./chunk-BPJKI26M.js";import"./chunk-7FXPMHZ5.js";import"./chunk-TUWDUCWH.js";import"./chunk-TEW6YNEY.js";import{a as m}from"./chunk-BXVF4M5G.js";import"./chunk-SNSTWQSS.js";import"./chunk-B5XQQNQZ.js";import{a as n}from"./chunk-OCPSJVCN.js";import"./chunk-NIYIBTJZ.js";import"./chunk-V5W6AOGE.js";import{a as C}from"./chunk-LFCR6ZTM.js";import{a as d}from"./chunk-6UVNJJZQ.js";import"./chunk-Z4OUE4BH.js";import"./chunk-CN4P2KLK.js";import{a as E,b as f}from"./chunk-XJX3OTSZ.js";import{a as u}from"./chunk-GUUYKSUL.js";import"./chunk-D6HZ4P35.js";import{sa as l}from"./chunk-E72VSDOE.js";import"./chunk-U4WGNCSF.js";import{a as c}from"./chunk-3XQ73JET.js";var k;function W(){let e=n("item-div");if(!e){e=N({id:"item-div",className:"itemDiv"});let t=n("item-list"),o=T(l,t);for(;o.length;)o[0].classList.add("fshBlock"),v(e,o[0]);a(e,t)}return e}function Q(e,t,o){return e&&A(t,o)}function z(e,t,o){return!e&&!t&&!o}function G(e,t){t.children[0].lastElementChild.children[0].children[0].checked=!1;let o=s("fshHide",t),r=e==="folderid0",S=s(e,t);Q(o,r,S)&&(t.classList.remove("fshHide"),t.classList.add("fshBlock")),z(o,r,S)&&(t.classList.remove("fshBlock"),w(t))}function J(e){h(l,W()).forEach(c(G,e.target.id))}function K(e){e.target.nodeName==="SPAN"&&e.target.id.indexOf("folderid")!==-1&&J(e)}function U(e){return` &ensp;<span id="folderid${e[0]}" class="fshLink fshNoWrap" fid=${e[0]}>${e[1]}</span> `}function X(e){let t=p({id:"fshFolderSelect",innerHTML:`<td colspan=6><span id="folderid0" class="fshLink" fid=0>All</span> &ensp;<span id="folderid-1" class="fshLink" fid="-1">Main</span>${C(e).map(U).join("")}`});m(t,K);let o=n("item-list").parentNode.parentNode;F(o,'<tr id="fshShowSTs"><td align="center" colspan=6><label><input type="checkbox" id="itemsInSt" checked> Select items in ST</label></td></tr>'),a(t,o)}function Y(e,t){t.is_in_st&&e.classList.add("isInST")}function Z(e){let t=e.children[0].lastElementChild.children[0];if(!t)return;let o=t.children[0];if(!o)return;let r=k[o.getAttribute("value")];r&&(e.classList.add(`folderid${r.folder_id}`),k.fshHasST&&Y(e,r),o.classList.add(`itemid${r.item_id}`),o.classList.add(`itemtype${r.type}`))}function ee(e){let t=f("betaOptIn");t&&q("trade.processTrade"),k=e.items,h(l,n("item-list")).forEach(Z),X(e.folders),t&&D("trade.processTrade")}function te(e){i(3,ee,[e])}function g(){$()||M().then(te)}function I(e,t){return O(x,j,e,t)}async function oe(e,t){let o=await e;return console.log("promise data",o),o===null||o.s?I(t[0],t[1]):o}async function ne(){let e=y('form[name="sendItemForm"] [name="target_username"]'),o=await d('[name="sendItemList[]"]:checked').map(r=>[e.value,[r.value]]).reduce(oe,Promise.resolve(null));console.log("finalResult",o)}function B(){let e=y('form[name="sendItemForm"] input[value="Send"]'),t=H({className:"fshBl",id:"oneByOneBtn",textContent:"OneByOne",type:"button"});P(t,e),m(t,ne)}function re(e){let t=parseInt(n("fshSendHowMany").value,10);return b(t)?e.length:u.subcmd!=="-"?Math.min(100,t):t}function se(e,t){return e==="itemid-2"&&s("itemtype12",t)}function ie(e,t){return e==="itemid-1"||se(e,t)||s(e,t)}function me(){let e=n("itemsInSt");if(e)return e.checked}function ce(e,t){return e||!s("isInST",t)}function _(e){return e.children[0].lastElementChild.children[0].children[0]}function R(e,t){t.checked=e}function ae(e){R(!1,e)}function le(e){R(!0,e)}function fe(e,t){t.filter(c(ce,me())).map(_).filter(c(ie,e)).slice(0,re(t)).forEach(le)}function de(e){let t=n("item-div")||n("item-list"),o=d("table:not(.fshHide)",t);o.map(_).forEach(ae),fe(e.target.id,o)}function pe(e){s("fshCheckAll",e.target)&&de(e)}function V(e){return L(`[${e}]`)}function ue(){let e=f("sendClasses"),t=V(e);return t||V(E.sendClasses)}function he(e){return` &ensp;<span id="itemid${e[1]}" class="fshCheckAll fshLink fshNoWrap">${e[0]}</span>`}function ye(e){let t=p({id:"fshSelectMultiple",innerHTML:`<td colspan=6>Select:&ensp;<span id="itemid-1" class="fshCheckAll fshLink fshNoWrap">All Items</span> &ensp;<span id="itemid-2" class="fshCheckAll fshLink fshNoWrap">All Resources</span>${ue().map(he).join("")} &ensp;How&nbsp;many:<input id="fshSendHowMany" type="text" class="custominput fshHowMany" value="all"></td>`});m(t,pe),a(t,e.parentNode.parentNode)}function ke(){let e=n("item-list");!e||(i(3,g),i(3,ye,[e]),u.userIsDev&&i(3,B))}export{ke as default};
//# sourceMappingURL=trade-UFV6TUQ4.js.map
