import{a as X}from"./chunk-DKJUAPET.js";import{a as Q}from"./chunk-FGF45BX5.js";import"./chunk-B2CV3LZL.js";import{O as y,P as F,T as J,U as K,a as s,b as U,d as Y,o as v,p as u,q as m,s as p,u as z,v as I,w as A,y as g}from"./chunk-672ZPAPS.js";import{a as C}from"./chunk-EO5XDEZO.js";import{a as S}from"./chunk-2A2BOA2Y.js";import{a as b}from"./chunk-3IZSRBVW.js";import{a as x}from"./chunk-R6SLBHCS.js";import"./chunk-WZOINAX5.js";import"./chunk-RLNK6TGZ.js";import{a as G}from"./chunk-JQN7MVS5.js";import{a as M}from"./chunk-OO7D5SQF.js";import{a as L}from"./chunk-ZACGLTFX.js";import{a as N}from"./chunk-QJQL33BB.js";import{a as B}from"./chunk-FMNM33OL.js";import{a as w}from"./chunk-DPUM55LY.js";import{a as d}from"./chunk-CJ5MYL4D.js";import"./chunk-BPJKI26M.js";import"./chunk-7FXPMHZ5.js";import"./chunk-TUWDUCWH.js";import"./chunk-TEW6YNEY.js";import{a as E}from"./chunk-BUYHT5WE.js";import"./chunk-SNSTWQSS.js";import{a as W}from"./chunk-LFXZGYGZ.js";import"./chunk-B5XQQNQZ.js";import"./chunk-OCPSJVCN.js";import"./chunk-NIYIBTJZ.js";import"./chunk-V5W6AOGE.js";import"./chunk-LFCR6ZTM.js";import{b as f}from"./chunk-XJX3OTSZ.js";import"./chunk-GUUYKSUL.js";import"./chunk-D6HZ4P35.js";import{ra as H}from"./chunk-E72VSDOE.js";import"./chunk-U4WGNCSF.js";import"./chunk-3XQ73JET.js";function ne(e){return{c:s,m:s,p:s,d:s}}function re(e){let t=x(e[0]),n,r=t&&Z(e);return{c(){r&&r.c(),n=I()},m(o,i){r&&r.m(o,i),u(o,n,i)},p(o,i){i&1&&(t=x(o[0])),t?r?r.p(o,i):(r=Z(o),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},d(o){r&&r.d(o),o&&m(n)}}}function Z(e){let t,n,r,o,i,a={ctx:e,current:null,token:null,hasCatch:!1,pending:se,then:ie,catch:oe};return y(i=e[1],a),{c(){t=p("tr"),n=p("td"),n.innerHTML='<span data-tooltip="Ticking this box opts you in to the PVP Ladder, unticking it will remove you from the PVP Ladder." class="svelte-1quw1g">PvP Ladder Opt-in:</span>',r=z(),o=p("td"),a.block.c(),g(n,"class","svelte-1quw1g"),g(o,"class","svelte-1quw1g")},m(l,c){u(l,t,c),v(t,n),v(t,r),v(t,o),a.block.m(o,a.anchor=null),a.mount=()=>o,a.anchor=null},p(l,c){e=l,a.ctx=e,c&2&&i!==(i=e[1])&&y(i,a)||F(a,e,c)},d(l){l&&m(t),a.block.d(),a.token=null,a=null}}}function oe(e){return{c:s,m:s,p:s,d:s}}function ie(e){let t,n,r;return{c(){t=p("input"),g(t,"type","checkbox")},m(o,i){u(o,t,i),t.checked=e[0],n||(r=[A(t,"change",e[6]),A(t,"click",e[3])],n=!0)},p(o,i){i&1&&(t.checked=o[0])},d(o){o&&m(t),n=!1,U(r)}}}function se(e){let t;return{c(){t=p("div"),t.innerHTML='<span class="fshSpinner fshSpinner12 svelte-1quw1g"></span>',g(t,"class","svelte-1quw1g")},m(n,r){u(n,t,r)},p:s,d(n){n&&m(t)}}}function ae(e){return{c:s,m:s,p:s,d:s}}function le(e){let t,n,r={ctx:e,current:null,token:null,hasCatch:!1,pending:ae,then:re,catch:ne,value:7};return y(n=e[2](),r),{c(){t=I(),r.block.c()},m(o,i){u(o,t,i),r.block.m(o,r.anchor=i),r.mount=()=>t.parentNode,r.anchor=t},p(o,[i]){e=o,F(r,e,i)},i:s,o:s,d(o){o&&m(t),r.block.d(o),r.token=null,r=null}}}function ce(e,t,n){let{isOnLadder:r}=t,{toggleLadder:o}=t,i;async function a(){n(0,i=await r())}let l;function c(){n(0,i=!i),n(1,l=o(i)),W("ladder","opt in/out")}function te(){i=this.checked,n(0,i)}return e.$$set=k=>{"isOnLadder"in k&&n(4,r=k.isOnLadder),"toggleLadder"in k&&n(5,o=k.toggleLadder)},[i,l,a,c,r,o,te]}var $=class extends K{constructor(t){super();J(this,t,ce,le,Y,{isOnLadder:4,toggleLadder:5})}},ee=$;function _(e){return N(B({cmd:"settings"},e))}function R(e){return _({subcmd:"flags",flags:e.map(t=>t?1:0)})}var ue=["ui_preference_11","ui_preference_15","disable_wordcensor","ui_preference_30","ui_preference_21","ui_preference_33","ui_preference_23"];function me(e,t){let n=new FormData(e);return n.append("pvp_ladder",t),C(n.entries())}function pe(e,t){let n=new FormData(e);return ue.forEach((r,o)=>n.set(r,t[o+1])),C(n.entries())}async function D(e){let t=await d({cmd:"settings"}),n=w(t),r=me(n.forms[0],e[0]),o=pe(n.forms[2],e);return await Promise.all([r,o].map(i=>d(i))),{s:!0}}function P(e){return L(R,D,e)}var fe=[{name:"ca_default",id:54},{name:"sc_default",id:101},{name:"nv_default",id:60},{name:"barricade_default",id:98}];function de(e){let t=e.getAll("blockedSkillList[]").map(n=>({id:parseInt(n,10),blocked:!0,level:0}));return fe.forEach(n=>{let r=t.findIndex(o=>o.id===t.id);r===-1?t.push({id:parseInt(n.id,10),blocked:!1,level:e.get(n.name)}):t[r].level=e.get(n.name)}),t}function ge(e){return[...e.entries()].filter(n=>n[0].startsWith("discardPref")).map(n=>({id:parseInt(n[0][n[0].length-1],10),action:parseInt(n[1],10)}))}function _e(e){return[e[0].get("pvp_ladder")==="1",e[2].get("ui_preference_11")==="1",e[2].get("ui_preference_15")==="1",e[2].get("disable_wordcensor")==="1",e[2].get("ui_preference_30")==="1",e[2].get("ui_preference_21")==="1",e[2].get("ui_preference_33")==="1",e[2].get("ui_preference_23")==="1"]}function he(e){return{s:!0,r:{skills:de(e[4]),item_drop_rarity:ge(e[1]),flags:_e(e),min_group_join_level:parseInt(e[0].get("min_group_level"),10),item_drop_discard_level:parseInt(e[1].get("auto_discard_level"),10),player_block_type:parseInt(e[2].get("block_level"),10)}}}async function V(){let e=await d({cmd:"settings"});if(!e)return{s:!1,e:{message:"Could not connect to FS servers",code:1}};let n=[...w(e).forms].map(r=>new FormData(r));return he(n)}function q(){return _({subcmd:"view"})}function O(){return L(q,V)}var h;async function ke(){return h=(await O()).r?.flags,h?.[0]}async function be(e){if(M(h))return h[0]=e,P(h)}function we(e){return new ee({props:{toggleLadder:be,isOnLadder:ke},target:e})}function T(){if(f("optInOnLadderPage")){let e=b("#pCC table tbody");we(e)}}function Le(e){let t=Math.floor((S-e)/6e4),n=Math.floor(t/60);return t%=60,`${X(n," hours, ")+t} mins`}function ve(){let e=f(H);return e<S-48*60*60*1e3?'<span class="fshLink tip-static" data-tipped="FSH has not seen the last ladder reset.<br>You can find it in your log if you qualified<br>or Tavern Rumours.">???</span>':Le(e)}function ye(e){let t=e.insertCell(-1);t.height=25,G("Last Reset:",t)}function xe(e){let t=e.insertCell(-1);t.align="right",E(ve(),t)}function Se(){let e=b("#pCC table");if(!e)return;let t=e.insertRow(-1);ye(t),xe(t)}function j(){f("trackLadderReset")&&Se()}function Ie(){Q(),j(),T()}export{Ie as default};
//# sourceMappingURL=ladder-2RTHAFWV.js.map
