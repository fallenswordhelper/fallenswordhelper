import{a as qt}from"./chunk-LALOF5LD.js";import{A as W,B as z,E as xt,F as kt,b as yt,c as bt,e as o,f as N,g as $,i as d,j as w,k as I,m as P,n as vt,o as f,p as G,q as R,r as V,s as i,w as It,x as wt,y as _t,z as E}from"./chunk-GFRUEC27.js";import{a as Mt}from"./chunk-AUMQSEYC.js";import{a as mt}from"./chunk-ZUHJWTKY.js";import{a as S}from"./chunk-EHLYPUDG.js";import{b as ut}from"./chunk-TMMBKVUE.js";import{a as ft}from"./chunk-J6TJ2S7E.js";import{a as gt}from"./chunk-R3QPGR5M.js";import"./chunk-LWPHQG2H.js";import{a as ht}from"./chunk-AQKFNZOY.js";import"./chunk-OAQ3GOTA.js";import"./chunk-M5ZN4Z2N.js";import"./chunk-6R6RPTTO.js";import{a as pt}from"./chunk-UU6HXUOC.js";import"./chunk-4KMRATSZ.js";import{a as lt}from"./chunk-BM4FUEFL.js";import"./chunk-PKECKIP5.js";import"./chunk-BSKCRAT3.js";import"./chunk-MDOXDTXF.js";import{a as dt}from"./chunk-FLC7HS56.js";import"./chunk-N3R6MXRE.js";import"./chunk-PX7MLT6T.js";import"./chunk-QPRB5F5E.js";import"./chunk-NOLCAT6N.js";import"./chunk-QHU4ICCH.js";import{a as Q}from"./chunk-OOUI3CKV.js";import"./chunk-JROAODNJ.js";import"./chunk-SHVFOAM5.js";import"./chunk-N56IAE2U.js";import{a as F}from"./chunk-O5NIYLDT.js";import"./chunk-EEHLAE3S.js";import"./chunk-ISL3KEXS.js";import{a as at}from"./chunk-FE4PDZXL.js";import"./chunk-VMJ6DXBZ.js";import"./chunk-3PDILZ3R.js";import"./chunk-3WAX2TNR.js";import{V as st,n as ct}from"./chunk-4P4O4YGO.js";import{b as it}from"./chunk-KTAAKVTB.js";import"./chunk-RH5336H4.js";function H(e){return dt({cmd:"inventing",subcmd:"doinvent",recipe_id:e})}function Rt(e){let t=gt(e);return t.includes("successfully")?{r:{item:{}},s:!0}:{e:{message:t},s:!1}}function U(e){return pt({cmd:"inventing",subcmd:"doinvent",recipe_id:e}).then(Rt)}function Z(e){return ht(H,U,e)}function Ot(e){let t=e-1;return t*t*t+1}function J(e,{delay:t=0,duration:n=400,easing:p=Ot}={}){let r=getComputedStyle(e),m=+r.opacity,s=parseFloat(r.height),h=parseFloat(r.paddingTop),c=parseFloat(r.paddingBottom),y=parseFloat(r.marginTop),b=parseFloat(r.marginBottom),k=parseFloat(r.borderTopWidth),g=parseFloat(r.borderBottomWidth);return{delay:t,duration:n,easing:p,css:u=>`overflow: hidden;opacity: ${Math.min(u*20,1)*m};height: ${u*s}px;padding-top: ${u*h}px;padding-bottom: ${u*c}px;margin-top: ${u*y}px;margin-bottom: ${u*b}px;border-top-width: ${u*k}px;border-bottom-width: ${u*g}px;`}}function Ct(e){let t,n,p,r,m,s,h;return{c(){t=d("div"),n=d("div"),n.textContent="INFORMATION",p=I(),r=d("div"),m=w(e[4]),i(n,"background","#8E8668"),i(n,"color","#FFF"),i(n,"font-size","smaller"),i(t,"border","2px solid #FFF"),i(t,"margin","10px auto"),i(t,"width","80%"),i(t,"background","#D3CFC1")},m(c,y){N(c,t,y),o(t,n),o(t,p),o(t,r),o(r,m),h=!0},p(c,y){(!h||y&16)&&R(m,c[4])},i(c){h||(c&&It(()=>{s||(s=z(t,J,{},!0)),s.run(1)}),h=!0)},o(c){c&&(s||(s=z(t,J,{},!1)),s.run(0)),h=!1},d(c){c&&$(t),c&&s&&s.end()}}}function Pt(e){let t,n,p,r,m,s,h,c,y,b,k,g,u,_,x,A=e[1]+e[2]+"",M,q,D,tt,j,O,et,T,nt,C,ot,B,L,rt,a=e[4]&&Ct(e);return{c(){t=d("form"),n=d("label"),n.textContent="Select how many to quick invent",p=I(),r=d("input"),m=I(),s=d("button"),s.textContent="(max)",h=I(),c=d("input"),y=I(),b=d("div"),a&&a.c(),k=I(),g=d("div"),u=d("div"),_=I(),x=d("p"),M=w(A),q=w(" / "),D=w(e[0]),tt=I(),j=d("div"),O=d("div"),et=w("Successes: "),T=w(e[1]),nt=I(),C=d("div"),ot=w("Failures: "),B=w(e[2]),f(n,"for","quick-invent-amount"),f(r,"type","number"),f(r,"id","quick-invent-amount"),f(r,"name","quick-invent-amount"),f(r,"min","0"),f(r,"step","1"),f(r,"class","custominput fshNumberInput"),r.required=!0,f(s,"type","button"),f(s,"class","fshBl"),f(c,"class","custombutton"),f(c,"type","submit"),c.value="Quick Invent",i(c,"margin-left","8px"),f(u,"class","composing-progress-bar"),i(u,"background-position","right top"),i(u,"width",e[3]+"%"),i(u,"transition","width 0.4s ease-out"),i(u,"position","absolute"),i(u,"top","0px"),i(x,"position","relative"),f(g,"class","composing-progress"),i(g,"margin","0px auto"),i(g,"font-weight","bold"),i(g,"color","#fff"),i(g,"left","0px"),i(O,"display","inline-block"),i(O,"width","250px"),f(O,"class","fshQs fshGreen"),i(C,"display","inline-block"),i(C,"width","250px"),f(C,"class","fshQs fshRed"),i(j,"margin-top","36px"),f(t,"class","fshCenter"),i(t,"margin-top","12px")},m(l,v){N(l,t,v),o(t,n),o(t,p),o(t,r),V(r,e[0]),o(t,m),o(t,s),o(t,h),o(t,c),o(t,y),o(t,b),a&&a.m(b,null),o(b,k),o(b,g),o(g,u),o(g,_),o(g,x),o(x,M),o(x,q),o(x,D),o(b,tt),o(b,j),o(j,O),o(O,et),o(O,T),o(j,nt),o(j,C),o(C,ot),o(C,B),L||(rt=[P(r,"input",e[9]),P(s,"click",e[5]),P(t,"submit",vt(e[6]))],L=!0)},p(l,[v]){v&1&&G(r.value)!==l[0]&&V(r,l[0]),l[4]?a?(a.p(l,v),v&16&&E(a,1)):(a=Ct(l),a.c(),E(a,1),a.m(b,k)):a&&(wt(),W(a,1,1,()=>{a=null}),_t()),v&8&&i(u,"width",l[3]+"%"),v&6&&A!==(A=l[1]+l[2]+"")&&R(M,A),v&1&&R(D,l[0]),v&2&&R(T,l[1]),v&4&&R(B,l[2])},i(l){E(a)},o(l){W(a)},d(l){l&&$(t),a&&a.d(),L=!1,yt(rt)}}}function Et(e,t,n){let{max:p}=t,{recipeID:r}=t,m=1,s=0,h=0,c=0,y="";function b(){n(1,s=0),n(2,h=0),n(3,c=0),n(4,y="")}function k(){n(0,m=p),Q("inventing","maxInventButton")}async function g(){if(Q("inventing","quickInvent"),!m)return;b(),Array(m).fill(r).reduce(async(x,A)=>{let M=await x;if(!M||M.s===!0){let q=await Z(A);return q.s===!1?n(4,y=q.e.message):q.r.success_count>0?n(1,s+=1):n(2,h+=1),n(3,c=100*((s+h)/m)),q}return M},Promise.resolve())}function u(){m=G(this.value),n(0,m)}return e.$$set=_=>{"max"in _&&n(7,p=_.max),"recipeID"in _&&n(8,r=_.recipeID)},[m,s,h,c,y,k,g,p,r,u]}var St=class extends kt{constructor(t){super();xt(this,t,Et,Pt,bt,{max:7,recipeID:8})}},At=St;function Dt(e){let[t,n]=at(S("tr:nth-child(2) td",e)).split("/").map(p=>parseInt(p,10));return{have:t,need:n,id:S("img",e).src.match(/(\d+)\.[A-Za-z]+$/)[1]}}function Tt(){return F(`#pCC td[background^="${it}ui/inventory/"]`).map(t=>t.parentElement.parentElement).map(Dt)}function K(){return Tt().reduce((t,n)=>Math.min(t,Math.floor(n.have/n.need)),1/0)}function Bt(e,t){return new At({props:e,target:t})}function Lt(e){let n=e.insertRow(-1).insertCell(-1);n.className="header",n.setAttribute("height","1")}function Qt(e){let n=e.insertRow(-1).insertCell(-1);return n.className="fshCenter",n}function X(){let e=S('input[name="recipe_id"]');if(!e)return;let t=K(),n=ut.lastElementChild;Lt(n),Bt({max:t,recipeID:e.value},Qt(n))}function Nt(e){if(!e)return;let t=e.src.match(/\/items\/(\d+)\.gif/);if(t)return t[1]}function $t(e){return`${st}items${ct}view&item_id=${e}`}function Gt(e){return Mt({href:$t(e),target:"_blank"})}function jt(e,t){let n=Nt(t);if(!n)return;let p=Gt(n);ft(p,e),lt(p,e)}function Vt(e){jt(e,e)}function Wt(){let e=qt('.//b[.="Target Invention"]/../../following-sibling::*[1]//img'),t=S("#pCC b");jt(t,e)}function zt(){F('#pCC img[src*="/items/"]').forEach(Vt)}function Y(){Wt(),zt()}function Ht(){mt()&&(Y(),X())}export{Ht as default};
//# sourceMappingURL=inventing-2DKSVRIG.js.map
