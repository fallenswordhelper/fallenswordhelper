import{a as p}from"./chunk-2LDZK4DH.js";import{a as P}from"./chunk-33TRSIDJ.js";import{a as x,b as j}from"./chunk-6UEIGR3U.js";import"./chunk-JVRXDCFF.js";import{a as M}from"./chunk-YB2R7N6U.js";import"./chunk-KNB5RKXL.js";import{b as q,c as D}from"./chunk-WB3QPZQA.js";import"./chunk-YMRQPMXV.js";import"./chunk-7CPCF3KM.js";import{a as H}from"./chunk-TI66IBQX.js";import{a as w}from"./chunk-FOEXXIS5.js";import{a as L}from"./chunk-LYIUQA6S.js";import{a as $}from"./chunk-KFUQAFNA.js";import"./chunk-ZUHJWTKY.js";import{a as y}from"./chunk-EHLYPUDG.js";import{a as b}from"./chunk-CQWLAW3I.js";import{a}from"./chunk-J6TJ2S7E.js";import{a as F}from"./chunk-ZDD7CFQJ.js";import{a as h}from"./chunk-G6VG7VOM.js";import"./chunk-2BFYZNUH.js";import"./chunk-GRHMKKXW.js";import{a as T}from"./chunk-QGKEDUO2.js";import"./chunk-LAGOFWF3.js";import"./chunk-R3QPGR5M.js";import"./chunk-LWPHQG2H.js";import{a as O}from"./chunk-AQKFNZOY.js";import{a as i}from"./chunk-KAHUID7Q.js";import{a as A}from"./chunk-OAQ3GOTA.js";import"./chunk-3M65L4MQ.js";import"./chunk-M5ZN4Z2N.js";import"./chunk-C27IPPK7.js";import"./chunk-6R6RPTTO.js";import"./chunk-UU6HXUOC.js";import"./chunk-4KMRATSZ.js";import{a as s}from"./chunk-BI6EF352.js";import{a as v}from"./chunk-BM4FUEFL.js";import{a as N}from"./chunk-JW2UKJSK.js";import"./chunk-PKECKIP5.js";import"./chunk-BSKCRAT3.js";import{a as C}from"./chunk-MDOXDTXF.js";import"./chunk-FLC7HS56.js";import"./chunk-N3R6MXRE.js";import"./chunk-PX7MLT6T.js";import"./chunk-QPRB5F5E.js";import"./chunk-NOLCAT6N.js";import{a as m}from"./chunk-TO3QNLYY.js";import"./chunk-QHU4ICCH.js";import"./chunk-JROAODNJ.js";import{a as n}from"./chunk-SHVFOAM5.js";import"./chunk-N56IAE2U.js";import{a as d}from"./chunk-O5NIYLDT.js";import"./chunk-EEHLAE3S.js";import"./chunk-ISL3KEXS.js";import{a as E,b as f}from"./chunk-VMJ6DXBZ.js";import{a as u}from"./chunk-3PDILZ3R.js";import"./chunk-3WAX2TNR.js";import{sa as l}from"./chunk-4P4O4YGO.js";import"./chunk-KTAAKVTB.js";import{a as c}from"./chunk-RH5336H4.js";var k;function W(){let e=n("item-div");if(!e){e=N({id:"item-div",className:"itemDiv"});let t=n("item-list"),o=T(l,t);for(;o.length;)o[0].classList.add("fshBlock"),v(e,o[0]);a(e,t)}return e}function Q(e,t,o){return e&&A(t,o)}function z(e,t,o){return!e&&!t&&!o}function G(e,t){t.children[0].lastElementChild.children[0].children[0].checked=!1;let o=s("fshHide",t),r=e==="folderid0",S=s(e,t);Q(o,r,S)&&(t.classList.remove("fshHide"),t.classList.add("fshBlock")),z(o,r,S)&&(t.classList.remove("fshBlock"),w(t))}function J(e){h(l,W()).forEach(c(G,e.target.id))}function K(e){e.target.nodeName==="SPAN"&&e.target.id.indexOf("folderid")!==-1&&J(e)}function U(e){return` &ensp;<span id="folderid${e[0]}" class="fshLink fshNoWrap" fid=${e[0]}>${e[1]}</span> `}function X(e){let t=p({id:"fshFolderSelect",innerHTML:`<td colspan=6><span id="folderid0" class="fshLink" fid=0>All</span> &ensp;<span id="folderid-1" class="fshLink" fid="-1">Main</span>${C(e).map(U).join("")}`});m(t,K);let o=n("item-list").parentNode.parentNode;F(o,'<tr id="fshShowSTs"><td align="center" colspan=6><label><input type="checkbox" id="itemsInSt" checked> Select items in ST</label></td></tr>'),a(t,o)}function Y(e,t){t.is_in_st&&e.classList.add("isInST")}function Z(e){let t=e.children[0].lastElementChild.children[0];if(!t)return;let o=t.children[0];if(!o)return;let r=k[o.getAttribute("value")];r&&(e.classList.add(`folderid${r.folder_id}`),k.fshHasST&&Y(e,r),o.classList.add(`itemid${r.item_id}`),o.classList.add(`itemtype${r.type}`))}function ee(e){let t=f("betaOptIn");t&&q("trade.processTrade"),k=e.items,h(l,n("item-list")).forEach(Z),X(e.folders),t&&D("trade.processTrade")}function te(e){i(3,ee,[e])}function g(){$()||M().then(te)}function I(e,t){return O(x,j,e,t)}async function oe(e,t){let o=await e;return console.log("promise data",o),o===null||o.s?I(t[0],t[1]):o}async function ne(){let e=y('form[name="sendItemForm"] [name="target_username"]'),o=await d('[name="sendItemList[]"]:checked').map(r=>[e.value,[r.value]]).reduce(oe,Promise.resolve(null));console.log("finalResult",o)}function B(){let e=y('form[name="sendItemForm"] input[value="Send"]'),t=H({className:"fshBl",id:"oneByOneBtn",textContent:"OneByOne",type:"button"});P(t,e),m(t,ne)}function re(e){let t=parseInt(n("fshSendHowMany").value,10);return b(t)?e.length:u.subcmd!=="-"?Math.min(100,t):t}function se(e,t){return e==="itemid-2"&&s("itemtype12",t)}function ie(e,t){return e==="itemid-1"||se(e,t)||s(e,t)}function me(){let e=n("itemsInSt");if(e)return e.checked}function ce(e,t){return e||!s("isInST",t)}function _(e){return e.children[0].lastElementChild.children[0].children[0]}function R(e,t){t.checked=e}function ae(e){R(!1,e)}function le(e){R(!0,e)}function fe(e,t){t.filter(c(ce,me())).map(_).filter(c(ie,e)).slice(0,re(t)).forEach(le)}function de(e){let t=n("item-div")||n("item-list"),o=d("table:not(.fshHide)",t);o.map(_).forEach(ae),fe(e.target.id,o)}function pe(e){s("fshCheckAll",e.target)&&de(e)}function V(e){return L(`[${e}]`)}function ue(){let e=f("sendClasses"),t=V(e);return t||V(E.sendClasses)}function he(e){return` &ensp;<span id="itemid${e[1]}" class="fshCheckAll fshLink fshNoWrap">${e[0]}</span>`}function ye(e){let t=p({id:"fshSelectMultiple",innerHTML:`<td colspan=6>Select:&ensp;<span id="itemid-1" class="fshCheckAll fshLink fshNoWrap">All Items</span> &ensp;<span id="itemid-2" class="fshCheckAll fshLink fshNoWrap">All Resources</span>${ue().map(he).join("")} &ensp;How&nbsp;many:<input id="fshSendHowMany" type="text" class="custominput fshHowMany" value="all"></td>`});m(t,pe),a(t,e.parentNode.parentNode)}function ke(){let e=n("item-list");!e||(i(3,g),i(3,ye,[e]),u.userIsDev&&i(3,B))}export{ke as default};
//# sourceMappingURL=trade-6Z6AZLIO.js.map
