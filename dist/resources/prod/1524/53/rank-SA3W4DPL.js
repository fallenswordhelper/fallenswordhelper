import{a as O}from"./chunk-XDEHWQ67.js";import{a as Q}from"./chunk-DMYQ6CER.js";import{a as G}from"./chunk-MXFZTN4A.js";import{a as W}from"./chunk-YXABNXQA.js";import{a as M}from"./chunk-MIIGAWWQ.js";import{a as F}from"./chunk-S4AATYOV.js";import{a as $}from"./chunk-AFCJ6IYJ.js";import"./chunk-YRH7FGLK.js";import{a as H}from"./chunk-QRB25M5V.js";import{a as U}from"./chunk-AOOPN6WB.js";import"./chunk-7CPCF3KM.js";import{b as E}from"./chunk-ESHX3R26.js";import"./chunk-4WWEO4K3.js";import{a as T}from"./chunk-SCCYLSYU.js";import{a as _}from"./chunk-2SJYIFN7.js";import{a as I}from"./chunk-4GNRWF5F.js";import"./chunk-LARETTHC.js";import"./chunk-MJHY5FVK.js";import{a as q}from"./chunk-KFUQAFNA.js";import"./chunk-ZUHJWTKY.js";import{a}from"./chunk-EHLYPUDG.js";import"./chunk-CQWLAW3I.js";import{a as v}from"./chunk-USQ4I2P4.js";import{a as j}from"./chunk-JUU6TIW3.js";import{b as f}from"./chunk-TMMBKVUE.js";import{a as V}from"./chunk-J6TJ2S7E.js";import{a as D}from"./chunk-XGRP4UT7.js";import"./chunk-G6VG7VOM.js";import{a as u}from"./chunk-2BFYZNUH.js";import"./chunk-GRHMKKXW.js";import"./chunk-QGKEDUO2.js";import"./chunk-LAGOFWF3.js";import{a as d}from"./chunk-AQKFNZOY.js";import"./chunk-KAHUID7Q.js";import"./chunk-OAQ3GOTA.js";import"./chunk-3M65L4MQ.js";import"./chunk-M5ZN4Z2N.js";import"./chunk-C27IPPK7.js";import{a as h}from"./chunk-6R6RPTTO.js";import{a as i}from"./chunk-UU6HXUOC.js";import"./chunk-4KMRATSZ.js";import{a as P}from"./chunk-BM4FUEFL.js";import"./chunk-PKECKIP5.js";import"./chunk-BSKCRAT3.js";import{a as S}from"./chunk-MDOXDTXF.js";import"./chunk-FLC7HS56.js";import{a as L}from"./chunk-N3R6MXRE.js";import"./chunk-PX7MLT6T.js";import"./chunk-QPRB5F5E.js";import"./chunk-NOLCAT6N.js";import{a as l}from"./chunk-TO3QNLYY.js";import"./chunk-QHU4ICCH.js";import"./chunk-JROAODNJ.js";import"./chunk-SHVFOAM5.js";import"./chunk-N56IAE2U.js";import{a as k}from"./chunk-O5NIYLDT.js";import"./chunk-EEHLAE3S.js";import{a as C}from"./chunk-ISL3KEXS.js";import{a as p}from"./chunk-FE4PDZXL.js";import{b as B}from"./chunk-VMJ6DXBZ.js";import"./chunk-3PDILZ3R.js";import"./chunk-3WAX2TNR.js";import"./chunk-4P4O4YGO.js";import"./chunk-KTAAKVTB.js";import{a as m}from"./chunk-RH5336H4.js";function x(t){return Object.values(t)}function s(t){return F(L({subcmd:"ranks"},t))}var K=t=>i({cmd:"guild",subcmd:"ranks",subcmd2:"add",rank_id:t}),X=t=>K(t.getAttribute("onclick").match(/[=](\d+)/)[1]),Y=t=>k('input[name^="permission"]:checked',t).reduce((o,r)=>o+2**Number(r.name.match(/\[(\d+)\]/)[1]),0);function Z(t){return{id:Number(a('input[name="rank_id"]',t).value),name:a('input[name="rank_name"]',t).value,permissions:Y(t),tax:Number(a('input[name="rank_tax"]',t).value)}}function tt(t){let r=t.map(h).map(Z);return{r:{0:r[0],ranks:r.slice(1)},s:!0}}function ot(t){let o=h(t),r=k('input[value="Edit"]',o);return $(r.map(X),tt)}function g(){return i({cmd:"guild",subcmd:"ranks"}).then(ot)}function w(){return d(s,g)}var rt=[[2,5],[4,4],[64,5],[256,.1],[512,.2],[4096,.5],[32768,.2],[524288,.1],[65536,5],[4194304,4]];function nt(t){return E(rt.filter(([o])=>Q(t,o)).reduce((o,[,r])=>o+r-1,0)+t.toString(2).split("").map(Number).reduce(_,0),1)}function et(t,o){let r=o.children[0],n=p(r.firstChild),e=t.find(c=>c&&c.name===n);e&&H(r,`<span class="fshBlue">(${nt(e.permissions)}) Tax:(${e.tax}%)</span> `)}function mt(t,o,r){r.s&&(t.forEach(m(et,[r.r["0"]].concat(r.r.ranks))),o.classList.remove("fshSpinner"))}function at(t,o){let r=I({className:"fshBlock fshRelative fshSpinner fshSpinner12",style:{height:"15px",width:"136px"}});G(r,o),w().then(m(mt,t,r))}function it(t,o){let r=D({className:"custombutton",type:"button",value:"Get Rank Weightings"});l(r,m(at,t,r));let n=o.parentNode.parentNode;u(n,"&nbsp;"),P(n,r)}function b(t){let o=a('#pCC a[href*="=ranks&subcmd2=add"]');o&&it(t,o)}function R(t,o){return i({cmd:"guild",subcmd:"ranks",subcmd2:t,rank_id:o}).then(()=>({s:!0}))}function y(t,o){return s({subcmd2:t,rank_id:o})}function N(t,o){return d(y,R,t,o)}var A;function st(t,o){return A>=Math.min(t.rowIndex,o)||o<1||o>t.parentNode.rows.length}function ct(t){return t==="Up"?-1:2}function ut(t){return t==="Up"?-22:22}function ft(t,o,r){let n=t.target.getAttribute("onclick").match(/rank_id=(\d+)/);N(j(t.target.value),n[1]);let e=o.parentNode.rows[r];V(o,e);let c=ut(t.target.value);window.scrollBy(0,c),t.stopPropagation()}function pt(t){let o=t.target.parentNode.parentNode.parentNode,r=o.rowIndex+ct(t.target.value);st(o,r)||ft(t,o,r)}function lt(t){return["Up","Down"].includes(t.target.value)}function dt(t){lt(t)&&pt(t)}function z(){A&&B("ajaxifyRankControls")&&l(f,dt,!0)}function J(t,o){o&&o[1].includes(v())&&(A=t.rowIndex)}function kt(){let t=f.lastElementChild.previousElementSibling;if(t.rows&&t.rows.length>7)return C(t.rows[7].children[0].children[0].rows)}function ht(t,o){return o[0]===t}function xt(t){return t&&t[1].length>0}function gt(t,o){return t.rowIndex===1?"Guild Founder":p(o)}function wt(t,o){let r=o.children[0],n=gt(o,r),e=t.find(m(ht,n));xt(e)&&(J(o,e),u(r,` <span class="fshBlue">- ${e[1].join(", ")}</span>`))}function bt(t){let o=kt();o&&(T([5,3,o,1,m(wt,t)]),b(o),z())}function Rt(t){let o=x(U(S(t).filter(O)));return M(o.map(r=>r.rank_name)).map(r=>[r,o.filter(n=>n.rank_name===r).map(n=>n.username)])}function yt(){q()||W(!1).then(Rt).then(bt)}export{yt as default};
//# sourceMappingURL=rank-SA3W4DPL.js.map
