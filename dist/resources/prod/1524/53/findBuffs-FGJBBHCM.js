import{a as p}from"./chunk-4O2WFYTC.js";import{a as E}from"./chunk-Z4N2VSOM.js";import{c as Z}from"./chunk-HSVMTDMW.js";import{a as I}from"./chunk-ANRQZDQO.js";import{a as X}from"./chunk-ZVOORZ7V.js";import{b as _}from"./chunk-TFDLNSGH.js";import{a as Y}from"./chunk-OYFIU772.js";import{c as K}from"./chunk-LSD44FRF.js";import"./chunk-ABHC4DJD.js";import"./chunk-YJTGIFTH.js";import"./chunk-MJHY5FVK.js";import{a as W}from"./chunk-KFUQAFNA.js";import"./chunk-ZUHJWTKY.js";import"./chunk-63EULCQA.js";import{a as z}from"./chunk-EHLYPUDG.js";import{a as U}from"./chunk-USQ4I2P4.js";import{a as T}from"./chunk-VLL6MMT3.js";import"./chunk-QRPHAINE.js";import"./chunk-JUU6TIW3.js";import{b as v}from"./chunk-TMMBKVUE.js";import{a as G}from"./chunk-G6VG7VOM.js";import{a as Q}from"./chunk-LXRQYSTA.js";import"./chunk-UFYZMWBJ.js";import"./chunk-OZZ26S4K.js";import"./chunk-FBJQLDZK.js";import{a as L}from"./chunk-QGKEDUO2.js";import"./chunk-OAQ3GOTA.js";import"./chunk-M5ZN4Z2N.js";import{a as c}from"./chunk-6R6RPTTO.js";import{a as J}from"./chunk-UU6HXUOC.js";import"./chunk-4KMRATSZ.js";import"./chunk-BSKCRAT3.js";import"./chunk-MDOXDTXF.js";import{a as C}from"./chunk-PX7MLT6T.js";import"./chunk-QPRB5F5E.js";import{a}from"./chunk-I7NTXRDN.js";import{a as A}from"./chunk-TO3QNLYY.js";import"./chunk-QHU4ICCH.js";import"./chunk-JROAODNJ.js";import{a as n}from"./chunk-SHVFOAM5.js";import"./chunk-N56IAE2U.js";import{a as B}from"./chunk-O5NIYLDT.js";import"./chunk-EEHLAE3S.js";import{a as q}from"./chunk-ISL3KEXS.js";import{a as i}from"./chunk-FE4PDZXL.js";import{b as h}from"./chunk-VMJ6DXBZ.js";import{a as x}from"./chunk-3PDILZ3R.js";import"./chunk-3WAX2TNR.js";import{Da as O,N as H,e as F,u as R}from"./chunk-4P4O4YGO.js";import"./chunk-KTAAKVTB.js";import{a as f}from"./chunk-RH5336H4.js";function S(){return J({cmd:"guild",subcmd:"manage"})}function ye(e){return`<tr><td rowspan="2" colspan="2" class="headCell"><h1>Find ${e.header}</h1></td><td class="findLabel">Select ${e.what} to search for:</td><td>${e.control()}</td></tr>`}function ge(e){return`<tr><td class="findLabel">Level ${e.cutoff}ers only:</td><td><input id="level175" type="checkbox"></td></tr>`}function Pe(e){return`<tr><td class="leftLabel">${e.searched}:&nbsp;</td><td id="buffNicks">&nbsp;</td><td class="findLabel">Search guild members:</td><td><input id="guildMembers" type="checkbox" checked></td></tr>`}function xe(){return K("Search Allies/Enemies","The checkbox enables searching your own personal allies/enemies list for buffs.<br><br>Additional profiles to search can be added in the text field to the right, separated by commas.")}function ve(e,t){return`<tr><td class="findLabel"># potential ${e.potential}ers to search:&nbsp;</td><td id="potentialBuffers"></td><td class="findLabel">Search allies/enemies:${xe()}</td><td><input id="alliesEnemies" type="checkbox" checked><input class="extraProfile" class="custominput" id="extraProfile" type="text" title="Extra profiles to search" value="${t||""}"></td></tr>`}function Le(e){return`<tr><td class="findLabel"># ${e.processed}ers processed:&nbsp;</td><td id="buffersProcessed">0</td><td class="findLabel">Search online list:</td><td><select class="selectOnline" id="onlinePlayers"><option value="0">Disabled</option><option value="49">Short (fastest)</option><option value="47">Medium (medium)</option><option value="45">Long (slowest)</option></select></td></tr>`}function Be(e){return`<tr><td class="findLabel">Find ${e.progress} progress:&nbsp;</td><td class="buffProg" id="bufferProgress">Idle</td><td align="center"><input id="clearresultsbutton" class="custombutton" type="button" value="Clear Results"></td><td align="center"><input id="findbuffsbutton" class="custombutton" type="button" value="Find Buffers"></td></tr>`}function $e(e){return`<br><h1>Potential ${e.processed}ers and Bio Info</h1><br><table class="fshResult" id="buffTable"><tbody><tr><th class="nameCol">&nbsp;Name</th><th class="infoCol">&nbsp;Player Info</th><th>&nbsp;Notable Bio Text</th></tr></tbody></table><br>`}function Ae(){return'<div class="disclaim">Disclaimer: This functionality does a simple text search for the terms above. It is not as smart as you are, so please do not judge the results too harshly. It does not search all online players, just a subset of those that have been on recently. The aim is to be fast and still return a good set of results. This feature is a work in progress, so it may be tweaked and enhanced over time.</div>'}function y(e,t){return`<table class="fshFind"><tbody>${ye(e)}${ge(e)}${Pe(e)}${ve(e,t)}${Le(e)}${Be(e)}</tbody></table>${$e(e)}${Ae()}`}var w;function k(){w=n("bufferProgress")}function l(e,t){a(e,w),t&&(w.style.color=t)}var Te=/Level<br>(\d+)%/;function Ce(e,t){let r=new RegExp(`^.*\\b(?:(?:${t.replace(/,/g,")|(?:")}))\\b.*$`,"gim");return[...e.matchAll(r)].map(o=>o[0])}function Ie(e){let t=G("a",n("profileLeftColumn",e)).find(Q("Sustain"));if(t){let r=t.parentNode.parentNode.parentNode.nextElementSibling.children[0].dataset.tipped;return parseInt(Te.exec(r)[1],10)||-1}return 0}function Ee(e){return i(L("h1",n("pCC",e))[0])}function Se(e){return Y(i(n("profileLeftColumn",e).children[4].children[0].rows[0].cells[1]))}function we(e){return parseInt(i(n(O,e)),10)}function ke(e,t,r,o){let s=Ee(e),j=Se(e),d=we(e),pe=parseInt(r[1],10),me=_({min:pe}),be=t.href,he=o.replace(/'|"|\n/g,"");return`<nobr>${me}&nbsp;<a href="${be}" target="new" class="tip-static" data-tipped="${he}">${s}</a>&nbsp;<span class="fshBlue">[<span class="a-reply fshLink" target_player="${s}">m</span>]</span></nobr><br><span class="fshGrey">Level:&nbsp;</span>${j}&nbsp;(${d})`}function Ne(e){window.openQuickMsgDialog(e.target.getAttribute("target_player"))}function Me(e){let t=e.newRow.insertCell(0);t.style.verticalAlign="top",a(ke(e.doc,e.callback,e.lastActivity,e.bioCellHtml),t),$(".a-reply").on("click",Ne)}function De(e,t,r){let o="fshRed";t>=100&&(o="fshGreen");let s='<span class="fshRed">No</span>';return r&&(s='<span class="fshGreen">Yes</span>'),`<table><tbody><tr><td colspan="2" class="resAct">Last Activity:</td><td colspan="2"><nobr>${e[0]}</nobr></td></tr><tr><td class="resLbl">Sustain:</td><td class="resVal ${o}">${t}%</td><td class="resLbl">Extend:</td><td class="resVal">${s}</td></tr>`}function Ve(e,t,r,o){let s=e.insertCell(1);a(De(t,r,o),s),s.style.verticalAlign="top"}function je(e,t){e.innerHTML+=`${t}<br>`}function Fe(e,t){let r=e.insertCell(2);t.forEach(f(je,r))}function Re(){let e=n("buffersProcessed"),t=parseInt(i(n("potentialBuffers")),10),r=parseInt(i(e),10);a(r+1,e),t===r+1&&l("Done.","blue")}function He(e){let t=n("pCC",e),r=L("p",t)[0];return/(\d+) mins, (\d+) secs/.exec(i(r))}function Oe(e){return z('img.tip-static[data-tipped*="Extend"]',e)}function qe(e,t,r,o){let s=He(r),d=n("buffTable").insertRow(-1);Me({newRow:d,doc:r,callback:t,lastActivity:s,bioCellHtml:e}),Ve(d,s,Ie(r),Oe(r)),Fe(d,o)}function N(e,t){let r=c(e),o=n("profile-bio",r).innerHTML,s=Ce(o,t.findBuffNicks);s.length>0&&qe(o,t,r,s),Re()}function Ge(e){return`<option value="${e.id}">${e.name}</option>`}var ee={header:"Buff",what:"buff",control(){return`<select style="width:140px;" id="selectedBuff">${p.map(Ge).join("")}</select>`},cutoff:"175 buff",searched:"Nicknames of buff searched",potential:"buff",processed:"Buff",progress:"buffers"},te={header:"Other",what:"text",control(){return`<input style="width:140px;" class="custominput" id="textToSearchFor" type="text" title="Text to search for" value="${h("textToSearchFor")||""}">`},cutoff:"500+ play",searched:"Text searched for",potential:"play",processed:"Play",progress:"Other"};var re;function M(){return re?500:1}function ne(){re=n("level175").checked}var g,P,m,D,u,b,V;function Qe(e,t){N(t,{href:e,findBuffNicks:g})}function Ue(e){C(e).then(f(Qe,e))}function oe(){if(a(m.length,n("potentialBuffers")),m.length<=0){l("Done.","blue");return}l("Parsing player data ...","green"),m.forEach(Ue)}function _e(e,t){return e===1?Math.round(D*t/50):e+1}function se(e,t){U()!==t.trim()&&m.push(e)}function Ye(e){return parseInt($(e).find("td:eq(2)").text().replace(/,/g,""),10)}function ze(e){return e>=P&&e>=M()}function Je(e,t){if(ze(Ye(t))){let r=$(t).find("td:eq(1) a").attr("href"),o=$(t).find("td:eq(1) a").text();se(r,o)}}function Ke(e){return parseInt($(e).find('td:has(input[name="page"]):last').text().replace(/\D/g,""),10)}function We(e){return parseInt($(e).find('input[name="page"]:last').val().replace(/\D/g,""),10)}function Xe(e){$(e).find('table:contains("Username")>tbody>tr:has(td>a[href*="cmd=profile&player_id="])').each(Je)}function Ze(e,t,r){let o=_e(e,t);l(`Parsing online page ${e} ...`),E(o).then(r)}function ae(e){let t=c(e),r=We(t);r!==1&&Xe(t);let o=Ke(t);r<o?Ze(r,o,ae):oe()}function ie(){D=parseInt(n("onlinePlayers").value,10),D!==0?E(1).then(ae):oe()}function et(e){let t=F.exec(e),r=parseInt(t[1],10),o=parseInt(t[2],10)+r*24;return parseInt(t[3],10)+o*60}function tt(e,t,r){return e<5&&t>=P&&t>=r}function le(e){let{tipped:t}=e.dataset,r=et(t),o=Number(/VL:.+?(\d+)/.exec(t)[1]),s=M();tt(r,o,s)&&se(e.href,i(e))}function rt(e){let t=c(e);B('#profileLeftColumn a[data-tipped*="Last Activity"]',t).forEach(le),V+=1,V===b.length&&ie()}function nt(e){b.push(H+e)}function ot(e){C(e).then(rt)}function st(){b=[],b.push(R),X(u).forEach(nt),V=0,n("alliesEnemies").checked?b.forEach(ot):ie()}function at(e){let t=c(e);n("guildMembers").checked&&B('#pCC a[data-tipped*="<td>VL:</td>"]',t).forEach(le),st()}function it(e,t){return t!==0}function lt(e){e.deleteRow(-1)}function ft(){let e=n("buffTable");q(e.rows).filter(it).forEach(f(lt,e)),a("",n("buffNicks")),l("Idle.","black"),a("",n("potentialBuffers")),a("0",n("buffersProcessed"))}function fe(e){W()||(a(g,n("buffNicks")),l(`Gathering list of ${e} ...`,"green"),ne(),a("0",n("buffersProcessed")),m=[],u=n("extraProfile").value,T("extraProfile",u),S().then(at))}function ct(e,t){return e===t.id}function ut(){let e=parseInt($("#selectedBuff").val(),10),t=p.find(f(ct,e));g=t.nicks,P=t.lvl,fe("potential buffers")}function dt(){let e=$("#textToSearchFor").val().replace(/\s*,\s*/,",");T("textToSearchFor",e),g=e,P=1,fe("profiles to search")}function ce(){u=h("extraProfile")}function ue(e){A(n("findbuffsbutton"),e,!0)}function de(){A(n("clearresultsbutton"),ft,!0)}function dr(e){let t=e||v;x.sortBy="name",x.sortAsc=!0,p.sort(Z),ce(),a(y(ee,u),t),k(),ue(ut),de(),I("ui-dialog-titlebar-close").forEach(r=>r.blur())}function pr(e){let t=e||v;ce(),a(y(te,u),t),k(),ue(dt),de(),I("ui-dialog-titlebar-close").forEach(r=>r.blur())}export{u as extraProfile,dr as injectFindBuffs,pr as injectFindOther};
//# sourceMappingURL=findBuffs-FGJBBHCM.js.map
