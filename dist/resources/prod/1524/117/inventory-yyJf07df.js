import{g as t}from"./getMembrList-AgfQvkLG.js"
import{co as e,i as n,c2 as s,ag as a,p as i,aJ as r,bP as c,cH as o,s as d,c as l,aO as u,bp as f,ai as p,cx as m,cI as h,br as b,C as y,bK as v,aQ as g,k,G as _,$ as I,aI as x,aN as R,S as w,L,M,O as S,P as E,Q as j,T,U as D,X as N,_ as C,a0 as A,a1 as P,aA as G,a3 as O,cJ as U,a4 as q,g as F,cK as B,cL as W,a_ as H,cM as Q,cN as V,cO as Y,bh as J,bi as K,bc as X,bf as z,bj as Z,d as tt,v as et,m as nt,w as st,bU as at,f as it,aT as rt,bQ as ct,bR as ot}from"./calfSystem-G1dN925O.js"
import{a as dt}from"./all-TTLWag-d.js"
import{e as lt}from"./executeAll-EzEelzhH.js"
import{l as ut}from"./loadDataTables-opgkYLAf.js"
import{d as ft,a as pt,b as mt}from"./deepClone-NkGgFnYr.js"
import{d as ht}from"./daLoadInventory-20Qn11vN.js"
import{b as bt}from"./basicItem-w_tHNJN5.js"
import{e as yt,d as vt,a as gt,m as kt}from"./dropItem-vwbY25QT.js"
import{f as $t}from"./flattenItems-OuxkqZMH.js"
import{c as _t}from"./createTable-pGvXv4Gy.js"
import{i as It}from"./isSelected-tg-1ZNBk.js"
import{c as xt}from"./changeMinMax-9r1ZRXOG.js"
import{c as Rt}from"./chromeHandlers-iadsdOxf.js"
import{a as wt,u as Lt,e as Mt}from"./useItem-iOIoCAnH.js"
import{g as St}from"./guildInventory-kOrOD2FZ.js"
import{h as Et}from"./htmlResult-kLg7g2OU.js"
import{e as jt}from"./errorDialog-UVurWbsP.js"
import{q as Tt,a as Dt}from"./queue-D75-WXbH.js"
import{p as Nt,l as Ct}from"./lvlTests-Ed6CIznK.js"
import{i as At}from"./intValue-JHhLnq8V.js"
import{i as Pt}from"./isArray-bNviZzJA.js"
import"./guildMembers-4GuRAnc8.js"
import"./now-pQzGw6vd.js"
import"./guild-a4pzzzAR.js"
import"./dialog-RW6TE77j.js"
import"./dialogMsg-6-T2JNn4.js"
import"./sendItems-PYurMEkJ.js"
import"./numberIsNaN--k2kVli9.js"
import"./daUseItem-swRkhdvl.js"
import"./InfoBoxFrom-T4bMs0ax.js"
import"./backpackOk-yvfjNGgY.js"
import"./takeItem-ltIjN8gc.js"
function Gt([t]){return"lastUpdate"!==t}function Ot(){return e({subcmd:"inventory"})}let Ut=""
const qt=()=>Ut
function Ft(t,e){Ut||(Ut=e.message),Ut&&n(t,s("p",{className:"fshRed",textContent:Ut}))}let Bt={}
const Wt=()=>Bt
async function Ht(t){try{return await t()}catch(t){if(500!==t.jqXhr.status)throw t
Ft(i(),t)}}const Qt=(t,e)=>{return e.map(bt).map((n=t,function(t){const e=n?.find((({inv_id:e})=>e===t.inv_id))
return{...t,...e?.stats&&{stats:{...t.stats,armor:e.stats.armor,attack:e.stats.attack,damage:e.stats.damage,defense:e.stats.defense,hp:e.stats.hp,set_name:e.stats.set_name??""}}}}))
var n},Vt=t=>({...t,equipped:!0,folder_id:-2}),Yt=(t,e,n)=>({folders:yt(t),items:Qt(e,n),player_id:r()})
const Jt=t=>({...t,player:{id:-1}}),Kt=(t,e)=>({current_player_id:r(),items:Qt(t,e),guild_id:c()})
async function Xt(){if("invmanagernew"===a.subcmd){const t=await async function(){const[t,e]=await dt([Ht(Ot),ht()]),n=t?.items??[],s=e?.r??{},a=(s.equipment?.map(Vt)??[]).concat($t(s))
return Yt(s,n,a)}()
Bt=t}else if("guildinvmgr"===a.subcmd){const t=await async function(){const[t,e,n]=await dt([Ht(o),ft(),pt()]),s=t?.items??[],a=e?.r??[],i=n?.r??[],r=a.concat(i.map(Jt))
return Kt(s,r)}()
Bt=t}}const zt=t=>{d("Inventory","Header",t)},Zt=t=>{d("Inventory","Datatable",t)}
function te(t,e){Zt("clearSearch"),e.val(""),$(t).DataTable().search("").draw()}function ee(){Wt().folders&&(Wt().folders[-1]="Main")}const ne={checkedElements:{0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,100:1,101:1,102:1,103:1,104:1,105:1,106:1},fshMinLvl:1,fshMaxLvl:9999},se='<table class="fshInvFilter"><tr><th colspan="14">@@reportTitle@@</th><th><span id="fshRefresh" class="fshLink">[Refresh]</span></th></tr><tr><td colspan="2" rowspan="3"><b>&nbsp;Show Items:</b></td><td class="fshRight">&nbsp;Helmet:</td><td><input id="fshHelmet" type="checkbox" item="0"/></td><td class="fshRight">&nbsp;Armor:</td><td><input id="fshArmor" type="checkbox" item="1"/></td><td class="fshRight">&nbsp;Gloves:</td><td><input id="fshGloves" type="checkbox" item="2"/></td><td class="fshRight">&nbsp;Boots:</td><td><input id="fshBoots" type="checkbox" item="3"/></td><td class="fshRight">&nbsp;Weapon:</td><td><input id="fshWeapon" type="checkbox" item="4"/></td><td></td><td class="fshRight">&nbsp;Min lvl:</td><td rowspan="2"><input id="fshMinLvl" class="fshNumberInput" type="number" value="1" min="0"><br><input id="fshMaxLvl" class="fshNumberInput" type="number" value="9999" min="0"></td></tr><tr><td class="fshRight">&nbsp;Shield:</td><td><input id="fshShield" type="checkbox" item="5"/></td><td class="fshRight">&nbsp;Ring:</td><td><input id="fshRing" type="checkbox" item="6"/></td><td class="fshRight">&nbsp;Amulet:</td><td><input id="fshAmulet" type="checkbox" item="7"/></td><td class="fshRight">&nbsp;Rune:</td><td><input id="fshRune" type="checkbox" item="8"/></td><td class="fshRight">&nbsp;Sets Only:</td><td><input id="fshSets" item="-1" type="checkbox"/></td><td></td><td class="fshRight">&nbsp;Max lvl:</td></tr><tr><td colspan="2">&nbsp;[<span id="fshAll" class="fshLink">Select All</span>]</td><td colspan="2">&nbsp;[<span id="fshNone" class="fshLink">Select None</span>]</td><td colspan="2">&nbsp;[<span id="fshDefault" class="fshLink">Defaults</span>]</td><td colspan="6"></td><td><input id="fshReset" type="button" value="Reset"/></td></tr><tr><td class="fshRight">&nbsp;Quest Item:</td><td><input id="fshQuest" item="9" type="checkbox"/></td><td class="fshRight">&nbsp;Potion:</td><td><input id="fshPotion" item="10" type="checkbox"/></td><td class="fshRight">&nbsp;Resource:</td><td><input id="fshResource" item="12" type="checkbox"/></td><td class="fshRight">&nbsp;Recipe:</td><td><input id="fshRecipe" item="13" type="checkbox"/></td><td class="fshRight">&nbsp;Container:</td><td><input id="fshContainer" item="14" type="checkbox"/></td><td class="fshRight">&nbsp;Frag Stash:</td><td><input id="fshStash" item="16" type="checkbox"/></td><td class="fshRight">&nbsp;Composed:</td><td><input id="fshComposed" item="15" type="checkbox"/></td><td></td></tr><tr><td class="fshRight">&nbsp;Common:</td><td><input id="fshCommon" item="100" type="checkbox" checked/></td><td class="fshRight">&nbsp;Rare:</td><td><input id="fshRare" item="101" type="checkbox" checked/></td><td class="fshRight">&nbsp;Unique:</td><td><input id="fshUnique" item="102" type="checkbox" checked/></td><td class="fshRight">&nbsp;Legendary:</td><td><input id="fshLegendary" item="103" type="checkbox" checked/></td><td class="fshRight">&nbsp;Super Elite:</td><td><input id="fshSuperElite" item="104" type="checkbox" checked/></td><td class="fshRight">&nbsp;Crystalline:</td><td><input id="fshCrystalline" item="105" type="checkbox" checked/></td><td class="fshRight">&nbsp;Epic:</td><td colspan="2"><input id="fshEpic" item="106" type="checkbox" checked/></td></tr></table>',ae={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,100:1,101:1,102:1,103:1,104:1,105:1,106:1},ie={Perfect:{abbr:"Perf",colour:"#00b600",index:8},Excellent:{abbr:"Exc",colour:"#f6ed00",index:7},"Very Good":{abbr:"VG",colour:"#f67a00",index:6},Good:{abbr:"Good",colour:"#f65d00",index:5},Average:{abbr:"Ave",colour:"#f64500",index:4},Poor:{abbr:"Poor",colour:"#f61d00",index:3},"Very Poor":{abbr:"VPr",colour:"#b21500",index:2},Uncrafted:{abbr:"Unc",colour:"#666666",index:1}}
let re={},ce=0,oe=0
const de=()=>re,le=()=>ce,ue=()=>oe
function fe(t){return ie[t]?ie[t].abbr:""}function pe(t,e){const n=function(t){return t.folder_id?function(t){return t.equipped?"fshGreen":"fshNavy"}(t):function(t){return-1===t.player_id?"fshNavy":"fshMaroon"}(t)}(e)
t.classList.add(n),e.equipped&&t.classList.add("fshBold")}function me(t){return function(t){return t.player_id&&-1!==t.player_id}(t)||function(t){return t.folder_id&&-1!==t.guild_tag}(t)}function he(t){return`<span class="fshLink recallItem" invid="${t.inv_id}" playerid="${f(t.player_id,Wt().player_id)}" mode="1" action="recall">GS</span>`}function be(t){return`<span class="fshLink storeItem" invid="${t.inv_id}">GS</span>`}function ye(t,e,n){return"display"===t?n(e):"GS"}function ve(t,e){const n=function(t){return-1===t.player_id?4:me(t)?7:1}(e),s=(a=Wt().player_id,i=e.player_id,r=Wt().guild_id,a||(-1!==i?i:r))
var a,i,r
let c=""
return function(t){return t.stats&&""!==t.stats.set_name}(e)&&(c=` (<span class="fshLink setName" set="${e.stats.set_name}">set</span>)`),`<a href="${m}${t}" class="fshInvItem tip-dynamic ${h[e.rarity].clas}" data-tipped="fetchitem.php?item_id=${e.item_id}&inv_id=${e.inv_id}&t=${n}&p=${s}">${t}</a>${c}`}const ge=[[t=>t.player_id&&-1===t.player_id,(t,e)=>`takeItem" action="${e.a}`],[t=>t.player_id&&t.player_id!==Wt().current_player_id,(t,e)=>`recallItem" playerid="${t.player_id}" mode="0" action="${e.a}`],[t=>function(t){return t.folder_id&&!t.equipped}(t)||function(t){return t.player_id&&!t.equipped&&t.player_id===Wt().current_player_id}(t),(t,e)=>e.c]]
function ke(t,e){const n=ge.find((([e])=>e(t)))
return n?`<span class="fshLink ${n[1](t,e)}" invid="${t.inv_id}">${e.b}</span>`:""}function $e(t){return f(t.folder_id,t.player_id)}function _e(t){return a.membrList[t]?a.membrList[t].username:"???"}function Ie(t,e){return t[0]-e[0]}function xe(t,e){return`<option value="${e[0]}"${It(Number(e[0]),t)}>${e[1]}</option>`}const Re=[{title:"Name",data:"item_name",render:function(t,e,n){return"display"!==e?t:ve(t,n)}},{title:"Level",data:"stats.min_level"},{title:"Where",data:$e,render:{_:function(t,e,n){return n.folder_id?function(t){return t.equipped?-2:t.folder_id}(n):-1===n.player_id?"~":_e(n.player_id)},display:function(t,e,n){return n.player_id?function(t){return-1===t.player_id?"Guild Store":`<a class="fshMaroon" href="${b}${t.player_id}">${_e(t.player_id)}</a>`}(n):n.equipped?"Worn":`<select class="fshMoveItem" data-inv="${n.inv_id}">${s=n.folder_id,a=Wt().folders,y(a).sort(Ie).map(l(xe,s)).join("")}</select>`
var s,a},filter:function(t,e,n){return n.player_id?function(t){return-1===t.player_id?"Guild Store":_e(t.player_id)}(n):n.equipped?"Worn":Wt().folders[n.folder_id]}}},{title:"Type",data:"type",render:t=>v[t]},{title:"Att",data:"stats.attack"},{title:"Def",data:"stats.defense"},{title:"Arm",data:"stats.armor"},{title:"Dam",data:"stats.damage"},{title:"HP",data:"stats.hp"},{title:"Frg",data:"forge",render:function(t,e,n){if(n.type<9)return n.forge}},{title:"Craft",data:"craft",render:{_:t=>ie[t]?ie[t].index:0,display:fe,filter:fe}},{title:"Du%",data:"durability",render:function(t,e,n){if(n.type<9&&n.max_durability>0)return Math.floor(n.durability/n.max_durability*100)}},{title:"BP",data:$e,render:function(t,e,n){if(!n.folder_id&&n.player_id!==Wt().current_player_id)return function(t,e){return"display"!==t?"BP":-1===e.player_id?`<span class="fshLink takeItem" invid="${e.inv_id}" action="take">BP</span>`:`<span class="fshLink recallItem" invid="${e.inv_id}" playerid="${e.player_id}" mode="0" action="recall">BP</span>`}(e,n)}},{title:"GS",data:$e,render:function(t,e,n){return me(n)?ye(e,n,he):function(t){return t.folder_id&&!t.bound}(n)?ye(e,n,be):void 0}},{title:"W/U",data:"type",render:function(t,e,n){const s=[1,1,1,1,1,1,1,1,1,null,2,2,null,null,null,2][t]
return 1===s?ke(n,{a:"wear",b:"Wear",c:"wearItem"}):2===s?ke(n,{a:"use",b:"Use",c:"useItem"}):void 0}},{title:"setName",data:"stats.set_name",orderable:!1,visible:!1},{title:"Tag",data:"guild_tag",render:t=>-1===t?"No":"Yes"},{title:"Drop",data:"type",render:function(t,e,n){if(!function(t){return-1!==t.guild_tag||t.equipped}(n))return"display"!==e?"Drop":`<span class="dropItem dropLink" data-tooltip="INSTANTLY DESTROY THE ITEM. NO REFUNDS OR DO-OVERS! Use at own risk." data-inv="${n.inv_id}">Drop</span>`}},{title:"Send",data:"type",render:function(t,e,n){if(!function(t){return t.equipped||-1===t.guild_tag&&t.bound}(n))return"display"!==e?"Send":`<span class="sendItem sendLink" data-tooltip="INSTANTLY SEND THE ITEM. NO REFUNDS OR DO-OVERS! Use at own risk." data-inv="${n.inv_id}">Send</span>`}}]
function we(){return"player_id"in Wt()}function Le(){const t=function(){const t=_t({className:"hover fshXSmall",id:we()?"fshUserInv":"fshGuildInv"})
return n(i(),t),t}(),e=function(t){return $(t).DataTable({autoWidth:!1,columnDefs:[{targets:"_all",defaultContent:""},{targets:[1,4,5,6,7,8,9,10,12,13],orderSequence:["desc","asc"]}],columns:Re,createdRow:pe,data:Wt().items,deferRender:!0,lengthMenu:[[50,100,150,200,-1],[50,100,150,200,"All"]],pageLength:50,stateDuration:0,stateSave:!0})}(t)
return function(t){[[12,"current_player_id"in Wt()],[17,we()&&le()],[18,we()&&ue()]].forEach((([e,n])=>t.column(e).visible(n)))}(e),t}function Me(t){g(`fsh_${a.subcmd}`,t)}function Se(){k('table.fshInvFilter input[type="checkbox"]').forEach((t=>{t.checked=1===de().checkedElements[t.getAttribute("item")]})),Me(de())}function Ee(t){zt("Select All"),de().checkedElements=ae,Se(),$(t).DataTable().draw(!1)}function je(t,e){de().fshMinLvl=t,de().fshMaxLvl=e,Me(de())}function Te(t){$(t).DataTable().draw(!1)}function De(t){zt("changeLvls"),xt(je,l(Te,t))}function Ne(t){return Number(t[0])>=100}function Ce(t,e){return t[e[0]]=e[1],t}function Ae(t){var e
zt("Select None"),de().checkedElements=(e=de().checkedElements,y(e).filter(Ne).reduce(Ce,{})),Se(),$(t).DataTable().draw()}function Pe(t){zt("Checkbox"),de().checkedElements={},k('table.fshInvFilter input[type="checkbox"][item]:checked').forEach((t=>{de().checkedElements[t.getAttribute("item")]=1})),Me(de()),$(t).DataTable().draw(!1)}function Ge(t){zt("Defaults"),de().checkedElements=ne.checkedElements,Se(),$(t).DataTable().draw(!1)}function Oe(t){zt("Reset levels"),de().fshMinLvl=ne.fshMinLvl,de().fshMaxLvl=ne.fshMaxLvl,Me(de()),function(t){$("#fshMinLvl").val(de().fshMinLvl),$("#fshMaxLvl").val(de().fshMaxLvl),$(t).DataTable().draw(!1)}(t)}async function Ue(t){const e=await vt(t)
return wt(e)}function qe(t){return St({subcmd2:"dostoreitems",items:t})}async function Fe(t){const e=await _({cmd:"guild",subcmd:"inventory",subcmd2:"dostoreitems",storeIndex:t})
return Et(e)}async function Be(t){const e=await function(t){return I(qe,Fe,t)}(t)
return jt(e),wt(e)}function We(t,e){t.eq(e).empty()}function He(t,e){if(1===e.r)return
const n=t.closest("tr")
!function(t){[2,12,13,14,15,16].forEach(l(We,t))}($("td",n)),n.css("text-decoration","line-through")}async function Qe(t,e){x(e),function(t){t.closest("tr").find(".takeItem, .recallItem, .wearItem, .dropItem, .sendItem, .storeItem").removeClass()}(e),function(t){t.empty().append(`<img src="${R}ui/misc/spinner.gif" width="11" height="11">`)}(e)
const n=await t()
n&&He(e,n)}function Ve(t,e){Zt("setName"),$(t).DataTable().search(e.attr("set")).draw(),$(`#${t.id}_filter input`).trigger("focus")}function Ye(t){Zt("takeItem"),Qe(l(Tt,t.attr("invid"),t.attr("action")),t)}function Je(t){Zt("recallItem"),Qe(l(Dt,t.attr("invid"),t.attr("playerid"),t.attr("mode"),t.attr("action")),t)}function Ke(t,e,n,s){Zt(n),Qe(l(t,e),s)}function Xe(t){Ke(Be,[t.attr("invid")],"doStoreItem",t)}function ze(t,e,n){Ke(t,n.attr("invid"),e,n)}const Ze=t=>ze(Lt,"doUseItem",t),tn=t=>ze(Mt,"doWearItem",t)
function en(t,e,n){Ke(t,[n.data("inv")],e,n)}const nn=t=>en(gt,"doDropItem",t),sn=t=>en(Ue,"doSendItem",t),an=t=>e=>t($(e.target))
function rn(t,[e,n]){$(t).on("click",`span.${e}`,an(n))}function cn(t){Zt("doMoveItem")
const e=$(t.target)
kt([e.data("inv")],e.val())}function on(t,e){$(e[0]).on("click",l(e[1],t))}const dn=t=>()=>{Zt(t)}
function ln(t){!function(t){[["#fshReset",Oe],["#fshAll",Ee],["#fshNone",Ae],["#fshDefault",Ge]].forEach(l(on,t))}(t),$("table.fshInvFilter").on("click",'input[type="checkbox"]',l(Pe,t)),function(t){[["dropItem",nn],["recallItem",Je],["sendItem",sn],["setName",l(Ve,t)],["storeItem",Xe],["takeItem",Ye],["useItem",Ze],["wearItem",tn]].forEach(l(rn,t))}(t),function(t){["fshInvItem","fshMaroon","sorting"].forEach((e=>{$(t).on("click",`.${e}`,dn(e))}))}(t)}let un=0
function fn(t,e){return Ct(un,At(e[1]),de().fshMinLvl,de().fshMaxLvl)}function pn(){un=[(t,e,n)=>0===n,...Nt],$.fn.dataTable.ext.search.push(fn)}function mn(){$.fn.dataTable.ext.search.push(((t,e,n,s)=>!de().checkedElements||de().checkedElements[s.type]))}function hn(){$.fn.dataTable.ext.search.push(((t,e,n,s)=>!de().checkedElements?.[-1]||function(t){return de().checkedElements[-1]&&t.stats&&""!==t.stats.set_name}(s)))}function bn(){$.fn.dataTable.ext.search.push(((t,e,n,s)=>{const a=(parseInt(s.rarity,10)+100).toString()
return!de().checkedElements||de().checkedElements[a]}))}function yn(t){let e,n,s,a,i,r,c,o,d
return{c(){e=S("div"),n=S("div"),n.textContent="Recall all visible to",s=E(),a=S("div"),i=S("button"),i.textContent="BP",r=E(),c=S("button"),c.textContent="GS",j(n,"class","head svelte-1mlms3r"),j(i,"class","custombutton svelte-1mlms3r"),j(i,"type","button"),j(c,"class","custombutton svelte-1mlms3r"),j(c,"type","button"),j(a,"class","btnbox svelte-1mlms3r"),j(e,"class","main svelte-1mlms3r")},m(l,u){T(l,e,u),D(e,n),D(e,s),D(e,a),D(a,i),D(a,r),D(a,c),o||(d=[N(i,"click",t[0]),N(c,"click",t[1])],o=!0)},p:C,i:C,o:C,d(t){t&&A(e),o=!1,P(d)}}}function vn(t){const e=t=>{d("Inventory","Recall All",t)}
return[function(){e("toBp"),[...k('span[action="take"]'),...k('span[mode="0"][action="recall"]')].forEach(G)},function(){e("toGs"),k('span[mode="1"][action="recall"]').forEach(G)}]}class gn extends w{constructor(t){super(),L(this,t,vn,yn,M,{})}}function kn(t){let e,n,s,a,i,r,c,o,d,l=(t[0]||"")+"",u=(t[1]||"")+""
return{c(){e=S("div"),n=O("Chunks needed: "),s=S("span"),a=O(l),i=E(),r=S("div"),c=O("Chunks received: "),o=S("span"),d=O(u)},m(t,l){T(t,e,l),D(e,n),D(e,s),D(s,a),T(t,i,l),T(t,r,l),D(r,c),D(r,o),D(o,d)},p(t,e){1&e&&l!==(l=(t[0]||"")+"")&&q(a,l),2&e&&u!==(u=(t[1]||"")+"")&&q(d,u)},d(t){t&&(A(e),A(i),A(r))}}}function $n(t){let e,n,s,a,i,r,c,o,d,l,u,f,p,m,h,b,y,v,g,k,$,_=t[0]&&kn(t)
return{c(){e=S("div"),n=S("div"),s=O("Update Stats\n    "),a=S("div"),i=O("[\n      "),r=S("div"),c=S("span"),o=O("?"),d=O("\n      ]"),l=E(),u=S("div"),f=S("button"),f.textContent="On page",p=E(),m=S("button"),m.textContent="All",h=E(),b=S("div"),y=S("button"),y.textContent="Clear cache",v=E(),g=S("div"),_&&_.c(),j(c,"class","tooltip-multiline"),j(c,"data-tooltip",t[5]),j(r,"class","tooltip svelte-15yybge"),j(a,"class","wrapper svelte-15yybge"),j(n,"class","head svelte-15yybge"),j(f,"class","custombutton svelte-15yybge"),j(f,"type","button"),j(m,"class","custombutton svelte-15yybge"),j(m,"type","button"),j(u,"class","btnbox svelte-15yybge"),j(y,"class","custombutton svelte-15yybge"),j(y,"type","button"),j(b,"class","btnbox svelte-15yybge"),j(g,"class","chunkbox svelte-15yybge"),j(e,"class","main svelte-15yybge")},m(I,x){T(I,e,x),D(e,n),D(n,s),D(n,a),D(a,i),D(a,r),D(r,c),D(c,o),D(a,d),D(e,l),D(e,u),D(u,f),D(u,p),D(u,m),D(e,h),D(e,b),D(b,y),D(e,v),D(e,g),_&&_.m(g,null),k||($=[N(f,"click",t[2]),N(m,"click",t[3]),N(y,"click",t[4])],k=!0)},p(t,[e]){t[0]?_?_.p(t,e):(_=kn(t),_.c(),_.m(g,null)):_&&(_.d(1),_=null)},i:C,o:C,d(t){t&&A(e),_&&_.d(),k=!1,P($)}}}function _n(t,e,n){let{fshInv:s=0}=e
const i=new DataTable(s)
let r=0,c=0
async function o([t,e,s]){const a=await Y(t,e,s)
return n(1,c+=1),a}async function l(t){const e=i.rows(B,t),s=W(H(e.data()))
n(0,r=s.length),n(1,c=0)
const a=await dt(s.map(o))
e.every(Q(a.flatMap(V))),i.draw()}const u=t=>{d("Inventory","Update Stats",t)}
U(s)
return t.$$set=t=>{"fshInv"in t&&n(6,s=t.fshInv)},[r,c,async function(){u("On page"),l({page:"current"})},function(){u("All"),l()},async function(){u("Clear cache"),await g(`fsh_${a.subcmd}_cache`,[]),G(F("fshRefresh"))},"This allows you to update the stats of items. It is useful in cases where stats are missing or if you want accurate stats for forged items. It can be slow for large data sets. The results are cached and will be used automatically next time you visit this page. You will need to update again if these stats become stale. For example, if you forged or crafted an item, or if a guild store item has moved.",s]}class In extends w{constructor(t){super(),L(this,t,_n,$n,M,{fshInv:6})}}function xn(t){let e
return{c(){e=S("div")},m(t,n){T(t,e,n)},i:C,o:C,d(t){t&&A(e)}}}function Rn(t){let e,n
return e=new gn({}),{c(){J(e.$$.fragment)},m(t,s){K(e,t,s),n=!0},i(t){n||(X(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function wn(t){let e,n,s,i,r,c
const o=[Rn,xn],d=[]
return n="guildinvmgr"===a.subcmd?0:1,s=d[n]=o[n](t),r=new In({props:{fshInv:t[0]}}),{c(){e=S("div"),s.c(),i=E(),J(r.$$.fragment),j(e,"class","container svelte-1tjz5ud")},m(t,s){T(t,e,s),d[n].m(e,null),D(e,i),K(r,e,null),c=!0},p(t,[e]){const n={}
1&e&&(n.fshInv=t[0]),r.$set(n)},i(t){c||(X(s),X(r.$$.fragment,t),c=!0)},o(t){z(s),z(r.$$.fragment,t),c=!1},d(t){t&&A(e),d[n].d(),Z(r)}}}function Ln(t,e,n){let{fshInv:s=0}=e
return t.$$set=t=>{"fshInv"in t&&n(0,s=t.fshInv)},[s]}class Mn extends w{constructor(t){super(),L(this,t,Ln,wn,M,{fshInv:0})}}function Sn(t){!function(t){new Mn({props:{fshInv:t},target:i()})}(t)}const En=()=>Wt().player_id?`<b>&nbsp;Inventory Manager</b> ${Wt().items.length} items (green = worn, blue = backpack)`:`<b>&nbsp;Guild Inventory Manager</b> ${Wt().items.length} items (maroon = in BP, blue=guild store)`
function jn(){const t=En()
tt("",i()),function(){if(!qt())return
Ft(n(F("pF"),nt({style:{textAlign:"center"}})))}(),et(i(),se.replace("@@reportTitle@@",t))}function Tn(){Pt(Wt().items)&&jn()}function Dn(){$("#fshMinLvl").val(de().fshMinLvl),$("#fshMaxLvl").val(de().fshMaxLvl)}const Nn=([,t])=>[t.id,t]
function Cn(t){lt([ee,pn,mn,hn,bn,Tn,Se,Dn])
const e=Le()
!function(t){$("#fshMinLvl, #fshMaxLvl").on("keyup",l(De,t)),$(t).on("change","select.fshMoveItem",cn),ln(t),Rt(t,dn,Zt)}(e),$("#fshRefresh").on("click",t),function(t){const e=$(`#${t.id}_filter input`)
e.prop("type","text")
const n=$("<span>&times;</span>")
e.wrap($('<span class="text-input-wrapper"/>')),e.after(n),n.on("click",l(te,t,e))}(e),Sn(e)}function An(t){ct("JS Perf","getInvMan"),Cn(t),ot("JS Perf","getInvMan")}const Pn=()=>Object.getOwnPropertyNames(Wt()).length
async function Gn(e){const n=[ut(),Xt()]
"guildinvmgr"===a.subcmd&&n.push(async function(){await t(!1),a.membrList=it(y(a.membrList).filter(Gt).map(Nn))}()),n.push(async function(){const t=await u(`fsh_${a.subcmd}`)
re={...mt(ne),...f(t,{})},ce=p("showQuickDropLinks"),oe=p("showQuickSendLinks")}()),await dt(n),Pn()&&function(t){rt(3,An,[t])}(e)}function On(){!st()&&i()&&("guildinvmgr"!==a.subcmd||c())&&(tt(`<span id="fshInvMan"><img src = "${at}">&nbsp;Getting inventory data...</span>`,i()),Gn(On))}export{On as default}
//# sourceMappingURL=inventory-yyJf07df.js.map
