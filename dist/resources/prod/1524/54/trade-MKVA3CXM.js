import{a as p}from"./chunk-BBJTJ3PY.js";import{a as P}from"./chunk-HG2UE43G.js";import{a as x,b as j}from"./chunk-Z5XSPKXA.js";import"./chunk-6SAAX4B5.js";import{a as M}from"./chunk-C7OLZHP6.js";import"./chunk-EH6HI6C6.js";import{b as q,c as D}from"./chunk-T42EJ6KP.js";import"./chunk-ZK7DROC7.js";import"./chunk-LHUEXIVY.js";import{a as H}from"./chunk-X63THUW4.js";import{a as w}from"./chunk-DEZFJJ5P.js";import{a as L}from"./chunk-SAH3AQWT.js";import{a as $}from"./chunk-XNGQGTQC.js";import"./chunk-S5PNJEX5.js";import{a as y}from"./chunk-SDLEVN3U.js";import{a as b}from"./chunk-KRMC6RHB.js";import{a}from"./chunk-GO7TNSV2.js";import{a as F}from"./chunk-C7VENGSF.js";import{a as h}from"./chunk-T5SOXK6H.js";import"./chunk-6YCYI5QI.js";import"./chunk-N6OIOPGP.js";import{a as T}from"./chunk-4BGELNLW.js";import"./chunk-UUCRRVRT.js";import"./chunk-KDAF7E27.js";import"./chunk-VNRGEE3X.js";import{a as O}from"./chunk-ZGR2D6YK.js";import{a as i}from"./chunk-T4Z7JY2Z.js";import"./chunk-VOSZ275N.js";import{a as A}from"./chunk-NFWUZ6G7.js";import"./chunk-MU27BHL6.js";import"./chunk-KJFFVIXC.js";import"./chunk-AA2SS673.js";import"./chunk-FJRQCZWN.js";import"./chunk-UTDTWSR5.js";import{a as s}from"./chunk-6AI4EA3G.js";import{a as v}from"./chunk-PTVVXABI.js";import{a as N}from"./chunk-OEVQOGQE.js";import"./chunk-ZKGIRUUN.js";import"./chunk-IZT3DORW.js";import{a as C}from"./chunk-REJ57ZO4.js";import"./chunk-VI6Y3FZI.js";import"./chunk-LAXTQMR6.js";import"./chunk-AOLXKWOL.js";import"./chunk-2WRNIMPS.js";import"./chunk-DVEUT6SI.js";import{a as m}from"./chunk-LKZ3ZEU4.js";import"./chunk-KTSA4HUA.js";import"./chunk-3WWWYMDW.js";import{a as n}from"./chunk-ZKT3V6EP.js";import"./chunk-562FJNCP.js";import{a as d}from"./chunk-OSE7TXVS.js";import"./chunk-AEOIQGDY.js";import"./chunk-JFH2ANYQ.js";import{a as E,b as f}from"./chunk-3PFYPJ7R.js";import{a as u}from"./chunk-6U4GCDKS.js";import"./chunk-C6Z346VW.js";import{sa as l}from"./chunk-4X7HEDV6.js";import"./chunk-XZ2D5B2Y.js";import{a as c}from"./chunk-HGTLDLGM.js";var k;function W(){let e=n("item-div");if(!e){e=N({id:"item-div",className:"itemDiv"});let t=n("item-list"),o=T(l,t);for(;o.length;)o[0].classList.add("fshBlock"),v(e,o[0]);a(e,t)}return e}function Q(e,t,o){return e&&A(t,o)}function z(e,t,o){return!e&&!t&&!o}function G(e,t){t.children[0].lastElementChild.children[0].children[0].checked=!1;let o=s("fshHide",t),r=e==="folderid0",S=s(e,t);Q(o,r,S)&&(t.classList.remove("fshHide"),t.classList.add("fshBlock")),z(o,r,S)&&(t.classList.remove("fshBlock"),w(t))}function J(e){h(l,W()).forEach(c(G,e.target.id))}function K(e){e.target.nodeName==="SPAN"&&e.target.id.indexOf("folderid")!==-1&&J(e)}function U(e){return` &ensp;<span id="folderid${e[0]}" class="fshLink fshNoWrap" fid=${e[0]}>${e[1]}</span> `}function X(e){let t=p({id:"fshFolderSelect",innerHTML:`<td colspan=6><span id="folderid0" class="fshLink" fid=0>All</span> &ensp;<span id="folderid-1" class="fshLink" fid="-1">Main</span>${C(e).map(U).join("")}`});m(t,K);let o=n("item-list").parentNode.parentNode;F(o,'<tr id="fshShowSTs"><td align="center" colspan=6><label><input type="checkbox" id="itemsInSt" checked> Select items in ST</label></td></tr>'),a(t,o)}function Y(e,t){t.is_in_st&&e.classList.add("isInST")}function Z(e){let t=e.children[0].lastElementChild.children[0];if(!t)return;let o=t.children[0];if(!o)return;let r=k[o.getAttribute("value")];r&&(e.classList.add(`folderid${r.folder_id}`),k.fshHasST&&Y(e,r),o.classList.add(`itemid${r.item_id}`),o.classList.add(`itemtype${r.type}`))}function ee(e){let t=f("betaOptIn");t&&q("trade.processTrade"),k=e.items,h(l,n("item-list")).forEach(Z),X(e.folders),t&&D("trade.processTrade")}function te(e){i(3,ee,[e])}function g(){$()||M().then(te)}function I(e,t){return O(x,j,e,t)}async function oe(e,t){let o=await e;return console.log("promise data",o),o===null||o.s?I(t[0],t[1]):o}async function ne(){let e=y('form[name="sendItemForm"] [name="target_username"]'),o=await d('[name="sendItemList[]"]:checked').map(r=>[e.value,[r.value]]).reduce(oe,Promise.resolve(null));console.log("finalResult",o)}function B(){let e=y('form[name="sendItemForm"] input[value="Send"]'),t=H({className:"fshBl",id:"oneByOneBtn",textContent:"OneByOne",type:"button"});P(t,e),m(t,ne)}function re(e){let t=parseInt(n("fshSendHowMany").value,10);return b(t)?e.length:u.subcmd!=="-"?Math.min(100,t):t}function se(e,t){return e==="itemid-2"&&s("itemtype12",t)}function ie(e,t){return e==="itemid-1"||se(e,t)||s(e,t)}function me(){let e=n("itemsInSt");if(e)return e.checked}function ce(e,t){return e||!s("isInST",t)}function _(e){return e.children[0].lastElementChild.children[0].children[0]}function R(e,t){t.checked=e}function ae(e){R(!1,e)}function le(e){R(!0,e)}function fe(e,t){t.filter(c(ce,me())).map(_).filter(c(ie,e)).slice(0,re(t)).forEach(le)}function de(e){let t=n("item-div")||n("item-list"),o=d("table:not(.fshHide)",t);o.map(_).forEach(ae),fe(e.target.id,o)}function pe(e){s("fshCheckAll",e.target)&&de(e)}function V(e){return L(`[${e}]`)}function ue(){let e=f("sendClasses"),t=V(e);return t||V(E.sendClasses)}function he(e){return` &ensp;<span id="itemid${e[1]}" class="fshCheckAll fshLink fshNoWrap">${e[0]}</span>`}function ye(e){let t=p({id:"fshSelectMultiple",innerHTML:`<td colspan=6>Select:&ensp;<span id="itemid-1" class="fshCheckAll fshLink fshNoWrap">All Items</span> &ensp;<span id="itemid-2" class="fshCheckAll fshLink fshNoWrap">All Resources</span>${ue().map(he).join("")} &ensp;How&nbsp;many:<input id="fshSendHowMany" type="text" class="custominput fshHowMany" value="all"></td>`});m(t,pe),a(t,e.parentNode.parentNode)}function ke(){let e=n("item-list");!e||(i(3,g),i(3,ye,[e]),u.userIsDev&&i(3,B))}export{ke as default};
//# sourceMappingURL=trade-MKVA3CXM.js.map
