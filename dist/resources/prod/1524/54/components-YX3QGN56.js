import{a as Ne,b as Re,c as Fe}from"./chunk-UXFKWLNY.js";import{a as J}from"./chunk-TE67ESRV.js";import{a as We}from"./chunk-ZHRTCLDT.js";import{a as ae}from"./chunk-ODYD27E4.js";import{a as Z}from"./chunk-VK76G7OF.js";import"./chunk-DKVOK45R.js";import{a as Ue}from"./chunk-67MIGLGE.js";import{a as H}from"./chunk-FI7QBVVQ.js";import"./chunk-FLOWSKWZ.js";import"./chunk-SNIFLWSF.js";import{A as le,C as ee,G as ce,H as ie,J as N,K as R,L as h,M as v,O as Me,P as Pe,Q as B,R as I,S as Q,T as X,U as Y,a as A,d as K,e as me,g as Qe,h as ne,m as O,o as u,p as y,q as D,r as Le,s as g,t as E,u as q,v as re,y as x}from"./chunk-3UYX2GUA.js";import{a as He}from"./chunk-QMNSVNGA.js";import{p as Ge}from"./chunk-73MEPCFL.js";import"./chunk-M2HNJF7B.js";import{a as Ve}from"./chunk-4BRS4YID.js";import{a as qe}from"./chunk-NWEDQK2E.js";import{a as je}from"./chunk-SDLEVN3U.js";import"./chunk-OJ3R4IZK.js";import{a as Be}from"./chunk-ASVE332D.js";import{a as Ie}from"./chunk-KDAF7E27.js";import"./chunk-VNRGEE3X.js";import{a as z}from"./chunk-ZGR2D6YK.js";import{a as F}from"./chunk-AA2SS673.js";import{a as W}from"./chunk-FJRQCZWN.js";import"./chunk-UTDTWSR5.js";import"./chunk-PTVVXABI.js";import{a as Te}from"./chunk-OEVQOGQE.js";import"./chunk-ZKGIRUUN.js";import"./chunk-IZT3DORW.js";import{a as xe}from"./chunk-REJ57ZO4.js";import{a as G}from"./chunk-SVIDRAEF.js";import"./chunk-VI6Y3FZI.js";import"./chunk-LAXTQMR6.js";import{a as oe}from"./chunk-AOLXKWOL.js";import"./chunk-2WRNIMPS.js";import"./chunk-DVEUT6SI.js";import"./chunk-ACUHISUK.js";import{a as Ee}from"./chunk-LKZ3ZEU4.js";import"./chunk-KTSA4HUA.js";import{a as P}from"./chunk-MF5QCESC.js";import"./chunk-3WWWYMDW.js";import{a as Se}from"./chunk-ZKT3V6EP.js";import"./chunk-562FJNCP.js";import{a as V}from"./chunk-OSE7TXVS.js";import"./chunk-AEOIQGDY.js";import"./chunk-JFH2ANYQ.js";import"./chunk-4RUOSMIM.js";import"./chunk-3PFYPJ7R.js";import"./chunk-6U4GCDKS.js";import"./chunk-C6Z346VW.js";import{g as we}from"./chunk-4X7HEDV6.js";import{b as Ae}from"./chunk-XZ2D5B2Y.js";import{a as M}from"./chunk-HGTLDLGM.js";var L=Ne(new Map),ze=Re(L,t=>[...t].reduce((e,[,o])=>e+(o.get("del")?.length??0),0));function st(t){let e;return{c(){e=g("tr"),e.innerHTML='<td class="compDel svelte-1qoer4b" colspan="3">Deleted</td>'},m(o,n){y(o,e,n)},p:A,i:A,o:A,d(o){o&&D(e)}}}function mt(t){let e,o,n,r,l,a,c,$=t[0].get("del").length+"",m,s,p,k,S,f,d=[ft,pt],_=[];function w(i,j){return(p==null||j&1)&&(p=!!i[0].get("delPending")),p?0:1}return k=w(t,-1),S=_[k]=d[k](t),{c(){e=g("tr"),o=g("td"),n=g("img"),a=q(),c=g("td"),m=E($),s=q(),S.c(),me(n.src,r=t[1](t[0]))||x(n,"src",r),x(n,"class","tip-dynamic"),x(n,"data-tipped",l=t[2](t[0])),x(n,"alt","component")},m(i,j){y(i,e,j),u(e,o),u(o,n),u(e,a),u(e,c),u(c,m),u(e,s),_[k].m(e,null),f=!0},p(i,j){(!f||j&1&&!me(n.src,r=i[1](i[0])))&&x(n,"src",r),(!f||j&1&&l!==(l=i[2](i[0])))&&x(n,"data-tipped",l),(!f||j&1)&&$!==($=i[0].get("del").length+"")&&le(m,$);let b=k;k=w(i,j),k===b?_[k].p(i,j):(N(),v(_[b],1,1,()=>{_[b]=null}),R(),S=_[k],S?S.p(i,j):(S=_[k]=d[k](i),S.c()),h(S,1),S.m(e,null))},i(i){f||(h(S),f=!0)},o(i){v(S),f=!1},d(i){i&&D(e),_[k].d()}}}function pt(t){let e,o,n;return o=new H({props:{$$slots:{default:[ut]},$$scope:{ctx:t}}}),o.$on("click",O(t[3])),{c(){e=g("td"),B(o.$$.fragment)},m(r,l){y(r,e,l),I(o,e,null),n=!0},p(r,l){let a={};l&256&&(a.$$scope={dirty:l,ctx:r}),o.$set(a)},i(r){n||(h(o.$$.fragment,r),n=!0)},o(r){v(o.$$.fragment,r),n=!1},d(r){r&&D(e),Q(o)}}}function ft(t){let e;return{c(){e=g("td"),e.innerHTML='<span class="fshSpinner fshSpinner12"></span>',x(e,"class","compSumSpin")},m(o,n){y(o,e,n)},p:A,i:A,o:A,d(o){o&&D(e)}}}function ut(t){let e;return{c(){e=E("Del")},m(o,n){y(o,e,n)},d(o){o&&D(e)}}}function dt(t){let e,o,n,r,l,a=[mt,st],c=[];function $(m,s){return(e==null||s&1)&&(e=!!m[0].get("del").length),e?0:1}return o=$(t,-1),n=c[o]=a[o](t),{c(){n.c(),r=re()},m(m,s){c[o].m(m,s),y(m,r,s),l=!0},p(m,[s]){let p=o;o=$(m,s),o===p?c[o].p(m,s):(N(),v(c[p],1,1,()=>{c[p]=null}),R(),n=c[o],n?n.p(m,s):(n=c[o]=a[o](m),n.c()),h(n,1),n.m(r.parentNode,r))},i(m){l||(h(n),l=!0)},o(m){v(n),l=!1},d(m){c[o].d(m),m&&D(r)}}}function _t(t,e,o){let n;ne(t,L,p=>o(5,n=p));let{itemId:r}=e,l=ce(),a=Ve(),c=p=>`${Ae}items/${p.get("b")}.gif`,$=p=>`fetchitem.php?item_id=${p.get("b")}&inv_id=${p.get("a")}&t=2&p=${a}&vcode=${p.get("v")}`,m;function s(){P("components","delType"),l("delType",r)}return t.$$set=p=>{"itemId"in p&&o(4,r=p.itemId)},t.$$.update=()=>{if(t.$$.dirty&48){e:o(0,m=n.get(r))}},[m,c,$,s,r,n]}var Ke=class extends Y{constructor(e){super();X(this,e,_t,dt,K,{itemId:4})}},Oe=Ke;var bt=/\?item_id=(\d+)&inv_id=(\d+)&.*&vcode=([0-9a-f]+)/;function gt(t){let e=t.children[0].dataset.tipped.match(bt);return{a:Number(e[2]),b:Number(e[1]),v:e[3]}}var ht=t=>V('a[href*="=destroycomponent&"]',t).map(gt);async function pe(){let t=await W({cmd:"profile"}),e=F(t),o=V('a[href*="profile&component_page="]',e);return{r:(await Z([t,...o.slice(1).map(l=>oe(l.href))])).map(F).flatMap(ht),s:!0}}function fe(){return G({subcmd:"loadcomponents"})}function ue(){return z(fe,pe)}function de(){return G({subcmd:"limits"})}var kt=t=>t[t.length-1].href,Xe=t=>V('td[background*="1x1mini"]',t).length;async function $t(t,e){if(e.length>1){let o=F(await oe(kt(e)));return(e.length-1)*50+Xe(o)}return Xe(t)}async function _e(){let t=F(await W({cmd:"profile"})),e=V('a[href*="=profile&component_page="]',t);return{r:{max_components:await $t(t,e)},s:!0}}function be(){return z(de,_e)}async function se(t){let e=await t();if(!e?.s)throw new Error(e?.e?.message??"Unknown Error");return e}function ge(t){return new Map(xe(t))}function Ye(t){t[4]=t[6][0],t[5]=t[6][1].r}function Ze(t,e,o){let n=t.slice();return n[7]=e[o],n}function vt(t){let e,o=t[10].message+"",n;return{c(){e=g("p"),n=E(o),ee(e,"color","red")},m(r,l){y(r,e,l),u(e,n)},p:A,i:A,o:A,d(r){r&&D(e)}}}function yt(t){Ye(t);let e,o,n,r,l,a,c,$,m,s,p,k,S,f=t[5].max_components+"",d,_,w=t[4],i=[];for(let b=0;b<w.length;b+=1)i[b]=Je(Ze(t,w,b));let j=b=>v(i[b],1,1,()=>{i[b]=null});return{c(){e=g("div"),o=g("table"),n=g("thead"),n.innerHTML='<tr><th colspan="3">Component Summary</th></tr>',r=q(),l=g("tbody");for(let b=0;b<i.length;b+=1)i[b].c();a=q(),c=g("tfoot"),$=g("tr"),m=g("td"),m.textContent="Total:",s=q(),p=g("td"),k=E(t[0]),S=E(" / "),d=E(f),x(p,"colspan","2"),x(o,"class","fshTblCenter")},m(b,T){y(b,e,T),u(e,o),u(o,n),u(o,r),u(o,l);for(let C=0;C<i.length;C+=1)i[C].m(l,null);u(o,a),u(o,c),u(c,$),u($,m),u($,s),u($,p),u(p,k),u(p,S),u(p,d),_=!0},p(b,T){if(Ye(b),T&2){w=b[4];let C;for(C=0;C<w.length;C+=1){let Ce=Ze(b,w,C);i[C]?(i[C].p(Ce,T),h(i[C],1)):(i[C]=Je(Ce),i[C].c(),h(i[C],1),i[C].m(l,null))}for(N(),C=w.length;C<i.length;C+=1)j(C);R()}(!_||T&1)&&le(k,b[0])},i(b){if(!_){for(let T=0;T<w.length;T+=1)h(i[T]);_=!0}},o(b){i=i.filter(Boolean);for(let T=0;T<i.length;T+=1)v(i[T]);_=!1},d(b){b&&D(e),Le(i,b)}}}function Je(t){let e,o;return e=new Oe({props:{itemId:t[7]}}),e.$on("delType",t[2]),{c(){B(e.$$.fragment)},m(n,r){I(e,n,r),o=!0},p:A,i(n){o||(h(e.$$.fragment,n),o=!0)},o(n){v(e.$$.fragment,n),o=!1},d(n){Q(e,n)}}}function Dt(t){let e;return{c(){e=g("div"),e.innerHTML='<span class="fshSpinner fshSpinner12"></span>',x(e,"class","compSumSpin")},m(o,n){y(o,e,n)},p:A,i:A,o:A,d(o){o&&D(e)}}}function Ct(t){let e,o,n,r={ctx:t,current:null,token:null,hasCatch:!0,pending:Dt,then:yt,catch:vt,value:6,error:10,blocks:[,,,]};return Me(o=Z([t[1](),se(be)]),r),{c(){e=re(),r.block.c()},m(l,a){y(l,e,a),r.block.m(l,r.anchor=a),r.mount=()=>e.parentNode,r.anchor=e,n=!0},p(l,[a]){t=l,Pe(r,t,a)},i(l){n||(h(r.block),n=!0)},o(l){for(let a=0;a<3;a+=1){let c=r.blocks[a];v(c)}n=!1},d(l){l&&D(e),r.block.d(l),r.token=null,r=null}}}function St(t,e,o){let n;ne(t,ze,c=>o(0,n=c));function r(c){let $=new Map(ae(c,"b").map(m=>[m.b,ge({...m,del:c.filter(({b:s})=>s===m.b).map(({a:s})=>s),delPending:!1})]));return L.set($),[...$.keys()]}async function l(){let c=await se(ue);return r(c.r)}function a(c){ie.call(this,t,c)}return[n,l,a]}var et=class extends Y{constructor(e){super();X(this,e,St,Ct,K,{})}},tt=et;function ot(t){let e,o,n;return o=new H({props:{$$slots:{default:[At]},$$scope:{ctx:t}}}),o.$on("click",O(t[2])),{c(){e=g("div"),B(o.$$.fragment)},m(r,l){y(r,e,l),I(o,e,null),n=!0},p(r,l){let a={};l&256&&(a.$$scope={dirty:l,ctx:r}),o.$set(a)},i(r){n||(h(o.$$.fragment,r),n=!0)},o(r){v(o.$$.fragment,r),n=!1},d(r){r&&D(e),Q(o)}}}function At(t){let e;return{c(){e=E("Enable Quick Del")},m(o,n){y(o,e,n)},d(o){o&&D(e)}}}function wt(t){let e,o;return e=new tt({}),e.$on("delType",t[6]),{c(){B(e.$$.fragment)},m(n,r){I(e,n,r),o=!0},p:A,i(n){o||(h(e.$$.fragment,n),o=!0)},o(n){v(e.$$.fragment,n),o=!1},d(n){Q(e,n)}}}function xt(t){let e,o,n;return o=new H({props:{$$slots:{default:[Tt]},$$scope:{ctx:t}}}),o.$on("click",O(t[3])),{c(){e=g("div"),B(o.$$.fragment)},m(r,l){y(r,e,l),I(o,e,null),n=!0},p(r,l){let a={};l&256&&(a.$$scope={dirty:l,ctx:r}),o.$set(a)},i(r){n||(h(o.$$.fragment,r),n=!0)},o(r){v(o.$$.fragment,r),n=!1},d(r){r&&D(e),Q(o)}}}function Tt(t){let e;return{c(){e=E("Count Components")},m(o,n){y(o,e,n)},d(o){o&&D(e)}}}function Et(t){let e;return{c(){e=E("Quick Extract")},m(o,n){y(o,e,n)},d(o){o&&D(e)}}}function nt(t){let e,o,n,r;return o=new H({props:{$$slots:{default:[jt]},$$scope:{ctx:t}}}),o.$on("click",O(t[5])),{c(){e=g("div"),n=g("div"),B(o.$$.fragment),ee(n,"display","contents"),ee(n,"--button-color","red")},m(l,a){y(l,e,a),u(e,n),I(o,n,null),r=!0},p(l,a){let c={};a&256&&(c.$$scope={dirty:a,ctx:l}),o.$set(c)},i(l){r||(h(o.$$.fragment,l),r=!0)},o(l){v(o.$$.fragment,l),r=!1},d(l){l&&D(e),Q(o)}}}function jt(t){let e;return{c(){e=E("Delete All Visible")},m(o,n){y(o,e,n)},d(o){o&&D(e)}}}function qt(t){let e,o,n,r,l,a,c,$,m,s=!t[0]&&ot(t),p=[xt,wt],k=[];function S(d,_){return d[1]?1:0}n=S(t,-1),r=k[n]=p[n](t),c=new H({props:{$$slots:{default:[Et]},$$scope:{ctx:t}}}),c.$on("click",t[4]);let f=t[0]&&nt(t);return{c(){e=g("div"),s&&s.c(),o=q(),r.c(),l=q(),a=g("div"),B(c.$$.fragment),$=q(),f&&f.c(),x(e,"class","fshCenter")},m(d,_){y(d,e,_),s&&s.m(e,null),u(e,o),k[n].m(e,null),u(e,l),u(e,a),I(c,a,null),u(e,$),f&&f.m(e,null),m=!0},p(d,[_]){d[0]?s&&(N(),v(s,1,1,()=>{s=null}),R()):s?(s.p(d,_),_&1&&h(s,1)):(s=ot(d),s.c(),h(s,1),s.m(e,o));let w=n;n=S(d,_),n===w?k[n].p(d,_):(N(),v(k[w],1,1,()=>{k[w]=null}),R(),r=k[n],r?r.p(d,_):(r=k[n]=p[n](d),r.c()),h(r,1),r.m(e,l));let i={};_&256&&(i.$$scope={dirty:_,ctx:d}),c.$set(i),d[0]?f?(f.p(d,_),_&1&&h(f,1)):(f=nt(d),f.c(),h(f,1),f.m(e,null)):f&&(N(),v(f,1,1,()=>{f=null}),R())},i(d){m||(h(s),h(r),h(c.$$.fragment,d),h(f),m=!0)},o(d){v(s),v(r),v(c.$$.fragment,d),v(f),m=!1},d(d){d&&D(e),s&&s.d(),k[n].d(),Q(c),f&&f.d()}}}function Bt(t,e,o){let n,r,l=ce();function a(){P("components","enableQuickDel"),o(0,n=!0),l("enableQuickDel")}function c(){P("components","countComponents"),o(1,r=!0)}function $(){P("components","insertQuickExtract"),He(Ge)}function m(){P("components","deleteAllVisible"),l("deleteAllVisible")}function s(p){ie.call(this,t,p)}return[n,r,a,c,$,m,s]}var rt=class extends Y{constructor(e){super();X(this,e,Bt,qt,K,{})}},lt=rt;function he(t){return G({subcmd:"destroycomponent",removeIndex:t})}function It(t,e){let o=Ie(e),n=1;return o==="Component destroyed."&&(n=0),{r:n,m:o,c:t}}function Qt(t){return W({cmd:"profile",subcmd:"destroycomponent",component_id:t}).then(M(It,t))}function Lt(t){let e=t.filter(n=>n.r===0),o=t.filter(n=>n.r===1);return e.length>0?{r:e.map(n=>n.c),s:!0}:o.length>0?{e:{message:o[0].m},s:!1}:{e:{message:t[0].m},s:!1}}function ke(t){return We(t.map(Qt),Lt)}function $e(t){return z(he,ke,t)}function Mt(t,e){if(!e)return;let o=e.get("del").filter(n=>!t.includes(n));e.set("del",o)}function Pt(t,e){L.update(o=>(Mt(e,o.get(t)),o))}function Nt(t,e,o){L.update(n=>(n.get(t)?.set(e,o),n))}function Rt(t){if(!t)return;let e=t.children[0];return e.replaceWith(Te({className:"compSumSpin",innerHTML:'<span class="fshSpinner fshSpinner12"></span>'})),e}function ct(t,e){Nt(e,"delPending",t)}function Vt(t){t.forEach(([e,o])=>{o&&e.children[0].replaceWith(o)})}var Ht=t=>t.forEach(([e])=>e?.children[0]?.remove()),Ut=t=>t.map(([e])=>[e,Rt(e)]),Wt=([,t])=>t,it=t=>ae(t.map(Wt)),at=([,,t])=>t,Ft=t=>it(t).map(e=>[e,t.filter(([,o])=>o===e).map(at)]),Gt=t=>Pt(...t);async function zt(t){let e=Ut(t),o=await $e(t.map(at));o?.s?(Ft(t).forEach(Gt),Ht(e)):(Fe(o?.e?.message??"Unknown Error"),Vt(e))}async function U(t){let e=it(t);e.forEach(M(ct,!0)),await Z(Ue(30,t).map(zt)),e.forEach(M(ct,!1))}var Kt=t=>Qe(L).get(t.detail).get("del"),Ot=(t,e)=>J(je(`img[data-tipped*="&inv_id=${e}&"]`,t));async function ve(t,e){U(Kt(e).map(o=>[Ot(t,o),e.detail,o]))}function te(t){let e=t.dataset.tipped.match(we);return[Number(e[1]),Number(e[2])]}var Xt=t=>[J(t),...te(t)];function ye(t){U(V("img",t).map(Xt))}function Yt(t){t.target.tagName==="IMG"&&(t.preventDefault(),P("components","quickDel"),Be(t.target),U([[J(t.target),...te(t.target)]]))}function De(t){t.classList.add("fshQuickDel"),Ee(t,Yt)}function Zt(){let t=Se("profileRightColumn"),e=qe("inventory-table",t);if(e.length===2)return e[1]}function Jt(){let t=Zt();if(!t)return;let e=new lt({target:t.parentNode});e.$on("enableQuickDel",M(De,t)),e.$on("delType",M(ve,t)),e.$on("deleteAllVisible",M(ye,t))}export{Jt as default};
//# sourceMappingURL=components-YX3QGN56.js.map
