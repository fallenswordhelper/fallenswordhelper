import{c as t,m as e,y as a,z as n,h as r,t as o,i,o as s,aB as u,aC as l,aD as c,aE as f,Z as d,b as m,f as h,D as p,C as b,V as g,ai as v,H as y,aF as k,B as w,ax as L,aG as C,aH as D,aI as A,aJ as M,aK as V,aL as S,ao as H,aA as N,A as B,aM as G,a2 as T,T as x,v as E,aa as P,a3 as j,aN as I,aO as R,P as O,u as F,aP as _,aQ as q,aR as K,aS as Y,av as z,q as U,a as Q,J as W,aT as J,aU as Z,aV as X,aW as tt,aX as et,l as at,M as nt,as as rt,a5 as ot,aY as it,aZ as st,a_ as ut,a$ as lt,b0 as ct,b1 as ft,b2 as dt,b3 as mt,b4 as ht}from"./calfSystem-793da633.js"
import{i as pt}from"./insertElementAfter-cbb9f3a9.js"
import{t as bt}from"./toggleForce-f376374b.js"
import{c as gt}from"./createSpan-2b6fe10e.js"
import{i as vt}from"./insertTextBeforeEnd-62f9f72f.js"
import{a as yt,r as kt}from"./roundToString-c55ff653.js"
import{a as wt}from"./addCommas-4b913655.js"
import{d as Lt,q as Ct}from"./quickbuffSuccess-50632151.js"
import{p as Dt}from"./playerName-5c267470.js"
import{i as At}from"./isArray-3d9d6e31.js"
import{g as Mt,s as Vt}from"./idb-e7344221.js"
import{c as $t}from"./createStyle-ebbd2c27.js"
import{g as St}from"./getArrayByClassName-ea5b14c8.js"
import{e as Ht}from"./executeAll-7837be0f.js"
import{c as Nt}from"./createButton-6735d85a.js"
import{e as Bt}from"./eventHandler5-dd5f5b88.js"
import{i as Gt}from"./insertElementBefore-9e5d02cd.js"
import{c as Tt}from"./createInput-9733446a.js"
import{c as xt}from"./createLabel-c606cd5f.js"
import{o as Et}from"./openQuickBuffByName-074c8760.js"
import{a as Pt}from"./all-3246a95f.js"
import{a as jt}from"./allthen-9dd15411.js"
import{d as It,g as Rt}from"./getGroupStats-4df94e7b.js"
import{g as Ot}from"./getMercStats-1a0b11c0.js"
import{g as Ft}from"./getProfile-b68e9095.js"
import{g as _t}from"./getMembrList-b3463327.js"
import{h as qt}from"./hideElement-7b9c883f.js"
import{n as Kt}from"./numberIsNaN-738f2a3f.js"
import{r as Yt}from"./reduceBuffArray-7cd20b37.js"
import{r as zt}from"./rnd-e579b276.js"
import{h as Ut}from"./hasClasses-ef43cc6b.js"
import{v as Qt}from"./valueText-23076c84.js"
import{g as Wt}from"./guild-367418e5.js"
import{g as Jt,a as Zt}from"./getTitanString-c1115a95.js"
import{p as Xt}from"./padZ-d4e02992.js"
import{c as te}from"./createTable-1ddc44c4.js"
import{t as ee}from"./testQuant-0f1de145.js"
import{m as ae}from"./myStats-613f3819.js"
import{a as ne}from"./huntingBuffs-a409ddf7.js"
import{b as re}from"./simpleCheckbox-7834ef28.js"
import{b as oe}from"./bitwiseAnd-822dbd82.js"
import{s as ie}from"./shouldBeArray-9d21631b.js"
import"./fshOpen-49538a62.js"
import"./chunk-5d7e6f3a.js"
import"./createLi-b0b9466b.js"
import"./createUl-870923e1.js"
import"./groupViewStats-fda5fcc8.js"
import"./intValue-d2a6f461.js"
import"./cmdExport-6a61d44d.js"
import"./indexAjaxJson-bfa28533.js"
import"./currentGuildId-1aba3c9c.js"
import"./testRange-d919f908.js"
import"./isChecked-d96c8dec.js"
import"./isSelected-2ed90a64.js"
import"./csvSplit-5e072bd9.js"
let se,ue,le,ce,fe,de,me,he,pe
function be(t){return t}function ge(n){if(function(e){return t.showBuffInfo&&e.some(be)}(n))return function(){if(se)bt(se,!1)
else{se=e({className:"fshActionBox",innerHTML:"<div></div><div></div><div></div><div></div><div></div><div></div>"})
const t=a("actionContainer")
pt(se,t.children[2])}return se}()
se&&bt(se,!0)}function ve(t,e){ue?bt(ue,!1):function(t){ue=t.children[3],ue.className="fshBlue",n("CA ",ue),le=gt(),r(ue,le),vt(ue," active")}(t),n(e.level,le)}function ye(t,e){e?ve(t,e):ue&&bt(ue,!0)}function ke(t,e){ce?bt(ce,!1):function(t){ce=t.children[4],ce.className="fshRed",n("Doubler ",ce),fe=gt(),r(ce,fe),vt(ce," active")}(t),n(e.level,fe)}function we(t,e){e?ke(t,e):ce&&bt(ce,!0)}function Le(t,e,a){de?bt(de,!1):function(t){de=t.children[2],n("Damage bonus: ",de),me=gt(),r(de,me),vt(de,"%")}(t),n(function(t,e){if(t){const a=Math.min(.01*Math.round(Math.floor(e/5)*Number(t.level)),20)
return yt(a,2).toString()}return"0"}(e,Number(a)),me)}function Ce(t,e,a){e?Le(t,e,a):de&&bt(de,!0)}function De(t,e){n(wt(t),e)}function Ae(t,e){he?bt(he,!1):function(t){he=t.children[1],n("Kill Streak: ",he),pe=gt(),r(he,pe)}(t),De(e,pe)}function Me(t,e,a,n){e||a?Ae(t,n):he&&bt(he,!0)}function Ve(t,e){return e.name===t}function $e(t){const{buffs:e}=GameData.player()
if(e)return e.find(o(Ve,t))}const Se=["red","orange","yellow"]
let He,Ne
function Be(t){Ct(t)&&GameData.fetch(u)}function Ge(){$e("Summon Shield Imp")||Lt([Dt()],[55]).then(Be)}const Te=["imp-0","imp-1","imp-1"]
function xe(t,e){He?bt(He,!1):function(t){He=t.children[0],n("Shield Imps Remaining: ",He),Ne=gt(),r(He,Ne),i(He,"&nbsp;")
const e=gt({className:"xSmallLink",textContent:"Recast"})
r(He,e),s(e,Ge)}(t)
const a=function(t){return t?Number(t.stack):0}(e)
He.className=function(t){return Te[t]||"fshGreen"}(a),n(a,Ne)}function Ee(t,e,a){e||a?xe(t,e):He&&bt(He,!0)}function Pe(t){return 0===t.type}function je(t){return gt({textContent:t})}let Ie,Re,Oe,Fe,_e,qe,Ke,Ye,ze,Ue
function Qe(t,e){Ie?bt(Ie,!1):function(t,e){Ie=t.children[5],n("Teleport Cooldown: ",Ie),Re=je(e.toString()),r(Ie,Re)}(t,e)}function We(){const t=Math.max(Math.ceil((Oe-Date.now())/1e3),0)
n(t,Re),t>0&&setTimeout(We,500)}function Je(t,e){e?Qe(t,e):Ie&&bt(Ie,!0)}function Ze(){Fe=$e("Death Dealer"),_e=$e("Doubler"),qe=$e("Counter Attack"),Ke=$e("Summon Shield Imp"),Ye=function(){const t=GameData.player().teleportCooldown
return t>1&&t}(),ze=function(){const{dynamic:t}=GameData.realm()
return At(t)&&t.some(Pe)}(),Ue=GameData.player().killStreak}function Xe(){!function(){const t=$("#actionlist-shield-imp")
1===t.length&&t.css("background-color",Se[t.text()]||"#ad8043")}(),Ze()
const t=ge([Fe,_e,qe,Ke,Ye,ze])
t&&(Ee(t,Ke,Fe),Me(t,Fe,ze,Ue),Ce(t,Fe,Ue),ye(t,qe),we(t,_e),Je(t,Ye))}function ta(t,e){var a
a=e.player.teleportCooldown,Re&&(Oe=Date.now()+1e3*a,We())}const ea=["NORMAL","CHAMPION","ELITE","SUPER ELITE","TITAN","LEGENDARY"]
let aa=!1
function na(t){return b(".verb.attack",t)}function ra(t){const e=ea.indexOf(t.toUpperCase())
return p(`#actionList .actionListItem.creature.creature-${e}`)}function oa(t){const e=["LEGENDARY","NORMAL"].flatMap(ra),a=ra("CHAMPION"),[n,r]=t?[e,a]:[a,e],o=`url("${v}ui/world/icon_action_attack_`
n.map(na).filter((t=>null!==t)).forEach((t=>{t.classList.remove("attack-1","attack-2","attack-3","attack-4","attack-5","attack-6","attack-7","attack-8"),t.style.backgroundImage=""})),r.slice(0,8).map(na).forEach(((t,e)=>{null!==t&&(t.classList.add(`attack-${e+1}`),t.style.backgroundImage=`${o}${e+1}.png")`)}))}function ia(t){if(!t.ctrlKey||!t.shiftKey||"INPUT"===t.target.tagName||"TEXTAREA"===t.target.tagName)return
if(aa||oa(!0),aa=!0,!t.code.match(/(Digit|Numpad)[1-8]/))return
const e=ra("CHAMPION"),a=parseInt(t.code.slice(-1),10)-1
if(a<e.length){const t=na(e[a])
null!==t&&(g("world","ChampionAttack"),t.click())}}function sa(t){!aa||t.ctrlKey&&t.shiftKey||(aa=!1,oa(!1))}const ua=["Breaker","Protection","Master Thief","Protect Gold","Disarm","Duelist","Thievery","Master Blacksmith","Master Crafter","Fury Caster","Master Inventor","Sustain"]
let la,ca=[]
function fa(t){54!==t.id&&26!==t.id||(la.player.buffs[t.id]=parseInt(t.level,10))}function da(t){-1===ua.indexOf(t.name)&&(la.player.enhancements[t.name]=t.value)}function ma(t,e){la={},la.combat=e.response.data,la.combat.inventory_id&&(la.combat.drop=la.combat.item.id),la.player={},la.player.buffs={},la.player.enhancements={},function(t){t.player.buffs&&t.player.buffs.forEach(fa)}(e),function(t){t.player.enhancements&&t.player.enhancements.forEach(da)}(e),la.time=e.time,ca.push(la),Vt("fsh_combatLog",ca)}function ha(t,e){0===e.response.response&&ma(0,e)}function pa(t){t&&(ca=t),$.subscribe(k,ha)}function ba(e){return t.doNotKillList.includes(e.trim())}function ga(t){t.classList.toggle("fshBlue",ba(w(t)))}function va(){const t=a("actionList")
St("creature",t).forEach(ga)}function ya(t){const e=GameData.actions()[t]
if(e)return function(t,e){if(ba(t))return a("actionList").children[e].children[0].children[1].classList.remove("loading"),!0}(e.data.name,t)}const ka={2:function(t){return function(e,a,n,r){ya(n.passback)||t(e,a,n,r)}}}
function wa(t){return function(e,a,n,r){const o=ka[e];(function(t){return t&&L(t)})(o)&&function(t){return C(t)||0===t}(r)?o(t)(e,a,n,r):t(e,a,n,r)}}function La(){window.GameController&&GameController.Realm&&!GameController.Realm.footprintTileList&&(GameController.Realm.footprintTileList=[])}function Ca(t,e,a){return xt({className:`fshCurveEle fshCurveLbl fshPoint tip-static ${t}`,dataset:{tipped:e},htmlFor:a})}function Da(t){const a=e({className:"fshToggle"}),n=Tt({checked:t.prefVal,id:t.checkId,type:"checkbox"})
r(a,n)
const o=Ca(t.onClass,t.onTip,t.checkId)
r(a,o)
const i=Ca(t.offClass,t.offTip,t.checkId)
return r(a,i),r(t.worldName,a),n}let Aa,Ma,Va,$a,Sa,Ha,Na,Ba,Ga
function Ta(t){return t?t.toString():"?"}function xa(t){const a=e({className:"fshFsty"})
r(a,function(){const t=e({textContent:"Min Lvl: "})
return Ma=je(Ta(GameData.realm().minlevel)),r(t,Ma),t}()),r(a,function(){const t=e({textContent:"Your Lvl: "})
return Va=je(Ta(GameData.player().level)),r(t,Va),t}()),r(t,a)}function Ea(t,e,a){const n=Nt({className:`fshCurveEle fshCurveBtn fshPoint tip-static ${t}`,dataset:{tipped:e}})
return r(a,n),n}function Pa(){var e
xa(e=Aa),$a=Ea("fshFormGroup","Quick Create Attack Group",e),Sa=Ea("fshQuickBuff","Open Quick Buff Popup",e),Ha=Ea("fshRealmMap","Open Realm Map",e),Na=Ea("fshTempleOne","Search map in Ultimate FSG",e),function(t){if(y("showSpeakerOnWorld")){const e=y("playNewMessageSound")
Ba=Da({prefVal:e,checkId:"fshSoundCheck",onClass:"soundOn",onTip:"Turn Off Sound when you have a new log message",offClass:"soundOff",offTip:"Turn On Sound when you have a new log message",worldName:t})}}(Aa),function(e){const a=t.huntingMode
Ga=Da({prefVal:a,checkId:"fshHuntCheck",onClass:"huntOn",onTip:"Hunting mode is ON",offClass:"huntOff",offTip:"Hunting mode is OFF",worldName:e})}(Aa)}const ja=[[t=>t===Ba,function(){d("playNewMessageSound",!y("playNewMessageSound"))}],[t=>t===Ga,function(){t.huntingMode=!t.huntingMode,d("huntingMode",t.huntingMode)}]],Ia=[[t=>t===$a,function(t){V(t),GameData.doAction(12,401,{},0)}],[t=>t===Sa,function(){Et(Dt())}],[t=>t===Ha,function(){window.open(`${S+H}map`,"fsMap")}],[t=>t===Na,function(){const t=GameData.realm()
window.open(`${N}realms${H}view&realm_id=${t.id}`,"mapUfsg")}]]
function Ra(){Aa||(Aa=e({className:"fshCurveContainer",id:"fshWorldButtonContainer"}),Pa(),s(Aa,Bt(Ia)),h(Aa,"change",Bt(ja)),Gt(Aa,a("worldCoord")))}function Oa(t,e){Ma&&e.b.minlevel&&(La(),n(e.b.minlevel,Ma))}function Fa(t,e){Va&&n(e.b,Va)}function _a(t){return!t||!t.response||!t.response.data}let qa,Ka,Ya,za,Ua,Qa,Wa,Ja,Za,Xa,tn,en,an,nn,rn,on,sn,un,ln,cn,fn,dn,mn,hn,pn,bn,gn,vn,yn,kn,wn,Ln,Cn,Dn,An
function Mn(t){return t.player_name}function Vn(t){!function(t){za=t.defenders.map(Mn)}(t),qa?B("",qa):qa=e({className:"body"}),function(t){Ka=e({className:"fshFloatLeft fshRelicLeftDiv"}),r(qa,Ka),t.is_owner&&r(Ka,It(za)),Ya=Nt({className:"custombutton",textContent:"Fetch Stats"}),r(Ka,Ya)}(t)
const n=a("dialog-relic")
r(n,qa)}const $n=[t=>"lastUpdate"!==t,t=>!za.includes(t),t=>Ua[t].last_login,t=>Number(Ua[t].last_login)<Qa,t=>Number(Ua[t].last_login)>Wa,t=>Ua[t].level<400||Ua[t].level>421,t=>Ua[t].level<441||Ua[t].level>450]
function Sn(t,e){return e(t)}function Hn(t){return $n.every(o(Sn,t))}function Nn(t){return`<a href="${T}${Ua[t].id}">${t}</a>`}function Bn(t){Ua=t,Qa=x-120,Wa=x-604800
const e=G(Ua).filter(Hn).map(Nn)
i(qa,`<div class="fshFloatLeft fshRelicLowDiv"><table class="relicT"><thead><tr><th>${e.length.toString()} Offline guild members not at relic:</th></tr></thead><tbody><tr><td>${e.join(" ")}</td></tr></tbody></table></div>`)}function Gn(t){qt(Ya)
const n=y("hideRelicOffline")
t.is_owner&&!n&&_t(!0).then(Bn),i(Ka,'<table class="relicT"><thead><tr><th colspan="2">Processing</th></tr></thead><tbody><tr><td class="fshGreen" colspan="2" id="ProcessingStatus">Parsing defending guild stats ...</td></tr></tbody><thead><tr><th colspan="2">Assumptions</th></tr></thead><tbody><tr><td colspan="2" class="fshGrey">Above calculations include Constitution, Fortitude, Nightmare Visage, Chi Strike, Sanctuary, Terrorize and Flinch bonus calculations (in that order) on both the defending group and attacking group.</td></tr></tbody></table>'),An=a("ProcessingStatus")
const o=e({className:"fshFloatLeft fshRelicMidDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Defending Guild Stats</th></tr></thead><tbody><tr><td>Relic Count:</td><td id="relicCount">0</td></tr><tr><td>Lead Defender Bonus:</td><td id="LDPercentage">0</td></tr><tr><td>Lead Defender Cloaked:</td><td id="LDCloaked">No</td></tr></tbody><thead><tr><th colspan="2">Other Defender Stats</th></tr></thead><tbody><tr><td>Raw Attack:</td><td class="fshGrey" id="attackValue">0</td></tr><tr><td>Attack w/ buffs:</td><td id="attackValueBuffed">0</td></tr><tr><td>Raw Defense:</td><td class="fshGrey" id="defenseValue">0</td></tr><tr><td>Defense w/buffs:</td><td id="defenseValueBuffed">0</td></tr><tr><td>Raw Armor:</td><td class="fshGrey" id="armorValue">0</td></tr><tr><td>Armor w/ buffs:</td><td id="armorValueBuffed">0</td></tr><tr><td>Raw Damage:</td><td class="fshGrey" id="damageValue">0</td></tr><tr><td>Damage w/ buffs:</td><td id="damageValueBuffed">0</td></tr><tr><td>Raw HP:</td><td class="fshGrey" id="hpValue">0</td></tr><tr><td>HP w/ buffs:</td><td id="hpValueBuffed">0</td></tr><tr><td>Cloaked:</td><td id="defendersCloaked">0</td></tr><tr><td>Processed:</td><td id="defendersProcessed">0</td></tr></tbody></table>'})
r(qa,o),Ja=a("relicCount"),Za=a("LDPercentage"),Xa=a("LDCloaked"),tn=a("attackValue"),en=a("attackValueBuffed"),an=a("defenseValue"),nn=a("defenseValueBuffed"),rn=a("armorValue"),on=a("armorValueBuffed"),sn=a("damageValue"),un=a("damageValueBuffed"),ln=a("hpValue"),cn=a("hpValueBuffed"),fn=a("defendersCloaked"),dn=a("defendersProcessed")
const s=e({className:"fshFloatLeft fshRelicRightDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Adjusted defense values</th></tr></thead><tbody><tr><td>DC225:</td><td id="DC225">0</td></tr><tr><td>DC175:</td><td id="DC175">0</td></tr><tr><td colspan="2">&nbsp;</td></tr></tbody><thead><tr><th colspan="2">Attacking Group Stats</th></tr></thead><tbody><tr><td>Raw Group Attack:</td><td class="fshGrey" id="GroupAttack"></td></tr><tr><td>Group Attack w/ buffs:</td><td id="GroupAttackBuffed"></td></tr><tr><td>Raw Group Defense:</td><td class="fshGrey" id="GroupDefense"></td></tr><tr><td>Group Defense w/ buffs:</td><td id="GroupDefenseBuffed"></td></tr><tr><td>Raw Group Armor:</td><td class="fshGrey" id="GroupArmor"></td></tr><tr><td>Group Armor w/ buffs:</td><td id="GroupArmorBuffed"></td></tr><tr><td>Raw Group Damage:</td><td class="fshGrey" id="GroupDamage"></td></tr><tr><td>Group Damage w/ buffs:</td><td id="GroupDamageBuffed"></td></tr><tr><td>Raw Group HP:</td><td class="fshGrey" id="GroupHP"></td></tr><tr><td>Group HP w/ buffs:</td><td id="GroupHPBuffed"></td></tr></tbody></table>'})
r(qa,s),mn=a("DC225"),hn=a("DC175"),pn=a("GroupAttack"),bn=a("GroupAttackBuffed"),gn=a("GroupDefense"),vn=a("GroupDefenseBuffed"),yn=a("GroupArmor"),kn=a("GroupArmorBuffed"),wn=a("GroupDamage"),Ln=a("GroupDamageBuffed"),Cn=a("GroupHP"),Dn=a("GroupHPBuffed")}let Tn
function xn(t){const e=E(t),a=P('#pCC img[src*="/relics/"]',e).length
var r
n(a,Ja),Tn=1===(r=a)?1.5:yt(1-r/10,2),n(`${String(100*Tn)}%`,Za)}function En(t,e){return t>10*e||t<e?t:10*e}const Pn=[["levelValue","level"],["attackValue","attack"],["attackBonus","bonus_attack"],["defenseValue","defense"],["defenseBonus","bonus_defense"],["armorValue","armor"],["armorBonus","bonus_armor"],["damageValue","damage"],["damageBonus","bonus_damage"],["hpValue","hp"],["hpBonus","bonus_hp"],["killStreakValue","killstreak"]]
function jn(t,e,a){t[a[0]]=Number(e[a[1]])}const In=[["counterAttackLevel","Counter Attack"],["doublerLevel","Doubler"],["deathDealerLevel","Death Dealer"],["darkCurseLevel","Dark Curse"],["holyFlameLevel","Holy Flame"],["constitutionLevel","Constitution"],["sanctuaryLevel","Sanctuary"],["flinchLevel","Flinch"],["nightmareVisageLevel","Nightmare Visage"],["superEliteSlayerLevel","Super Elite Slayer"],["fortitudeLevel","Fortitude"],["chiStrikeLevel","Chi Strike"],["terrorizeLevel","Terrorize"],["barricadeLevel","Barricade"],["reignOfTerrorLevel","Reign Of Terror"],["anchoredLevel","Anchored"],["severeConditionLevel","Severe Condition"],["entrenchLevel","Entrench"],["cloakLevel","Cloak"]]
function Rn(t,e,a){t[a[0]]=e[a[1]]||0}function On(t){const e=Yt(t._skills),a={}
return function(t,e){Pn.forEach(o(jn,t,e))}(a,t),function(t,e){In.forEach(o(Rn,t,e))}(a,e),a.superEliteSlayerMultiplier=yt(.002*a.superEliteSlayerLevel,2),Kt(a.armorValue)&&function(t){t.attackValue=En(t.attackBonus,t.levelValue),t.defenseValue=En(t.defenseBonus,t.levelValue),t.armorValue=En(t.armorBonus,t.levelValue),t.damageValue=En(t.damageBonus,t.levelValue),t.hpValue=t.hpBonus}(a),a}let Fn,_n,qn,Kn,Yn,zn,Un,Qn,Wn,Jn,Zn,Xn,tr,er
function ar(t){return Math.round(t*Tn)}function nr(){De(Fn,tn),De(qn,an),De(Kn,rn),De(Yn,sn),De(Un,ln),n(Qn,fn),Wn+=1,n(Wn,dn)}function rr(t){const e=function(t){return Math.ceil(Zn.attack*(.0025*j(t["Nightmare Visage"],0)))}(t)
Zn.attack-=e,function(){const t=Math.ceil(Zn.attack*Jn.flinchLevel*.001)
De(Zn.attack-t,bn)}()
const a=function(t){return Math.ceil(Zn.defense*(1+.001*j(t.Constitution,0)))}(t)
De(a+e,vn),function(t){De(Zn.armor+Math.floor(Zn.armor*j(t.Sanctuary,0)*.001),kn)}(t)
const n=function(t,e){return Math.ceil(e*j(t.Fortitude,0)*.001)}(t,a)
!function(t){De(Zn.hp+t,Dn)}(n),function(t,e){const a=Math.ceil((Zn.hp+e)*j(t["Chi Strike"],0)*.001),n=Math.ceil(Zn.damage*Jn.terrorizeLevel*.001)
De(Zn.damage+a-n,Ln)}(t,n)}function or(){n("Processing attacking group stats ... ",An),Xn&&(Zn.attack-=Xn.attack,Zn.defense-=Xn.defense,Zn.armor-=Xn.armor,Zn.damage-=Xn.damage,Zn.hp-=Xn.hp),De(Zn.attack,pn),De(Zn.defense,gn),De(Zn.armor,yn),De(Zn.damage,wn),De(Zn.hp,Cn)
const t=Yt(GameData.player().buffs)
rr(t),function(t){const e=Math.ceil(_n*j(t.Flinch,0)*.001)
De(_n-e,en)}(t),function(t){const e=Math.ceil(zn*j(t.Terrorize,0)*.001)
De(zn-e,un)}(t),n("Done.",An)}function ir(){n("Processing defending guild stats ... ",An),Fn+=ar(Jn.attackValue),qn+=ar(Jn.defenseValue),Kn+=ar(Jn.armorValue),Yn+=ar(Jn.damageValue),Un+=ar(Jn.hpValue),nr()
const t=Math.ceil(Fn*(.0025*Jn.nightmareVisageLevel))
!function(t){_n=Fn-t,De(_n,en)}(t)
const e=Math.ceil(qn*(1+.001*Jn.constitutionLevel))
!function(t,e){const a=e+t
De(a,nn),De(Math.ceil(.55*a),mn),De(Math.ceil(.65*a),hn)}(t,e),De(Kn+Math.floor(Kn*Jn.sanctuaryLevel*.001),on)
const a=Un+function(t){return Math.ceil(t*Jn.fortitudeLevel*.001)}(e)
De(a,cn),function(t){zn=Yn+Math.ceil(t*Jn.chiStrikeLevel*.001),De(zn)}(a),0!==Jn.cloakLevel&&n("Yes",Xa),GameData.player().hasGroup&&Zn?or():n("Done.",An)}function sr(t){const e=On(t)
Fn+=Math.round(e.attackValue*I),qn+=Math.round(e.defenseValue*I),Kn+=Math.round(e.armorValue*I),Yn+=Math.round(e.damageValue*I),Un+=Math.round(e.hpValue*I),0!==e.cloakLevel&&(Qn+=1),nr()}function ur(t){Jn=On(t)}function lr(t){Zn=t}function cr(t){Xn=t}function fr(t){n(t.message,An)}function dr(t){const e=E(t),a=b('#pCC a[href*="confirmDisband"]',e)
if(!a)return
const n=function(t){const e=t.previousElementSibling.href,a=[Rt(e).then(lr)]
return function(t){return-1!==t.parentNode.parentNode.previousElementSibling.previousElementSibling.innerHTML.indexOf('"#000099"')}(t)&&a.push(Ot().then(cr)),a}(a)
return Pt(n)}function mr(t,e){return 0===e?Ft(t).then(ur):Ft(t).then(sr).catch(fr)}function hr(){let t=[F({cmd:"guild",subcmd:"view",guild_id:tr.controlled_by.guild_id}).then(xn)]
return GameData.player().hasGroup&&t.push(F({cmd:"guild",subcmd:"groups"}).then(dr)),t=t.concat(za.map(mr)),t}function pr(){Gn(tr),Fn=0,qn=0,Kn=0,Yn=0,Un=0,Qn=0,Wn=0
const t=hr()
jt(t,ir)}function br(t,e){_a(e)||(tr=e.response.data,tr.defenders.length>0&&(Vn(tr),O(Ya,"click",pr)))}function gr(t){$("#statbar-gold").css("background-color",t)}function vr(){$("#HelperSendTotal").html(wt(y("currentGoldSentTotal"))),Number(GameData.player().gold)>er?gr("red"):gr("inherit")}function yr(){er=y("goldAmount"),$("#statbar-gold-tooltip-general").append(`<dt class="stat-gold-sendTo">Send To:</dt><dd id="HelperSendTo">${y("goldRecipient")}</dd><dt class="stat-gold-sendAmt">Amount:</dt><dd id="HelperSendAmt">${wt(er)}</dd><dt class="stat-gold-sendTo">Send?</dt><dd><input id="HelperSendGold" value="Send!" class="custombutton" type="submit"><input type="hidden" id="xc" value=""</dd><dt class="stat-gold-sendTotal">Total Sent:</dt><dd id="HelperSendTotal">${wt(y("currentGoldSentTotal"))}</dd>`),$("#HelperSendGold").on("click",K),vr(),$.subscribe(Y,vr)}function kr(t){return z({cache:!1,url:"fetchdata.php",data:U(t,{fshrnd:zt()}),dataType:"json"})}const wr=[]
function Lr(t){return _a(t)||wr.push(t),t}function Cr(t,e){return t===Number(e.response.data.id)}function Dr(t,e){t(e)}function Ar(t,e){const a=wr.find(o(Cr,t))
return a?function(t){return new Promise((e=>{Q(3,Dr,[e,t])}))}(a):kr({a:1,id:t,passback:e}).then(Lr)}let Mr,Vr,$r,Sr,Hr,Nr
function Br(t,e){return Qt(W(e,t))}function Gr(){var t
Mr=GameData.player().level,t=a("statbar-character-tooltip-stats"),$r=Br(t,et),Vr=Br(t,J),Hr=Br(t,Z),Sr=Br(t,X),Nr=Br(t,tt)}function Tr(t){return`<tr><td colspan="2">${t.name}:</td><td colspan="2">${t.value}</td></tr>`}function xr(t,e,a){return function(t){return`<table><tr><td><img src="${v}creatures/${t.image_id}.png" height="200" width="200"></td><td rowspan="2"><table width="400"><tr><td class="header" colspan="4" class="fshCenter">Statistics</td></tr>`}(t)+function(t,e){return`<tr><td>Class:&nbsp;</td><td width="40%">${t.creature_class}</td><td>Level:&nbsp;</td><td width="40%">${t.level} (your level:<span class="${e}">${Mr}</span>)</td></tr>`}(t,a)+function(t){return`<tr><td>Attack:&nbsp;</td><td width="40%">${t.attack} (your defense:<span class="fshYellow">${Vr}</span>)</td><td>Defense:&nbsp;</td><td width="40%">${t.defense} (your attack:<span class="fshYellow">${$r}</span>)</td></tr>`}(t)+function(t){return`<tr><td>Armor:&nbsp;</td><td width="40%">${t.armor} (your damage:<span class="fshYellow">${Sr}</span>)</td><td>Damage:&nbsp;</td><td width="40%">${t.damage} (your armor:<span class="fshYellow">${Hr}</span>)</td></tr>`}(t)+function(t,e){return`<tr><td>HP:&nbsp;</td><td width="40%">${t.hp} (your HP:<span class="fshYellow">${Nr}</span>)(1H: <span class="fshRed">${e}</span>)</td><td>Gold:&nbsp;</td><td width="40%">${t.gold}</td></tr>`}(t,e)+'<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Enhancements</td></tr>'+function(t){return 0===t.enhancements.length?'<tr><td colspan="4">[no enhancements]</td></tr>':t.enhancements.map(Tr).join("")}(t)+function(t){return`<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Description</td></tr><tr><td colspan="4">${t.description}</td></tr><tr><td colspan="4" height="5"></td></tr></table></td></tr><tr><td class="fshCenter"><b>${t.name}</b></td></tr></table>`}(t)}function Er(e){if(!_a(e))return function(e){const a=Math.ceil(e.hp*t.hpVariable+e.armor*t.generalVariable)
let n="fshYellow"
return Gr(),Mr>e.level&&(n="fshRed"),xr(e,a,n)}(e.response.data)}const Pr=["verb","view","tip-static"]
function jr(t,e){const a=Er(e)
t.set("content.text",a)}function Ir(t,e,a){return Ar(GameData.actions()[t].data.id,t).then(o(jr,a)),"Loading..."}function Rr(t,e){g("NewMap","CreatureInfo")
const a=nt((n=e).parentNode.children).indexOf(n)
var n,r,i
t.classList.add("fshTip"),r=t,i=o(Ir,a),$(r).qtip({overwrite:!0,show:{event:"mouseover",ready:!0},style:{classes:"qtip-tipsy qtip-custom"},position:{my:"center right",at:"center left",effect:!1,viewport:$(window)},content:{text:i},hide:{effect:!1}})}function Or(e){if(!t.showCreatureInfo)return
const{target:a}=e,n=a.parentNode.parentNode.parentNode;(function(t,e){return Ut(Pr,t)&&!at("fshTip",t)&&at("creature",e)})(a,n)&&Rr(a,n)}function Fr(){return Wt({subcmd:"scouttower"})}function _r(t,e){const a=t.insertCell(-1)
return[a.colSpan]=e,e[2]&&(a.className="header"),r(a,e[1]),a}function qr(t,e,a){const n=t.insertRow(-1)
return a&&(n.className="fshBlue"),function(t,e){e.forEach(o(_r,t))}(n,e),n}function Kr(t,e){qr(t,e[0],e[1])}function Yr(t,e){e.forEach(o(Kr,t))}let zr,Ur,Qr,Wr,Jr,Zr,Xr,to,eo,ao,no,ro,oo,io,so,uo,lo,co,fo,mo,ho,po,bo,go,vo,yo,ko,wo
function Lo(){Ur=je("Current"),Qr=je("Kills"),Wr=je("Member"),Jr=je("% of Total"),Zr=je("Status"),Xr=je("Titan HP"),to=je("Total"),eo=je("Your Guild")}function Co(){for(;lo.rows.length>7;)lo.deleteRow(7)}function Do(){const t=gt()
return r(t,ao),vt(t,"/"),r(t,no),t}function Ao(t){const e=gt()
return r(e,t),vt(e,"%"),e}function Mo(){fo=null,co&&!at("fshHide",co)&&(bt(co,!0),n("",ao),n("",no),n("",ro),n("",oo),n("",io),B("",so),B("",uo),Co())}function Vo(t){return 0===t.type&&(fo=t.base_creature_id,!0)}function $o(){if(co)bt(co,!1)
else{const t=a("actionContainer")
co=e({className:"fshActionBox titanInfo"}),ao=gt(),no=gt(),ro=gt(),oo=gt(),io=gt(),so=gt(),uo=gt(),lo=te({className:"fshCenter"}),Lo(),Yr(lo,[[[[2,Xr,!0],[4,eo,!0]]],[[[2,Do()],[4,ro]]],[[[2,Ur,!0],[4,Ao(oo)]],!0],[[[2,to,!0],[4,Ao(io)]],!0],[[[2,Zr,!0],[4,so]],!0],[[[6,uo]]],[[[2,Wr,!0],[2,Qr,!0],[2,Jr,!0]]]]),r(co,lo),r(t,co)}}function So(t){return t<=0?'<span class="fshGreen cooldown">No active cooldown</span>':`<span class="fshMaroon cooldown">Cooldown until: ${function(t){const e=new Date(ot+1e3*t)
return`${Xt(e.getHours())}:${Xt(e.getMinutes())} ${Xt(e.getDate())}/${rt[e.getMonth()]}/${e.getFullYear()}`}(t)}</span>`}function Ho(t){return kt(Jt(t.max_hp-t.current_hp,t.kills),2)}function No(t){return kt(100*t.kills/t.max_hp,2)}function Bo(t){[[t.current_hp,ao],[t.max_hp,no],[t.kills,ro],[Ho(t),oo],[No(t),io]].forEach((([t,e])=>{n(t,e)})),B(function(t){return Zt(t.kills,t.max_hp,t.current_hp)}(t),so),B(So(t.cooldown),uo)}function Go(t,e){return[[[2,je(e.player.name)],[2,je(e.kills.toString())],[2,je(`${kt(100*e.kills/t.kills,2)}%`)]]]}function To(t){return t.realm&&t.creature.base_id===fo&&t.realm===zr}function xo(t){const e=t.find(To)
e&&(Bo(e),function(t){if(Co(),!t.contributors)return
const e=t.contributors.map(o(Go,t))
Yr(lo,e)}(e))}function Eo(e){return t.showTitanInfo&&At(e)&&e.some(Vo)}function Po(t,e){(function(t){return t.s&&At(t.r)})(e)&&(xo(e.r),Eo(GameData.realm().dynamic)?mo=window.setTimeout(t,3e4):Mo())}function jo(){Fr().then(o(Po,jo))}function Io(t){mo&&(window.clearTimeout(mo),mo=null),Eo(t)?($o(),jo()):Mo()}function Ro(t){var e
t.dynamic&&(e=t.name,zr=e,Io(t.dynamic))}function Oo(t,e){(function(t){return t.realm&&t.realm.name})(e)&&Ro(e.realm)}function Fo(t){const e=t.response.response,a=t.response.msg
let n
if(0!==e){const t=a.indexOf("<")
n=-1!==t?a.substring(0,t):a}else n=`You purchased ${t.response.data.name} for ${wt(t.response.data.cost)} gold.`
i(ko,`${n}<br>`)}function _o(){GameData.doAction(14,3,{id:ho.id,item_id:ho.itemId},0),bo.close()}function qo(){const t=ee(vo.value)
if(!t)return
const e=[]
for(let a=1;a<t;a+=1)e.push(kr({a:14,d:0,id:ho.id,item_id:ho.itemId}).then(Fo))
jt(e,_o)}function Ko(){go?n("",ko):(go=e({className:"fshClear",textContent:"Select how many to quick-buy:"}),vo=Tt({id:"buyAmount",className:"fshNumberInput",min:1,max:99,value:1,type:"number"}),r(go,vo),yo=Nt({textContent:"Quick-buy"}),s(yo,qo),r(go,yo),ko=e(),r(go,ko),r(po,go))}function Yo(t,e){ho=e,po=po||a("shopDialogConfirm"),po&&(bo=bo||$(po).data("hcsWorldDialogShopConfirm"),bo&&Ko())}function zo(t){wo[t.name]?wo[t.name].seen&&(wo[t.name].seen+=1):(wo[t.name]={seen:1},function(t,e){e.creature_class=t.creature_class,e.image_id=t.image_id,e.level=Number(t.level),e.type=t.type}(t,wo[t.name]))}function Uo(t,e,a){return e?t(e,a):a}function Qo(t,e){const a=t||{}
return a.min=Uo(Math.min,a.min,e),a.max=Uo(Math.max,a.max,e),a}const Wo=["attack","armor","damage","defense","hp"]
function Jo(t,e,a){const n=Qo(e[a],Number(t[a]));(function(t,e){return!t||t.min!==e.min||t.max!==e.max})(e[a],n)&&(e[a]=n)}function Zo(t,e){t[e.name]=Qo(t[e.name],Number(e.value))}function Xo(t){wo||(wo={}),zo(t),function(t,e){Wo.forEach(o(Jo,t,e))}(t,wo[t.name]),function(t,e){(function(t){return t.enhancements&&t.enhancements.length>0})(t)&&(e.enhancements=e.enhancements||{},t.enhancements.forEach(o(Zo,e.enhancements)))}(t,wo[t.name]),Vt("fsh_monsterLog",wo)}function ti(t){wo=t||{}}const ei=[]
function ai(e){var a
_a(e)||(g("NewMap","MonsterLog"),a=e.response.data,t.showMonsterLog&&Xo(a))}function ni(t,e){return t.id===e.id}function ri(t,e){6!==t.type||function(t){if(ei.find(o(ni,t.data)))return!0
ei.push(t.data)}(t)||Ar(t.data.id,e).then(ai)}function oi(){t.showMonsterLog&&GameData.actions().forEach(ri)}function ii(t){return Wt(U({subcmd:"groups"},t))}function si(t){return function(t){return ii({subcmd2:"viewstats",group_id:t})}(t)}function ui(){return ii({subcmd2:"view"})}function li(t){return t.numberOfCreatureHitsTillDead-t.numberOfHitsRequired<=1?", dies on miss":", survives a miss"}const ci=[[t=>"-"===t.playerHits&&"-"===t.creatureHits,()=>"Unresolved"],[t=>"-"===t.playerHits,()=>"Player dies"],[t=>1===t.playerHits,t=>`Player 1 hits${li(t)}`],[t=>t.playerHits>1,t=>`Player > 1 hits${li(t)}`]]
function fi(t,e){return e[0](t)}function di(t){t.playerHits=function(t){return"-"===t.numberOfCreatureHitsTillDead?t.numberOfHitsRequired:function(t){return"-"===t.numberOfHitsRequired||t.numberOfHitsRequired>t.numberOfCreatureHitsTillDead}(t)?"-":t.numberOfHitsRequired}(t),t.creatureHits=function(t){return"-"===t.numberOfHitsRequired?t.numberOfCreatureHitsTillDead:function(t){return"-"===t.numberOfCreatureHitsTillDead||t.numberOfCreatureHitsTillDead>t.numberOfHitsRequired}(t)?"-":t.numberOfCreatureHitsTillDead}(t),t.fightStatus=function(t){const e=ci.find(o(fi,t))
return e?e[1](t):"Unknown"}(t)}function mi(t){t.creatureHitByHowMuch>=0?function(t){const e=t.generalVariable*t.creature.damage
e<t.overallArmorValue?t.numberOfCreatureHitsTillDead=t.overallHPValue:t.numberOfCreatureHitsTillDead=Math.ceil(t.overallHPValue/(e-t.overallArmorValue))}(t):t.numberOfCreatureHitsTillDead="-"}function hi(t){!function(t){const e=function(t){return t.callback.groupExists?t.callback.groupArmorValue:t.player.armorValue}(t)
t.overallArmorValue=e+Math.floor(t.player.armorValue*t.player.sanctuaryLevel*.001)}(t),function(t){t.player.sanctuaryLevel>0&&(t.extraNotes+=`Sanc Bonus Armor = ${Math.floor(t.player.armorValue*t.player.sanctuaryLevel*.001)}<br>`)}(t),function(t){t.terrorizeEffect=Math.floor(t.creature.damage*t.player.terrorizeLevel*.001)}(t),function(t){t.player.terrorizeLevel>0&&(t.extraNotes+=`Terrorize Creature Damage Effect = ${-1*t.terrorizeEffect}<br>`)}(t),t.creature.damage-=t.terrorizeEffect,function(t){t.creatureDamageDone=Math.ceil(t.generalVariable*t.creature.damage-t.overallArmorValue+t.overallHPValue)}(t),mi(t)}function pi(t){const e=function(t){return t.callback.groupExists?t.callback.groupAttackValue:t.player.attackValue}(t)
t.player.darkCurseLevel>0&&(t.extraNotes+=`DC Bonus Attack = ${Math.floor(t.creature.defense*t.player.darkCurseLevel*.002)}<br>`),t.nightmareVisageAttackMovedToDefense=Math.floor((e+t.counterAttackBonusAttack)*t.player.nightmareVisageLevel*.0025),t.player.nightmareVisageLevel>0&&(t.extraNotes+=`NMV Attack moved to Defense = ${t.nightmareVisageAttackMovedToDefense}<br>`),t.overallAttackValue=e+t.counterAttackBonusAttack-t.nightmareVisageAttackMovedToDefense,t.hitByHowMuch=function(t){const e=t.creature.defense-t.creature.defense*t.player.darkCurseLevel*.002
return 3===t.combatEvaluatorBias?t.overallAttackValue-Math.ceil(e)-50:t.overallAttackValue-Math.ceil(t.attackVariable*e)}(t)}function bi(t){t.lowestCALevelToStillHit=Math.max(Math.ceil((t.counterAttackBonusAttack-t.hitByHowMuch+1)/t.player.attackValue/.0025),0),t.lowestCALevelToStillKill=Math.max(Math.ceil((t.counterAttackBonusDamage-t.damageDone+1)/t.player.damageValue/.0025),0)}function gi(t){bi(t),t.lowestFeasibleCALevel=Math.max(t.lowestCALevelToStillHit,t.lowestCALevelToStillKill),t.extraNotes+=`Lowest CA to still 1-hit this creature = ${t.lowestFeasibleCALevel}<br>`,0!==t.lowestFeasibleCALevel&&function(t){t.extraAttackAtLowestFeasibleCALevel=Math.floor(.0025*t.player.attackValue*t.lowestFeasibleCALevel),t.extraDamageAtLowestFeasibleCALevel=Math.floor(.0025*t.player.damageValue*t.lowestFeasibleCALevel),t.extraNotes+=`Extra CA Att/Dam at this lowered CA level = ${t.extraAttackAtLowestFeasibleCALevel} / ${t.extraDamageAtLowestFeasibleCALevel}<br>`}(t),t.extraStaminaPerHitAtLowestFeasibleCALevel=function(t){return t.player.counterAttackLevel>0?Math.ceil(.0025*(1+t.player.doublerLevel/50)*t.lowestFeasibleCALevel):0}(t),t.extraStaminaPerHitAtLowestFeasibleCALevel<t.extraStaminaPerHit?t.extraNotes+=`Extra Stam Used at this lowered CA level = ${t.extraStaminaPerHitAtLowestFeasibleCALevel}<br>`:t.extraNotes+="No reduction of stam used at the lower CA level<br>"}function vi(t){(function(t){return t.player.counterAttackLevel>0&&1===t.numberOfHitsRequired})(t)&&gi(t),function(t){return"-"===t.numberOfHitsRequired||1!==t.numberOfHitsRequired}(t)&&function(t){bi(t),function(t){t.lowestCALevelToStillHit>175?t.extraNotes+="Even with CA175 you cannot hit this creature<br>":0!==t.lowestCALevelToStillHit&&(t.extraNotes+=`You need a minimum of CA${t.lowestCALevelToStillHit} to hit this creature<br>`)}(t),function(t){t.lowestCALevelToStillKill>175?t.extraNotes+="Even with CA175 you cannot 1-hit kill this creature<br>":0!==t.lowestCALevelToStillKill&&(t.extraNotes+=`You need a minimum of CA${t.lowestCALevelToStillKill} to 1-hit kill this creature<br>`)}(t)}(t)}function yi(t){!function(t){const e=function(t){return t.callback.groupExists?t.callback.groupHPValue:t.player.hpValue}(t),{fortitudeLevel:a}=t.player
t.fortitudeExtraHPs=Math.floor(e*a*.001),a>0&&(t.extraNotes+=`Fortitude Bonus HP = ${t.fortitudeExtraHPs}<br>`),t.overallHPValue=e+t.fortitudeExtraHPs}(t),function(t){const{chiStrikeLevel:e}=t.player
t.chiStrikeExtraDamage=Math.floor(t.overallHPValue*e*.001),e>0&&(t.extraNotes+=`Chi Strike Bonus Damage = ${t.chiStrikeExtraDamage}<br>`)}(t)
const e=function(t){return t.callback.groupExists?t.callback.groupDamageValue:t.player.damageValue}(t)
if(t.overallDamageValue=e+t.deathDealerBonusDamage+t.counterAttackBonusDamage+t.holyFlameBonusDamage+t.chiStrikeExtraDamage,t.damageDone=Math.floor(t.overallDamageValue-(t.generalVariable*t.creature.armor+t.hpVariable*t.creature.hp)),t.hitByHowMuch>0){let e=1
t.overallDamageValue>=t.generalVariable*t.creature.armor&&(e=t.overallDamageValue-t.generalVariable*t.creature.armor),t.numberOfHitsRequired=Math.ceil(t.hpVariable*t.creature.hp/e)}else t.numberOfHitsRequired="-"}function ki(t){return t.callback.groupExists?t.callback.groupDefenseValue:t.player.defenseValue}function wi(t){t.overallDefenseValue=ki(t)+Math.floor(ki(t)*t.player.constitutionLevel*.001)+t.nightmareVisageAttackMovedToDefense,function(t){t.player.constitutionLevel>0&&(t.extraNotes+=`Constitution Bonus Defense = ${Math.floor(ki(t)*t.player.constitutionLevel*.001)}<br>`)}(t),function(t){t.player.flinchLevel>0&&(t.extraNotes+=`Flinch Bonus Attack Reduction = ${Math.floor(t.creature.attack*t.player.flinchLevel*.001)}<br>`)}(t),t.creatureHitByHowMuch=Math.floor(t.attackVariable*t.creature.attack-t.creature.attack*t.player.flinchLevel*.001-t.overallDefenseValue),3===t.combatEvaluatorBias&&(t.creatureHitByHowMuch=Math.floor(t.creature.attack-t.creature.attack*t.player.flinchLevel*.001-t.overallDefenseValue-50))}function Li(t){t.extraNotes="",function(t){t.player.superEliteSlayerLevel>0&&(t.extraNotes+=`SES Stat Reduction Multiplier = ${t.player.superEliteSlayerMultiplier}<br>`)}(t),function(t){t.holyFlameBonusDamage=0,"Undead"===t.creature.class&&(t.holyFlameBonusDamage=Math.max(Math.floor((t.player.damageValue-t.creature.armor)*t.player.holyFlameLevel*.002),0),t.player.holyFlameLevel>0&&(t.extraNotes+=`HF Bonus Damage = ${t.holyFlameBonusDamage}<br>`))}(t),function(t){t.deathDealerBonusDamage=Math.floor(t.player.damageValue*(Math.min(.01*Math.floor(t.player.killStreakValue/5)*t.player.deathDealerLevel,20)/100))}(t),function(t){t.counterAttackBonusAttack=Math.floor(.0025*t.player.attackValue*t.player.counterAttackLevel),t.counterAttackBonusDamage=Math.floor(.0025*t.player.damageValue*t.player.counterAttackLevel)}(t),function(t){t.extraStaminaPerHit=0,t.player.counterAttackLevel>0&&(t.extraStaminaPerHit=Math.ceil(.0025*(1+t.player.doublerLevel/50)*t.player.counterAttackLevel))}(t),function(t){t.player.deathDealerLevel>0&&(t.extraNotes+=`DD Bonus Damage = ${t.deathDealerBonusDamage}<br>`)}(t),function(t){t.player.counterAttackLevel>0&&(t.extraNotes+=`CA Bonus Attack/Damage = ${t.counterAttackBonusAttack} / ${t.counterAttackBonusDamage}<br>CA Extra Stam Used = ${t.extraStaminaPerHit}<br>`)}(t)}let Ci,Di,Ai,Mi,Vi,$i,Si,Hi,Ni,Bi
function Gi(){return ba(Di)?"Remove from do not kill list":"Add to the do not kill list"}function Ti(){n(Gi(),Ai)}function xi(){const e=t.doNotKillList.indexOf(Di);-1===e?t.doNotKillList.push(Di):t.doNotKillList.splice(e,1),Ti(),d("doNotKillList",t.doNotKillList.join()),va()}function Ei(){Ai?Ti():function(){Ai=Nt({className:"fshBl",textContent:Gi(),type:"button"})
const t=e({className:"description",innerHTML:'<span class="ui-helper-hidden-accessible"><input type="text"></span>'})
r(t,Ai),r(Ci,t),s(Ai,xi)}()}function Pi(t,e){!function(t){if(!Ci){const e=W("body",t)
1===e.length&&([Ci]=e)}}(e),Ci&&(Di=t.trim(),Ei())}function ji(){$i||(Vi||(Vi=e(),r(Mi,Vi),r(Mi,e({innerHTML:'<span class="fshFooter">*Does include CA, DD, HF, DC, Flinch, Super Elite Slayer, NMV, Sanctuary, Constitution, Fortitude, Chi Strike and Terrorize (if active) and allow for randomness (1.1053). Constitution, NMV, Fortitude and Chi Strike apply to group stats.</span>'}))),$i=e(),r(Vi,$i))}function Ii(t){ji(),B(t,$i)}function Ri(t){Si||(ji(),Si=e(),r(Vi,Si)),B(t,Si)}function Oi(t,e){const a={name:t.name,class:t.creature_class,attack:Number(t.attack),defense:Number(t.defense),armor:Number(t.armor),damage:Number(t.damage),hp:Number(t.hp)}
return function(t,e,a){3===a&&(e.attack-=Math.ceil(e.attack*t),e.defense-=Math.ceil(e.defense*t),e.armor-=Math.ceil(e.armor*t),e.damage-=Math.ceil(e.damage*t),e.hp-=Math.ceil(e.hp*t))}(e,a,t.type),a}function Fi(e,a,n){const r={}
r.callback=n,r.player=On(a),function(e){e.combatEvaluatorBias=t.combatEvaluatorBias,e.attackVariable=1.1053,e.generalVariable=t.generalVariable,e.hpVariable=t.hpVariable}(r),r.creature=Oi(e.response.data,r.player.superEliteSlayerMultiplier),function(t){Li(t),pi(t),yi(t),wi(t),hi(t),di(t),vi(t)}(r),r.evaluatorHTML=function(t){return`<table width="100%"><tbody>${function(t){return`<tr><td bgcolor="#CD9E4B" colspan="4" align="center">${function(t){return t.callback.groupExists?"Group ":""}(t)}Combat Evaluation</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333">Will I hit it? </td><td align="left">${function(t){return t.hitByHowMuch>0?"Yes":"No"}(t)}</td><td align="right"><span style="color:#333333">Extra Attack: </td><td align="left">( ${t.hitByHowMuch} )</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333"># Hits to kill it? </td><td align="left">${t.numberOfHitsRequired}</td><td align="right"><span style="color:#333333">Extra Damage: </td><td align="left">( ${t.damageDone} )</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333">Will I be hit? </td><td align="left">${function(t){return t.creatureHitByHowMuch>=0?"Yes":"No"}(t)}</td><td align="right"><span style="color:#333333">Extra Defense: </td><td align="left">( ${-1*t.creatureHitByHowMuch} )</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333"># Hits to kill me? </td><td align="left">${t.numberOfCreatureHitsTillDead}</td><td align="right"><span style="color:#333333">Extra Armor + HP: </td><td align="left">( ${-1*t.creatureDamageDone} )</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333"># Player Hits? </td><td align="left">${t.playerHits}</td><td align="right"><span style="color:#333333"># Creature Hits? </td><td align="left">${t.creatureHits}</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333">Fight Status: </span></td><td align="left" colspan="3"><span>${t.fightStatus}</span></td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333">Notes: </span></td><td align="left" colspan="3"><span style="font-size:x-small;">${t.extraNotes}</span></td></tr>`}(t)}</tbody></table>`}(r),n.groupExists?Ri(r.evaluatorHTML):Ii(r.evaluatorHTML)}function _i(t){return t.members[0].name===Dt()}function qi(t){if(At(t.r))return t.r.find(_i).id}function Ki(t,e,a){if(!a.r||!a.r.attributes)return
const n=a.r.attributes
Fi(t,e,{groupExists:!0,groupAttackValue:n[0].value,groupDefenseValue:n[1].value,groupArmorValue:n[2].value,groupDamageValue:n[3].value,groupHPValue:n[4].value})}function Yi(t,e,a){a&&si(a).then(o(Ki,t,e))}function zi(t,e){t.player.hasGroup&&function(t,e){ui().then(qi).then(o(Yi,t,e))}(t,e),Fi(t,e,{groupExists:!1})}function Ui(t,e){Mi||(Mi=a("dialog-viewcreature")),Mi&&(Ii(""),Ri(""),function(t){return t.response&&t.response.data}(e)&&(Pi(e.response.data.name,Mi),ae(!0).then(o(zi,e))))}function Qi(){const e=[,[t.buffs,t.buffsName],[t.buffs2,t.buffs2Name],[t.buffs3,t.buffs3Name]][t.enabledHuntingMode]
At(e)&&([Hi,Ni]=e)}function Wi(e){"enabledHuntingMode"===e.target.name&&(t.enabledHuntingMode=e.target.value,d("enabledHuntingMode",t.enabledHuntingMode),Qi(),GameData.fetch(u))}function Ji(t){const e=W("verbs",t)
1===e.length&&qt(e[0])}function Zi(){if(!Bi)return
const t=a("actionList")
St("player",t).forEach(Ji)}const Xi={hideSubLvlCreature:function(){t.hideSubLvlCreature=!t.hideSubLvlCreature,d("hideSubLvlCreature",t.hideSubLvlCreature),GameData.fetch(ct)},hidePlayerActions:function(){Bi=!Bi,d("hidePlayerActions",Bi),GameData.fetch(ct)},showCreatureInfo:function(){t.showCreatureInfo=!t.showCreatureInfo,d("showCreatureInfo",t.showCreatureInfo)},showHuntingBuffs:function(){t.showBuffs=!t.showBuffs,d("showHuntingBuffs",t.showBuffs),GameData.fetch(u)},showMonsterLog:function(){t.showMonsterLog=!t.showMonsterLog,d("showMonsterLog",t.showMonsterLog)},showTitanInfo:function(){t.showTitanInfo=!t.showTitanInfo,d("showTitanInfo",t.showTitanInfo),Io(GameData.realm().dynamic)},showBuffInfo:function(){t.showBuffInfo=!t.showBuffInfo,d("showBuffInfo",t.showBuffInfo),Xe()}}
function ts(t){const e=Xi[t.target.name]
L(e)&&(t.target.blur(),e(t))}function es(){const t=e({className:"fshCenter fshFten"}),n=e({id:"fshWorldPrefs",innerHTML:`${re("showCreatureInfo")}&nbsp;&nbsp;${re("showMonsterLog")}&nbsp;&nbsp;${re("showTitanInfo")}&nbsp;&nbsp;${re("showBuffInfo")}<br>${re("hideSubLvlCreature")}&nbsp;&nbsp;${re("hidePlayerActions")}&nbsp;&nbsp;${ne()}`})
s(n,ts),h(n,"change",Wi),r(t,n)
const o=e()
r(t,o)
const i=a("worldContainerBelow").children[0]
return Gt(t,i),o}function as(t,e){return t[e.name]=!0,t}function ns(t,e,a){return t[a.trim()]||e.push(a),e}function rs(t){B("",t)}function os(t,e){const a=e.b.reduce(as,{}),n=Hi.reduce(o(ns,a),[])
n.length>0?function(t,e){B(`You are missing some ${Ni} hunting buffs<br>(${e.join(", ")})`,t)}(t,n):rs(t)}function is(e,a,n){Hi&&function(e,a,n){t.showBuffs?os(e,n):rs(e)}(e,0,n)}const ss=[{generalVariable:1.1053,hpVariable:1.1},{generalVariable:1.1,hpVariable:1.053},{generalVariable:1.053,hpVariable:1},{generalVariable:1.1053,hpVariable:1}]
function us(){var e
t.combatEvaluatorBias=y("combatEvaluatorBias"),t.generalVariable=(e=t.combatEvaluatorBias,ss[e]?ss[e].generalVariable:1.1053),t.hpVariable=function(t){return ss[t]?ss[t].hpVariable:1.1}(t.combatEvaluatorBias)}function ls(t,e){return 6!==e.type||(0!==e.data.creature_type||e.data.level>=t)}function cs(t){const e=ft(t)
return function(t){return!t||!t.actions||0===t.actions.length}(e)?t:(e.actions=e.actions.filter(o(ls,function(t){return t.realm&&t.realm.minlevel||GameData.realm().minlevel}(e))),JSON.stringify(e))}function fs(e,a){t.hideSubLvlCreature&&function(t){return t.data&&t.data.d&&oe(t.data.d,ct)}(a)&&(e.dataFilter=cs)}function ds(e){t[e[0]]=ie(e[1])}function ms(e){t[e]=ie(e)}function hs(){[["buffs","huntingBuffs"],["buffs2","huntingBuffs2"],["buffs3","huntingBuffs3"]].forEach(ds),["doNotKillList"].forEach(ms)}function ps(e){t[e[0]]=y(e[1])}function bs(e){t[e]=y(e)}function gs(){[["buffsName","huntingBuffsName"],["buffs2Name","huntingBuffs2Name"],["buffs3Name","huntingBuffs3Name"],["showBuffs","showHuntingBuffs"]].forEach(ps),["enabledHuntingMode","hideSubLvlCreature","showTitanInfo","showBuffInfo","showMonsterLog","showCreatureInfo"].forEach(bs)}function vs(t){$(`#actionList li.creature-${t.toString()} a.create-group`).hide()}const ys=["hideChampionsGroup","hideElitesGroup","hideSEGroup","hideTitanGroup","hideLegendaryGroup"]
function ks(t,e){var a
y(t)&&(a=e+1,$.subscribe(D,o(vs,a)),vs(e+1))}function ws(t,e){"ACT_REPAIR"===e&&GameData.fetch(mt+u+ht+ct)}function Ls(t){V(t.target)}const Cs=[function(){us(),hs(),gs()
const e=es()
$.ajaxPrefilter("JSON",fs),t.hideSubLvlCreature&&GameData.fetch(ct),function(e){Qi()
const a=o(is,e)
$.subscribe(l,a),t.showBuffs&&window.initialGameData&&a(null,{b:window.initialGameData.player.buffs})}(e),Bi=y("hidePlayerActions"),$.subscribe(D,Zi),Zi()},function(){_(),q&&yr()},function(){$.subscribe(lt,Ui)},function(){ys.forEach(ks)},function(){y("enableCreatureColoring")&&r(document.body,$t("#actionList .creature-1 {color: green;}\n#actionList .creature-2 {color: yellow;}\n#actionList .creature-3 {color: red;}"))},function(){$.subscribe(D,va),va(),function(){const t=GameData.doAction
GameData.doAction=wa(t)}()},function(){Mt("fsh_monsterLog").then(ti),$.subscribe("-1-success.action-response 4-success.action-response 5-success.action-response 25-success.action-response",oi),oi()},function(){$.subscribe(dt,ws)},function(){y("keepLogs")&&Mt("fsh_combatLog").then(pa)},function(){window.initialGameData&&Oo(0,window.initialGameData),$.subscribe(`${it} ${st}`,Oo)},function(){$.subscribe(ut,Yo)},function(){$.subscribe(R,br)},function(){$("#messageCenter").worldMessageCenter({offset:"0 60"})},function(){V("#mapTooltip")},function(){Ra(),$.subscribe(A,Oa),$.subscribe(M,Fa)},function(){Xe(),$.subscribe(`${l} ${c}`,Xe),$.subscribe(f,ta)},function(){s(a("buffList"),Ls)},function(){h(a("actionList"),"mouseover",Or)},function(){const t=m("body")[0]
h(t,"keydown",ia),h(t,"keyup",sa)}]
function Ds(){Ht(Cs)}export default Ds
//# sourceMappingURL=newMap-50cfd653.js.map
