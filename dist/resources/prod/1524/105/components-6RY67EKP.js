import{a as Ye}from"./chunk-HG54HP5W.js";import{a as Ue}from"./chunk-ELQ42VUR.js";import{a as U}from"./chunk-OOXPCX53.js";import{a as L}from"./chunk-6HYHAIWX.js";import"./chunk-6RNWJDUW.js";import{a as Te}from"./chunk-NOVV3NGO.js";import{a as xe}from"./chunk-TGFHLCXE.js";import"./chunk-VIYL46Q6.js";import"./chunk-6WIP4RNC.js";import{a as Me}from"./chunk-UKC3WBSJ.js";import{a as ce}from"./chunk-6HERGS5C.js";import{a as Pe}from"./chunk-URWUNVTF.js";import{a as Ee}from"./chunk-RN6NICJ7.js";import{a as we}from"./chunk-JDEF33GP.js";import"./chunk-EHOD6CNQ.js";import{a as We,b as Re}from"./chunk-3XG27UWS.js";import{a as Fe}from"./chunk-I6ZSBYQ3.js";import{a as ie}from"./chunk-YQ625XVJ.js";import"./chunk-VMCLSOZO.js";import"./chunk-PBUQY6G2.js";import{a as De}from"./chunk-GUJMNTXY.js";import{a as M}from"./chunk-3UNKZDTI.js";import{a as re}from"./chunk-CAX7THIP.js";import"./chunk-A6LP6MUS.js";import"./chunk-E62N6RI5.js";import"./chunk-7VIXIIBV.js";import{a as J}from"./chunk-Y5EGDMIB.js";import{$ as Ve,D as B,F as te,H as Y,P as oe,Q as ne,V as N,W as D,X as k,Y as C,_ as Qe,a as Z,aa as ae,d as H,e as se,fa as V,g as Se,ga as W,h as O,ha as R,ia as P,ja as T,n as F,s as g,t as $,u as G,v as Ae,w as _,x as A,y as Q,z as ee}from"./chunk-TVNPLL64.js";import"./chunk-Z5JYB3FL.js";import"./chunk-MHWHHESW.js";import{a as le}from"./chunk-QQEKW5LY.js";import{a as pe}from"./chunk-WVO4VYA4.js";import{a as He}from"./chunk-C63Q3HN7.js";import{a as Xe}from"./chunk-FMA2QB7F.js";import"./chunk-NRW7AT6T.js";import{c as je}from"./chunk-DPECAWNM.js";import"./chunk-KOM3R443.js";import"./chunk-NIOVFM2M.js";import"./chunk-6ZCA6D63.js";import{a as Ne}from"./chunk-YXAOTQ2S.js";import{a as q}from"./chunk-V45UJIF2.js";import{a as Le}from"./chunk-64PLTPQD.js";import"./chunk-OHAOQZFW.js";import"./chunk-PJWDCLVE.js";import{a as Je}from"./chunk-JCK66TTB.js";import{a as Ze}from"./chunk-SY4ES3W2.js";import{b as Be,g as K}from"./chunk-5ELKH2XV.js";import"./chunk-5ORZS6IQ.js";import"./chunk-BRQN5OZB.js";import{a as E}from"./chunk-BZJZQFW2.js";import"./chunk-QCTVAEOV.js";import"./chunk-VQDTHLUC.js";function ue(){return ce({subcmd:"loadcomponents"})}function st(t){let{itemId:e,invId:o,vcode:n}=le(K,t.children[0].dataset.tipped);return{a:Number(o),b:Number(e),v:n}}var at=t=>je(t.href),pt=t=>q('a[href*="=destroycomponent&"]',t).map(st),ut=t=>Le('td[background*="/1x1mini."]',t).length;function mt(t){let e=pe(t);return q('a[href*="profile&component_page="]',e).slice(1).map(at)}function ft(t){let e=Array(57);return e[56]={k:56,v:t.map(ut).reduce(Ye,0)},{p:e}}var dt=t=>({h:ft(t),r:t.flatMap(pt),s:!0});async function me(){let t=await He({cmd:"profile"}),e=await M([t,...mt(t)]);return dt(e.map(pe))}function fe(){return ie(ue,me)}function de(t){return new Map(Ne(t))}var x=We(new Map),qe=Re(x,t=>[...t].reduce((e,[,o])=>e+(o.get("del")?.length??0),0));function bt(t){let e;return{c(){e=_("tr"),e.innerHTML='<td class="compDel svelte-1qoer4b" colspan="3">Deleted</td>'},m(o,n){$(o,e,n)},p:Z,i:Z,o:Z,d(o){o&&G(e)}}}function gt(t){let e,o,n,r,l,s,c,I=t[0].get("del").length+"",p,a,u,h,v,m,f=[kt,_t],d=[];function w(i,S){return S&1&&(u=null),u==null&&(u=!!i[0].get("delPending")),u?0:1}return h=w(t,-1),v=d[h]=f[h](t),{c(){e=_("tr"),o=_("td"),n=_("img"),s=Q(),c=_("td"),p=A(I),a=Q(),v.c(),se(n.src,r=t[1](t[0]))||B(n,"src",r),B(n,"class","tip-dynamic"),B(n,"data-tipped",l=t[2](t[0])),B(n,"alt","component")},m(i,S){$(i,e,S),g(e,o),g(o,n),g(e,s),g(e,c),g(c,p),g(e,a),d[h].m(e,null),m=!0},p(i,S){(!m||S&1&&!se(n.src,r=i[1](i[0])))&&B(n,"src",r),(!m||S&1&&l!==(l=i[2](i[0])))&&B(n,"data-tipped",l),(!m||S&1)&&I!==(I=i[0].get("del").length+"")&&te(p,I);let b=h;h=w(i,S),h===b?d[h].p(i,S):(N(),C(d[b],1,1,()=>{d[b]=null}),D(),v=d[h],v?v.p(i,S):(v=d[h]=f[h](i),v.c()),k(v,1),v.m(e,null))},i(i){m||(k(v),m=!0)},o(i){C(v),m=!1},d(i){i&&G(e),d[h].d()}}}function _t(t){let e,o,n;return o=new L({props:{$$slots:{default:[ht]},$$scope:{ctx:t}}}),o.$on("click",F(t[3])),{c(){e=_("td"),V(o.$$.fragment)},m(r,l){$(r,e,l),W(o,e,null),n=!0},p(r,l){let s={};l&256&&(s.$$scope={dirty:l,ctx:r}),o.$set(s)},i(r){n||(k(o.$$.fragment,r),n=!0)},o(r){C(o.$$.fragment,r),n=!1},d(r){r&&G(e),R(o)}}}function kt(t){let e;return{c(){e=_("td"),e.innerHTML='<span class="fshSpinner fshSpinner12"></span>',B(e,"class","compSumSpin")},m(o,n){$(o,e,n)},p:Z,i:Z,o:Z,d(o){o&&G(e)}}}function ht(t){let e;return{c(){e=A("Del")},m(o,n){$(o,e,n)},d(o){o&&G(e)}}}function It(t){let e,o,n,r,l,s=[gt,bt],c=[];function I(p,a){return a&1&&(e=null),e==null&&(e=!!p[0].get("del").length),e?0:1}return o=I(t,-1),n=c[o]=s[o](t),{c(){n.c(),r=ee()},m(p,a){c[o].m(p,a),$(p,r,a),l=!0},p(p,[a]){let u=o;o=I(p,a),o===u?c[o].p(p,a):(N(),C(c[u],1,1,()=>{c[u]=null}),D(),n=c[o],n?n.p(p,a):(n=c[o]=s[o](p),n.c()),k(n,1),n.m(r.parentNode,r))},i(p){l||(k(n),l=!0)},o(p){C(n),l=!1},d(p){p&&G(r),c[o].d(p)}}}function Ct(t,e,o){let n;O(t,x,u=>o(5,n=u));let{itemId:r}=e,l=oe(),s=we(),c=u=>`${Be}items/${u.get("b")}.gif`,I=u=>`fetchitem.php?item_id=${u.get("b")}&inv_id=${u.get("a")}&t=2&p=${s}&vcode=${u.get("v")}`,p;function a(){J("components","delType"),l("delType",r)}return t.$$set=u=>{"itemId"in u&&o(4,r=u.itemId)},t.$$.update=()=>{t.$$.dirty&48&&o(0,p=n.get(r))},[p,c,I,a,r,n]}var be=class extends T{constructor(e){super(),P(this,e,Ct,It,H,{itemId:4})}},ze=be;async function ge(t){let e=await t();if(!e?.s)throw new Error(e?.e?.message??"Unknown Error");return e}function Ke(t){t[4]=t[6].rollup,t[5]=t[6].maxComp}function Oe(t,e,o){let n=t.slice();return n[7]=e[o],n}function $t(t){let e;return{c(){e=_("p"),e.textContent=`${t[10].message}`,Y(e,"color","red")},m(o,n){$(o,e,n)},p:Z,i:Z,o:Z,d(o){o&&G(e)}}}function Gt(t){Ke(t);let e,o,n,r,l,s,c,I,p,a,u,h,v,m=t[5]+"",f,d,w=ae(t[4]),i=[];for(let b=0;b<w.length;b+=1)i[b]=et(Oe(t,w,b));let S=b=>C(i[b],1,1,()=>{i[b]=null});return{c(){e=_("div"),o=_("table"),n=_("thead"),n.innerHTML='<tr><th colspan="3">Component Summary</th></tr>',r=Q(),l=_("tbody");for(let b=0;b<i.length;b+=1)i[b].c();s=Q(),c=_("tfoot"),I=_("tr"),p=_("td"),p.textContent="Total:",a=Q(),u=_("td"),h=A(t[0]),v=A(" / "),f=A(m),B(u,"colspan","2"),B(o,"class","fshTblCenter")},m(b,X){$(b,e,X),g(e,o),g(o,n),g(o,r),g(o,l);for(let y=0;y<i.length;y+=1)i[y]&&i[y].m(l,null);g(o,s),g(o,c),g(c,I),g(I,p),g(I,a),g(I,u),g(u,h),g(u,v),g(u,f),d=!0},p(b,X){if(Ke(b),X&2){w=ae(b[4]);let y;for(y=0;y<w.length;y+=1){let ve=Oe(b,w,y);i[y]?(i[y].p(ve,X),k(i[y],1)):(i[y]=et(ve),i[y].c(),k(i[y],1),i[y].m(l,null))}for(N(),y=w.length;y<i.length;y+=1)S(y);D()}(!d||X&1)&&te(h,b[0])},i(b){if(!d){for(let X=0;X<w.length;X+=1)k(i[X]);d=!0}},o(b){i=i.filter(Boolean);for(let X=0;X<i.length;X+=1)C(i[X]);d=!1},d(b){b&&G(e),Ae(i,b)}}}function et(t){let e,o;return e=new ze({props:{itemId:t[7]}}),e.$on("delType",t[2]),{c(){V(e.$$.fragment)},m(n,r){W(e,n,r),o=!0},p:Z,i(n){o||(k(e.$$.fragment,n),o=!0)},o(n){C(e.$$.fragment,n),o=!1},d(n){R(e,n)}}}function yt(t){let e;return{c(){e=_("div"),e.innerHTML='<span class="fshSpinner fshSpinner12"></span>',B(e,"class","compSumSpin")},m(o,n){$(o,e,n)},p:Z,i:Z,o:Z,d(o){o&&G(e)}}}function vt(t){let e,o,n,r={ctx:t,current:null,token:null,hasCatch:!0,pending:yt,then:Gt,catch:$t,value:6,error:10,blocks:[,,,]};return Qe(o=t[1](),r),{c(){e=ee(),r.block.c()},m(l,s){$(l,e,s),r.block.m(l,r.anchor=s),r.mount=()=>e.parentNode,r.anchor=e,n=!0},p(l,[s]){t=l,Ve(r,t,s)},i(l){n||(k(r.block),n=!0)},o(l){for(let s=0;s<3;s+=1){let c=r.blocks[s];C(c)}n=!1},d(l){l&&G(e),r.block.d(l),r.token=null,r=null}}}function Zt(t,e,o){let n;O(t,qe,c=>o(0,n=c));function r(c){let I=new Map(re(c,"b").map(p=>[p.b,de({...p,del:c.filter(({b:a})=>a===p.b).map(({a})=>a),delPending:!1})]));return x.set(I),[...I.keys()]}async function l(){let c=await ge(fe);return{rollup:r(c.r),maxComp:c.h?.p[56]?.v}}function s(c){ne.call(this,t,c)}return[n,l,s]}var _e=class extends T{constructor(e){super(),P(this,e,Zt,vt,H,{})}},tt=_e;function ot(t){let e,o,n;return o=new L({props:{$$slots:{default:[wt]},$$scope:{ctx:t}}}),o.$on("click",F(t[2])),{c(){e=_("div"),V(o.$$.fragment)},m(r,l){$(r,e,l),W(o,e,null),n=!0},p(r,l){let s={};l&256&&(s.$$scope={dirty:l,ctx:r}),o.$set(s)},i(r){n||(k(o.$$.fragment,r),n=!0)},o(r){C(o.$$.fragment,r),n=!1},d(r){r&&G(e),R(o)}}}function wt(t){let e;return{c(){e=A("Enable Quick Del")},m(o,n){$(o,e,n)},d(o){o&&G(e)}}}function Bt(t){let e,o;return e=new tt({}),e.$on("delType",t[6]),{c(){V(e.$$.fragment)},m(n,r){W(e,n,r),o=!0},p:Z,i(n){o||(k(e.$$.fragment,n),o=!0)},o(n){C(e.$$.fragment,n),o=!1},d(n){R(e,n)}}}function Xt(t){let e,o,n;return o=new L({props:{$$slots:{default:[St]},$$scope:{ctx:t}}}),o.$on("click",F(t[3])),{c(){e=_("div"),V(o.$$.fragment)},m(r,l){$(r,e,l),W(o,e,null),n=!0},p(r,l){let s={};l&256&&(s.$$scope={dirty:l,ctx:r}),o.$set(s)},i(r){n||(k(o.$$.fragment,r),n=!0)},o(r){C(o.$$.fragment,r),n=!1},d(r){r&&G(e),R(o)}}}function St(t){let e;return{c(){e=A("Count Components")},m(o,n){$(o,e,n)},d(o){o&&G(e)}}}function At(t){let e;return{c(){e=A("Quick Extract")},m(o,n){$(o,e,n)},d(o){o&&G(e)}}}function nt(t){let e,o,n,r;return o=new L({props:{$$slots:{default:[Qt]},$$scope:{ctx:t}}}),o.$on("click",F(t[5])),{c(){e=_("div"),n=_("div"),V(o.$$.fragment),Y(n,"display","contents"),Y(n,"--button-color","red")},m(l,s){$(l,e,s),g(e,n),W(o,n,null),r=!0},p(l,s){let c={};s&256&&(c.$$scope={dirty:s,ctx:l}),o.$set(c)},i(l){r||(k(o.$$.fragment,l),r=!0)},o(l){C(o.$$.fragment,l),r=!1},d(l){l&&G(e),R(o)}}}function Qt(t){let e;return{c(){e=A("Delete All Visible")},m(o,n){$(o,e,n)},d(o){o&&G(e)}}}function Vt(t){let e,o,n,r,l,s,c,I,p,a=!t[0]&&ot(t),u=[Xt,Bt],h=[];function v(f,d){return f[1]?1:0}n=v(t,-1),r=h[n]=u[n](t),c=new L({props:{$$slots:{default:[At]},$$scope:{ctx:t}}}),c.$on("click",t[4]);let m=t[0]&&nt(t);return{c(){e=_("div"),a&&a.c(),o=Q(),r.c(),l=Q(),s=_("div"),V(c.$$.fragment),I=Q(),m&&m.c(),B(e,"class","fshCenter")},m(f,d){$(f,e,d),a&&a.m(e,null),g(e,o),h[n].m(e,null),g(e,l),g(e,s),W(c,s,null),g(e,I),m&&m.m(e,null),p=!0},p(f,[d]){f[0]?a&&(N(),C(a,1,1,()=>{a=null}),D()):a?(a.p(f,d),d&1&&k(a,1)):(a=ot(f),a.c(),k(a,1),a.m(e,o));let w=n;n=v(f,d),n===w?h[n].p(f,d):(N(),C(h[w],1,1,()=>{h[w]=null}),D(),r=h[n],r?r.p(f,d):(r=h[n]=u[n](f),r.c()),k(r,1),r.m(e,l));let i={};d&256&&(i.$$scope={dirty:d,ctx:f}),c.$set(i),f[0]?m?(m.p(f,d),d&1&&k(m,1)):(m=nt(f),m.c(),k(m,1),m.m(e,null)):m&&(N(),C(m,1,1,()=>{m=null}),D())},i(f){p||(k(a),k(r),k(c.$$.fragment,f),k(m),p=!0)},o(f){C(a),C(r),C(c.$$.fragment,f),C(m),p=!1},d(f){f&&G(e),a&&a.d(),h[n].d(),R(c),m&&m.d()}}}function Wt(t,e,o){let n,r,l=oe();function s(){J("components","enableQuickDel"),o(0,n=!0),l("enableQuickDel")}function c(){J("components","countComponents"),o(1,r=!0)}function I(){J("components","insertQuickExtract"),Te()}function p(){J("components","deleteAllVisible"),l("deleteAllVisible")}function a(u){ne.call(this,t,u)}return[n,r,s,c,I,p,a]}var ke=class extends T{constructor(e){super(),P(this,e,Wt,Vt,H,{})}},rt=ke;function he(t){return ce({subcmd:"destroycomponent",removeIndex:t})}function Rt(t,e){let o=Pe(e);return{r:o==="Component destroyed."?0:1,m:o,c:t}}async function xt(t){let e=await Fe({cmd:"profile",subcmd:"destroycomponent",component_id:t});return Rt(t,e)}function Nt(t){let e=t.filter(n=>n.r===0),o=t.filter(n=>n.r===1);return e.length>0?{r:e.map(n=>n.c),s:!0}:o.length>0?{e:{message:o[0].m},s:!1}:{e:{message:t[0].m},s:!1}}async function Ie(t){let e=await M(t.map(xt));return Nt(e)}function Ce(t){return ie(he,Ie,t)}function Dt(t,e){if(!e)return;let o=e.get("del").filter(n=>!t.includes(n));e.set("del",o)}function Jt(t,e){x.update(o=>(Dt(e,o.get(t)),o))}function Et(t,e,o){x.update(n=>(n.get(t)?.set(e,o),n))}function Lt(t){if(!t)return;let e=t.children[0];return e.replaceWith(De({className:"compSumSpin",innerHTML:'<span class="fshSpinner fshSpinner12"></span>'})),e}function lt(t,e){Et(e,"delPending",t)}function jt(t){t.forEach(([e,o])=>{o&&e.children[0].replaceWith(o)})}var Ht=t=>t.forEach(([e])=>e?.children[0]?.remove()),Ft=t=>t.map(([e])=>[e,Lt(e)]),Pt=([,t])=>t,ct=t=>re(t.map(Pt)),it=([,,t])=>t,Tt=t=>ct(t).map(e=>[e,t.filter(([,o])=>o===e).map(it)]),Mt=t=>Jt(...t);async function Ut(t){let e=Ft(t),o=await Ce(t.map(it));o?.s?(Tt(t).forEach(Mt),Ht(e)):(xe(o?.e?.message??"Unknown Error"),jt(e))}async function j(t){let e=ct(t);e.forEach(E(lt,!0)),await M(Ue(30,t).map(Ut)),e.forEach(E(lt,!1))}function z(t){let{itemId:e,invId:o}=le(K,t.dataset.tipped);return[Number(e),Number(o)]}var Yt=t=>[U(t),...z(t)];function $e(t){j(q("img",t).map(Yt))}var qt=t=>Se(x).get(t.detail).get("del"),zt=(t,e)=>U(Xe(`img[data-tipped*="&inv_id=${e}&"]`,t));function Ge(t,e){j(qt(e).map(o=>[zt(t,o),e.detail,o]))}function Kt(t){t.target.tagName==="IMG"&&(t.preventDefault(),J("components","quickDel"),Me(t.target),j([[U(t.target),...z(t.target)]]))}function ye(t){t.classList.add("fshQuickDel"),Je(t,Kt)}function Ot(){let t=Ze("profileRightColumn"),e=Ee("inventory-table",t);if(e.length===2)return e[1]}function eo(){let t=Ot();if(!t)return;let e=new rt({target:t.parentNode});e.$on("enableQuickDel",E(ye,t)),e.$on("delType",E(Ge,t)),e.$on("deleteAllVisible",E($e,t))}export{eo as default};
//# sourceMappingURL=components-6RY67EKP.js.map
