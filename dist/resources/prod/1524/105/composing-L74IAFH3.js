import{a as nt}from"./chunk-PGRP3LZS.js";import{a as x,b as tt}from"./chunk-XGRR26NB.js";import{a as et}from"./chunk-7Z2WEOAF.js";import{a as ot}from"./chunk-PDLRL2U6.js";import{a as S}from"./chunk-OGCSPNP7.js";import{a as Z}from"./chunk-GGHZKIXB.js";import{a as K,b as W}from"./chunk-AWGMP4V7.js";import{a as k}from"./chunk-GPANXWBJ.js";import{a as Y}from"./chunk-4S4RJIWM.js";import{a as X}from"./chunk-JWVJSOBO.js";import{a as C}from"./chunk-4QY6SPTZ.js";import"./chunk-PVXVA62G.js";import{a as z}from"./chunk-URWUNVTF.js";import{a as V}from"./chunk-RN6NICJ7.js";import{a as g}from"./chunk-WP265O3M.js";import"./chunk-TZIXO72F.js";import{a as U}from"./chunk-I6ZSBYQ3.js";import{a as M}from"./chunk-YQ625XVJ.js";import"./chunk-VMCLSOZO.js";import"./chunk-PBUQY6G2.js";import{a as R}from"./chunk-GUJMNTXY.js";import{a as b}from"./chunk-GXOFVYKC.js";import"./chunk-A6LP6MUS.js";import{a as H}from"./chunk-E2MFTVAH.js";import{a as s}from"./chunk-Y5EGDMIB.js";import"./chunk-SNNJRQSX.js";import"./chunk-5YAX7RCO.js";import"./chunk-Z5JYB3FL.js";import"./chunk-SY2OGTK4.js";import{a as $}from"./chunk-MHWHHESW.js";import"./chunk-DLFQE7QF.js";import{a as D}from"./chunk-QQEKW5LY.js";import{c as O}from"./chunk-FR27OJE5.js";import{a as J}from"./chunk-DDG7VJDB.js";import"./chunk-GMQMPQTF.js";import"./chunk-B7LKBV3M.js";import{a as _}from"./chunk-E3BH7XBT.js";import"./chunk-IUVEXKRJ.js";import"./chunk-WVO4VYA4.js";import"./chunk-C63Q3HN7.js";import"./chunk-JG7KZ32H.js";import{a as j}from"./chunk-FMA2QB7F.js";import"./chunk-35MRBVSX.js";import{a as G}from"./chunk-NRW7AT6T.js";import"./chunk-DPECAWNM.js";import{a as d}from"./chunk-KOM3R443.js";import"./chunk-NIOVFM2M.js";import"./chunk-6ZCA6D63.js";import"./chunk-YXAOTQ2S.js";import{a as l}from"./chunk-V45UJIF2.js";import{a}from"./chunk-64PLTPQD.js";import"./chunk-OHAOQZFW.js";import"./chunk-PJWDCLVE.js";import{b as i}from"./chunk-Q3ULPWYK.js";import{a as r}from"./chunk-SSAI4GAC.js";import{a as c}from"./chunk-JCK66TTB.js";import{a as L}from"./chunk-SY4ES3W2.js";import{a as p}from"./chunk-S7AF3SZF.js";import"./chunk-TFKKNJKY.js";import"./chunk-ZFTJPJLX.js";import{c as F}from"./chunk-R7J7NY4A.js";import{b as I,f as Q,qa as h,ra as w}from"./chunk-5ELKH2XV.js";import"./chunk-5ORZS6IQ.js";import"./chunk-BRQN5OZB.js";import{a as m}from"./chunk-BZJZQFW2.js";import{a as P}from"./chunk-QCTVAEOV.js";import"./chunk-VQDTHLUC.js";async function y(t){let e=await G({cache:!1,dataType:"text",data:{cmd:"composing",subcmd:"createajax",template_id:t,fshrnd:tt()}});return $(e)??{error:"Server Error"}}function ct(){return`url(${I}composing/${x(1,11)}_${x(1,51)}.png)`}function lt(t,e){r("",t.children[0]),t.children[0].classList.add("fshPot"),t.children[0].style.backgroundImage=ct(),r(`Creating '<span class="fshBold">${e}</span>' Potion`,t.children[2]),r("",t.children[3])}function mt(){a('[id|="composing-template"]:not(#composing-template-multi)').length===0&&p(h,!1)}function at(t){let e=t.parentNode;e&&(r('<div class="fshScs">Success</div>',e),lt(e.previousElementSibling.previousElementSibling,t[t.selectedIndex].text),mt())}function pt(t,e){let o=t.parentNode;!o||!e||(e.error?r(`<div class="fshScs">${e.error}</div>`,o):at(t))}async function ft(t){let e=await y(t.value);pt(t,e)}function f(t,e){e.id=`proc-${e.id}`,r("",t),t.classList.add("fshSpinner","fshSpinner12","fshComposingSpinner"),ft(e),K("quickcreate")}function it(t,e){t.classList.add(`left-${e.toString()}`)}function ut(t){let e=a(".quickCreate .sendLink");it(t,e.length)}function dt(t,e){s("composing","FastComposeButton");let o=a('[id|="composing-template"]:not(#composing-template-multi)');if(!(o.length<t.value))for(let n=0;n<t.value;n+=1)o[n].value=e,f(o[n].nextElementSibling.nextElementSibling,o[n])}function gt(t){let e=t.target,{templateId:o}=e.dataset;o&&dt(e,o)}function ht(t,e){return k({className:"awesome orange",dataset:{templateId:e},type:"button",value:t})}function Ct(t,e,o,n){return n===0&&Y(t[1],e.insertCell(-1)),b(e.insertCell(-1),ht((n+1).toString(),t[0])),e}function bt(t,e,o){return t.forEach(m(Ct,o,e.insertRow(-1))),e}function kt(t,e,o){let n=et({id:"fshFastCompose"});return it(n,o),t.reduce(m(bt,e),n)}function St(t){return[t.value,t.text]}function xt(t,e,o){let n=l("#composing-template-multi option").map(St),u=kt(n,e,o);b(t,u),c(i(),gt),W("quickcreate",m(ut,u))}function yt(t){s("composing","FastCompose"),g(t,"<br>");let e=C("composing-potion-time",document),o=e.filter(J("ETA: n/a")).length;o>0?xt(t,e,o):g(t,"No open slots!")}function v(){let t=j("#pCC div.centered");g(t,'<span class="fsh-fast-compose">[ <label for="fast-compose"><span class="sendLink">Fast Compose</span></label> ]</span>');let e=R({className:"centered"});S(e,t);let o=k({id:"fast-compose",type:"checkbox"});S(o,t),H(o,"change",m(yt,e))}function vt(t){let e=D(Q,d(t));if(e){let{h:o,m:n,s:u}=e;return(o*3600+n*60+Number(u))*1e3+O()}return 0}function rt(t){p(h,t)}function E(){if(!P.enableComposingAlert)return;let t=C("composing-potion-time",document),e=Math.min(...t.map(vt));e===0?rt(!0):(rt(!1),p(w,e))}function B(t){return Z({subcmd:"collect",potion_id:t})}async function N(t){let e=await U({cmd:"composing",subcmd:"collect",potion_id:t}),o=z(e);return o.includes("collected")?{s:!0}:{s:!1,e:{message:o}}}function q(t){return M(B,N,t)}function Et(t){let e=t.getAttribute("onclick").split("&")[2].split("=")[1];nt(t.parentNode,`[ <span class="fsh-quick-collect"><button class="fshBl fsh-bli" type="button" value="${e}">Quick Collect</button></span> ]&nbsp;`)}var Bt=t=>t.tagName==="BUTTON"&&d(t)==="Quick Collect";function Nt(t){t.nextElementSibling.disabled=!0,t.nextElementSibling.nextElementSibling.disabled=!0,r("",t),t.classList.add("fshSpinner")}function st(t,e,o){r(o,t),t.classList.add(e)}function qt(t,e){t.classList.remove("fshSpinner"),e.s?st(t,"fshGreen","Collected"):st(t,"fshRed","Error")}async function Tt(t){s("composing","quickCollect");let e=t.parentNode,o=t.value;Nt(e);let n=await q(o);qt(e,n)}function At(t){Bt(t.target)&&Tt(t.target)}function T(){l('input[value="Collect Potion"]',i()).forEach(Et),c(i(),At)}function Lt(t){ot(t,'<span class="quickCreate">[<span class="sendLink">Quick Create</span>]</span>')}var Pt=t=>t.tagName==="SPAN"&&t.className==="quickCreate";function It(t){let e=t.previousElementSibling.previousElementSibling;e&&e.value!=="none"&&(f(t,e),s("composing","QuickCreate"))}function Qt(t){let e=t.target.parentNode;Pt(e)&&It(e)}function A(){l("input[id^=create-]:not(#create-multi)",i()).forEach(Lt),c(i(),Qt)}function wt(){if(!F("moveComposingButtons"))return;let t=L("composing-error-dialog").previousElementSibling;t.setAttribute("style","text-align: right; padding: 0 38px 0 0");let e=V("composing-level",i())[0].parentNode;X(t,e)}function Ft(){E(),A(),wt(),v(),T()}function $t(){_()&&i()&&Ft()}export{$t as default};
//# sourceMappingURL=composing-L74IAFH3.js.map
