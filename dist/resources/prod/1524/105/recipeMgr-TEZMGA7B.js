import{a as z}from"./chunk-HY6EB2ER.js";import{a as V}from"./chunk-25YDKMOE.js";import{a as O}from"./chunk-RN6NICJ7.js";import{a as E}from"./chunk-JDEF33GP.js";import{a}from"./chunk-WP265O3M.js";import"./chunk-TZIXO72F.js";import{a as x}from"./chunk-EJFOLQ4R.js";import{a as D}from"./chunk-GUJMNTXY.js";import{a as l}from"./chunk-3UNKZDTI.js";import{a as q}from"./chunk-GXOFVYKC.js";import"./chunk-A6LP6MUS.js";import{a as Q,b as v}from"./chunk-K2ALIVI4.js";import"./chunk-SNNJRQSX.js";import"./chunk-5YAX7RCO.js";import"./chunk-Z5JYB3FL.js";import"./chunk-JFV47WCR.js";import"./chunk-DLFQE7QF.js";import{a as K}from"./chunk-2LYWZOMD.js";import"./chunk-ZWVBDX5N.js";import{a as G}from"./chunk-QQEKW5LY.js";import{a as M}from"./chunk-NT4BD23Z.js";import"./chunk-B7LKBV3M.js";import"./chunk-E3BH7XBT.js";import"./chunk-IUVEXKRJ.js";import{a as p}from"./chunk-WVO4VYA4.js";import{a as L}from"./chunk-C63Q3HN7.js";import"./chunk-35MRBVSX.js";import{a as A}from"./chunk-5UBD44K5.js";import"./chunk-AH7GU5B4.js";import"./chunk-NRW7AT6T.js";import{c as u}from"./chunk-DPECAWNM.js";import"./chunk-V7IRBBI6.js";import"./chunk-B72RCTA5.js";import{a as f}from"./chunk-KOM3R443.js";import"./chunk-NIOVFM2M.js";import"./chunk-6ZCA6D63.js";import"./chunk-YXAOTQ2S.js";import{a as I}from"./chunk-V45UJIF2.js";import"./chunk-64PLTPQD.js";import"./chunk-OHAOQZFW.js";import"./chunk-PJWDCLVE.js";import{b as H}from"./chunk-Q3ULPWYK.js";import{a as h}from"./chunk-SSAI4GAC.js";import{a as U}from"./chunk-JCK66TTB.js";import{a as y}from"./chunk-SY4ES3W2.js";import{c as j}from"./chunk-R7J7NY4A.js";import{g as _}from"./chunk-5ELKH2XV.js";import"./chunk-5ORZS6IQ.js";import{a as S}from"./chunk-BRQN5OZB.js";import{a as i}from"./chunk-BZJZQFW2.js";import{a as s}from"./chunk-QCTVAEOV.js";import"./chunk-VQDTHLUC.js";function Z(t){return s.sortBy&&s.sortBy===t}function P(t){let r=t.getAttribute("sortKey");S(s.sortAsc)&&(s.sortAsc=!0),Z(r)&&(s.sortAsc=!s.sortAsc),s.sortBy=r}var R=0,W=[];function tt(t){return`<div class="rmItem"><img class="tip-dynamic" data-tipped="fetchitem.php?item_id=${t.id}&inv_id=-1&t=2&p=${R}&vcode=${t.verify}" src="${t.img}" height="20px" width="20px"><p>${t.amountPresent}/${t.amountNeeded}</p></div>`}var J=t=>t?t.map(tt).join(""):"";function rt(t){return t.target?` <img class="tip-dynamic" data-tipped="fetchitem.php?item_id=${t.target.id}&inv_id=-1&t=2&p=${R}&vcode=${t.target.verify}" src="${t.target.img}" height="30px" width="30px"><br/>`:""}function et(t){return!W.includes(t.name)}function ot(t){return`<tr class="rmTr"><td class="rmTd"><a href="${t.link}"><img src="${t.img}" height="30px" width="30px"></a></td><td class="rmTd"><a href="${t.link}">${t.name}</a></td><td class="rmTd">${J(t.items)}</td><td class="rmTd">${J(t.components)}</td><td class="rmTd">${rt(t)}</td></tr>`}function nt(t,r){R=E();let e='<table width="100%"><tr class="rmTh"><th>Recipe</th><th><span id="sortName" class="fshLink" sortkey="name">Name</span></th><th>Items</th><th>Components</th><th>Target</th></tr>';e+=r.recipe.filter(et).map(ot).join(""),e+="</table>",h(e,t),v("fsh_recipeBook",r)}function g(t,r){r&&(j("hideRecipes")&&(W=z("hideRecipeNames")),nt(t,r))}function b(t){return I('#pCC img[src*="/folder"]',t)}function it(t){return A("td",y("pCC",t))}function mt(t,r){let e=r.getAttribute("background");return e&&e.includes(t)}function st(t){let{itemId:r,vcode:e}=G(_,t.dataset.tipped);return{img:t.getAttribute("src"),id:r,verify:e}}function at(t,r){if(r){let e=f(r).split("/");t.amountPresent=parseInt(e[0],10),t.amountNeeded=parseInt(e[1],10)}}function pt(t){let r=t.children[0].children[0],e=st(r);return at(e,t.parentNode.nextElementSibling),e}function $(t,r){return t.filter(i(mt,r)).map(pt)}function k(t,r,e,o){let n=p(o);a(t,`Parsing blueprint ${e.name}...<br>`);let d=it(n);e.items=$(d,"/inventory/2x3."),e.components=$(d,"/inventory/1x1mini."),[e.target]=$(d,"/hellforge/2x3."),r.recipe.push(e)}function ct(t){return I('#pCC a[href*="=viewrecipe&"]',t)}function ft(t){return{img:t.parentNode.previousElementSibling.children[0].getAttribute("src"),link:t.href,name:f(t),id:x(t.search,"recipe_id")}}async function dt(t,r,e){a(t,`Found blueprint "${f(e)}".<br>`);let o=ft(e),n=await u(e.href);k(t,r,o,n)}function B(t,r,e){let o=p(e),n=ct(o).map(i(dt,t,r));return l(n)}function ut(t){return/\/folder_on\./.test(t.getAttribute("src"))}function lt(t){return b(t).find(ut)?.parentNode?.href}function gt(t,r){return r!==0}function ht(t){return t.value}function bt(t){return A("option",O("customselect",y("pCC",t))[0]).filter(gt).map(ht)}async function yt(t,r,e){let o=await u(`${t}&page=${e}`);return r(o)}function xt(t,r,e){return bt(t).map(i(yt,r,e))}function F(t,r,e){let o=p(e);if(!o)return;let n=lt(o);if(!n)return;let d=i(B,t,r),C=xt(o,n,d);return C.push(d(e)),l(C)}function At(t){return x(t.parentNode.search,"folder_id")!=="-1"}function It(t,r){let e=f(r.parentNode.parentNode.nextElementSibling),o=/quest/i.test(e);return o&&a(t,`Skipping folder "${e}"  as it has the word "quest" in folder name.<br>`),!o}async function vt(t,r){let e=await u(r.parentNode.href);return t(e)}function Pt(t,r,e){let o=p(r);return b(o).filter(At).filter(i(It,t)).map(i(vt,e))}function T(t,r,e){let o=i(F,t,r),n=Pt(t,e,o);return n.push(o(e)),l(n)}var m=0,c=0,N=()=>m,X=()=>c;function Rt(){a(c,"Finished parsing ... formatting ..."),v("fsh_recipeBook",m),g(c,m)}async function w(){m={},m.recipe=[],h("<br>Parsing inventing screen ...<br>",c);let t=await L({cmd:"inventing"});t&&(await T(c,m,t),Rt())}function Y(t,r){m=r,h('<table class="fshInvFilter"><thead><tr><th width="90%"><b>&nbsp;Recipe Manager</b></th><th width="10%" class="fshBtnBox">[<span id="rfsh" class="fshLink">Refresh</span>]</th></tr></thead></table>',t),c=D(),q(t,c),m?g(c,m):w()}function $t(t){P(t),N().recipe.sort(K),g(X(),N())}var kt=[["rfsh",w],["sortName",$t]];async function Bt(t){if(M())return;let r=t||H(),e=await Q("fsh_recipeBook");Y(r,e),U(r,V(kt))}export{Bt as default};
//# sourceMappingURL=recipeMgr-TEZMGA7B.js.map
