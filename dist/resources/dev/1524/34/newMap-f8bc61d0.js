import{c as t,m as e,y as a,z as n,h as r,t as o,i,o as s,aE as u,Q as l,aF as c,aG as f,aH as d,_ as m,b as h,f as p,D as b,C as g,W as v,al as y,H as k,aI as w,B as C,aA as L,aJ as D,aK as A,aL as M,aM as V,aN as S,aO as H,aP as N,aQ as B,ar as G,aD as x,A as T,aR as E,a3 as P,U as j,v as I,ab as R,a4 as O,aS as F,aT as _,P as q,u as K,aU as Y,aV as z,aW as U,aX as W,ay as Q,q as J,a as X,J as Z,aY as tt,aZ as et,a_ as at,a$ as nt,b0 as rt,l as ot,M as it,av as st,a6 as ut,b1 as lt,b2 as ct,b3 as ft,b4 as dt,b5 as mt,b6 as ht,b7 as pt}from"./calfSystem-c07e3259.js"
import{i as bt}from"./insertElementAfter-6171d8e9.js"
import{t as gt}from"./toggleForce-f376374b.js"
import{c as vt}from"./createSpan-9738bb01.js"
import{i as yt}from"./insertTextBeforeEnd-3127a0cf.js"
import{a as kt,r as wt}from"./roundToString-c55ff653.js"
import{a as Ct}from"./addCommas-4b913655.js"
import{d as Lt,q as Dt}from"./quickbuffSuccess-7d1ade41.js"
import{p as At}from"./playerName-54b31a1f.js"
import{g as Mt,s as Vt}from"./idb-dd65ea6c.js"
import{c as $t}from"./createStyle-7a0bcb4f.js"
import{g as St}from"./getArrayByClassName-abf6bba3.js"
import{e as Ht}from"./executeAll-7837be0f.js"
import{c as Nt}from"./createButton-caed9067.js"
import{e as Bt}from"./eventHandler5-b1b2b9da.js"
import{i as Gt}from"./insertElementBefore-9e5d02cd.js"
import{c as xt}from"./createInput-a08cdf48.js"
import{c as Tt}from"./createLabel-43a0f7dc.js"
import{o as Et}from"./openQuickBuffByName-e650cf6c.js"
import{a as Pt}from"./all-3246a95f.js"
import{a as jt}from"./allthen-9dd15411.js"
import{d as It,g as Rt}from"./getGroupStats-fe76b9fa.js"
import{g as Ot}from"./getMercStats-475d6e45.js"
import{g as Ft}from"./getProfile-c197091b.js"
import{g as _t}from"./getMembrList-1b7939f3.js"
import{h as qt}from"./hideElement-7b9c883f.js"
import{n as Kt}from"./numberIsNaN-738f2a3f.js"
import{r as Yt}from"./reduceBuffArray-7cd20b37.js"
import{r as zt}from"./rnd-e579b276.js"
import{h as Ut}from"./hasClasses-b0f9355e.js"
import{v as Wt}from"./valueText-5b814802.js"
import{g as Qt}from"./guild-aff48b9b.js"
import{g as Jt,a as Xt}from"./getTitanString-c1115a95.js"
import{p as Zt}from"./padZ-d4e02992.js"
import{c as te}from"./createTable-b1dbea45.js"
import{t as ee}from"./testQuant-0f1de145.js"
import{m as ae}from"./myStats-ea8ed6db.js"
import{a as ne}from"./huntingBuffs-0bbe9ea2.js"
import{b as re}from"./simpleCheckbox-d4a4dee5.js"
import{b as oe}from"./bitwiseAnd-822dbd82.js"
import{s as ie}from"./shouldBeArray-ed4cac04.js"
import"./fshOpen-49538a62.js"
import"./chunk-5d7e6f3a.js"
import"./createLi-bee65984.js"
import"./createUl-09bf27ae.js"
import"./groupViewStats-c231931a.js"
import"./intValue-d2a6f461.js"
import"./cmdExport-73f6ff02.js"
import"./indexAjaxJson-18a12ea8.js"
import"./currentGuildId-0e53e6a7.js"
import"./testRange-d919f908.js"
import"./isChecked-d96c8dec.js"
import"./isSelected-2ed90a64.js"
import"./csvSplit-5e072bd9.js"
let se,ue,le,ce,fe,de,me,he,pe
function be(t){return t}function ge(n){if(function(e){return t.showBuffInfo&&e.some(be)}(n))return function(){if(se)gt(se,!1)
else{se=e({className:"fshActionBox",innerHTML:"<div></div><div></div><div></div><div></div><div></div><div></div>"})
const t=a("actionContainer")
bt(se,t.children[2])}return se}()
se&&gt(se,!0)}function ve(t,e){ue?gt(ue,!1):function(t){ue=t.children[3],ue.className="fshBlue",n("CA ",ue),le=vt(),r(ue,le),yt(ue," active")}(t),n(e.level,le)}function ye(t,e){e?ve(t,e):ue&&gt(ue,!0)}function ke(t,e){ce?gt(ce,!1):function(t){ce=t.children[4],ce.className="fshRed",n("Doubler ",ce),fe=vt(),r(ce,fe),yt(ce," active")}(t),n(e.level,fe)}function we(t,e){e?ke(t,e):ce&&gt(ce,!0)}function Ce(t,e,a){de?gt(de,!1):function(t){de=t.children[2],n("Damage bonus: ",de),me=vt(),r(de,me),yt(de,"%")}(t),n(function(t,e){if(t){const a=Math.min(.01*Math.round(Math.floor(e/5)*Number(t.level)),20)
return kt(a,2).toString()}return"0"}(e,Number(a)),me)}function Le(t,e,a){e?Ce(t,e,a):de&&gt(de,!0)}function De(t,e){n(Ct(t),e)}function Ae(t,e){he?gt(he,!1):function(t){he=t.children[1],n("Kill Streak: ",he),pe=vt(),r(he,pe)}(t),De(e,pe)}function Me(t,e,a,n){e||a?Ae(t,n):he&&gt(he,!0)}function Ve(t,e){return e.name===t}function $e(t){const{buffs:e}=GameData.player()
if(e)return e.find(o(Ve,t))}const Se=["red","orange","yellow"]
let He,Ne
function Be(t){Dt(t)&&GameData.fetch(u)}function Ge(){$e("Summon Shield Imp")||Lt([At()],[55]).then(Be)}const xe=["imp-0","imp-1","imp-1"]
function Te(t,e){He?gt(He,!1):function(t){He=t.children[0],n("Shield Imps Remaining: ",He),Ne=vt(),r(He,Ne),i(He,"&nbsp;")
const e=vt({className:"xSmallLink",textContent:"Recast"})
r(He,e),s(e,Ge)}(t)
const a=function(t){return t?Number(t.stack):0}(e)
He.className=function(t){return xe[t]||"fshGreen"}(a),n(a,Ne)}function Ee(t,e,a){e||a?Te(t,e):He&&gt(He,!0)}function Pe(t){return 0===t.type}function je(t){return vt({textContent:t})}let Ie,Re,Oe,Fe,_e,qe,Ke,Ye,ze,Ue
function We(t,e){Ie?gt(Ie,!1):function(t,e){Ie=t.children[5],n("Teleport Cooldown: ",Ie),Re=je(e.toString()),r(Ie,Re)}(t,e)}function Qe(){const t=Math.max(Math.ceil((Oe-Date.now())/1e3),0)
n(t,Re),t>0&&setTimeout(Qe,500)}function Je(t,e){e?We(t,e):Ie&&gt(Ie,!0)}function Xe(){Fe=$e("Death Dealer"),_e=$e("Doubler"),qe=$e("Counter Attack"),Ke=$e("Summon Shield Imp"),Ye=function(){const t=GameData.player().teleportCooldown
return t>1&&t}(),ze=function(){const{dynamic:t}=GameData.realm()
return l(t)&&t.some(Pe)}(),Ue=GameData.player().killStreak}function Ze(){!function(){const t=$("#actionlist-shield-imp")
1===t.length&&t.css("background-color",Se[t.text()]||"#ad8043")}(),Xe()
const t=ge([Fe,_e,qe,Ke,Ye,ze])
t&&(Ee(t,Ke,Fe),Me(t,Fe,ze,Ue),Le(t,Fe,Ue),ye(t,qe),we(t,_e),Je(t,Ye))}function ta(t,e){var a
a=e.player.teleportCooldown,Re&&(Oe=Date.now()+1e3*a,Qe())}const ea=["NORMAL","CHAMPION","ELITE","SUPER ELITE","TITAN","LEGENDARY"]
let aa=!1
function na(t){return g(".verb.attack",t)}function ra(t){const e=ea.indexOf(t.toUpperCase())
return b(`#actionList .actionListItem.creature.creature-${e}`)}function oa(t){const e=["LEGENDARY","NORMAL"].flatMap(ra),a=ra("CHAMPION"),[n,r]=t?[e,a]:[a,e],o=`url("${y}ui/world/icon_action_attack_`
n.map(na).filter((t=>null!==t)).forEach((t=>{t.classList.remove("attack-1","attack-2","attack-3","attack-4","attack-5","attack-6","attack-7","attack-8"),t.style.backgroundImage=""})),r.slice(0,8).map(na).forEach(((t,e)=>{null!==t&&(t.classList.add(`attack-${e+1}`),t.style.backgroundImage=`${o}${e+1}.png")`)}))}function ia(t){if(!t.ctrlKey||!t.shiftKey||"INPUT"===t.target.tagName||"TEXTAREA"===t.target.tagName)return
if(aa||oa(!0),aa=!0,!t.code.match(/(Digit|Numpad)[1-8]/))return
const e=ra("CHAMPION"),a=parseInt(t.code.slice(-1),10)-1
if(a<e.length){const t=na(e[a])
null!==t&&(v("world","ChampionAttack"),t.click())}}function sa(t){!aa||t.ctrlKey&&t.shiftKey||(aa=!1,oa(!1))}const ua=["Breaker","Protection","Master Thief","Protect Gold","Disarm","Duelist","Thievery","Master Blacksmith","Master Crafter","Fury Caster","Master Inventor","Sustain"]
let la,ca=[]
function fa(t){54!==t.id&&26!==t.id||(la.player.buffs[t.id]=parseInt(t.level,10))}function da(t){-1===ua.indexOf(t.name)&&(la.player.enhancements[t.name]=t.value)}function ma(t,e){la={},la.combat=e.response.data,la.combat.inventory_id&&(la.combat.drop=la.combat.item.id),la.player={},la.player.buffs={},la.player.enhancements={},function(t){t.player.buffs&&t.player.buffs.forEach(fa)}(e),function(t){t.player.enhancements&&t.player.enhancements.forEach(da)}(e),la.time=e.time,ca.push(la),Vt("fsh_combatLog",ca)}function ha(t,e){0===e.response.response&&ma(0,e)}function pa(t){t&&(ca=t),$.subscribe(w,ha)}function ba(e){return t.doNotKillList.includes(e.trim())}function ga(t){t.classList.toggle("fshBlue",ba(C(t)))}function va(){const t=a("actionList")
St("creature",t).forEach(ga)}function ya(t){const e=GameData.actions()[t]
if(e)return function(t,e){if(ba(t))return a("actionList").children[e].children[0].children[1].classList.remove("loading"),!0}(e.data.name,t)}const ka={2:function(t){return function(e,a,n,r){ya(n.passback)||t(e,a,n,r)}}}
function wa(t){return function(e,a,n,r){const o=ka[e];(function(t){return t&&L(t)})(o)&&function(t){return D(t)||0===t}(r)?o(t)(e,a,n,r):t(e,a,n,r)}}function Ca(t){t.remove()}function La(t,e){!function(t){(function(t){return t.response&&t.response.msg&&t.response.msg.startsWith("Creature did not exist at that location")})(t)&&GameData.fetch(M+V)}(e),b(".creature-4 > .quickCombat > .verbs").forEach(Ca)}function Da(){window.GameController&&GameController.Realm&&!GameController.Realm.footprintTileList&&(GameController.Realm.footprintTileList=[])}function Aa(t,e,a){return Tt({className:`fshCurveEle fshCurveLbl fshPoint tip-static ${t}`,dataset:{tipped:e},htmlFor:a})}function Ma(t){const a=e({className:"fshToggle"}),n=xt({checked:t.prefVal,id:t.checkId,type:"checkbox"})
r(a,n)
const o=Aa(t.onClass,t.onTip,t.checkId)
r(a,o)
const i=Aa(t.offClass,t.offTip,t.checkId)
return r(a,i),r(t.worldName,a),n}let Va,$a,Sa,Ha,Na,Ba,Ga,xa,Ta
function Ea(t){return t?t.toString():"?"}function Pa(t){const a=e({className:"fshFsty"})
r(a,function(){const t=e({textContent:"Min Lvl: "})
return $a=je(Ea(GameData.realm().minlevel)),r(t,$a),t}()),r(a,function(){const t=e({textContent:"Your Lvl: "})
return Sa=je(Ea(GameData.player().level)),r(t,Sa),t}()),r(t,a)}function ja(t,e,a){const n=Nt({className:`fshCurveEle fshCurveBtn fshPoint tip-static ${t}`,dataset:{tipped:e}})
return r(a,n),n}function Ia(){var e
Pa(e=Va),Ha=ja("fshFormGroup","Quick Create Attack Group",e),Na=ja("fshQuickBuff","Open Quick Buff Popup",e),Ba=ja("fshRealmMap","Open Realm Map",e),Ga=ja("fshTempleOne","Search map in Ultimate FSG",e),function(t){if(k("showSpeakerOnWorld")){const e=k("playNewMessageSound")
xa=Ma({prefVal:e,checkId:"fshSoundCheck",onClass:"soundOn",onTip:"Turn Off Sound when you have a new log message",offClass:"soundOff",offTip:"Turn On Sound when you have a new log message",worldName:t})}}(Va),function(e){const a=t.huntingMode
Ta=Ma({prefVal:a,checkId:"fshHuntCheck",onClass:"huntOn",onTip:"Hunting mode is ON",offClass:"huntOff",offTip:"Hunting mode is OFF",worldName:e})}(Va)}const Ra=[[t=>t===xa,function(){m("playNewMessageSound",!k("playNewMessageSound"))}],[t=>t===Ta,function(){t.huntingMode=!t.huntingMode,m("huntingMode",t.huntingMode)}]],Oa=[[t=>t===Ha,function(t){N(t),GameData.doAction(12,401,{},0)}],[t=>t===Na,function(){Et(At())}],[t=>t===Ba,function(){window.open(`${B+G}map`,"fsMap")}],[t=>t===Ga,function(){const t=GameData.realm()
window.open(`${x}realms${G}view&realm_id=${t.id}`,"mapUfsg")}]]
function Fa(){Va||(Va=e({className:"fshCurveContainer",id:"fshWorldButtonContainer"}),Ia(),s(Va,Bt(Oa)),p(Va,"change",Bt(Ra)),Gt(Va,a("worldCoord")))}function _a(t,e){$a&&e.b.minlevel&&(Da(),n(e.b.minlevel,$a))}function qa(t,e){Sa&&n(e.b,Sa)}function Ka(t){return!t||!t.response||!t.response.data}let Ya,za,Ua,Wa,Qa,Ja,Xa,Za,tn,en,an,nn,rn,on,sn,un,ln,cn,fn,dn,mn,hn,pn,bn,gn,vn,yn,kn,wn,Cn,Ln,Dn,An,Mn,Vn
function $n(t){return t.player_name}function Sn(t){!function(t){Wa=t.defenders.map($n)}(t),Ya?T("",Ya):Ya=e({className:"body"}),function(t){za=e({className:"fshFloatLeft fshRelicLeftDiv"}),r(Ya,za),t.is_owner&&r(za,It(Wa)),Ua=Nt({className:"custombutton",textContent:"Fetch Stats"}),r(za,Ua)}(t)
const n=a("dialog-relic")
r(n,Ya)}const Hn=[t=>"lastUpdate"!==t,t=>!Wa.includes(t),t=>Qa[t].last_login,t=>Number(Qa[t].last_login)<Ja,t=>Number(Qa[t].last_login)>Xa,t=>Qa[t].level<400||Qa[t].level>421,t=>Qa[t].level<441||Qa[t].level>450]
function Nn(t,e){return e(t)}function Bn(t){return Hn.every(o(Nn,t))}function Gn(t){return`<a href="${P}${Qa[t].id}">${t}</a>`}function xn(t){Qa=t,Ja=j-120,Xa=j-604800
const e=E(Qa).filter(Bn).map(Gn)
i(Ya,`<div class="fshFloatLeft fshRelicLowDiv"><table class="relicT"><thead><tr><th>${e.length.toString()} Offline guild members not at relic:</th></tr></thead><tbody><tr><td>${e.join(" ")}</td></tr></tbody></table></div>`)}function Tn(t){qt(Ua)
const n=k("hideRelicOffline")
t.is_owner&&!n&&_t(!0).then(xn),i(za,'<table class="relicT"><thead><tr><th colspan="2">Processing</th></tr></thead><tbody><tr><td class="fshGreen" colspan="2" id="ProcessingStatus">Parsing defending guild stats ...</td></tr></tbody><thead><tr><th colspan="2">Assumptions</th></tr></thead><tbody><tr><td colspan="2" class="fshGrey">Above calculations include Constitution, Fortitude, Nightmare Visage, Chi Strike, Sanctuary, Terrorize and Flinch bonus calculations (in that order) on both the defending group and attacking group.</td></tr></tbody></table>'),Vn=a("ProcessingStatus")
const o=e({className:"fshFloatLeft fshRelicMidDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Defending Guild Stats</th></tr></thead><tbody><tr><td>Relic Count:</td><td id="relicCount">0</td></tr><tr><td>Lead Defender Bonus:</td><td id="LDPercentage">0</td></tr><tr><td>Lead Defender Cloaked:</td><td id="LDCloaked">No</td></tr></tbody><thead><tr><th colspan="2">Other Defender Stats</th></tr></thead><tbody><tr><td>Raw Attack:</td><td class="fshGrey" id="attackValue">0</td></tr><tr><td>Attack w/ buffs:</td><td id="attackValueBuffed">0</td></tr><tr><td>Raw Defense:</td><td class="fshGrey" id="defenseValue">0</td></tr><tr><td>Defense w/buffs:</td><td id="defenseValueBuffed">0</td></tr><tr><td>Raw Armor:</td><td class="fshGrey" id="armorValue">0</td></tr><tr><td>Armor w/ buffs:</td><td id="armorValueBuffed">0</td></tr><tr><td>Raw Damage:</td><td class="fshGrey" id="damageValue">0</td></tr><tr><td>Damage w/ buffs:</td><td id="damageValueBuffed">0</td></tr><tr><td>Raw HP:</td><td class="fshGrey" id="hpValue">0</td></tr><tr><td>HP w/ buffs:</td><td id="hpValueBuffed">0</td></tr><tr><td>Cloaked:</td><td id="defendersCloaked">0</td></tr><tr><td>Processed:</td><td id="defendersProcessed">0</td></tr></tbody></table>'})
r(Ya,o),Za=a("relicCount"),tn=a("LDPercentage"),en=a("LDCloaked"),an=a("attackValue"),nn=a("attackValueBuffed"),rn=a("defenseValue"),on=a("defenseValueBuffed"),sn=a("armorValue"),un=a("armorValueBuffed"),ln=a("damageValue"),cn=a("damageValueBuffed"),fn=a("hpValue"),dn=a("hpValueBuffed"),mn=a("defendersCloaked"),hn=a("defendersProcessed")
const s=e({className:"fshFloatLeft fshRelicRightDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Adjusted defense values</th></tr></thead><tbody><tr><td>DC225:</td><td id="DC225">0</td></tr><tr><td>DC175:</td><td id="DC175">0</td></tr><tr><td colspan="2">&nbsp;</td></tr></tbody><thead><tr><th colspan="2">Attacking Group Stats</th></tr></thead><tbody><tr><td>Raw Group Attack:</td><td class="fshGrey" id="GroupAttack"></td></tr><tr><td>Group Attack w/ buffs:</td><td id="GroupAttackBuffed"></td></tr><tr><td>Raw Group Defense:</td><td class="fshGrey" id="GroupDefense"></td></tr><tr><td>Group Defense w/ buffs:</td><td id="GroupDefenseBuffed"></td></tr><tr><td>Raw Group Armor:</td><td class="fshGrey" id="GroupArmor"></td></tr><tr><td>Group Armor w/ buffs:</td><td id="GroupArmorBuffed"></td></tr><tr><td>Raw Group Damage:</td><td class="fshGrey" id="GroupDamage"></td></tr><tr><td>Group Damage w/ buffs:</td><td id="GroupDamageBuffed"></td></tr><tr><td>Raw Group HP:</td><td class="fshGrey" id="GroupHP"></td></tr><tr><td>Group HP w/ buffs:</td><td id="GroupHPBuffed"></td></tr></tbody></table>'})
r(Ya,s),pn=a("DC225"),bn=a("DC175"),gn=a("GroupAttack"),vn=a("GroupAttackBuffed"),yn=a("GroupDefense"),kn=a("GroupDefenseBuffed"),wn=a("GroupArmor"),Cn=a("GroupArmorBuffed"),Ln=a("GroupDamage"),Dn=a("GroupDamageBuffed"),An=a("GroupHP"),Mn=a("GroupHPBuffed")}let En
function Pn(t){const e=I(t),a=R('#pCC img[src*="/relics/"]',e).length
var r
n(a,Za),En=1===(r=a)?1.5:kt(1-r/10,2),n(`${String(100*En)}%`,tn)}function jn(t,e){return t>10*e||t<e?t:10*e}const In=[["levelValue","level"],["attackValue","attack"],["attackBonus","bonus_attack"],["defenseValue","defense"],["defenseBonus","bonus_defense"],["armorValue","armor"],["armorBonus","bonus_armor"],["damageValue","damage"],["damageBonus","bonus_damage"],["hpValue","hp"],["hpBonus","bonus_hp"],["killStreakValue","killstreak"]]
function Rn(t,e,a){t[a[0]]=Number(e[a[1]])}const On=[["counterAttackLevel","Counter Attack"],["doublerLevel","Doubler"],["deathDealerLevel","Death Dealer"],["darkCurseLevel","Dark Curse"],["holyFlameLevel","Holy Flame"],["constitutionLevel","Constitution"],["sanctuaryLevel","Sanctuary"],["flinchLevel","Flinch"],["nightmareVisageLevel","Nightmare Visage"],["superEliteSlayerLevel","Super Elite Slayer"],["fortitudeLevel","Fortitude"],["chiStrikeLevel","Chi Strike"],["terrorizeLevel","Terrorize"],["barricadeLevel","Barricade"],["reignOfTerrorLevel","Reign Of Terror"],["anchoredLevel","Anchored"],["severeConditionLevel","Severe Condition"],["entrenchLevel","Entrench"],["cloakLevel","Cloak"]]
function Fn(t,e,a){t[a[0]]=e[a[1]]||0}function _n(t){const e=Yt(t._skills),a={}
return function(t,e){In.forEach(o(Rn,t,e))}(a,t),function(t,e){On.forEach(o(Fn,t,e))}(a,e),a.superEliteSlayerMultiplier=kt(.002*a.superEliteSlayerLevel,2),Kt(a.armorValue)&&function(t){t.attackValue=jn(t.attackBonus,t.levelValue),t.defenseValue=jn(t.defenseBonus,t.levelValue),t.armorValue=jn(t.armorBonus,t.levelValue),t.damageValue=jn(t.damageBonus,t.levelValue),t.hpValue=t.hpBonus}(a),a}let qn,Kn,Yn,zn,Un,Wn,Qn,Jn,Xn,Zn,tr,er,ar,nr
function rr(t){return Math.round(t*En)}function or(){De(qn,an),De(Yn,rn),De(zn,sn),De(Un,ln),De(Qn,fn),n(Jn,mn),Xn+=1,n(Xn,hn)}function ir(t){const e=function(t){return Math.ceil(tr.attack*(.0025*O(t["Nightmare Visage"],0)))}(t)
tr.attack-=e,function(){const t=Math.ceil(tr.attack*Zn.flinchLevel*.001)
De(tr.attack-t,vn)}()
const a=function(t){return Math.ceil(tr.defense*(1+.001*O(t.Constitution,0)))}(t)
De(a+e,kn),function(t){De(tr.armor+Math.floor(tr.armor*O(t.Sanctuary,0)*.001),Cn)}(t)
const n=function(t,e){return Math.ceil(e*O(t.Fortitude,0)*.001)}(t,a)
!function(t){De(tr.hp+t,Mn)}(n),function(t,e){const a=Math.ceil((tr.hp+e)*O(t["Chi Strike"],0)*.001),n=Math.ceil(tr.damage*Zn.terrorizeLevel*.001)
De(tr.damage+a-n,Dn)}(t,n)}function sr(){n("Processing attacking group stats ... ",Vn),er&&(tr.attack-=er.attack,tr.defense-=er.defense,tr.armor-=er.armor,tr.damage-=er.damage,tr.hp-=er.hp),De(tr.attack,gn),De(tr.defense,yn),De(tr.armor,wn),De(tr.damage,Ln),De(tr.hp,An)
const t=Yt(GameData.player().buffs)
ir(t),function(t){const e=Math.ceil(Kn*O(t.Flinch,0)*.001)
De(Kn-e,nn)}(t),function(t){const e=Math.ceil(Wn*O(t.Terrorize,0)*.001)
De(Wn-e,cn)}(t),n("Done.",Vn)}function ur(){n("Processing defending guild stats ... ",Vn),qn+=rr(Zn.attackValue),Yn+=rr(Zn.defenseValue),zn+=rr(Zn.armorValue),Un+=rr(Zn.damageValue),Qn+=rr(Zn.hpValue),or()
const t=Math.ceil(qn*(.0025*Zn.nightmareVisageLevel))
!function(t){Kn=qn-t,De(Kn,nn)}(t)
const e=Math.ceil(Yn*(1+.001*Zn.constitutionLevel))
!function(t,e){const a=e+t
De(a,on),De(Math.ceil(.55*a),pn),De(Math.ceil(.65*a),bn)}(t,e),De(zn+Math.floor(zn*Zn.sanctuaryLevel*.001),un)
const a=Qn+function(t){return Math.ceil(t*Zn.fortitudeLevel*.001)}(e)
De(a,dn),function(t){Wn=Un+Math.ceil(t*Zn.chiStrikeLevel*.001),De(Wn)}(a),0!==Zn.cloakLevel&&n("Yes",en),GameData.player().hasGroup&&tr?sr():n("Done.",Vn)}function lr(t){const e=_n(t)
qn+=Math.round(e.attackValue*F),Yn+=Math.round(e.defenseValue*F),zn+=Math.round(e.armorValue*F),Un+=Math.round(e.damageValue*F),Qn+=Math.round(e.hpValue*F),0!==e.cloakLevel&&(Jn+=1),or()}function cr(t){Zn=_n(t)}function fr(t){tr=t}function dr(t){er=t}function mr(t){n(t.message,Vn)}function hr(t){const e=I(t),a=g('#pCC a[href*="confirmDisband"]',e)
if(!a)return
const n=function(t){const e=t.previousElementSibling.href,a=[Rt(e).then(fr)]
return function(t){return-1!==t.parentNode.parentNode.previousElementSibling.previousElementSibling.innerHTML.indexOf('"#000099"')}(t)&&a.push(Ot().then(dr)),a}(a)
return Pt(n)}function pr(t,e){return 0===e?Ft(t).then(cr):Ft(t).then(lr).catch(mr)}function br(){let t=[K({cmd:"guild",subcmd:"view",guild_id:ar.controlled_by.guild_id}).then(Pn)]
return GameData.player().hasGroup&&t.push(K({cmd:"guild",subcmd:"groups"}).then(hr)),t=t.concat(Wa.map(pr)),t}function gr(){Tn(ar),qn=0,Yn=0,zn=0,Un=0,Qn=0,Jn=0,Xn=0
const t=br()
jt(t,ur)}function vr(t,e){Ka(e)||(ar=e.response.data,ar.defenders.length>0&&(Sn(ar),q(Ua,"click",gr)))}function yr(t){$("#statbar-gold").css("background-color",t)}function kr(){$("#HelperSendTotal").html(Ct(k("currentGoldSentTotal"))),Number(GameData.player().gold)>nr?yr("red"):yr("inherit")}function wr(){nr=k("goldAmount"),$("#statbar-gold-tooltip-general").append(`<dt class="stat-gold-sendTo">Send To:</dt><dd id="HelperSendTo">${k("goldRecipient")}</dd><dt class="stat-gold-sendAmt">Amount:</dt><dd id="HelperSendAmt">${Ct(nr)}</dd><dt class="stat-gold-sendTo">Send?</dt><dd><input id="HelperSendGold" value="Send!" class="custombutton" type="submit"><input type="hidden" id="xc" value=""</dd><dt class="stat-gold-sendTotal">Total Sent:</dt><dd id="HelperSendTotal">${Ct(k("currentGoldSentTotal"))}</dd>`),$("#HelperSendGold").on("click",U),kr(),$.subscribe(W,kr)}function Cr(t){return Q({cache:!1,url:"fetchdata.php",data:J(t,{fshrnd:zt()}),dataType:"json"})}const Lr=[]
function Dr(t){return Ka(t)||Lr.push(t),t}function Ar(t,e){return t===Number(e.response.data.id)}function Mr(t,e){t(e)}function Vr(t,e){const a=Lr.find(o(Ar,t))
return a?function(t){return new Promise((e=>{X(3,Mr,[e,t])}))}(a):Cr({a:1,id:t,passback:e}).then(Dr)}let $r,Sr,Hr,Nr,Br,Gr
function xr(t,e){return Wt(Z(e,t))}function Tr(){var t
$r=GameData.player().level,t=a("statbar-character-tooltip-stats"),Hr=xr(t,rt),Sr=xr(t,tt),Br=xr(t,et),Nr=xr(t,at),Gr=xr(t,nt)}function Er(t){return`<tr><td colspan="2">${t.name}:</td><td colspan="2">${t.value}</td></tr>`}function Pr(t,e,a){return function(t){return`<table><tr><td><img src="${y}creatures/${t.image_id}.png" height="200" width="200"></td><td rowspan="2"><table width="400"><tr><td class="header" colspan="4" class="fshCenter">Statistics</td></tr>`}(t)+function(t,e){return`<tr><td>Class:&nbsp;</td><td width="40%">${t.creature_class}</td><td>Level:&nbsp;</td><td width="40%">${t.level} (your level:<span class="${e}">${$r}</span>)</td></tr>`}(t,a)+function(t){return`<tr><td>Attack:&nbsp;</td><td width="40%">${t.attack} (your defense:<span class="fshYellow">${Sr}</span>)</td><td>Defense:&nbsp;</td><td width="40%">${t.defense} (your attack:<span class="fshYellow">${Hr}</span>)</td></tr>`}(t)+function(t){return`<tr><td>Armor:&nbsp;</td><td width="40%">${t.armor} (your damage:<span class="fshYellow">${Nr}</span>)</td><td>Damage:&nbsp;</td><td width="40%">${t.damage} (your armor:<span class="fshYellow">${Br}</span>)</td></tr>`}(t)+function(t,e){return`<tr><td>HP:&nbsp;</td><td width="40%">${t.hp} (your HP:<span class="fshYellow">${Gr}</span>)(1H: <span class="fshRed">${e}</span>)</td><td>Gold:&nbsp;</td><td width="40%">${t.gold}</td></tr>`}(t,e)+'<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Enhancements</td></tr>'+function(t){return 0===t.enhancements.length?'<tr><td colspan="4">[no enhancements]</td></tr>':t.enhancements.map(Er).join("")}(t)+function(t){return`<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Description</td></tr><tr><td colspan="4">${t.description}</td></tr><tr><td colspan="4" height="5"></td></tr></table></td></tr><tr><td class="fshCenter"><b>${t.name}</b></td></tr></table>`}(t)}function jr(e){if(!Ka(e))return function(e){const a=Math.ceil(e.hp*t.hpVariable+e.armor*t.generalVariable)
let n="fshYellow"
return Tr(),$r>e.level&&(n="fshRed"),Pr(e,a,n)}(e.response.data)}const Ir=["verb","view","tip-static"]
function Rr(t,e){const a=jr(e)
t.set("content.text",a)}function Or(t,e,a){return Vr(GameData.actions()[t].data.id,t).then(o(Rr,a)),"Loading..."}function Fr(t,e){v("NewMap","CreatureInfo")
const a=it((n=e).parentNode.children).indexOf(n)
var n,r,i
t.classList.add("fshTip"),r=t,i=o(Or,a),$(r).qtip({overwrite:!0,show:{event:"mouseover",ready:!0},style:{classes:"qtip-tipsy qtip-custom"},position:{my:"center right",at:"center left",effect:!1,viewport:$(window)},content:{text:i},hide:{effect:!1}})}function _r(e){if(!t.showCreatureInfo)return
const{target:a}=e,n=a.parentNode.parentNode.parentNode;(function(t,e){return Ut(Ir,t)&&!ot("fshTip",t)&&ot("creature",e)})(a,n)&&Fr(a,n)}function qr(){return Qt({subcmd:"scouttower"})}function Kr(t,e){const a=t.insertCell(-1)
return[a.colSpan]=e,e[2]&&(a.className="header"),r(a,e[1]),a}function Yr(t,e,a){const n=t.insertRow(-1)
return a&&(n.className="fshBlue"),function(t,e){e.forEach(o(Kr,t))}(n,e),n}function zr(t,e){Yr(t,e[0],e[1])}function Ur(t,e){e.forEach(o(zr,t))}let Wr,Qr,Jr,Xr,Zr,to,eo,ao,no,ro,oo,io,so,uo,lo,co,fo,mo,ho,po,bo,go,vo,yo,ko,wo,Co,Lo
function Do(){Qr=je("Current"),Jr=je("Kills"),Xr=je("Member"),Zr=je("% of Total"),to=je("Status"),eo=je("Titan HP"),ao=je("Total"),no=je("Your Guild")}function Ao(){for(;fo.rows.length>7;)fo.deleteRow(7)}function Mo(){const t=vt()
return r(t,ro),yt(t,"/"),r(t,oo),t}function Vo(t){const e=vt()
return r(e,t),yt(e,"%"),e}function $o(){ho=null,mo&&!ot("fshHide",mo)&&(gt(mo,!0),n("",ro),n("",oo),n("",io),n("",so),n("",uo),T("",lo),T("",co),Ao())}function So(t){return 0===t.type&&(ho=t.base_creature_id,!0)}function Ho(){if(mo)gt(mo,!1)
else{const t=a("actionContainer")
mo=e({className:"fshActionBox titanInfo"}),ro=vt(),oo=vt(),io=vt(),so=vt(),uo=vt(),lo=vt(),co=vt(),fo=te({className:"fshCenter"}),Do(),Ur(fo,[[[[2,eo,!0],[4,no,!0]]],[[[2,Mo()],[4,io]]],[[[2,Qr,!0],[4,Vo(so)]],!0],[[[2,ao,!0],[4,Vo(uo)]],!0],[[[2,to,!0],[4,lo]],!0],[[[6,co]]],[[[2,Xr,!0],[2,Jr,!0],[2,Zr,!0]]]]),r(mo,fo),r(t,mo)}}function No(t){return t<=0?'<span class="fshGreen cooldown">No active cooldown</span>':`<span class="fshMaroon cooldown">Cooldown until: ${function(t){const e=new Date(ut+1e3*t)
return`${Zt(e.getHours())}:${Zt(e.getMinutes())} ${Zt(e.getDate())}/${st[e.getMonth()]}/${e.getFullYear()}`}(t)}</span>`}function Bo(t){return wt(Jt(t.max_hp-t.current_hp,t.kills),2)}function Go(t){return wt(100*t.kills/t.max_hp,2)}function xo(t){[[t.current_hp,ro],[t.max_hp,oo],[t.kills,io],[Bo(t),so],[Go(t),uo]].forEach((([t,e])=>{n(t,e)})),T(function(t){return Xt(t.kills,t.max_hp,t.current_hp)}(t),lo),T(No(t.cooldown),co)}function To(t,e){return[[[2,je(e.player.name)],[2,je(e.kills.toString())],[2,je(`${wt(100*e.kills/t.kills,2)}%`)]]]}function Eo(t){return t.realm&&t.creature.base_id===ho&&t.realm===Wr}function Po(t){const e=t.find(Eo)
e&&(xo(e),function(t){if(Ao(),!t.contributors)return
const e=t.contributors.map(o(To,t))
Ur(fo,e)}(e))}function jo(e){return t.showTitanInfo&&l(e)&&e.some(So)}function Io(t,e){(function(t){return t.s&&l(t.r)})(e)&&(Po(e.r),jo(GameData.realm().dynamic)?po=window.setTimeout(t,3e4):$o())}function Ro(){qr().then(o(Io,Ro))}function Oo(t){po&&(window.clearTimeout(po),po=null),jo(t)?(Ho(),Ro()):$o()}function Fo(t){var e
t.dynamic&&(e=t.name,Wr=e,Oo(t.dynamic))}function _o(t,e){(function(t){return t.realm&&t.realm.name})(e)&&Fo(e.realm)}function qo(t){const e=t.response.response,a=t.response.msg
let n
if(0!==e){const t=a.indexOf("<")
n=-1!==t?a.substring(0,t):a}else n=`You purchased ${t.response.data.name} for ${Ct(t.response.data.cost)} gold.`
i(Co,`${n}<br>`)}function Ko(){GameData.doAction(14,3,{id:bo.id,item_id:bo.itemId},0),vo.close()}function Yo(){const t=ee(ko.value)
if(!t)return
const e=[]
for(let a=1;a<t;a+=1)e.push(Cr({a:14,d:0,id:bo.id,item_id:bo.itemId}).then(qo))
jt(e,Ko)}function zo(){yo?n("",Co):(yo=e({className:"fshClear",textContent:"Select how many to quick-buy:"}),ko=xt({id:"buyAmount",className:"fshNumberInput",min:1,max:99,value:1,type:"number"}),r(yo,ko),wo=Nt({textContent:"Quick-buy"}),s(wo,Yo),r(yo,wo),Co=e(),r(yo,Co),r(go,yo))}function Uo(t,e){bo=e,go=go||a("shopDialogConfirm"),go&&(vo=vo||$(go).data("hcsWorldDialogShopConfirm"),vo&&zo())}function Wo(t){Lo[t.name]?Lo[t.name].seen&&(Lo[t.name].seen+=1):(Lo[t.name]={seen:1},function(t,e){e.creature_class=t.creature_class,e.image_id=t.image_id,e.level=Number(t.level),e.type=t.type}(t,Lo[t.name]))}function Qo(t,e,a){return e?t(e,a):a}function Jo(t,e){const a=t||{}
return a.min=Qo(Math.min,a.min,e),a.max=Qo(Math.max,a.max,e),a}const Xo=["attack","armor","damage","defense","hp"]
function Zo(t,e,a){const n=Jo(e[a],Number(t[a]));(function(t,e){return!t||t.min!==e.min||t.max!==e.max})(e[a],n)&&(e[a]=n)}function ti(t,e){t[e.name]=Jo(t[e.name],Number(e.value))}function ei(t){Lo||(Lo={}),Wo(t),function(t,e){Xo.forEach(o(Zo,t,e))}(t,Lo[t.name]),function(t,e){(function(t){return t.enhancements&&t.enhancements.length>0})(t)&&(e.enhancements=e.enhancements||{},t.enhancements.forEach(o(ti,e.enhancements)))}(t,Lo[t.name]),Vt("fsh_monsterLog",Lo)}function ai(t){Lo=t||{}}const ni=[]
function ri(e){var a
Ka(e)||(v("NewMap","MonsterLog"),a=e.response.data,t.showMonsterLog&&ei(a))}function oi(t,e){return t.id===e.id}function ii(t,e){6!==t.type||function(t){if(ni.find(o(oi,t.data)))return!0
ni.push(t.data)}(t)||Vr(t.data.id,e).then(ri)}function si(){t.showMonsterLog&&GameData.actions().forEach(ii)}function ui(t){return Qt(J({subcmd:"groups"},t))}function li(t){return function(t){return ui({subcmd2:"viewstats",group_id:t})}(t)}function ci(){return ui({subcmd2:"view"})}function fi(t){return t.numberOfCreatureHitsTillDead-t.numberOfHitsRequired<=1?", dies on miss":", survives a miss"}const di=[[t=>"-"===t.playerHits&&"-"===t.creatureHits,()=>"Unresolved"],[t=>"-"===t.playerHits,()=>"Player dies"],[t=>1===t.playerHits,t=>`Player 1 hits${fi(t)}`],[t=>t.playerHits>1,t=>`Player > 1 hits${fi(t)}`]]
function mi(t,e){return e[0](t)}function hi(t){t.playerHits=function(t){return"-"===t.numberOfCreatureHitsTillDead?t.numberOfHitsRequired:function(t){return"-"===t.numberOfHitsRequired||t.numberOfHitsRequired>t.numberOfCreatureHitsTillDead}(t)?"-":t.numberOfHitsRequired}(t),t.creatureHits=function(t){return"-"===t.numberOfHitsRequired?t.numberOfCreatureHitsTillDead:function(t){return"-"===t.numberOfCreatureHitsTillDead||t.numberOfCreatureHitsTillDead>t.numberOfHitsRequired}(t)?"-":t.numberOfCreatureHitsTillDead}(t),t.fightStatus=function(t){const e=di.find(o(mi,t))
return e?e[1](t):"Unknown"}(t)}function pi(t){t.creatureHitByHowMuch>=0?function(t){const e=t.generalVariable*t.creature.damage
e<t.overallArmorValue?t.numberOfCreatureHitsTillDead=t.overallHPValue:t.numberOfCreatureHitsTillDead=Math.ceil(t.overallHPValue/(e-t.overallArmorValue))}(t):t.numberOfCreatureHitsTillDead="-"}function bi(t){!function(t){const e=function(t){return t.callback.groupExists?t.callback.groupArmorValue:t.player.armorValue}(t)
t.overallArmorValue=e+Math.floor(t.player.armorValue*t.player.sanctuaryLevel*.001)}(t),function(t){t.player.sanctuaryLevel>0&&(t.extraNotes+=`Sanc Bonus Armor = ${Math.floor(t.player.armorValue*t.player.sanctuaryLevel*.001)}<br>`)}(t),function(t){t.terrorizeEffect=Math.floor(t.creature.damage*t.player.terrorizeLevel*.001)}(t),function(t){t.player.terrorizeLevel>0&&(t.extraNotes+=`Terrorize Creature Damage Effect = ${-1*t.terrorizeEffect}<br>`)}(t),t.creature.damage-=t.terrorizeEffect,function(t){t.creatureDamageDone=Math.ceil(t.generalVariable*t.creature.damage-t.overallArmorValue+t.overallHPValue)}(t),pi(t)}function gi(t){const e=function(t){return t.callback.groupExists?t.callback.groupAttackValue:t.player.attackValue}(t)
t.player.darkCurseLevel>0&&(t.extraNotes+=`DC Bonus Attack = ${Math.floor(t.creature.defense*t.player.darkCurseLevel*.002)}<br>`),t.nightmareVisageAttackMovedToDefense=Math.floor((e+t.counterAttackBonusAttack)*t.player.nightmareVisageLevel*.0025),t.player.nightmareVisageLevel>0&&(t.extraNotes+=`NMV Attack moved to Defense = ${t.nightmareVisageAttackMovedToDefense}<br>`),t.overallAttackValue=e+t.counterAttackBonusAttack-t.nightmareVisageAttackMovedToDefense,t.hitByHowMuch=function(t){const e=t.creature.defense-t.creature.defense*t.player.darkCurseLevel*.002
return 3===t.combatEvaluatorBias?t.overallAttackValue-Math.ceil(e)-50:t.overallAttackValue-Math.ceil(t.attackVariable*e)}(t)}function vi(t){t.lowestCALevelToStillHit=Math.max(Math.ceil((t.counterAttackBonusAttack-t.hitByHowMuch+1)/t.player.attackValue/.0025),0),t.lowestCALevelToStillKill=Math.max(Math.ceil((t.counterAttackBonusDamage-t.damageDone+1)/t.player.damageValue/.0025),0)}function yi(t){vi(t),t.lowestFeasibleCALevel=Math.max(t.lowestCALevelToStillHit,t.lowestCALevelToStillKill),t.extraNotes+=`Lowest CA to still 1-hit this creature = ${t.lowestFeasibleCALevel}<br>`,0!==t.lowestFeasibleCALevel&&function(t){t.extraAttackAtLowestFeasibleCALevel=Math.floor(.0025*t.player.attackValue*t.lowestFeasibleCALevel),t.extraDamageAtLowestFeasibleCALevel=Math.floor(.0025*t.player.damageValue*t.lowestFeasibleCALevel),t.extraNotes+=`Extra CA Att/Dam at this lowered CA level = ${t.extraAttackAtLowestFeasibleCALevel} / ${t.extraDamageAtLowestFeasibleCALevel}<br>`}(t),t.extraStaminaPerHitAtLowestFeasibleCALevel=function(t){return t.player.counterAttackLevel>0?Math.ceil(.0025*(1+t.player.doublerLevel/50)*t.lowestFeasibleCALevel):0}(t),t.extraStaminaPerHitAtLowestFeasibleCALevel<t.extraStaminaPerHit?t.extraNotes+=`Extra Stam Used at this lowered CA level = ${t.extraStaminaPerHitAtLowestFeasibleCALevel}<br>`:t.extraNotes+="No reduction of stam used at the lower CA level<br>"}function ki(t){(function(t){return t.player.counterAttackLevel>0&&1===t.numberOfHitsRequired})(t)&&yi(t),function(t){return"-"===t.numberOfHitsRequired||1!==t.numberOfHitsRequired}(t)&&function(t){vi(t),function(t){t.lowestCALevelToStillHit>175?t.extraNotes+="Even with CA175 you cannot hit this creature<br>":0!==t.lowestCALevelToStillHit&&(t.extraNotes+=`You need a minimum of CA${t.lowestCALevelToStillHit} to hit this creature<br>`)}(t),function(t){t.lowestCALevelToStillKill>175?t.extraNotes+="Even with CA175 you cannot 1-hit kill this creature<br>":0!==t.lowestCALevelToStillKill&&(t.extraNotes+=`You need a minimum of CA${t.lowestCALevelToStillKill} to 1-hit kill this creature<br>`)}(t)}(t)}function wi(t){!function(t){const e=function(t){return t.callback.groupExists?t.callback.groupHPValue:t.player.hpValue}(t),{fortitudeLevel:a}=t.player
t.fortitudeExtraHPs=Math.floor(e*a*.001),a>0&&(t.extraNotes+=`Fortitude Bonus HP = ${t.fortitudeExtraHPs}<br>`),t.overallHPValue=e+t.fortitudeExtraHPs}(t),function(t){const{chiStrikeLevel:e}=t.player
t.chiStrikeExtraDamage=Math.floor(t.overallHPValue*e*.001),e>0&&(t.extraNotes+=`Chi Strike Bonus Damage = ${t.chiStrikeExtraDamage}<br>`)}(t)
const e=function(t){return t.callback.groupExists?t.callback.groupDamageValue:t.player.damageValue}(t)
if(t.overallDamageValue=e+t.deathDealerBonusDamage+t.counterAttackBonusDamage+t.holyFlameBonusDamage+t.chiStrikeExtraDamage,t.damageDone=Math.floor(t.overallDamageValue-(t.generalVariable*t.creature.armor+t.hpVariable*t.creature.hp)),t.hitByHowMuch>0){let e=1
t.overallDamageValue>=t.generalVariable*t.creature.armor&&(e=t.overallDamageValue-t.generalVariable*t.creature.armor),t.numberOfHitsRequired=Math.ceil(t.hpVariable*t.creature.hp/e)}else t.numberOfHitsRequired="-"}function Ci(t){return t.callback.groupExists?t.callback.groupDefenseValue:t.player.defenseValue}function Li(t){t.overallDefenseValue=Ci(t)+Math.floor(Ci(t)*t.player.constitutionLevel*.001)+t.nightmareVisageAttackMovedToDefense,function(t){t.player.constitutionLevel>0&&(t.extraNotes+=`Constitution Bonus Defense = ${Math.floor(Ci(t)*t.player.constitutionLevel*.001)}<br>`)}(t),function(t){t.player.flinchLevel>0&&(t.extraNotes+=`Flinch Bonus Attack Reduction = ${Math.floor(t.creature.attack*t.player.flinchLevel*.001)}<br>`)}(t),t.creatureHitByHowMuch=Math.floor(t.attackVariable*t.creature.attack-t.creature.attack*t.player.flinchLevel*.001-t.overallDefenseValue),3===t.combatEvaluatorBias&&(t.creatureHitByHowMuch=Math.floor(t.creature.attack-t.creature.attack*t.player.flinchLevel*.001-t.overallDefenseValue-50))}function Di(t){t.extraNotes="",function(t){t.player.superEliteSlayerLevel>0&&(t.extraNotes+=`SES Stat Reduction Multiplier = ${t.player.superEliteSlayerMultiplier}<br>`)}(t),function(t){t.holyFlameBonusDamage=0,"Undead"===t.creature.class&&(t.holyFlameBonusDamage=Math.max(Math.floor((t.player.damageValue-t.creature.armor)*t.player.holyFlameLevel*.002),0),t.player.holyFlameLevel>0&&(t.extraNotes+=`HF Bonus Damage = ${t.holyFlameBonusDamage}<br>`))}(t),function(t){t.deathDealerBonusDamage=Math.floor(t.player.damageValue*(Math.min(.01*Math.floor(t.player.killStreakValue/5)*t.player.deathDealerLevel,20)/100))}(t),function(t){t.counterAttackBonusAttack=Math.floor(.0025*t.player.attackValue*t.player.counterAttackLevel),t.counterAttackBonusDamage=Math.floor(.0025*t.player.damageValue*t.player.counterAttackLevel)}(t),function(t){t.extraStaminaPerHit=0,t.player.counterAttackLevel>0&&(t.extraStaminaPerHit=Math.ceil(.0025*(1+t.player.doublerLevel/50)*t.player.counterAttackLevel))}(t),function(t){t.player.deathDealerLevel>0&&(t.extraNotes+=`DD Bonus Damage = ${t.deathDealerBonusDamage}<br>`)}(t),function(t){t.player.counterAttackLevel>0&&(t.extraNotes+=`CA Bonus Attack/Damage = ${t.counterAttackBonusAttack} / ${t.counterAttackBonusDamage}<br>CA Extra Stam Used = ${t.extraStaminaPerHit}<br>`)}(t)}let Ai,Mi,Vi,$i,Si,Hi,Ni,Bi,Gi,xi
function Ti(){return ba(Mi)?"Remove from do not kill list":"Add to the do not kill list"}function Ei(){n(Ti(),Vi)}function Pi(){const e=t.doNotKillList.indexOf(Mi);-1===e?t.doNotKillList.push(Mi):t.doNotKillList.splice(e,1),Ei(),m("doNotKillList",t.doNotKillList.join()),va()}function ji(){Vi?Ei():function(){Vi=Nt({className:"fshBl",textContent:Ti(),type:"button"})
const t=e({className:"description",innerHTML:'<span class="ui-helper-hidden-accessible"><input type="text"></span>'})
r(t,Vi),r(Ai,t),s(Vi,Pi)}()}function Ii(t,e){!function(t){if(!Ai){const e=Z("body",t)
1===e.length&&([Ai]=e)}}(e),Ai&&(Mi=t.trim(),ji())}function Ri(){Hi||(Si||(Si=e(),r($i,Si),r($i,e({innerHTML:'<span class="fshFooter">*Does include CA, DD, HF, DC, Flinch, Super Elite Slayer, NMV, Sanctuary, Constitution, Fortitude, Chi Strike and Terrorize (if active) and allow for randomness (1.1053). Constitution, NMV, Fortitude and Chi Strike apply to group stats.</span>'}))),Hi=e(),r(Si,Hi))}function Oi(t){Ri(),T(t,Hi)}function Fi(t){Ni||(Ri(),Ni=e(),r(Si,Ni)),T(t,Ni)}function _i(t,e){const a={name:t.name,class:t.creature_class,attack:Number(t.attack),defense:Number(t.defense),armor:Number(t.armor),damage:Number(t.damage),hp:Number(t.hp)}
return function(t,e,a){3===a&&(e.attack-=Math.ceil(e.attack*t),e.defense-=Math.ceil(e.defense*t),e.armor-=Math.ceil(e.armor*t),e.damage-=Math.ceil(e.damage*t),e.hp-=Math.ceil(e.hp*t))}(e,a,t.type),a}function qi(e,a,n){const r={}
r.callback=n,r.player=_n(a),function(e){e.combatEvaluatorBias=t.combatEvaluatorBias,e.attackVariable=1.1053,e.generalVariable=t.generalVariable,e.hpVariable=t.hpVariable}(r),r.creature=_i(e.response.data,r.player.superEliteSlayerMultiplier),function(t){Di(t),gi(t),wi(t),Li(t),bi(t),hi(t),ki(t)}(r),r.evaluatorHTML=function(t){return`<table width="100%"><tbody>${function(t){return`<tr><td bgcolor="#CD9E4B" colspan="4" align="center">${function(t){return t.callback.groupExists?"Group ":""}(t)}Combat Evaluation</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333">Will I hit it? </td><td align="left">${function(t){return t.hitByHowMuch>0?"Yes":"No"}(t)}</td><td align="right"><span style="color:#333333">Extra Attack: </td><td align="left">( ${t.hitByHowMuch} )</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333"># Hits to kill it? </td><td align="left">${t.numberOfHitsRequired}</td><td align="right"><span style="color:#333333">Extra Damage: </td><td align="left">( ${t.damageDone} )</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333">Will I be hit? </td><td align="left">${function(t){return t.creatureHitByHowMuch>=0?"Yes":"No"}(t)}</td><td align="right"><span style="color:#333333">Extra Defense: </td><td align="left">( ${-1*t.creatureHitByHowMuch} )</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333"># Hits to kill me? </td><td align="left">${t.numberOfCreatureHitsTillDead}</td><td align="right"><span style="color:#333333">Extra Armor + HP: </td><td align="left">( ${-1*t.creatureDamageDone} )</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333"># Player Hits? </td><td align="left">${t.playerHits}</td><td align="right"><span style="color:#333333"># Creature Hits? </td><td align="left">${t.creatureHits}</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333">Fight Status: </span></td><td align="left" colspan="3"><span>${t.fightStatus}</span></td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333">Notes: </span></td><td align="left" colspan="3"><span style="font-size:x-small;">${t.extraNotes}</span></td></tr>`}(t)}</tbody></table>`}(r),n.groupExists?Fi(r.evaluatorHTML):Oi(r.evaluatorHTML)}function Ki(t){return t.members[0].name===At()}function Yi(t){if(l(t.r))return t.r.find(Ki).id}function zi(t,e,a){if(!a.r||!a.r.attributes)return
const n=a.r.attributes
qi(t,e,{groupExists:!0,groupAttackValue:n[0].value,groupDefenseValue:n[1].value,groupArmorValue:n[2].value,groupDamageValue:n[3].value,groupHPValue:n[4].value})}function Ui(t,e,a){a&&li(a).then(o(zi,t,e))}function Wi(t,e){t.player.hasGroup&&function(t,e){ci().then(Yi).then(o(Ui,t,e))}(t,e),qi(t,e,{groupExists:!1})}function Qi(t,e){$i||($i=a("dialog-viewcreature")),$i&&(Oi(""),Fi(""),function(t){return t.response&&t.response.data}(e)&&(Ii(e.response.data.name,$i),ae(!0).then(o(Wi,e))))}function Ji(){const e=[,[t.buffs,t.buffsName],[t.buffs2,t.buffs2Name],[t.buffs3,t.buffs3Name]][t.enabledHuntingMode]
l(e)&&([Bi,Gi]=e)}function Xi(e){"enabledHuntingMode"===e.target.name&&(t.enabledHuntingMode=e.target.value,m("enabledHuntingMode",t.enabledHuntingMode),Ji(),GameData.fetch(u))}function Zi(t){const e=Z("verbs",t)
1===e.length&&qt(e[0])}function ts(){if(!xi)return
const t=a("actionList")
St("player",t).forEach(Zi)}const es={hideSubLvlCreature:function(){t.hideSubLvlCreature=!t.hideSubLvlCreature,m("hideSubLvlCreature",t.hideSubLvlCreature),GameData.fetch(V)},hidePlayerActions:function(){xi=!xi,m("hidePlayerActions",xi),GameData.fetch(V)},showCreatureInfo:function(){t.showCreatureInfo=!t.showCreatureInfo,m("showCreatureInfo",t.showCreatureInfo)},showHuntingBuffs:function(){t.showBuffs=!t.showBuffs,m("showHuntingBuffs",t.showBuffs),GameData.fetch(u)},showMonsterLog:function(){t.showMonsterLog=!t.showMonsterLog,m("showMonsterLog",t.showMonsterLog)},showTitanInfo:function(){t.showTitanInfo=!t.showTitanInfo,m("showTitanInfo",t.showTitanInfo),Oo(GameData.realm().dynamic)},showBuffInfo:function(){t.showBuffInfo=!t.showBuffInfo,m("showBuffInfo",t.showBuffInfo),Ze()}}
function as(t){const e=es[t.target.name]
L(e)&&(t.target.blur(),e(t))}function ns(){const t=e({className:"fshCenter fshFten"}),n=e({id:"fshWorldPrefs",innerHTML:`${re("showCreatureInfo")}&nbsp;&nbsp;${re("showMonsterLog")}&nbsp;&nbsp;${re("showTitanInfo")}&nbsp;&nbsp;${re("showBuffInfo")}<br>${re("hideSubLvlCreature")}&nbsp;&nbsp;${re("hidePlayerActions")}&nbsp;&nbsp;${ne()}`})
s(n,as),p(n,"change",Xi),r(t,n)
const o=e()
r(t,o)
const i=a("worldContainerBelow").children[0]
return Gt(t,i),o}function rs(t,e){return t[e.name]=!0,t}function os(t,e,a){return t[a.trim()]||e.push(a),e}function is(t){T("",t)}function ss(t,e){const a=e.b.reduce(rs,{}),n=Bi.reduce(o(os,a),[])
n.length>0?function(t,e){T(`You are missing some ${Gi} hunting buffs<br>(${e.join(", ")})`,t)}(t,n):is(t)}function us(e,a,n){Bi&&function(e,a,n){t.showBuffs?ss(e,n):is(e)}(e,0,n)}const ls=[{generalVariable:1.1053,hpVariable:1.1},{generalVariable:1.1,hpVariable:1.053},{generalVariable:1.053,hpVariable:1},{generalVariable:1.1053,hpVariable:1}]
function cs(){var e
t.combatEvaluatorBias=k("combatEvaluatorBias"),t.generalVariable=(e=t.combatEvaluatorBias,ls[e]?ls[e].generalVariable:1.1053),t.hpVariable=function(t){return ls[t]?ls[t].hpVariable:1.1}(t.combatEvaluatorBias)}function fs(t,e){return 6!==e.type||(0!==e.data.creature_type||e.data.level>=t)}function ds(t){const e=mt(t)
return function(t){return!t||!t.actions||0===t.actions.length}(e)?t:(e.actions=e.actions.filter(o(fs,function(t){return t.realm&&t.realm.minlevel||GameData.realm().minlevel}(e))),JSON.stringify(e))}function ms(e,a){t.hideSubLvlCreature&&function(t){return t.data&&t.data.d&&oe(t.data.d,V)}(a)&&(e.dataFilter=ds)}function hs(e){t[e[0]]=ie(e[1])}function ps(e){t[e]=ie(e)}function bs(){[["buffs","huntingBuffs"],["buffs2","huntingBuffs2"],["buffs3","huntingBuffs3"]].forEach(hs),["doNotKillList"].forEach(ps)}function gs(e){t[e[0]]=k(e[1])}function vs(e){t[e]=k(e)}function ys(){[["buffsName","huntingBuffsName"],["buffs2Name","huntingBuffs2Name"],["buffs3Name","huntingBuffs3Name"],["showBuffs","showHuntingBuffs"]].forEach(gs),["enabledHuntingMode","hideSubLvlCreature","showTitanInfo","showBuffInfo","showMonsterLog","showCreatureInfo"].forEach(vs)}function ks(t){$(`#actionList li.creature-${t.toString()} a.create-group`).hide()}const ws=["hideChampionsGroup","hideElitesGroup","hideSEGroup","hideTitanGroup","hideLegendaryGroup"]
function Cs(t,e){var a
k(t)&&(a=e+1,$.subscribe(A,o(ks,a)),ks(e+1))}function Ls(t,e){"ACT_REPAIR"===e&&GameData.fetch(pt+u+M+V)}function Ds(t){N(t.target)}const As=[function(){cs(),bs(),ys()
const e=ns()
$.ajaxPrefilter("JSON",ms),t.hideSubLvlCreature&&GameData.fetch(V),function(e){Ji()
const a=o(us,e)
$.subscribe(c,a),t.showBuffs&&window.initialGameData&&a(null,{b:window.initialGameData.player.buffs})}(e),xi=k("hidePlayerActions"),$.subscribe(A,ts),ts()},function(){Y(),z&&wr()},function(){$.subscribe(dt,Qi)},function(){ws.forEach(Cs)},function(){k("enableCreatureColoring")&&r(document.body,$t("#actionList .creature-1 {color: green;}\n#actionList .creature-2 {color: yellow;}\n#actionList .creature-3 {color: red;}"))},function(){$.subscribe(A,va),va(),function(){const t=GameData.doAction
GameData.doAction=wa(t)}()},function(){Mt("fsh_monsterLog").then(ai),$.subscribe("-1-success.action-response 4-success.action-response 5-success.action-response 25-success.action-response",si),si()},function(){$.subscribe(ht,Ls)},function(){k("keepLogs")&&Mt("fsh_combatLog").then(pa)},function(){window.initialGameData&&_o(0,window.initialGameData),$.subscribe(`${lt} ${ct}`,_o)},function(){$.subscribe(ft,Uo)},function(){$.subscribe(_,vr)},function(){$("#messageCenter").worldMessageCenter({offset:"0 60"})},function(){N("#mapTooltip")},function(){Fa(),$.subscribe(S,_a),$.subscribe(H,qa)},function(){Ze(),$.subscribe(`${c} ${f}`,Ze),$.subscribe(d,ta)},function(){s(a("buffList"),Ds)},function(){p(a("actionList"),"mouseover",_r)},function(){const t=h("body")[0]
p(t,"keydown",ia),p(t,"keyup",sa)}]
function Ms(){Ht(As),$.subscribe(w,La)}export default Ms
//# sourceMappingURL=newMap-f8bc61d0.js.map
