import{c as e,m as t,z as a,A as n,h as r,t as o,i,o as s,aF as u,R as l,aG as c,aH as f,aI as d,a0 as m,b as h,f as p,E as b,D as g,X as v,an as y,I as k,aJ as w,C,aB as L,aK as D,aL as A,aM as M,aN as V,aO as S,aP as N,aQ as H,aR as B,at as G,aE as x,B as T,aS as E,a5 as j,V as P,v as I,ad as R,a6 as O,aT as F,aU as _,Q as q,u as K,aV as Y,aW as z,aX as U,aY as Q,aA as W,q as J,a as X,K as Z,aZ as ee,a_ as te,a$ as ae,b0 as ne,b1 as re,l as oe,N as ie,$ as se,ax as ue,a8 as le,b2 as ce,b3 as fe,b4 as de,b5 as me,b6 as he,b7 as pe,b8 as be}from"./calfSystem-eeb1d862.js"
import{i as ge}from"./insertElementAfter-4120bdd7.js"
import{t as ve}from"./toggleForce-a73479b0.js"
import{c as ye}from"./createSpan-c8cd4d0e.js"
import{i as ke}from"./insertTextBeforeEnd-1e1caba8.js"
import{a as we,r as Ce}from"./roundToString-a9a284a9.js"
import{a as Le}from"./addCommas-fc2f471e.js"
import{d as De,q as Ae}from"./quickbuffSuccess-efd28ee3.js"
import{p as Me}from"./playerName-018cf18c.js"
import{g as Ve,s as $e}from"./idb-874d144e.js"
import{c as Se}from"./createStyle-c3852d42.js"
import{g as Ne}from"./getArrayByClassName-23419047.js"
import{e as He}from"./executeAll-a7ad7ece.js"
import{c as Be}from"./createButton-033e413f.js"
import{e as Ge}from"./eventHandler5-2b58fcfe.js"
import{i as xe}from"./insertElementBefore-42a90ba9.js"
import{c as Te}from"./createInput-c963dc21.js"
import{c as Ee}from"./createLabel-7969394e.js"
import{o as je}from"./openQuickBuffByName-d4740e2d.js"
import{a as Pe}from"./all-778b38b7.js"
import{a as Ie}from"./allthen-a8900f54.js"
import{d as Re,g as Oe}from"./getGroupStats-394fe6da.js"
import{g as Fe}from"./getMercStats-03953551.js"
import{g as _e}from"./getProfile-52958e59.js"
import{g as qe}from"./getMembrList-8d90010d.js"
import{h as Ke}from"./hideElement-f0e898f0.js"
import{n as Ye}from"./numberIsNaN-891c59d9.js"
import{r as ze}from"./reduceBuffArray-3976c24a.js"
import{r as Ue}from"./rnd-ae0c3594.js"
import{h as Qe}from"./hasClasses-11851d22.js"
import{v as We}from"./valueText-7c11f0d0.js"
import{g as Je}from"./guild-9a62ed17.js"
import{g as Xe,a as Ze}from"./getTitanString-79514877.js"
import{p as et}from"./padZ-0374e903.js"
import{c as tt}from"./createTable-6575caa9.js"
import{t as at}from"./testQuant-6e089d1c.js"
import{g as nt}from"./groupViewStats-3169244c.js"
import{m as rt}from"./myStats-fb0c0c4d.js"
import{a as ot}from"./huntingBuffs-93584f34.js"
import{b as it}from"./simpleCheckbox-91ea73d5.js"
import{b as st}from"./bitwiseAnd-4098b974.js"
import{s as ut}from"./shouldBeArray-640ec982.js"
import"./getBuff-16237e80.js"
import"./buffObj-ae031e44.js"
import"./fshOpen-6a6a1b65.js"
import"./chunk-eaa75fd1.js"
import"./createLi-f6e99087.js"
import"./createUl-b4c1441e.js"
import"./cmdExport-7e823e95.js"
import"./indexAjaxJson-2deb257d.js"
import"./currentGuildId-5370ff7a.js"
import"./testRange-7cadf27e.js"
import"./intValue-ca51a3c0.js"
import"./isChecked-d75e63a5.js"
import"./isSelected-ec34c747.js"
import"./csvSplit-482f2ccd.js"
let lt,ct,ft,dt,mt,ht,pt,bt,gt
function vt(e){return e}function yt(n){if(function(t){return e.showBuffInfo&&t.some(vt)}(n))return function(){if(lt)ve(lt,!1)
else{lt=t({className:"fshActionBox",innerHTML:"<div></div><div></div><div></div><div></div><div></div><div></div>"})
const e=a("actionContainer")
ge(lt,e.children[2])}return lt}()
lt&&ve(lt,!0)}function kt(e,t){ct?ve(ct,!1):function(e){ct=e.children[3],ct.className="fshBlue",n("CA ",ct),ft=ye(),r(ct,ft),ke(ct," active")}(e),n(t.level,ft)}function wt(e,t){t?kt(e,t):ct&&ve(ct,!0)}function Ct(e,t){dt?ve(dt,!1):function(e){dt=e.children[4],dt.className="fshRed",n("Doubler ",dt),mt=ye(),r(dt,mt),ke(dt," active")}(e),n(t.level,mt)}function Lt(e,t){t?Ct(e,t):dt&&ve(dt,!0)}function Dt(e,t,a){ht?ve(ht,!1):function(e){ht=e.children[2],n("Damage bonus: ",ht),pt=ye(),r(ht,pt),ke(ht,"%")}(e),n(function(e,t){if(e){const a=Math.min(.01*Math.round(Math.floor(t/5)*Number(e.level)),20)
return we(a,2).toString()}return"0"}(t,Number(a)),pt)}function At(e,t,a){t?Dt(e,t,a):ht&&ve(ht,!0)}function Mt(e,t){n(Le(e),t)}function Vt(e,t){bt?ve(bt,!1):function(e){bt=e.children[1],n("Kill Streak: ",bt),gt=ye(),r(bt,gt)}(e),Mt(t,gt)}function $t(e,t,a,n){t||a?Vt(e,n):bt&&ve(bt,!0)}function St(e,t){return t.name===e}function Nt(e){const{buffs:t}=GameData.player()
if(t)return t.find(o(St,e))}const Ht=["red","orange","yellow"]
let Bt,Gt
function xt(e){Ae(e)&&GameData.fetch(u)}function Tt(){Nt("Summon Shield Imp")||De([Me()],[55]).then(xt)}const Et=["imp-0","imp-1","imp-1"]
function jt(e,t){Bt?ve(Bt,!1):function(e){Bt=e.children[0],n("Shield Imps Remaining: ",Bt),Gt=ye(),r(Bt,Gt),i(Bt,"&nbsp;")
const t=ye({className:"xSmallLink",textContent:"Recast"})
r(Bt,t),s(t,Tt)}(e)
const a=function(e){return e?Number(e.stack):0}(t)
Bt.className=function(e){return Et[e]||"fshGreen"}(a),n(a,Gt)}function Pt(e,t,a){t||a?jt(e,t):Bt&&ve(Bt,!0)}function It(e){return 0===e.type}function Rt(e){return ye({textContent:e})}let Ot,Ft,_t,qt,Kt,Yt,zt,Ut,Qt,Wt
function Jt(e,t){Ot?ve(Ot,!1):function(e,t){Ot=e.children[5],n("Teleport Cooldown: ",Ot),Ft=Rt(t.toString()),r(Ot,Ft)}(e,t)}function Xt(){const e=Math.max(Math.ceil((_t-Date.now())/1e3),0)
n(e,Ft),e>0&&setTimeout(Xt,500)}function Zt(e,t){t?Jt(e,t):Ot&&ve(Ot,!0)}function ea(){qt=Nt("Death Dealer"),Kt=Nt("Doubler"),Yt=Nt("Counter Attack"),zt=Nt("Summon Shield Imp"),Ut=function(){const e=GameData.player().teleportCooldown
return e>1&&e}(),Qt=function(){const{dynamic:e}=GameData.realm()
return l(e)&&e.some(It)}(),Wt=GameData.player().killStreak}function ta(){!function(){const e=$("#actionlist-shield-imp")
1===e.length&&e.css("background-color",Ht[e.text()]||"#ad8043")}(),ea()
const e=yt([qt,Kt,Yt,zt,Ut,Qt])
e&&(Pt(e,zt,qt),$t(e,qt,Qt,Wt),At(e,qt,Wt),wt(e,Yt),Lt(e,Kt),Zt(e,Ut))}function aa(e,t){var a
a=t.player.teleportCooldown,Ft&&(_t=Date.now()+1e3*a,Xt())}const na=["NORMAL","CHAMPION","ELITE","SUPER ELITE","TITAN","LEGENDARY"]
let ra=!1
function oa(e){return g(".verb.attack",e)}function ia(e){const t=na.indexOf(e.toUpperCase())
return b(`#actionList .actionListItem.creature.creature-${t}`)}function sa(e){const t=["LEGENDARY","NORMAL"].flatMap(ia),a=ia("CHAMPION"),[n,r]=e?[t,a]:[a,t],o=`url("${y}ui/world/icon_action_attack_`
n.map(oa).filter((e=>null!==e)).forEach((e=>{e.classList.remove("attack-1","attack-2","attack-3","attack-4","attack-5","attack-6","attack-7","attack-8"),e.style.backgroundImage=""})),r.slice(0,8).map(oa).forEach(((e,t)=>{null!==e&&(e.classList.add(`attack-${t+1}`),e.style.backgroundImage=`${o}${t+1}.png")`)}))}function ua(e){if(!e.ctrlKey||!e.shiftKey||"INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName)return
if(ra||sa(!0),ra=!0,!e.code.match(/(Digit|Numpad)[1-8]/))return
const t=ia("CHAMPION"),a=parseInt(e.code.slice(-1),10)-1
if(a<t.length){const e=oa(t[a])
null!==e&&(v("world","ChampionAttack"),e.click())}}function la(e){!ra||e.ctrlKey&&e.shiftKey||(ra=!1,sa(!1))}const ca=["Breaker","Protection","Master Thief","Protect Gold","Disarm","Duelist","Thievery","Master Blacksmith","Master Crafter","Fury Caster","Master Inventor","Sustain"]
let fa,da=[]
function ma(e){54!==e.id&&26!==e.id||(fa.player.buffs[e.id]=parseInt(e.level,10))}function ha(e){-1===ca.indexOf(e.name)&&(fa.player.enhancements[e.name]=e.value)}function pa(e,t){fa={},fa.combat=t.response.data,fa.combat.inventory_id&&(fa.combat.drop=fa.combat.item.id),fa.player={},fa.player.buffs={},fa.player.enhancements={},function(e){e.player.buffs&&e.player.buffs.forEach(ma)}(t),function(e){e.player.enhancements&&e.player.enhancements.forEach(ha)}(t),fa.time=t.time,da.push(fa),$e("fsh_combatLog",da)}function ba(e,t){0===t.response.response&&pa(0,t)}function ga(e){e&&(da=e),$.subscribe(w,ba)}function va(t){return e.doNotKillList.includes(t.trim())}function ya(e){e.classList.toggle("fshBlue",va(C(e)))}function ka(){const e=a("actionList")
Ne("creature",e).forEach(ya)}function wa(e){const t=GameData.actions()[e]
if(t)return function(e,t){if(va(e))return a("actionList").children[t].children[0].children[1].classList.remove("loading"),!0}(t.data.name,e)}const Ca={2:function(e){return function(t,a,n,r){wa(n.passback)||e(t,a,n,r)}}}
function La(e){return function(t,a,n,r){const o=Ca[t];(function(e){return e&&L(e)})(o)&&function(e){return D(e)||0===e}(r)?o(e)(t,a,n,r):e(t,a,n,r)}}function Da(e){e.remove()}function Aa(e,t){!function(e){(function(e){return e.response&&e.response.msg&&e.response.msg.startsWith("Creature did not exist at that location")})(e)&&GameData.fetch(M+V)}(t),b(".creature-4 > .quickCombat > .verbs").forEach(Da)}function Ma(){window.GameController&&GameController.Realm&&!GameController.Realm.footprintTileList&&(GameController.Realm.footprintTileList=[])}function Va(e,t,a){return Ee({className:`fshCurveEle fshCurveLbl fshPoint tip-static ${e}`,dataset:{tipped:t},htmlFor:a})}function $a(e){const a=t({className:"fshToggle"}),n=Te({checked:e.prefVal,id:e.checkId,type:"checkbox"})
r(a,n)
const o=Va(e.onClass,e.onTip,e.checkId)
r(a,o)
const i=Va(e.offClass,e.offTip,e.checkId)
return r(a,i),r(e.worldName,a),n}let Sa,Na,Ha,Ba,Ga,xa,Ta,Ea,ja
function Pa(e){return e?e.toString():"?"}function Ia(e){const a=t({className:"fshFsty"})
r(a,function(){const e=t({textContent:"Min Lvl: "})
return Na=Rt(Pa(GameData.realm().minlevel)),r(e,Na),e}()),r(a,function(){const e=t({textContent:"Your Lvl: "})
return Ha=Rt(Pa(GameData.player().level)),r(e,Ha),e}()),r(e,a)}function Ra(e,t,a){const n=Be({className:`fshCurveEle fshCurveBtn fshPoint tip-static ${e}`,dataset:{tipped:t}})
return r(a,n),n}function Oa(){var t
Ia(t=Sa),Ba=Ra("fshFormGroup","Quick Create Attack Group",t),Ga=Ra("fshQuickBuff","Open Quick Buff Popup",t),xa=Ra("fshRealmMap","Open Realm Map",t),Ta=Ra("fshTempleOne","Search map in Ultimate FSG",t),function(e){if(k("showSpeakerOnWorld")){const t=k("playNewMessageSound")
Ea=$a({prefVal:t,checkId:"fshSoundCheck",onClass:"soundOn",onTip:"Turn Off Sound when you have a new log message",offClass:"soundOff",offTip:"Turn On Sound when you have a new log message",worldName:e})}}(Sa),function(t){const a=e.huntingMode
ja=$a({prefVal:a,checkId:"fshHuntCheck",onClass:"huntOn",onTip:"Hunting mode is ON",offClass:"huntOff",offTip:"Hunting mode is OFF",worldName:t})}(Sa)}const Fa=[[e=>e===Ea,function(){m("playNewMessageSound",!k("playNewMessageSound"))}],[e=>e===ja,function(){e.huntingMode=!e.huntingMode,m("huntingMode",e.huntingMode)}]],_a=[[e=>e===Ba,function(e){H(e),GameData.doAction(12,401,{},0)}],[e=>e===Ga,function(){je(Me())}],[e=>e===xa,function(){window.open(`${B+G}map`,"fsMap")}],[e=>e===Ta,function(){const e=GameData.realm()
window.open(`${x}realms${G}view&realm_id=${e.id}`,"mapUfsg")}]]
function qa(){Sa||(Sa=t({className:"fshCurveContainer",id:"fshWorldButtonContainer"}),Oa(),s(Sa,Ge(_a)),p(Sa,"change",Ge(Fa)),xe(Sa,a("worldCoord")))}function Ka(e,t){Na&&t.b.minlevel&&(Ma(),n(t.b.minlevel,Na))}function Ya(e,t){Ha&&n(t.b,Ha)}function za(e){return!e||!e.response||!e.response.data}let Ua,Qa,Wa,Ja,Xa,Za,en,tn,an,nn,rn,on,sn,un,ln,cn,fn,dn,mn,hn,pn,bn,gn,vn,yn,kn,wn,Cn,Ln,Dn,An,Mn,Vn,$n,Sn
function Nn(e){return e.player_name}function Hn(e){!function(e){Ja=e.defenders.map(Nn)}(e),Ua?T("",Ua):Ua=t({className:"body"}),function(e){Qa=t({className:"fshFloatLeft fshRelicLeftDiv"}),r(Ua,Qa),e.is_owner&&r(Qa,Re(Ja)),Wa=Be({className:"custombutton",textContent:"Fetch Stats"}),r(Qa,Wa)}(e)
const n=a("dialog-relic")
r(n,Ua)}const Bn=[e=>"lastUpdate"!==e,e=>!Ja.includes(e),e=>Xa[e].last_login,e=>Number(Xa[e].last_login)<Za,e=>Number(Xa[e].last_login)>en,e=>Xa[e].level<400||Xa[e].level>421,e=>Xa[e].level<441||Xa[e].level>450]
function Gn(e,t){return t(e)}function xn(e){return Bn.every(o(Gn,e))}function Tn(e){return`<a href="${j}${Xa[e].id}">${e}</a>`}function En(e){Xa=e,Za=P-120,en=P-604800
const t=E(Xa).filter(xn).map(Tn)
i(Ua,`<div class="fshFloatLeft fshRelicLowDiv"><table class="relicT"><thead><tr><th>${t.length.toString()} Offline guild members not at relic:</th></tr></thead><tbody><tr><td>${t.join(" ")}</td></tr></tbody></table></div>`)}function jn(e){Ke(Wa)
const n=k("hideRelicOffline")
e.is_owner&&!n&&qe(!0).then(En),i(Qa,'<table class="relicT"><thead><tr><th colspan="2">Processing</th></tr></thead><tbody><tr><td class="fshGreen" colspan="2" id="ProcessingStatus">Parsing defending guild stats ...</td></tr></tbody><thead><tr><th colspan="2">Assumptions</th></tr></thead><tbody><tr><td colspan="2" class="fshGrey">Above calculations include Constitution, Fortitude, Nightmare Visage, Chi Strike, Sanctuary, Terrorize and Flinch bonus calculations (in that order) on both the defending group and attacking group.</td></tr></tbody></table>'),Sn=a("ProcessingStatus")
const o=t({className:"fshFloatLeft fshRelicMidDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Defending Guild Stats</th></tr></thead><tbody><tr><td>Relic Count:</td><td id="relicCount">0</td></tr><tr><td>Lead Defender Bonus:</td><td id="LDPercentage">0</td></tr><tr><td>Lead Defender Cloaked:</td><td id="LDCloaked">No</td></tr></tbody><thead><tr><th colspan="2">Other Defender Stats</th></tr></thead><tbody><tr><td>Raw Attack:</td><td class="fshGrey" id="attackValue">0</td></tr><tr><td>Attack w/ buffs:</td><td id="attackValueBuffed">0</td></tr><tr><td>Raw Defense:</td><td class="fshGrey" id="defenseValue">0</td></tr><tr><td>Defense w/buffs:</td><td id="defenseValueBuffed">0</td></tr><tr><td>Raw Armor:</td><td class="fshGrey" id="armorValue">0</td></tr><tr><td>Armor w/ buffs:</td><td id="armorValueBuffed">0</td></tr><tr><td>Raw Damage:</td><td class="fshGrey" id="damageValue">0</td></tr><tr><td>Damage w/ buffs:</td><td id="damageValueBuffed">0</td></tr><tr><td>Raw HP:</td><td class="fshGrey" id="hpValue">0</td></tr><tr><td>HP w/ buffs:</td><td id="hpValueBuffed">0</td></tr><tr><td>Cloaked:</td><td id="defendersCloaked">0</td></tr><tr><td>Processed:</td><td id="defendersProcessed">0</td></tr></tbody></table>'})
r(Ua,o),tn=a("relicCount"),an=a("LDPercentage"),nn=a("LDCloaked"),rn=a("attackValue"),on=a("attackValueBuffed"),sn=a("defenseValue"),un=a("defenseValueBuffed"),ln=a("armorValue"),cn=a("armorValueBuffed"),fn=a("damageValue"),dn=a("damageValueBuffed"),mn=a("hpValue"),hn=a("hpValueBuffed"),pn=a("defendersCloaked"),bn=a("defendersProcessed")
const s=t({className:"fshFloatLeft fshRelicRightDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Adjusted defense values</th></tr></thead><tbody><tr><td>DC225:</td><td id="DC225">0</td></tr><tr><td>DC175:</td><td id="DC175">0</td></tr><tr><td colspan="2">&nbsp;</td></tr></tbody><thead><tr><th colspan="2">Attacking Group Stats</th></tr></thead><tbody><tr><td>Raw Group Attack:</td><td class="fshGrey" id="GroupAttack"></td></tr><tr><td>Group Attack w/ buffs:</td><td id="GroupAttackBuffed"></td></tr><tr><td>Raw Group Defense:</td><td class="fshGrey" id="GroupDefense"></td></tr><tr><td>Group Defense w/ buffs:</td><td id="GroupDefenseBuffed"></td></tr><tr><td>Raw Group Armor:</td><td class="fshGrey" id="GroupArmor"></td></tr><tr><td>Group Armor w/ buffs:</td><td id="GroupArmorBuffed"></td></tr><tr><td>Raw Group Damage:</td><td class="fshGrey" id="GroupDamage"></td></tr><tr><td>Group Damage w/ buffs:</td><td id="GroupDamageBuffed"></td></tr><tr><td>Raw Group HP:</td><td class="fshGrey" id="GroupHP"></td></tr><tr><td>Group HP w/ buffs:</td><td id="GroupHPBuffed"></td></tr></tbody></table>'})
r(Ua,s),gn=a("DC225"),vn=a("DC175"),yn=a("GroupAttack"),kn=a("GroupAttackBuffed"),wn=a("GroupDefense"),Cn=a("GroupDefenseBuffed"),Ln=a("GroupArmor"),Dn=a("GroupArmorBuffed"),An=a("GroupDamage"),Mn=a("GroupDamageBuffed"),Vn=a("GroupHP"),$n=a("GroupHPBuffed")}let Pn
function In(e){const t=I(e),a=R('#pCC img[src*="/relics/"]',t).length
var r
n(a,tn),Pn=1===(r=a)?1.5:we(1-r/10,2),n(`${String(100*Pn)}%`,an)}function Rn(e,t){return e>10*t||e<t?e:10*t}const On=[["levelValue","level"],["attackValue","attack"],["attackBonus","bonus_attack"],["defenseValue","defense"],["defenseBonus","bonus_defense"],["armorValue","armor"],["armorBonus","bonus_armor"],["damageValue","damage"],["damageBonus","bonus_damage"],["hpValue","hp"],["hpBonus","bonus_hp"],["killStreakValue","killstreak"]]
function Fn(e,t,a){e[a[0]]=Number(t[a[1]])}const _n=[["counterAttackLevel","Counter Attack"],["doublerLevel","Doubler"],["deathDealerLevel","Death Dealer"],["darkCurseLevel","Dark Curse"],["holyFlameLevel","Holy Flame"],["constitutionLevel","Constitution"],["sanctuaryLevel","Sanctuary"],["flinchLevel","Flinch"],["nightmareVisageLevel","Nightmare Visage"],["superEliteSlayerLevel","Super Elite Slayer"],["fortitudeLevel","Fortitude"],["chiStrikeLevel","Chi Strike"],["terrorizeLevel","Terrorize"],["barricadeLevel","Barricade"],["reignOfTerrorLevel","Reign Of Terror"],["anchoredLevel","Anchored"],["severeConditionLevel","Severe Condition"],["entrenchLevel","Entrench"],["cloakLevel","Cloak"]]
function qn(e,t,a){e[a[0]]=t[a[1]]||0}function Kn(e){const t=ze(e._skills),a={}
return function(e,t){On.forEach(o(Fn,e,t))}(a,e),function(e,t){_n.forEach(o(qn,e,t))}(a,t),a.superEliteSlayerMultiplier=we(.002*a.superEliteSlayerLevel,2),Ye(a.armorValue)&&function(e){e.attackValue=Rn(e.attackBonus,e.levelValue),e.defenseValue=Rn(e.defenseBonus,e.levelValue),e.armorValue=Rn(e.armorBonus,e.levelValue),e.damageValue=Rn(e.damageBonus,e.levelValue),e.hpValue=e.hpBonus}(a),a}let Yn,zn,Un,Qn,Wn,Jn,Xn,Zn,er,tr,ar,nr,rr,or
function ir(e){return Math.round(e*Pn)}function sr(){Mt(Yn,rn),Mt(Un,sn),Mt(Qn,ln),Mt(Wn,fn),Mt(Xn,mn),n(Zn,pn),er+=1,n(er,bn)}function ur(e){const t=function(e){return Math.ceil(ar.attack*(.0025*O(e["Nightmare Visage"],0)))}(e)
ar.attack-=t,function(){const e=Math.ceil(ar.attack*tr.flinchLevel*.001)
Mt(ar.attack-e,kn)}()
const a=function(e){return Math.ceil(ar.defense*(1+.001*O(e.Constitution,0)))}(e)
Mt(a+t,Cn),function(e){Mt(ar.armor+Math.floor(ar.armor*O(e.Sanctuary,0)*.001),Dn)}(e)
const n=function(e,t){return Math.ceil(t*O(e.Fortitude,0)*.001)}(e,a)
!function(e){Mt(ar.hp+e,$n)}(n),function(e,t){const a=Math.ceil((ar.hp+t)*O(e["Chi Strike"],0)*.001),n=Math.ceil(ar.damage*tr.terrorizeLevel*.001)
Mt(ar.damage+a-n,Mn)}(e,n)}function lr(){n("Processing attacking group stats ... ",Sn),nr&&(ar.attack-=nr.attack,ar.defense-=nr.defense,ar.armor-=nr.armor,ar.damage-=nr.damage,ar.hp-=nr.hp),Mt(ar.attack,yn),Mt(ar.defense,wn),Mt(ar.armor,Ln),Mt(ar.damage,An),Mt(ar.hp,Vn)
const e=ze(GameData.player().buffs)
ur(e),function(e){const t=Math.ceil(zn*O(e.Flinch,0)*.001)
Mt(zn-t,on)}(e),function(e){const t=Math.ceil(Jn*O(e.Terrorize,0)*.001)
Mt(Jn-t,dn)}(e),n("Done.",Sn)}function cr(){n("Processing defending guild stats ... ",Sn),Yn+=ir(tr.attackValue),Un+=ir(tr.defenseValue),Qn+=ir(tr.armorValue),Wn+=ir(tr.damageValue),Xn+=ir(tr.hpValue),sr()
const e=Math.ceil(Yn*(.0025*tr.nightmareVisageLevel))
!function(e){zn=Yn-e,Mt(zn,on)}(e)
const t=Math.ceil(Un*(1+.001*tr.constitutionLevel))
!function(e,t){const a=t+e
Mt(a,un),Mt(Math.ceil(.55*a),gn),Mt(Math.ceil(.65*a),vn)}(e,t),Mt(Qn+Math.floor(Qn*tr.sanctuaryLevel*.001),cn)
const a=Xn+function(e){return Math.ceil(e*tr.fortitudeLevel*.001)}(t)
Mt(a,hn),function(e){Jn=Wn+Math.ceil(e*tr.chiStrikeLevel*.001),Mt(Jn)}(a),0!==tr.cloakLevel&&n("Yes",nn),GameData.player().hasGroup&&ar?lr():n("Done.",Sn)}function fr(e){const t=Kn(e)
Yn+=Math.round(t.attackValue*F),Un+=Math.round(t.defenseValue*F),Qn+=Math.round(t.armorValue*F),Wn+=Math.round(t.damageValue*F),Xn+=Math.round(t.hpValue*F),0!==t.cloakLevel&&(Zn+=1),sr()}function dr(e){tr=Kn(e)}function mr(e){ar=e}function hr(e){nr=e}function pr(e){n(e.message,Sn)}function br(e){const t=I(e),a=g('#pCC a[href*="confirmDisband"]',t)
if(!a)return
const n=function(e){const t=e.previousElementSibling.href,a=[Oe(t).then(mr)]
return function(e){return-1!==e.parentNode.parentNode.previousElementSibling.previousElementSibling.innerHTML.indexOf('"#000099"')}(e)&&a.push(Fe().then(hr)),a}(a)
return Pe(n)}function gr(e,t){return 0===t?_e(e).then(dr):_e(e).then(fr).catch(pr)}function vr(){let e=[K({cmd:"guild",subcmd:"view",guild_id:rr.controlled_by.guild_id}).then(In)]
return GameData.player().hasGroup&&e.push(K({cmd:"guild",subcmd:"groups"}).then(br)),e=e.concat(Ja.map(gr)),e}function yr(){jn(rr),Yn=0,Un=0,Qn=0,Wn=0,Xn=0,Zn=0,er=0
const e=vr()
Ie(e,cr)}function kr(e,t){za(t)||(rr=t.response.data,rr.defenders.length>0&&(Hn(rr),q(Wa,"click",yr)))}function wr(e){$("#statbar-gold").css("background-color",e)}function Cr(){$("#HelperSendTotal").html(Le(k("currentGoldSentTotal"))),Number(GameData.player().gold)>or?wr("red"):wr("inherit")}function Lr(){or=k("goldAmount"),$("#statbar-gold-tooltip-general").append(`<dt class="stat-gold-sendTo">Send To:</dt><dd id="HelperSendTo">${k("goldRecipient")}</dd><dt class="stat-gold-sendAmt">Amount:</dt><dd id="HelperSendAmt">${Le(or)}</dd><dt class="stat-gold-sendTo">Send?</dt><dd><input id="HelperSendGold" value="Send!" class="custombutton" type="submit"><input type="hidden" id="xc" value=""</dd><dt class="stat-gold-sendTotal">Total Sent:</dt><dd id="HelperSendTotal">${Le(k("currentGoldSentTotal"))}</dd>`),$("#HelperSendGold").on("click",U),Cr(),$.subscribe(Q,Cr)}function Dr(e){return W({cache:!1,url:"fetchdata.php",data:J(e,{fshrnd:Ue()}),dataType:"json"})}const Ar=[]
function Mr(e){return za(e)||Ar.push(e),e}function Vr(e,t){return e===Number(t.response.data.id)}function $r(e,t){e(t)}function Sr(e,t){const a=Ar.find(o(Vr,e))
return a?function(e){return new Promise((t=>{X(3,$r,[t,e])}))}(a):Dr({a:1,id:e,passback:t}).then(Mr)}let Nr,Hr,Br,Gr,xr,Tr
function Er(e,t){return We(Z(t,e))}function jr(){var e
Nr=GameData.player().level,e=a("statbar-character-tooltip-stats"),Br=Er(e,re),Hr=Er(e,ee),xr=Er(e,te),Gr=Er(e,ae),Tr=Er(e,ne)}function Pr(e){return`<tr><td colspan="2">${e.name}:</td><td colspan="2">${e.value}</td></tr>`}function Ir(e,t,a){return function(e){return`<table><tr><td><img src="${y}creatures/${e.image_id}.png" height="200" width="200"></td><td rowspan="2"><table width="400"><tr><td class="header" colspan="4" class="fshCenter">Statistics</td></tr>`}(e)+function(e,t){return`<tr><td>Class:&nbsp;</td><td width="40%">${e.creature_class}</td><td>Level:&nbsp;</td><td width="40%">${e.level} (your level:<span class="${t}">${Nr}</span>)</td></tr>`}(e,a)+function(e){return`<tr><td>Attack:&nbsp;</td><td width="40%">${e.attack} (your defense:<span class="fshYellow">${Hr}</span>)</td><td>Defense:&nbsp;</td><td width="40%">${e.defense} (your attack:<span class="fshYellow">${Br}</span>)</td></tr>`}(e)+function(e){return`<tr><td>Armor:&nbsp;</td><td width="40%">${e.armor} (your damage:<span class="fshYellow">${Gr}</span>)</td><td>Damage:&nbsp;</td><td width="40%">${e.damage} (your armor:<span class="fshYellow">${xr}</span>)</td></tr>`}(e)+function(e,t){return`<tr><td>HP:&nbsp;</td><td width="40%">${e.hp} (your HP:<span class="fshYellow">${Tr}</span>)(1H: <span class="fshRed">${t}</span>)</td><td>Gold:&nbsp;</td><td width="40%">${e.gold}</td></tr>`}(e,t)+'<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Enhancements</td></tr>'+function(e){return 0===e.enhancements.length?'<tr><td colspan="4">[no enhancements]</td></tr>':e.enhancements.map(Pr).join("")}(e)+function(e){return`<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Description</td></tr><tr><td colspan="4">${e.description}</td></tr><tr><td colspan="4" height="5"></td></tr></table></td></tr><tr><td class="fshCenter"><b>${e.name}</b></td></tr></table>`}(e)}function Rr(t){if(!za(t))return function(t){const a=Math.ceil(t.hp*e.hpVariable+t.armor*e.generalVariable)
let n="fshYellow"
return jr(),Nr>t.level&&(n="fshRed"),Ir(t,a,n)}(t.response.data)}const Or=["verb","view","tip-static"]
function Fr(e,t){const a=Rr(t)
e.set("content.text",a)}function _r(e,t,a){return Sr(GameData.actions()[e].data.id,e).then(o(Fr,a)),"Loading..."}function qr(e,t){v("NewMap","CreatureInfo")
const a=ie((n=t).parentNode.children).indexOf(n)
var n,r,i
e.classList.add("fshTip"),r=e,i=o(_r,a),$(r).qtip({overwrite:!0,show:{event:"mouseover",ready:!0},style:{classes:"qtip-tipsy qtip-custom"},position:{my:"center right",at:"center left",effect:!1,viewport:$(window)},content:{text:i},hide:{effect:!1}})}function Kr(t){if(!e.showCreatureInfo)return
const{target:a}=t,n=a.parentNode.parentNode.parentNode;(function(e,t){return Qe(Or,e)&&!oe("fshTip",e)&&oe("creature",t)})(a,n)&&qr(a,n)}function Yr(){return Je({subcmd:"scouttower"})}function zr(e,t){const a=e.insertCell(-1)
return[a.colSpan]=t,t[2]&&(a.className="header"),r(a,t[1]),a}function Ur(e,t,a){const n=e.insertRow(-1)
return a&&(n.className="fshBlue"),function(e,t){t.forEach(o(zr,e))}(n,t),n}function Qr(e,t){Ur(e,t[0],t[1])}function Wr(e,t){t.forEach(o(Qr,e))}let Jr,Xr,Zr,eo,to,ao,no,ro,oo,io,so,uo,lo,co,fo,mo,ho,po,bo,go,vo,yo,ko,wo,Co,Lo,Do,Ao
function Mo(){Xr=Rt("Current"),Zr=Rt("Kills"),eo=Rt("Member"),to=Rt("% of Total"),ao=Rt("Status"),no=Rt("Titan HP"),ro=Rt("Total"),oo=Rt("Your Guild")}function Vo(){for(;ho.rows.length>7;)ho.deleteRow(7)}function $o(){const e=ye()
return r(e,io),ke(e,"/"),r(e,so),e}function So(e){const t=ye()
return r(t,e),ke(t,"%"),t}function No(){bo=null,po&&!oe("fshHide",po)&&(ve(po,!0),n("",io),n("",so),n("",uo),n("",lo),n("",co),T("",fo),T("",mo),Vo())}function Ho(e){return 0===e.type&&(bo=e.base_creature_id,!0)}function Bo(){if(po)ve(po,!1)
else{const e=a("actionContainer")
po=t({className:"fshActionBox titanInfo"}),io=ye(),so=ye(),uo=ye(),lo=ye(),co=ye(),fo=ye(),mo=ye(),ho=tt({className:"fshCenter"}),Mo(),Wr(ho,[[[[2,no,!0],[4,oo,!0]]],[[[2,$o()],[4,uo]]],[[[2,Xr,!0],[4,So(lo)]],!0],[[[2,ro,!0],[4,So(co)]],!0],[[[2,ao,!0],[4,fo]],!0],[[[6,mo]]],[[[2,eo,!0],[2,Zr,!0],[2,to,!0]]]]),r(po,ho),r(e,po)}}function Go(e){return e<=0?'<span class="fshGreen cooldown">No active cooldown</span>':`<span class="fshMaroon cooldown">Cooldown until: ${function(e){const t=new Date(le+1e3*e)
return`${et(t.getHours())}:${et(t.getMinutes())} ${et(t.getDate())}/${ue[t.getMonth()]}/${t.getFullYear()}`}(e)}</span>`}function xo(e){return Ce(Xe(e.max_hp-e.current_hp,e.kills),2)}function To(e){return Ce(100*e.kills/e.max_hp,2)}function Eo(e){[[e.current_hp,io],[e.max_hp,so],[e.kills,uo],[xo(e),lo],[To(e),co]].forEach((([e,t])=>{n(e,t)})),T(function(e){return Ze(e.kills,e.max_hp,e.current_hp)}(e),fo),T(Go(e.cooldown),mo)}function jo(e,t){return[[[2,Rt(t.player.name)],[2,Rt(t.kills.toString())],[2,Rt(`${Ce(100*t.kills/e.kills,2)}%`)]]]}function Po(e){return e.realm&&e.creature.base_id===bo&&e.realm===Jr}function Io(e){const t=e.find(Po)
t&&(Eo(t),function(e){if(Vo(),!e.contributors)return
const t=e.contributors.map(o(jo,e))
Wr(ho,t)}(t))}function Ro(t){return e.showTitanInfo&&l(t)&&t.some(Ho)}function Oo(e,t){(function(e){return e.s&&l(e.r)})(t)&&(Io(t.r),Ro(GameData.realm().dynamic)?go=window.setTimeout(e,3e4):No())}function Fo(){se(Yr).then(o(Oo,Fo))}function _o(e){go&&(window.clearTimeout(go),go=null),Ro(e)?(Bo(),Fo()):No()}function qo(e){var t
e.dynamic&&(t=e.name,Jr=t,_o(e.dynamic))}function Ko(e,t){(function(e){return e.realm&&e.realm.name})(t)&&qo(t.realm)}function Yo(e){const t=e.response.response,a=e.response.msg
let n
if(0!==t){const e=a.indexOf("<")
n=-1!==e?a.substring(0,e):a}else n=`You purchased ${e.response.data.name} for ${Le(e.response.data.cost)} gold.`
i(Do,`${n}<br>`)}function zo(){GameData.doAction(14,3,{id:vo.id,item_id:vo.itemId},0),ko.close()}function Uo(){const e=at(Co.value)
if(!e)return
const t=[]
for(let a=1;a<e;a+=1)t.push(Dr({a:14,d:0,id:vo.id,item_id:vo.itemId}).then(Yo))
Ie(t,zo)}function Qo(){wo?n("",Do):(wo=t({className:"fshClear",textContent:"Select how many to quick-buy:"}),Co=Te({id:"buyAmount",className:"fshNumberInput",min:1,max:99,value:1,type:"number"}),r(wo,Co),Lo=Be({textContent:"Quick-buy"}),s(Lo,Uo),r(wo,Lo),Do=t(),r(wo,Do),r(yo,wo))}function Wo(e,t){vo=t,yo=yo||a("shopDialogConfirm"),yo&&(ko=ko||$(yo).data("hcsWorldDialogShopConfirm"),ko&&Qo())}function Jo(e){Ao[e.name]?Ao[e.name].seen&&(Ao[e.name].seen+=1):(Ao[e.name]={seen:1},function(e,t){t.creature_class=e.creature_class,t.image_id=e.image_id,t.level=Number(e.level),t.type=e.type}(e,Ao[e.name]))}function Xo(e,t,a){return t?e(t,a):a}function Zo(e,t){const a=e||{}
return a.min=Xo(Math.min,a.min,t),a.max=Xo(Math.max,a.max,t),a}const ei=["attack","armor","damage","defense","hp"]
function ti(e,t,a){const n=Zo(t[a],Number(e[a]));(function(e,t){return!e||e.min!==t.min||e.max!==t.max})(t[a],n)&&(t[a]=n)}function ai(e,t){e[t.name]=Zo(e[t.name],Number(t.value))}function ni(e){Ao||(Ao={}),Jo(e),function(e,t){ei.forEach(o(ti,e,t))}(e,Ao[e.name]),function(e,t){(function(e){return e.enhancements&&e.enhancements.length>0})(e)&&(t.enhancements=t.enhancements||{},e.enhancements.forEach(o(ai,t.enhancements)))}(e,Ao[e.name]),$e("fsh_monsterLog",Ao)}function ri(e){Ao=e||{}}const oi=[]
function ii(t){var a
za(t)||(v("NewMap","MonsterLog"),a=t.response.data,e.showMonsterLog&&ni(a))}function si(e,t){return e.id===t.id}function ui(e,t){6!==e.type||function(e){if(oi.find(o(si,e.data)))return!0
oi.push(e.data)}(e)||Sr(e.data.id,t).then(ii)}function li(){e.showMonsterLog&&GameData.actions().forEach(ui)}function ci(e){const t=I(e),a=nt(t)
return{r:{attributes:[{value:a.attack},{value:a.defense},{value:a.armor},{value:a.damage},{value:a.hp}]}}}function fi(e){return K({cmd:"guild",subcmd:"groups",subcmd2:"viewstats",group_id:e}).then(ci)}function di(e){return Je(J({subcmd:"groups"},e))}function mi(e){return di({subcmd2:"viewstats",group_id:e})}function hi(){return di({subcmd2:"view"})}function pi(e){return e.numberOfCreatureHitsTillDead-e.numberOfHitsRequired<=1?", dies on miss":", survives a miss"}const bi=[[e=>"-"===e.playerHits&&"-"===e.creatureHits,()=>"Unresolved"],[e=>"-"===e.playerHits,()=>"Player dies"],[e=>1===e.playerHits,e=>`Player 1 hits${pi(e)}`],[e=>e.playerHits>1,e=>`Player > 1 hits${pi(e)}`]]
function gi(e,t){return t[0](e)}function vi(e){e.playerHits=function(e){return"-"===e.numberOfCreatureHitsTillDead?e.numberOfHitsRequired:function(e){return"-"===e.numberOfHitsRequired||e.numberOfHitsRequired>e.numberOfCreatureHitsTillDead}(e)?"-":e.numberOfHitsRequired}(e),e.creatureHits=function(e){return"-"===e.numberOfHitsRequired?e.numberOfCreatureHitsTillDead:function(e){return"-"===e.numberOfCreatureHitsTillDead||e.numberOfCreatureHitsTillDead>e.numberOfHitsRequired}(e)?"-":e.numberOfCreatureHitsTillDead}(e),e.fightStatus=function(e){const t=bi.find(o(gi,e))
return t?t[1](e):"Unknown"}(e)}function yi(e){e.creatureHitByHowMuch>=0?function(e){const t=e.generalVariable*e.creature.damage
t<e.overallArmorValue?e.numberOfCreatureHitsTillDead=e.overallHPValue:e.numberOfCreatureHitsTillDead=Math.ceil(e.overallHPValue/(t-e.overallArmorValue))}(e):e.numberOfCreatureHitsTillDead="-"}function ki(e){!function(e){const t=function(e){return e.callback.groupExists?e.callback.groupArmorValue:e.player.armorValue}(e)
e.overallArmorValue=t+Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}(e),function(e){e.player.sanctuaryLevel>0&&(e.extraNotes+=`Sanc Bonus Armor = ${Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}<br>`)}(e),function(e){e.terrorizeEffect=Math.floor(e.creature.damage*e.player.terrorizeLevel*.001)}(e),function(e){e.player.terrorizeLevel>0&&(e.extraNotes+=`Terrorize Creature Damage Effect = ${-1*e.terrorizeEffect}<br>`)}(e),e.creature.damage-=e.terrorizeEffect,function(e){e.creatureDamageDone=Math.ceil(e.generalVariable*e.creature.damage-e.overallArmorValue+e.overallHPValue)}(e),yi(e)}function wi(e){const t=function(e){return e.callback.groupExists?e.callback.groupAttackValue:e.player.attackValue}(e)
e.player.darkCurseLevel>0&&(e.extraNotes+=`DC Bonus Attack = ${Math.floor(e.creature.defense*e.player.darkCurseLevel*.002)}<br>`),e.nightmareVisageAttackMovedToDefense=Math.floor((t+e.counterAttackBonusAttack)*e.player.nightmareVisageLevel*.0025),e.player.nightmareVisageLevel>0&&(e.extraNotes+=`NMV Attack moved to Defense = ${e.nightmareVisageAttackMovedToDefense}<br>`),e.overallAttackValue=t+e.counterAttackBonusAttack-e.nightmareVisageAttackMovedToDefense,e.hitByHowMuch=function(e){const t=e.creature.defense-e.creature.defense*e.player.darkCurseLevel*.002
return 3===e.combatEvaluatorBias?e.overallAttackValue-Math.ceil(t)-50:e.overallAttackValue-Math.ceil(e.attackVariable*t)}(e)}function Ci(e){e.lowestCALevelToStillHit=Math.max(Math.ceil((e.counterAttackBonusAttack-e.hitByHowMuch+1)/e.player.attackValue/.0025),0),e.lowestCALevelToStillKill=Math.max(Math.ceil((e.counterAttackBonusDamage-e.damageDone+1)/e.player.damageValue/.0025),0)}function Li(e){Ci(e),e.lowestFeasibleCALevel=Math.max(e.lowestCALevelToStillHit,e.lowestCALevelToStillKill),e.extraNotes+=`Lowest CA to still 1-hit this creature = ${e.lowestFeasibleCALevel}<br>`,0!==e.lowestFeasibleCALevel&&function(e){e.extraAttackAtLowestFeasibleCALevel=Math.floor(.0025*e.player.attackValue*e.lowestFeasibleCALevel),e.extraDamageAtLowestFeasibleCALevel=Math.floor(.0025*e.player.damageValue*e.lowestFeasibleCALevel),e.extraNotes+=`Extra CA Att/Dam at this lowered CA level = ${e.extraAttackAtLowestFeasibleCALevel} / ${e.extraDamageAtLowestFeasibleCALevel}<br>`}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel=function(e){return e.player.counterAttackLevel>0?Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.lowestFeasibleCALevel):0}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel<e.extraStaminaPerHit?e.extraNotes+=`Extra Stam Used at this lowered CA level = ${e.extraStaminaPerHitAtLowestFeasibleCALevel}<br>`:e.extraNotes+="No reduction of stam used at the lower CA level<br>"}function Di(e){(function(e){return e.player.counterAttackLevel>0&&1===e.numberOfHitsRequired})(e)&&Li(e),function(e){return"-"===e.numberOfHitsRequired||1!==e.numberOfHitsRequired}(e)&&function(e){Ci(e),function(e){e.lowestCALevelToStillHit>175?e.extraNotes+="Even with CA175 you cannot hit this creature<br>":0!==e.lowestCALevelToStillHit&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillHit} to hit this creature<br>`)}(e),function(e){e.lowestCALevelToStillKill>175?e.extraNotes+="Even with CA175 you cannot 1-hit kill this creature<br>":0!==e.lowestCALevelToStillKill&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillKill} to 1-hit kill this creature<br>`)}(e)}(e)}function Ai(e){!function(e){const t=function(e){return e.callback.groupExists?e.callback.groupHPValue:e.player.hpValue}(e),{fortitudeLevel:a}=e.player
e.fortitudeExtraHPs=Math.floor(t*a*.001),a>0&&(e.extraNotes+=`Fortitude Bonus HP = ${e.fortitudeExtraHPs}<br>`),e.overallHPValue=t+e.fortitudeExtraHPs}(e),function(e){const{chiStrikeLevel:t}=e.player
e.chiStrikeExtraDamage=Math.floor(e.overallHPValue*t*.001),t>0&&(e.extraNotes+=`Chi Strike Bonus Damage = ${e.chiStrikeExtraDamage}<br>`)}(e)
const t=function(e){return e.callback.groupExists?e.callback.groupDamageValue:e.player.damageValue}(e)
if(e.overallDamageValue=t+e.deathDealerBonusDamage+e.counterAttackBonusDamage+e.holyFlameBonusDamage+e.chiStrikeExtraDamage,e.damageDone=Math.floor(e.overallDamageValue-(e.generalVariable*e.creature.armor+e.hpVariable*e.creature.hp)),e.hitByHowMuch>0){let t=1
e.overallDamageValue>=e.generalVariable*e.creature.armor&&(t=e.overallDamageValue-e.generalVariable*e.creature.armor),e.numberOfHitsRequired=Math.ceil(e.hpVariable*e.creature.hp/t)}else e.numberOfHitsRequired="-"}function Mi(e){return e.callback.groupExists?e.callback.groupDefenseValue:e.player.defenseValue}function Vi(e){e.overallDefenseValue=Mi(e)+Math.floor(Mi(e)*e.player.constitutionLevel*.001)+e.nightmareVisageAttackMovedToDefense,function(e){e.player.constitutionLevel>0&&(e.extraNotes+=`Constitution Bonus Defense = ${Math.floor(Mi(e)*e.player.constitutionLevel*.001)}<br>`)}(e),function(e){e.player.flinchLevel>0&&(e.extraNotes+=`Flinch Bonus Attack Reduction = ${Math.floor(e.creature.attack*e.player.flinchLevel*.001)}<br>`)}(e),e.creatureHitByHowMuch=Math.floor(e.attackVariable*e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue),3===e.combatEvaluatorBias&&(e.creatureHitByHowMuch=Math.floor(e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue-50))}function $i(e){e.extraNotes="",function(e){e.player.superEliteSlayerLevel>0&&(e.extraNotes+=`SES Stat Reduction Multiplier = ${e.player.superEliteSlayerMultiplier}<br>`)}(e),function(e){e.holyFlameBonusDamage=0,"Undead"===e.creature.class&&(e.holyFlameBonusDamage=Math.max(Math.floor((e.player.damageValue-e.creature.armor)*e.player.holyFlameLevel*.002),0),e.player.holyFlameLevel>0&&(e.extraNotes+=`HF Bonus Damage = ${e.holyFlameBonusDamage}<br>`))}(e),function(e){e.deathDealerBonusDamage=Math.floor(e.player.damageValue*(Math.min(.01*Math.floor(e.player.killStreakValue/5)*e.player.deathDealerLevel,20)/100))}(e),function(e){e.counterAttackBonusAttack=Math.floor(.0025*e.player.attackValue*e.player.counterAttackLevel),e.counterAttackBonusDamage=Math.floor(.0025*e.player.damageValue*e.player.counterAttackLevel)}(e),function(e){e.extraStaminaPerHit=0,e.player.counterAttackLevel>0&&(e.extraStaminaPerHit=Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.player.counterAttackLevel))}(e),function(e){e.player.deathDealerLevel>0&&(e.extraNotes+=`DD Bonus Damage = ${e.deathDealerBonusDamage}<br>`)}(e),function(e){e.player.counterAttackLevel>0&&(e.extraNotes+=`CA Bonus Attack/Damage = ${e.counterAttackBonusAttack} / ${e.counterAttackBonusDamage}<br>CA Extra Stam Used = ${e.extraStaminaPerHit}<br>`)}(e)}let Si,Ni,Hi,Bi,Gi,xi,Ti,Ei,ji,Pi
function Ii(){return va(Ni)?"Remove from do not kill list":"Add to the do not kill list"}function Ri(){n(Ii(),Hi)}function Oi(){const t=e.doNotKillList.indexOf(Ni);-1===t?e.doNotKillList.push(Ni):e.doNotKillList.splice(t,1),Ri(),m("doNotKillList",e.doNotKillList.join()),ka()}function Fi(){Hi?Ri():function(){Hi=Be({className:"fshBl",textContent:Ii(),type:"button"})
const e=t({className:"description",innerHTML:'<span class="ui-helper-hidden-accessible"><input type="text"></span>'})
r(e,Hi),r(Si,e),s(Hi,Oi)}()}function _i(e,t){!function(e){if(!Si){const t=Z("body",e)
1===t.length&&([Si]=t)}}(t),Si&&(Ni=e.trim(),Fi())}function qi(){xi||(Gi||(Gi=t(),r(Bi,Gi),r(Bi,t({innerHTML:'<span class="fshFooter">*Does include CA, DD, HF, DC, Flinch, Super Elite Slayer, NMV, Sanctuary, Constitution, Fortitude, Chi Strike and Terrorize (if active) and allow for randomness (1.1053). Constitution, NMV, Fortitude and Chi Strike apply to group stats.</span>'}))),xi=t(),r(Gi,xi))}function Ki(e){qi(),T(e,xi)}function Yi(e){Ti||(qi(),Ti=t(),r(Gi,Ti)),T(e,Ti)}function zi(e,t){const a={name:e.name,class:e.creature_class,attack:Number(e.attack),defense:Number(e.defense),armor:Number(e.armor),damage:Number(e.damage),hp:Number(e.hp)}
return function(e,t,a){3===a&&(t.attack-=Math.ceil(t.attack*e),t.defense-=Math.ceil(t.defense*e),t.armor-=Math.ceil(t.armor*e),t.damage-=Math.ceil(t.damage*e),t.hp-=Math.ceil(t.hp*e))}(t,a,e.type),a}function Ui(t,a,n){const r={}
r.callback=n,r.player=Kn(a),function(t){t.combatEvaluatorBias=e.combatEvaluatorBias,t.attackVariable=1.1053,t.generalVariable=e.generalVariable,t.hpVariable=e.hpVariable}(r),r.creature=zi(t.response.data,r.player.superEliteSlayerMultiplier),function(e){$i(e),wi(e),Ai(e),Vi(e),ki(e),vi(e),Di(e)}(r),r.evaluatorHTML=function(e){return`<table width="100%"><tbody>${function(e){return`<tr><td bgcolor="#CD9E4B" colspan="4" align="center">${function(e){return e.callback.groupExists?"Group ":""}(e)}Combat Evaluation</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Will I hit it? </td><td align="left">${function(e){return e.hitByHowMuch>0?"Yes":"No"}(e)}</td><td align="right"><span style="color:#333333">Extra Attack: </td><td align="left">( ${e.hitByHowMuch} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333"># Hits to kill it? </td><td align="left">${e.numberOfHitsRequired}</td><td align="right"><span style="color:#333333">Extra Damage: </td><td align="left">( ${e.damageDone} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Will I be hit? </td><td align="left">${function(e){return e.creatureHitByHowMuch>=0?"Yes":"No"}(e)}</td><td align="right"><span style="color:#333333">Extra Defense: </td><td align="left">( ${-1*e.creatureHitByHowMuch} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333"># Hits to kill me? </td><td align="left">${e.numberOfCreatureHitsTillDead}</td><td align="right"><span style="color:#333333">Extra Armor + HP: </td><td align="left">( ${-1*e.creatureDamageDone} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333"># Player Hits? </td><td align="left">${e.playerHits}</td><td align="right"><span style="color:#333333"># Creature Hits? </td><td align="left">${e.creatureHits}</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Fight Status: </span></td><td align="left" colspan="3"><span>${e.fightStatus}</span></td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Notes: </span></td><td align="left" colspan="3"><span style="font-size:x-small;">${e.extraNotes}</span></td></tr>`}(e)}</tbody></table>`}(r),n.groupExists?Yi(r.evaluatorHTML):Ki(r.evaluatorHTML)}function Qi(e){return e.members[0].name===Me()}function Wi(e){if(l(e.r))return e.r.find(Qi).id}function Ji(e,t,a){if(!a.r||!a.r.attributes)return
const n=a.r.attributes
Ui(e,t,{groupExists:!0,groupAttackValue:n[0].value,groupDefenseValue:n[1].value,groupArmorValue:n[2].value,groupDamageValue:n[3].value,groupHPValue:n[4].value})}function Xi(e,t,a){a&&function(e){return se(mi,fi,e)}(a).then(o(Ji,e,t))}function Zi(e,t){se(hi).then(Wi).then(o(Xi,e,t))}function es(e,t){e.player.hasGroup&&Zi(e,t),Ui(e,t,{groupExists:!1})}function ts(e,t){Bi||(Bi=a("dialog-viewcreature")),Bi&&(Ki(""),Yi(""),function(e){return e.response&&e.response.data}(t)&&(_i(t.response.data.name,Bi),rt(!0).then(o(es,t))))}function as(){const t=[,[e.buffs,e.buffsName],[e.buffs2,e.buffs2Name],[e.buffs3,e.buffs3Name]][e.enabledHuntingMode]
l(t)&&([Ei,ji]=t)}function ns(t){"enabledHuntingMode"===t.target.name&&(e.enabledHuntingMode=t.target.value,m("enabledHuntingMode",e.enabledHuntingMode),as(),GameData.fetch(u))}function rs(e){const t=Z("verbs",e)
1===t.length&&Ke(t[0])}function os(){if(!Pi)return
const e=a("actionList")
Ne("player",e).forEach(rs)}const is={hideSubLvlCreature:function(){e.hideSubLvlCreature=!e.hideSubLvlCreature,m("hideSubLvlCreature",e.hideSubLvlCreature),GameData.fetch(V)},hidePlayerActions:function(){Pi=!Pi,m("hidePlayerActions",Pi),GameData.fetch(V)},showCreatureInfo:function(){e.showCreatureInfo=!e.showCreatureInfo,m("showCreatureInfo",e.showCreatureInfo)},showHuntingBuffs:function(){e.showBuffs=!e.showBuffs,m("showHuntingBuffs",e.showBuffs),GameData.fetch(u)},showMonsterLog:function(){e.showMonsterLog=!e.showMonsterLog,m("showMonsterLog",e.showMonsterLog)},showTitanInfo:function(){e.showTitanInfo=!e.showTitanInfo,m("showTitanInfo",e.showTitanInfo),_o(GameData.realm().dynamic)},showBuffInfo:function(){e.showBuffInfo=!e.showBuffInfo,m("showBuffInfo",e.showBuffInfo),ta()}}
function ss(e){const t=is[e.target.name]
L(t)&&(e.target.blur(),t(e))}function us(){const e=t({className:"fshCenter fshFten"}),n=t({id:"fshWorldPrefs",innerHTML:`${it("showCreatureInfo")}&nbsp;&nbsp;${it("showMonsterLog")}&nbsp;&nbsp;${it("showTitanInfo")}&nbsp;&nbsp;${it("showBuffInfo")}<br>${it("hideSubLvlCreature")}&nbsp;&nbsp;${it("hidePlayerActions")}&nbsp;&nbsp;${ot()}`})
s(n,ss),p(n,"change",ns),r(e,n)
const o=t()
r(e,o)
const i=a("worldContainerBelow").children[0]
return xe(e,i),o}function ls(e,t){return e[t.name]=!0,e}function cs(e,t,a){return e[a.trim()]||t.push(a),t}function fs(e){T("",e)}function ds(e,t){const a=t.b.reduce(ls,{}),n=Ei.reduce(o(cs,a),[])
n.length>0?function(e,t){T(`You are missing some ${ji} hunting buffs<br>(${t.join(", ")})`,e)}(e,n):fs(e)}function ms(t,a,n){Ei&&function(t,a,n){e.showBuffs?ds(t,n):fs(t)}(t,0,n)}const hs=[{generalVariable:1.1053,hpVariable:1.1},{generalVariable:1.1,hpVariable:1.053},{generalVariable:1.053,hpVariable:1},{generalVariable:1.1053,hpVariable:1}]
function ps(){var t
e.combatEvaluatorBias=k("combatEvaluatorBias"),e.generalVariable=(t=e.combatEvaluatorBias,hs[t]?hs[t].generalVariable:1.1053),e.hpVariable=function(e){return hs[e]?hs[e].hpVariable:1.1}(e.combatEvaluatorBias)}function bs(e,t){return 6!==t.type||(0!==t.data.creature_type||t.data.level>=e)}function gs(e){const t=he(e)
return function(e){return!e||!e.actions||0===e.actions.length}(t)?e:(t.actions=t.actions.filter(o(bs,function(e){return e.realm&&e.realm.minlevel||GameData.realm().minlevel}(t))),JSON.stringify(t))}function vs(t,a){e.hideSubLvlCreature&&function(e){return e.data&&e.data.d&&st(e.data.d,V)}(a)&&(t.dataFilter=gs)}function ys(t){e[t[0]]=ut(t[1])}function ks(t){e[t]=ut(t)}function ws(){[["buffs","huntingBuffs"],["buffs2","huntingBuffs2"],["buffs3","huntingBuffs3"]].forEach(ys),["doNotKillList"].forEach(ks)}function Cs(t){e[t[0]]=k(t[1])}function Ls(t){e[t]=k(t)}function Ds(){[["buffsName","huntingBuffsName"],["buffs2Name","huntingBuffs2Name"],["buffs3Name","huntingBuffs3Name"],["showBuffs","showHuntingBuffs"]].forEach(Cs),["enabledHuntingMode","hideSubLvlCreature","showTitanInfo","showBuffInfo","showMonsterLog","showCreatureInfo"].forEach(Ls)}function As(e){$(`#actionList li.creature-${e.toString()} a.create-group`).hide()}const Ms=["hideChampionsGroup","hideElitesGroup","hideSEGroup","hideTitanGroup","hideLegendaryGroup"]
function Vs(e,t){var a
k(e)&&(a=t+1,$.subscribe(A,o(As,a)),As(t+1))}function $s(e,t){"ACT_REPAIR"===t&&GameData.fetch(be+u+M+V)}function Ss(e){H(e.target)}const Ns=[function(){ps(),ws(),Ds()
const t=us()
$.ajaxPrefilter("JSON",vs),e.hideSubLvlCreature&&GameData.fetch(V),function(t){as()
const a=o(ms,t)
$.subscribe(c,a),e.showBuffs&&window.initialGameData&&a(null,{b:window.initialGameData.player.buffs})}(t),Pi=k("hidePlayerActions"),$.subscribe(A,os),os()},function(){Y(),z&&Lr()},function(){$.subscribe(me,ts)},function(){Ms.forEach(Vs)},function(){k("enableCreatureColoring")&&r(document.body,Se("#actionList .creature-1 {color: green;}\n#actionList .creature-2 {color: yellow;}\n#actionList .creature-3 {color: red;}"))},function(){$.subscribe(A,ka),ka(),function(){const e=GameData.doAction
GameData.doAction=La(e)}()},function(){Ve("fsh_monsterLog").then(ri),$.subscribe("-1-success.action-response 4-success.action-response 5-success.action-response 25-success.action-response",li),li()},function(){$.subscribe(pe,$s)},function(){k("keepLogs")&&Ve("fsh_combatLog").then(ga)},function(){window.initialGameData&&Ko(0,window.initialGameData),$.subscribe(`${ce} ${fe}`,Ko)},function(){$.subscribe(de,Wo)},function(){$.subscribe(_,kr)},function(){$("#messageCenter").worldMessageCenter({offset:"0 60"})},function(){H("#mapTooltip")},function(){qa(),$.subscribe(S,Ka),$.subscribe(N,Ya)},function(){ta(),$.subscribe(`${c} ${f}`,ta),$.subscribe(d,aa)},function(){s(a("buffList"),Ss)},function(){p(a("actionList"),"mouseover",Kr)},function(){const e=h("body")[0]
p(e,"keydown",ua),p(e,"keyup",la)}]
function Hs(){He(Ns),$.subscribe(w,Aa)}export default Hs
//# sourceMappingURL=newMap-3148c2a3.js.map
