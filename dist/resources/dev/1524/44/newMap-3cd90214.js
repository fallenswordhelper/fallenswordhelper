import{c as t,m as e,z as a,A as n,h as r,t as o,i,o as s,aO as u,Q as l,aP as c,aQ as f,aR as d,_ as m,b as h,f as p,E as b,D as g,T as v,ay as y,I as k,aS as w,C,aL as L,aT as D,aU as A,aV as M,aW as V,aX as S,aY as N,aZ as H,a_ as B,aE as G,aN as T,B as x,a$ as E,a4 as P,V as j,v as I,ac as O,a5 as R,b0 as F,b1 as _,P as q,u as K,b2 as Y,b3 as z,b4 as U,b5 as Q,aK as W,q as J,a as X,M as Z,b6 as tt,b7 as et,b8 as at,b9 as nt,ba as rt,l as ot,ap as it,$ as st,aq as ut,a7 as lt,bb as ct,bc as ft,bd as dt,be as mt,bf as ht,bg as pt,bh as bt}from"./calfSystem-f7cf24f6.js"
import{i as gt}from"./insertElementAfter-634bdf02.js"
import{t as vt}from"./toggleForce-46f497a3.js"
import{c as yt}from"./createSpan-0636b0fd.js"
import{i as kt}from"./insertTextBeforeEnd-60f92d3f.js"
import{a as wt,r as Ct}from"./roundToString-8b06d154.js"
import{a as Lt}from"./addCommas-aab57e5e.js"
import{d as Dt,q as At}from"./quickbuffSuccess-8554a4ca.js"
import{p as Mt}from"./playerName-c3c6c732.js"
import{g as Vt,s as $t}from"./idb-62b65e66.js"
import{c as St}from"./createStyle-8458ea8e.js"
import{g as Nt}from"./getArrayByClassName-f4491c81.js"
import{e as Ht}from"./executeAll-4e27c022.js"
import{c as Bt}from"./createButton-8f3d8326.js"
import{e as Gt}from"./eventHandler5-ef84bfc0.js"
import{i as Tt}from"./insertElementBefore-7c440c87.js"
import{c as xt}from"./createInput-8f2d1a63.js"
import{c as Et}from"./createLabel-bff122d0.js"
import{o as Pt}from"./openQuickBuffByName-85f930d9.js"
import{a as jt}from"./all-8d04560c.js"
import{a as It}from"./allthen-c5cfa8a4.js"
import{d as Ot,g as Rt}from"./getGroupStats-eaaded33.js"
import{g as Ft}from"./getMercStats-1a87cecb.js"
import{g as _t}from"./getProfile-9279556b.js"
import{g as qt}from"./getMembrList-5ed7c7b2.js"
import{h as Kt}from"./hideElement-3be61495.js"
import{n as Yt}from"./numberIsNaN-11f99b26.js"
import{r as zt}from"./reduceBuffArray-a59bb5c3.js"
import{r as Ut}from"./rnd-b5047085.js"
import{h as Qt}from"./hasClasses-27597364.js"
import{v as Wt}from"./valueText-ea28f9e0.js"
import{g as Jt}from"./guild-587e1e6d.js"
import{g as Xt,a as Zt}from"./getTitanString-e08d7584.js"
import{p as te}from"./padZ-634214b3.js"
import{c as ee}from"./createTable-fea82781.js"
import{t as ae}from"./testQuant-4528e278.js"
import{g as ne}from"./groupViewStats-8b0d987c.js"
import{m as re}from"./myStats-1bcedc5e.js"
import{a as oe}from"./huntingBuffs-facb1951.js"
import{b as ie}from"./simpleCheckbox-92565e2b.js"
import{b as se}from"./bitwiseAnd-9ac724a1.js"
import{s as ue}from"./shouldBeArray-df37b06b.js"
import"./getBuff-7b591316.js"
import"./buffObj-1b3bee9b.js"
import"./fshOpen-d480412d.js"
import"./chunk-d354fb99.js"
import"./createLi-c6c225cd.js"
import"./createUl-4041441e.js"
import"./cmdExport-a23d53af.js"
import"./indexAjaxJson-57024e17.js"
import"./currentGuildId-d5258e6c.js"
import"./testRange-2941bddb.js"
import"./intValue-66f66ba9.js"
import"./isChecked-5630e19a.js"
import"./isSelected-fb883928.js"
import"./csvSplit-d22d07ed.js"
let le,ce,fe,de,me,he,pe,be,ge
function ve(t){return t}function ye(n){if(function(e){return t.showBuffInfo&&e.some(ve)}(n))return function(){if(le)vt(le,!1)
else{le=e({className:"fshActionBox",innerHTML:"<div></div><div></div><div></div><div></div><div></div><div></div>"})
const t=a("actionContainer")
gt(le,t.children[2])}return le}()
le&&vt(le,!0)}function ke(t,e){ce?vt(ce,!1):function(t){ce=t.children[3],ce.className="fshBlue",n("CA ",ce),fe=yt(),r(ce,fe),kt(ce," active")}(t),n(e.level,fe)}function we(t,e){e?ke(t,e):ce&&vt(ce,!0)}function Ce(t,e){de?vt(de,!1):function(t){de=t.children[4],de.className="fshRed",n("Doubler ",de),me=yt(),r(de,me),kt(de," active")}(t),n(e.level,me)}function Le(t,e){e?Ce(t,e):de&&vt(de,!0)}function De(t,e,a){he?vt(he,!1):function(t){he=t.children[2],n("Damage bonus: ",he),pe=yt(),r(he,pe),kt(he,"%")}(t),n(function(t,e){if(t){const a=Math.min(.01*Math.round(Math.floor(e/5)*Number(t.level)),20)
return wt(a,2).toString()}return"0"}(e,Number(a)),pe)}function Ae(t,e,a){e?De(t,e,a):he&&vt(he,!0)}function Me(t,e){n(Lt(t),e)}function Ve(t,e){be?vt(be,!1):function(t){be=t.children[1],n("Kill Streak: ",be),ge=yt(),r(be,ge)}(t),Me(e,ge)}function $e(t,e,a,n){e||a?Ve(t,n):be&&vt(be,!0)}function Se(t,e){return e.name===t}function Ne(t){const{buffs:e}=GameData.player()
if(e)return e.find(o(Se,t))}const He=["red","orange","yellow"]
let Be,Ge
function Te(t){At(t)&&GameData.fetch(u)}function xe(){Ne("Summon Shield Imp")||Dt([Mt()],[55]).then(Te)}const Ee=["imp-0","imp-1","imp-1"]
function Pe(t,e){Be?vt(Be,!1):function(t){Be=t.children[0],n("Shield Imps Remaining: ",Be),Ge=yt(),r(Be,Ge),i(Be,"&nbsp;")
const e=yt({className:"xSmallLink",textContent:"Recast"})
r(Be,e),s(e,xe)}(t)
const a=function(t){return t?Number(t.stack):0}(e)
Be.className=function(t){return Ee[t]||"fshGreen"}(a),n(a,Ge)}function je(t,e,a){e||a?Pe(t,e):Be&&vt(Be,!0)}function Ie(t){return 0===t.type}function Oe(t){return yt({textContent:t})}let Re,Fe,_e,qe,Ke,Ye,ze,Ue,Qe,We
function Je(t,e){Re?vt(Re,!1):function(t,e){Re=t.children[5],n("Teleport Cooldown: ",Re),Fe=Oe(e.toString()),r(Re,Fe)}(t,e)}function Xe(){const t=Math.max(Math.ceil((_e-Date.now())/1e3),0)
n(t,Fe),t>0&&setTimeout(Xe,500)}function Ze(t,e){e?Je(t,e):Re&&vt(Re,!0)}function ta(){qe=Ne("Death Dealer"),Ke=Ne("Doubler"),Ye=Ne("Counter Attack"),ze=Ne("Summon Shield Imp"),Ue=function(){const t=GameData.player().teleportCooldown
return t>1&&t}(),Qe=function(){const{dynamic:t}=GameData.realm()
return l(t)&&t.some(Ie)}(),We=GameData.player().killStreak}function ea(){!function(){const t=$("#actionlist-shield-imp")
1===t.length&&t.css("background-color",He[t.text()]||"#ad8043")}(),ta()
const t=ye([qe,Ke,Ye,ze,Ue,Qe])
t&&(je(t,ze,qe),$e(t,qe,Qe,We),Ae(t,qe,We),we(t,Ye),Le(t,Ke),Ze(t,Ue))}function aa(t,e){var a
a=e.player.teleportCooldown,Fe&&(_e=Date.now()+1e3*a,Xe())}const na=["NORMAL","CHAMPION","ELITE","SUPER ELITE","TITAN","LEGENDARY"]
let ra=!1
function oa(t){return g(".verb.attack",t)}function ia(t){const e=na.indexOf(t.toUpperCase())
return b(`#actionList .actionListItem.creature.creature-${e}`)}function sa(t){const e=["LEGENDARY","NORMAL"].flatMap(ia),a=ia("CHAMPION"),[n,r]=t?[e,a]:[a,e],o=`url("${y}ui/world/icon_action_attack_`
n.map(oa).filter((t=>null!==t)).forEach((t=>{t.classList.remove("attack-1","attack-2","attack-3","attack-4","attack-5","attack-6","attack-7","attack-8"),t.style.backgroundImage=""})),r.slice(0,8).map(oa).forEach(((t,e)=>{null!==t&&(t.classList.add(`attack-${e+1}`),t.style.backgroundImage=`${o}${e+1}.png")`)}))}function ua(t){if(!t.ctrlKey||!t.shiftKey||"INPUT"===t.target.tagName||"TEXTAREA"===t.target.tagName)return
if(ra||sa(!0),ra=!0,!t.code.match(/(Digit|Numpad)[1-8]/))return
const e=ia("CHAMPION"),a=parseInt(t.code.slice(-1),10)-1
if(a<e.length){const t=oa(e[a])
null!==t&&(v("world","ChampionAttack"),t.click())}}function la(t){!ra||t.ctrlKey&&t.shiftKey||(ra=!1,sa(!1))}const ca=["Breaker","Protection","Master Thief","Protect Gold","Disarm","Duelist","Thievery","Master Blacksmith","Master Crafter","Fury Caster","Master Inventor","Sustain"]
let fa,da=[]
function ma(t){54!==t.id&&26!==t.id||(fa.player.buffs[t.id]=parseInt(t.level,10))}function ha(t){-1===ca.indexOf(t.name)&&(fa.player.enhancements[t.name]=t.value)}function pa(t,e){fa={},fa.combat=e.response.data,fa.combat.inventory_id&&(fa.combat.drop=fa.combat.item.id),fa.player={},fa.player.buffs={},fa.player.enhancements={},function(t){t.player.buffs&&t.player.buffs.forEach(ma)}(e),function(t){t.player.enhancements&&t.player.enhancements.forEach(ha)}(e),fa.time=e.time,da.push(fa),$t("fsh_combatLog",da)}function ba(t,e){0===e.response.response&&pa(0,e)}function ga(t){t&&(da=t),$.subscribe(w,ba)}function va(e){return t.doNotKillList.includes(e.trim())}function ya(t){t.classList.toggle("fshBlue",va(C(t)))}function ka(){const t=a("actionList")
Nt("creature",t).forEach(ya)}function wa(t){const e=GameData.actions()[t]
if(e)return function(t,e){if(va(t))return a("actionList").children[e].children[0].children[1].classList.remove("loading"),!0}(e.data.name,t)}const Ca={2:function(t){return function(e,a,n,r){wa(n.passback)||t(e,a,n,r)}}}
function La(t){return function(e,a,n,r){const o=Ca[e];(function(t){return t&&L(t)})(o)&&function(t){return D(t)||0===t}(r)?o(t)(e,a,n,r):t(e,a,n,r)}}function Da(t){t.remove()}function Aa(t,e){!function(t){(function(t){return t.response&&t.response.msg&&t.response.msg.startsWith("Creature did not exist at that location")})(t)&&GameData.fetch(M+V)}(e),b(".creature-4 > .quickCombat > .verbs").forEach(Da)}function Ma(){window.GameController&&GameController.Realm&&!GameController.Realm.footprintTileList&&(GameController.Realm.footprintTileList=[])}function Va(t,e,a){return Et({className:`fshCurveEle fshCurveLbl fshPoint tip-static ${t}`,dataset:{tipped:e},htmlFor:a})}function $a(t){const a=e({className:"fshToggle"}),n=xt({checked:t.prefVal,id:t.checkId,type:"checkbox"})
r(a,n)
const o=Va(t.onClass,t.onTip,t.checkId)
r(a,o)
const i=Va(t.offClass,t.offTip,t.checkId)
return r(a,i),r(t.worldName,a),n}let Sa,Na,Ha,Ba,Ga,Ta,xa,Ea,Pa
function ja(t){return t?t.toString():"?"}function Ia(t){const a=e({className:"fshFsty"})
r(a,function(){const t=e({textContent:"Min Lvl: "})
return Na=Oe(ja(GameData.realm().minlevel)),r(t,Na),t}()),r(a,function(){const t=e({textContent:"Your Lvl: "})
return Ha=Oe(ja(GameData.player().level)),r(t,Ha),t}()),r(t,a)}function Oa(t,e,a){const n=Bt({className:`fshCurveEle fshCurveBtn fshPoint tip-static ${t}`,dataset:{tipped:e}})
return r(a,n),n}function Ra(){var e
Ia(e=Sa),Ba=Oa("fshFormGroup","Quick Create Attack Group",e),Ga=Oa("fshQuickBuff","Open Quick Buff Popup",e),Ta=Oa("fshRealmMap","Open Realm Map",e),xa=Oa("fshTempleOne","Search map in Ultimate FSG",e),function(t){if(k("showSpeakerOnWorld")){const e=k("playNewMessageSound")
Ea=$a({prefVal:e,checkId:"fshSoundCheck",onClass:"soundOn",onTip:"Turn Off Sound when you have a new log message",offClass:"soundOff",offTip:"Turn On Sound when you have a new log message",worldName:t})}}(Sa),function(e){const a=t.huntingMode
Pa=$a({prefVal:a,checkId:"fshHuntCheck",onClass:"huntOn",onTip:"Hunting mode is ON",offClass:"huntOff",offTip:"Hunting mode is OFF",worldName:e})}(Sa)}const Fa=[[t=>t===Ea,function(){m("playNewMessageSound",!k("playNewMessageSound"))}],[t=>t===Pa,function(){t.huntingMode=!t.huntingMode,m("huntingMode",t.huntingMode)}]],_a=[[t=>t===Ba,function(t){H(t),GameData.doAction(12,401,{},0)}],[t=>t===Ga,function(){Pt(Mt())}],[t=>t===Ta,function(){window.open(`${B+G}map`,"fsMap")}],[t=>t===xa,function(){const t=GameData.realm()
window.open(`${T}realms${G}view&realm_id=${t.id}`,"mapUfsg")}]]
function qa(){Sa||(Sa=e({className:"fshCurveContainer",id:"fshWorldButtonContainer"}),Ra(),s(Sa,Gt(_a)),p(Sa,"change",Gt(Fa)),Tt(Sa,a("worldCoord")))}function Ka(t,e){Na&&e.b.minlevel&&(Ma(),n(e.b.minlevel,Na))}function Ya(t,e){Ha&&n(e.b,Ha)}function za(t){return!t||!t.response||!t.response.data}let Ua,Qa,Wa,Ja,Xa,Za,tn,en,an,nn,rn,on,sn,un,ln,cn,fn,dn,mn,hn,pn,bn,gn,vn,yn,kn,wn,Cn,Ln,Dn,An,Mn,Vn,$n,Sn
function Nn(t){return t.player_name}function Hn(t){!function(t){Ja=t.defenders.map(Nn)}(t),Ua?x("",Ua):Ua=e({className:"body"}),function(t){Qa=e({className:"fshFloatLeft fshRelicLeftDiv"}),r(Ua,Qa),t.is_owner&&r(Qa,Ot(Ja)),Wa=Bt({className:"custombutton",textContent:"Fetch Stats"}),r(Qa,Wa)}(t)
const n=a("dialog-relic")
r(n,Ua)}const Bn=[t=>"lastUpdate"!==t,t=>!Ja.includes(t),t=>Xa[t].last_login,t=>Number(Xa[t].last_login)<Za,t=>Number(Xa[t].last_login)>tn,t=>Xa[t].level<400||Xa[t].level>421,t=>Xa[t].level<441||Xa[t].level>450]
function Gn(t,e){return e(t)}function Tn(t){return Bn.every(o(Gn,t))}function xn(t){return`<a href="${P}${Xa[t].id}">${t}</a>`}function En(t){Xa=t,Za=j-120,tn=j-604800
const e=E(Xa).filter(Tn).map(xn)
i(Ua,`<div class="fshFloatLeft fshRelicLowDiv"><table class="relicT"><thead><tr><th>${e.length.toString()} Offline guild members not at relic:</th></tr></thead><tbody><tr><td>${e.join(" ")}</td></tr></tbody></table></div>`)}function Pn(t){Kt(Wa)
const n=k("hideRelicOffline")
t.is_owner&&!n&&qt(!0).then(En),i(Qa,'<table class="relicT"><thead><tr><th colspan="2">Processing</th></tr></thead><tbody><tr><td class="fshGreen" colspan="2" id="ProcessingStatus">Parsing defending guild stats ...</td></tr></tbody><thead><tr><th colspan="2">Assumptions</th></tr></thead><tbody><tr><td colspan="2" class="fshGrey">Above calculations include Constitution, Fortitude, Nightmare Visage, Chi Strike, Sanctuary, Terrorize and Flinch bonus calculations (in that order) on both the defending group and attacking group.</td></tr></tbody></table>'),Sn=a("ProcessingStatus")
const o=e({className:"fshFloatLeft fshRelicMidDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Defending Guild Stats</th></tr></thead><tbody><tr><td>Relic Count:</td><td id="relicCount">0</td></tr><tr><td>Lead Defender Bonus:</td><td id="LDPercentage">0</td></tr><tr><td>Lead Defender Cloaked:</td><td id="LDCloaked">No</td></tr></tbody><thead><tr><th colspan="2">Other Defender Stats</th></tr></thead><tbody><tr><td>Raw Attack:</td><td class="fshGrey" id="attackValue">0</td></tr><tr><td>Attack w/ buffs:</td><td id="attackValueBuffed">0</td></tr><tr><td>Raw Defense:</td><td class="fshGrey" id="defenseValue">0</td></tr><tr><td>Defense w/buffs:</td><td id="defenseValueBuffed">0</td></tr><tr><td>Raw Armor:</td><td class="fshGrey" id="armorValue">0</td></tr><tr><td>Armor w/ buffs:</td><td id="armorValueBuffed">0</td></tr><tr><td>Raw Damage:</td><td class="fshGrey" id="damageValue">0</td></tr><tr><td>Damage w/ buffs:</td><td id="damageValueBuffed">0</td></tr><tr><td>Raw HP:</td><td class="fshGrey" id="hpValue">0</td></tr><tr><td>HP w/ buffs:</td><td id="hpValueBuffed">0</td></tr><tr><td>Cloaked:</td><td id="defendersCloaked">0</td></tr><tr><td>Processed:</td><td id="defendersProcessed">0</td></tr></tbody></table>'})
r(Ua,o),en=a("relicCount"),an=a("LDPercentage"),nn=a("LDCloaked"),rn=a("attackValue"),on=a("attackValueBuffed"),sn=a("defenseValue"),un=a("defenseValueBuffed"),ln=a("armorValue"),cn=a("armorValueBuffed"),fn=a("damageValue"),dn=a("damageValueBuffed"),mn=a("hpValue"),hn=a("hpValueBuffed"),pn=a("defendersCloaked"),bn=a("defendersProcessed")
const s=e({className:"fshFloatLeft fshRelicRightDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Adjusted defense values</th></tr></thead><tbody><tr><td>DC225:</td><td id="DC225">0</td></tr><tr><td>DC175:</td><td id="DC175">0</td></tr><tr><td colspan="2">&nbsp;</td></tr></tbody><thead><tr><th colspan="2">Attacking Group Stats</th></tr></thead><tbody><tr><td>Raw Group Attack:</td><td class="fshGrey" id="GroupAttack"></td></tr><tr><td>Group Attack w/ buffs:</td><td id="GroupAttackBuffed"></td></tr><tr><td>Raw Group Defense:</td><td class="fshGrey" id="GroupDefense"></td></tr><tr><td>Group Defense w/ buffs:</td><td id="GroupDefenseBuffed"></td></tr><tr><td>Raw Group Armor:</td><td class="fshGrey" id="GroupArmor"></td></tr><tr><td>Group Armor w/ buffs:</td><td id="GroupArmorBuffed"></td></tr><tr><td>Raw Group Damage:</td><td class="fshGrey" id="GroupDamage"></td></tr><tr><td>Group Damage w/ buffs:</td><td id="GroupDamageBuffed"></td></tr><tr><td>Raw Group HP:</td><td class="fshGrey" id="GroupHP"></td></tr><tr><td>Group HP w/ buffs:</td><td id="GroupHPBuffed"></td></tr></tbody></table>'})
r(Ua,s),gn=a("DC225"),vn=a("DC175"),yn=a("GroupAttack"),kn=a("GroupAttackBuffed"),wn=a("GroupDefense"),Cn=a("GroupDefenseBuffed"),Ln=a("GroupArmor"),Dn=a("GroupArmorBuffed"),An=a("GroupDamage"),Mn=a("GroupDamageBuffed"),Vn=a("GroupHP"),$n=a("GroupHPBuffed")}let jn
function In(t){const e=I(t),a=O('#pCC img[src*="/relics/"]',e).length
var r
n(a,en),jn=1===(r=a)?1.5:wt(1-r/10,2),n(`${String(100*jn)}%`,an)}function On(t,e){return t>10*e||t<e?t:10*e}const Rn=[["levelValue","level"],["attackValue","attack"],["attackBonus","bonus_attack"],["defenseValue","defense"],["defenseBonus","bonus_defense"],["armorValue","armor"],["armorBonus","bonus_armor"],["damageValue","damage"],["damageBonus","bonus_damage"],["hpValue","hp"],["hpBonus","bonus_hp"],["killStreakValue","killstreak"]]
function Fn(t,e,a){t[a[0]]=Number(e[a[1]])}const _n=[["counterAttackLevel","Counter Attack"],["doublerLevel","Doubler"],["deathDealerLevel","Death Dealer"],["darkCurseLevel","Dark Curse"],["holyFlameLevel","Holy Flame"],["constitutionLevel","Constitution"],["sanctuaryLevel","Sanctuary"],["flinchLevel","Flinch"],["nightmareVisageLevel","Nightmare Visage"],["superEliteSlayerLevel","Super Elite Slayer"],["fortitudeLevel","Fortitude"],["chiStrikeLevel","Chi Strike"],["terrorizeLevel","Terrorize"],["barricadeLevel","Barricade"],["reignOfTerrorLevel","Reign Of Terror"],["anchoredLevel","Anchored"],["severeConditionLevel","Severe Condition"],["entrenchLevel","Entrench"],["cloakLevel","Cloak"]]
function qn(t,e,a){t[a[0]]=e[a[1]]||0}function Kn(t){if(!t)return
const e=zt(t._skills),a={}
return function(t,e){Rn.forEach(o(Fn,t,e))}(a,t),function(t,e){_n.forEach(o(qn,t,e))}(a,e),a.superEliteSlayerMultiplier=wt(.002*a.superEliteSlayerLevel,2),Yt(a.armorValue)&&function(t){t.attackValue=On(t.attackBonus,t.levelValue),t.defenseValue=On(t.defenseBonus,t.levelValue),t.armorValue=On(t.armorBonus,t.levelValue),t.damageValue=On(t.damageBonus,t.levelValue),t.hpValue=t.hpBonus}(a),a}let Yn,zn,Un,Qn,Wn,Jn,Xn,Zn,tr,er,ar,nr,rr,or
function ir(t){return Math.round(t*jn)}function sr(){Me(Yn,rn),Me(Un,sn),Me(Qn,ln),Me(Wn,fn),Me(Xn,mn),n(Zn,pn),tr+=1,n(tr,bn)}function ur(t){const e=function(t){return Math.ceil(ar.attack*(.0025*R(t["Nightmare Visage"],0)))}(t)
ar.attack-=e,function(){const t=Math.ceil(ar.attack*er.flinchLevel*.001)
Me(ar.attack-t,kn)}()
const a=function(t){return Math.ceil(ar.defense*(1+.001*R(t.Constitution,0)))}(t)
Me(a+e,Cn),function(t){Me(ar.armor+Math.floor(ar.armor*R(t.Sanctuary,0)*.001),Dn)}(t)
const n=function(t,e){return Math.ceil(e*R(t.Fortitude,0)*.001)}(t,a)
!function(t){Me(ar.hp+t,$n)}(n),function(t,e){const a=Math.ceil((ar.hp+e)*R(t["Chi Strike"],0)*.001),n=Math.ceil(ar.damage*er.terrorizeLevel*.001)
Me(ar.damage+a-n,Mn)}(t,n)}function lr(){n("Processing attacking group stats ... ",Sn),nr&&(ar.attack-=nr.attack,ar.defense-=nr.defense,ar.armor-=nr.armor,ar.damage-=nr.damage,ar.hp-=nr.hp),Me(ar.attack,yn),Me(ar.defense,wn),Me(ar.armor,Ln),Me(ar.damage,An),Me(ar.hp,Vn)
const t=zt(GameData.player().buffs)
ur(t),function(t){const e=Math.ceil(zn*R(t.Flinch,0)*.001)
Me(zn-e,on)}(t),function(t){const e=Math.ceil(Jn*R(t.Terrorize,0)*.001)
Me(Jn-e,dn)}(t),n("Done.",Sn)}function cr(){n("Processing defending guild stats ... ",Sn),Yn+=ir(er.attackValue),Un+=ir(er.defenseValue),Qn+=ir(er.armorValue),Wn+=ir(er.damageValue),Xn+=ir(er.hpValue),sr()
const t=Math.ceil(Yn*(.0025*er.nightmareVisageLevel))
!function(t){zn=Yn-t,Me(zn,on)}(t)
const e=Math.ceil(Un*(1+.001*er.constitutionLevel))
!function(t,e){const a=e+t
Me(a,un),Me(Math.ceil(.55*a),gn),Me(Math.ceil(.65*a),vn)}(t,e),Me(Qn+Math.floor(Qn*er.sanctuaryLevel*.001),cn)
const a=Xn+function(t){return Math.ceil(t*er.fortitudeLevel*.001)}(e)
Me(a,hn),function(t){Jn=Wn+Math.ceil(t*er.chiStrikeLevel*.001),Me(Jn)}(a),0!==er.cloakLevel&&n("Yes",nn),GameData.player().hasGroup&&ar?lr():n("Done.",Sn)}function fr(t){const e=Kn(t)
Yn+=Math.round(e.attackValue*F),Un+=Math.round(e.defenseValue*F),Qn+=Math.round(e.armorValue*F),Wn+=Math.round(e.damageValue*F),Xn+=Math.round(e.hpValue*F),0!==e.cloakLevel&&(Zn+=1),sr()}function dr(t){er=Kn(t)}function mr(t){ar=t}function hr(t){nr=t}function pr(t){n(t.message,Sn)}function br(t){const e=I(t),a=g('#pCC a[href*="confirmDisband"]',e)
if(!a)return
const n=function(t){const e=t.previousElementSibling.href,a=[Rt(e).then(mr)]
return function(t){return-1!==t.parentNode.parentNode.previousElementSibling.previousElementSibling.innerHTML.indexOf('"#000099"')}(t)&&a.push(Ft().then(hr)),a}(a)
return jt(n)}function gr(t,e){return 0===e?_t(t).then(dr):_t(t).then(fr).catch(pr)}function vr(){let t=[K({cmd:"guild",subcmd:"view",guild_id:rr.controlled_by.guild_id}).then(In)]
return GameData.player().hasGroup&&t.push(K({cmd:"guild",subcmd:"groups"}).then(br)),t=t.concat(Ja.map(gr)),t}function yr(){Pn(rr),Yn=0,Un=0,Qn=0,Wn=0,Xn=0,Zn=0,tr=0
const t=vr()
It(t,cr)}function kr(t,e){za(e)||(rr=e.response.data,rr.defenders.length>0&&(Hn(rr),q(Wa,"click",yr)))}function wr(t){$("#statbar-gold").css("background-color",t)}function Cr(){$("#HelperSendTotal").html(Lt(k("currentGoldSentTotal"))),Number(GameData.player().gold)>or?wr("red"):wr("inherit")}function Lr(){or=k("goldAmount"),$("#statbar-gold-tooltip-general").append(`<dt class="stat-gold-sendTo">Send To:</dt><dd id="HelperSendTo">${k("goldRecipient")}</dd><dt class="stat-gold-sendAmt">Amount:</dt><dd id="HelperSendAmt">${Lt(or)}</dd><dt class="stat-gold-sendTo">Send?</dt><dd><input id="HelperSendGold" value="Send!" class="custombutton" type="submit"><input type="hidden" id="xc" value=""</dd><dt class="stat-gold-sendTotal">Total Sent:</dt><dd id="HelperSendTotal">${Lt(k("currentGoldSentTotal"))}</dd>`),$("#HelperSendGold").on("click",U),Cr(),$.subscribe(Q,Cr)}function Dr(t){return W({cache:!1,url:"fetchdata.php",data:J(t,{fshrnd:Ut()}),dataType:"json"})}const Ar=[]
function Mr(t){return za(t)||Ar.push(t),t}function Vr(t,e){return t===Number(e.response.data.id)}function $r(t,e){t(e)}function Sr(t,e){const a=Ar.find(o(Vr,t))
return a?function(t){return new Promise((e=>{X(3,$r,[e,t])}))}(a):Dr({a:1,id:t,passback:e}).then(Mr)}let Nr,Hr,Br,Gr,Tr,xr
function Er(t,e){return Wt(Z(e,t))}function Pr(){var t
Nr=GameData.player().level,t=a("statbar-character-tooltip-stats"),Br=Er(t,rt),Hr=Er(t,tt),Tr=Er(t,et),Gr=Er(t,at),xr=Er(t,nt)}function jr(t){return`<tr><td colspan="2">${t.name}:</td><td colspan="2">${t.value}</td></tr>`}function Ir(t,e,a){return function(t){return`<table><tr><td><img src="${y}creatures/${t.image_id}.png" height="200" width="200"></td><td rowspan="2"><table width="400"><tr><td class="header" colspan="4" class="fshCenter">Statistics</td></tr>`}(t)+function(t,e){return`<tr><td>Class:&nbsp;</td><td width="40%">${t.creature_class}</td><td>Level:&nbsp;</td><td width="40%">${t.level} (your level:<span class="${e}">${Nr}</span>)</td></tr>`}(t,a)+function(t){return`<tr><td>Attack:&nbsp;</td><td width="40%">${t.attack} (your defense:<span class="fshYellow">${Hr}</span>)</td><td>Defense:&nbsp;</td><td width="40%">${t.defense} (your attack:<span class="fshYellow">${Br}</span>)</td></tr>`}(t)+function(t){return`<tr><td>Armor:&nbsp;</td><td width="40%">${t.armor} (your damage:<span class="fshYellow">${Gr}</span>)</td><td>Damage:&nbsp;</td><td width="40%">${t.damage} (your armor:<span class="fshYellow">${Tr}</span>)</td></tr>`}(t)+function(t,e){return`<tr><td>HP:&nbsp;</td><td width="40%">${t.hp} (your HP:<span class="fshYellow">${xr}</span>)(1H: <span class="fshRed">${e}</span>)</td><td>Gold:&nbsp;</td><td width="40%">${t.gold}</td></tr>`}(t,e)+'<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Enhancements</td></tr>'+function(t){return 0===t.enhancements.length?'<tr><td colspan="4">[no enhancements]</td></tr>':t.enhancements.map(jr).join("")}(t)+function(t){return`<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Description</td></tr><tr><td colspan="4">${t.description}</td></tr><tr><td colspan="4" height="5"></td></tr></table></td></tr><tr><td class="fshCenter"><b>${t.name}</b></td></tr></table>`}(t)}function Or(e){if(!za(e))return function(e){const a=Math.ceil(e.hp*t.hpVariable+e.armor*t.generalVariable)
let n="fshYellow"
return Pr(),Nr>e.level&&(n="fshRed"),Ir(e,a,n)}(e.response.data)}const Rr=["verb","view","tip-static"]
function Fr(t,e){const a=Or(e)
t.set("content.text",a)}function _r(t,e,a){return Sr(GameData.actions()[t].data.id,t).then(o(Fr,a)),"Loading..."}function qr(t,e){v("NewMap","CreatureInfo")
const a=it((n=e).parentNode.children).indexOf(n)
var n,r,i
t.classList.add("fshTip"),r=t,i=o(_r,a),$(r).qtip({overwrite:!0,show:{event:"mouseover",ready:!0},style:{classes:"qtip-tipsy qtip-custom"},position:{my:"center right",at:"center left",effect:!1,viewport:$(window)},content:{text:i},hide:{effect:!1}})}function Kr(e){if(!t.showCreatureInfo)return
const{target:a}=e,n=a.parentNode.parentNode.parentNode;(function(t,e){return Qt(Rr,t)&&!ot("fshTip",t)&&ot("creature",e)})(a,n)&&qr(a,n)}function Yr(){return Jt({subcmd:"scouttower"})}function zr(t,e){const a=t.insertCell(-1)
return[a.colSpan]=e,e[2]&&(a.className="header"),r(a,e[1]),a}function Ur(t,e,a){const n=t.insertRow(-1)
return a&&(n.className="fshBlue"),function(t,e){e.forEach(o(zr,t))}(n,e),n}function Qr(t,e){Ur(t,e[0],e[1])}function Wr(t,e){e.forEach(o(Qr,t))}let Jr,Xr,Zr,to,eo,ao,no,ro,oo,io,so,uo,lo,co,fo,mo,ho,po,bo,go,vo,yo,ko,wo,Co,Lo,Do,Ao
function Mo(){Xr=Oe("Current"),Zr=Oe("Kills"),to=Oe("Member"),eo=Oe("% of Total"),ao=Oe("Status"),no=Oe("Titan HP"),ro=Oe("Total"),oo=Oe("Your Guild")}function Vo(){for(;ho.rows.length>7;)ho.deleteRow(7)}function $o(){const t=yt()
return r(t,io),kt(t,"/"),r(t,so),t}function So(t){const e=yt()
return r(e,t),kt(e,"%"),e}function No(){bo=null,po&&!ot("fshHide",po)&&(vt(po,!0),n("",io),n("",so),n("",uo),n("",lo),n("",co),x("",fo),x("",mo),Vo())}function Ho(t){return 0===t.type&&(bo=t.base_creature_id,!0)}function Bo(){if(po)vt(po,!1)
else{const t=a("actionContainer")
po=e({className:"fshActionBox titanInfo"}),io=yt(),so=yt(),uo=yt(),lo=yt(),co=yt(),fo=yt(),mo=yt(),ho=ee({className:"fshCenter"}),Mo(),Wr(ho,[[[[2,no,!0],[4,oo,!0]]],[[[2,$o()],[4,uo]]],[[[2,Xr,!0],[4,So(lo)]],!0],[[[2,ro,!0],[4,So(co)]],!0],[[[2,ao,!0],[4,fo]],!0],[[[6,mo]]],[[[2,to,!0],[2,Zr,!0],[2,eo,!0]]]]),r(po,ho),r(t,po)}}function Go(t){return t<=0?'<span class="fshGreen cooldown">No active cooldown</span>':`<span class="fshMaroon cooldown">Cooldown until: ${function(t){const e=new Date(lt+1e3*t)
return`${te(e.getHours())}:${te(e.getMinutes())} ${te(e.getDate())}/${ut[e.getMonth()]}/${e.getFullYear()}`}(t)}</span>`}function To(t){return Ct(Xt(t.max_hp-t.current_hp,t.kills),2)}function xo(t){return Ct(100*t.kills/t.max_hp,2)}function Eo(t){[[t.current_hp,io],[t.max_hp,so],[t.kills,uo],[To(t),lo],[xo(t),co]].forEach((([t,e])=>{n(t,e)})),x(function(t){return Zt(t.kills,t.max_hp,t.current_hp)}(t),fo),x(Go(t.cooldown),mo)}function Po(t,e){return[[[2,Oe(e.player.name)],[2,Oe(e.kills.toString())],[2,Oe(`${Ct(100*e.kills/t.kills,2)}%`)]]]}function jo(t){return t.realm&&t.creature.base_id===bo&&t.realm===Jr}function Io(t){const e=t.find(jo)
e&&(Eo(e),function(t){if(Vo(),!t.contributors)return
const e=t.contributors.map(o(Po,t))
Wr(ho,e)}(e))}function Oo(e){return t.showTitanInfo&&l(e)&&e.some(Ho)}function Ro(t,e){(function(t){return t&&t.s&&l(t.r)})(e)&&(Io(e.r),Oo(GameData.realm().dynamic)?go=window.setTimeout(t,3e4):No())}function Fo(){st(Yr).then(o(Ro,Fo))}function _o(t){go&&(window.clearTimeout(go),go=null),Oo(t)?(Bo(),Fo()):No()}function qo(t){var e
t.dynamic&&(e=t.name,Jr=e,_o(t.dynamic))}function Ko(t,e){(function(t){return t.realm&&t.realm.name})(e)&&qo(e.realm)}function Yo(t){const e=t.response.response,a=t.response.msg
let n
if(0!==e){const t=a.indexOf("<")
n=-1!==t?a.substring(0,t):a}else n=`You purchased ${t.response.data.name} for ${Lt(t.response.data.cost)} gold.`
i(Do,`${n}<br>`)}function zo(){GameData.doAction(14,3,{id:vo.id,item_id:vo.itemId},0),ko.close()}function Uo(){const t=ae(Co.value)
if(!t)return
const e=[]
for(let a=1;a<t;a+=1)e.push(Dr({a:14,d:0,id:vo.id,item_id:vo.itemId}).then(Yo))
It(e,zo)}function Qo(){wo?n("",Do):(wo=e({className:"fshClear",textContent:"Select how many to quick-buy:"}),Co=xt({id:"buyAmount",className:"fshNumberInput",min:1,max:99,value:1,type:"number"}),r(wo,Co),Lo=Bt({textContent:"Quick-buy"}),s(Lo,Uo),r(wo,Lo),Do=e(),r(wo,Do),r(yo,wo))}function Wo(t,e){vo=e,yo=yo||a("shopDialogConfirm"),yo&&(ko=ko||$(yo).data("hcsWorldDialogShopConfirm"),ko&&Qo())}function Jo(t){Ao[t.name]?Ao[t.name].seen&&(Ao[t.name].seen+=1):(Ao[t.name]={seen:1},function(t,e){e.creature_class=t.creature_class,e.image_id=t.image_id,e.level=Number(t.level),e.type=t.type}(t,Ao[t.name]))}function Xo(t,e,a){return e?t(e,a):a}function Zo(t,e){const a=t||{}
return a.min=Xo(Math.min,a.min,e),a.max=Xo(Math.max,a.max,e),a}const ti=["attack","armor","damage","defense","hp"]
function ei(t,e,a){const n=Zo(e[a],Number(t[a]));(function(t,e){return!t||t.min!==e.min||t.max!==e.max})(e[a],n)&&(e[a]=n)}function ai(t,e){t[e.name]=Zo(t[e.name],Number(e.value))}function ni(t){Ao||(Ao={}),Jo(t),function(t,e){ti.forEach(o(ei,t,e))}(t,Ao[t.name]),function(t,e){(function(t){return t.enhancements&&t.enhancements.length>0})(t)&&(e.enhancements=e.enhancements||{},t.enhancements.forEach(o(ai,e.enhancements)))}(t,Ao[t.name]),$t("fsh_monsterLog",Ao)}function ri(t){Ao=t||{}}const oi=[]
function ii(e){var a
za(e)||(v("NewMap","MonsterLog"),a=e.response.data,t.showMonsterLog&&ni(a))}function si(t,e){return t.id===e.id}function ui(t,e){6!==t.type||function(t){if(oi.find(o(si,t.data)))return!0
oi.push(t.data)}(t)||Sr(t.data.id,e).then(ii)}function li(){t.showMonsterLog&&GameData.actions().forEach(ui)}function ci(t){const e=I(t),a=ne(e)
return{r:{attributes:[{value:a.attack},{value:a.defense},{value:a.armor},{value:a.damage},{value:a.hp}]}}}function fi(t){return K({cmd:"guild",subcmd:"groups",subcmd2:"viewstats",group_id:t}).then(ci)}function di(t){return Jt(J({subcmd:"groups"},t))}function mi(t){return di({subcmd2:"viewstats",group_id:t})}function hi(){return di({subcmd2:"view"})}function pi(t){return t.numberOfCreatureHitsTillDead-t.numberOfHitsRequired<=1?", dies on miss":", survives a miss"}const bi=[[t=>"-"===t.playerHits&&"-"===t.creatureHits,()=>"Unresolved"],[t=>"-"===t.playerHits,()=>"Player dies"],[t=>1===t.playerHits,t=>`Player 1 hits${pi(t)}`],[t=>t.playerHits>1,t=>`Player > 1 hits${pi(t)}`]]
function gi(t,e){return e[0](t)}function vi(t){t.playerHits=function(t){return"-"===t.numberOfCreatureHitsTillDead?t.numberOfHitsRequired:function(t){return"-"===t.numberOfHitsRequired||t.numberOfHitsRequired>t.numberOfCreatureHitsTillDead}(t)?"-":t.numberOfHitsRequired}(t),t.creatureHits=function(t){return"-"===t.numberOfHitsRequired?t.numberOfCreatureHitsTillDead:function(t){return"-"===t.numberOfCreatureHitsTillDead||t.numberOfCreatureHitsTillDead>t.numberOfHitsRequired}(t)?"-":t.numberOfCreatureHitsTillDead}(t),t.fightStatus=function(t){const e=bi.find(o(gi,t))
return e?e[1](t):"Unknown"}(t)}function yi(t){t.creatureHitByHowMuch>=0?function(t){const e=t.generalVariable*t.creature.damage
e<t.overallArmorValue?t.numberOfCreatureHitsTillDead=t.overallHPValue:t.numberOfCreatureHitsTillDead=Math.ceil(t.overallHPValue/(e-t.overallArmorValue))}(t):t.numberOfCreatureHitsTillDead="-"}function ki(t){!function(t){const e=function(t){return t.callback.groupExists?t.callback.groupArmorValue:t.player.armorValue}(t)
t.overallArmorValue=e+Math.floor(t.player.armorValue*t.player.sanctuaryLevel*.001)}(t),function(t){t.player.sanctuaryLevel>0&&(t.extraNotes+=`Sanc Bonus Armor = ${Math.floor(t.player.armorValue*t.player.sanctuaryLevel*.001)}<br>`)}(t),function(t){t.terrorizeEffect=Math.floor(t.creature.damage*t.player.terrorizeLevel*.001)}(t),function(t){t.player.terrorizeLevel>0&&(t.extraNotes+=`Terrorize Creature Damage Effect = ${-1*t.terrorizeEffect}<br>`)}(t),t.creature.damage-=t.terrorizeEffect,function(t){t.creatureDamageDone=Math.ceil(t.generalVariable*t.creature.damage-t.overallArmorValue+t.overallHPValue)}(t),yi(t)}function wi(t){const e=function(t){return t.callback.groupExists?t.callback.groupAttackValue:t.player.attackValue}(t)
t.player.darkCurseLevel>0&&(t.extraNotes+=`DC Bonus Attack = ${Math.floor(t.creature.defense*t.player.darkCurseLevel*.002)}<br>`),t.nightmareVisageAttackMovedToDefense=Math.floor((e+t.counterAttackBonusAttack)*t.player.nightmareVisageLevel*.0025),t.player.nightmareVisageLevel>0&&(t.extraNotes+=`NMV Attack moved to Defense = ${t.nightmareVisageAttackMovedToDefense}<br>`),t.overallAttackValue=e+t.counterAttackBonusAttack-t.nightmareVisageAttackMovedToDefense,t.hitByHowMuch=function(t){const e=t.creature.defense-t.creature.defense*t.player.darkCurseLevel*.002
return 3===t.combatEvaluatorBias?t.overallAttackValue-Math.ceil(e)-50:t.overallAttackValue-Math.ceil(t.attackVariable*e)}(t)}function Ci(t){t.lowestCALevelToStillHit=Math.max(Math.ceil((t.counterAttackBonusAttack-t.hitByHowMuch+1)/t.player.attackValue/.0025),0),t.lowestCALevelToStillKill=Math.max(Math.ceil((t.counterAttackBonusDamage-t.damageDone+1)/t.player.damageValue/.0025),0)}function Li(t){Ci(t),t.lowestFeasibleCALevel=Math.max(t.lowestCALevelToStillHit,t.lowestCALevelToStillKill),t.extraNotes+=`Lowest CA to still 1-hit this creature = ${t.lowestFeasibleCALevel}<br>`,0!==t.lowestFeasibleCALevel&&function(t){t.extraAttackAtLowestFeasibleCALevel=Math.floor(.0025*t.player.attackValue*t.lowestFeasibleCALevel),t.extraDamageAtLowestFeasibleCALevel=Math.floor(.0025*t.player.damageValue*t.lowestFeasibleCALevel),t.extraNotes+=`Extra CA Att/Dam at this lowered CA level = ${t.extraAttackAtLowestFeasibleCALevel} / ${t.extraDamageAtLowestFeasibleCALevel}<br>`}(t),t.extraStaminaPerHitAtLowestFeasibleCALevel=function(t){return t.player.counterAttackLevel>0?Math.ceil(.0025*(1+t.player.doublerLevel/50)*t.lowestFeasibleCALevel):0}(t),t.extraStaminaPerHitAtLowestFeasibleCALevel<t.extraStaminaPerHit?t.extraNotes+=`Extra Stam Used at this lowered CA level = ${t.extraStaminaPerHitAtLowestFeasibleCALevel}<br>`:t.extraNotes+="No reduction of stam used at the lower CA level<br>"}function Di(t){(function(t){return t.player.counterAttackLevel>0&&1===t.numberOfHitsRequired})(t)&&Li(t),function(t){return"-"===t.numberOfHitsRequired||1!==t.numberOfHitsRequired}(t)&&function(t){Ci(t),function(t){t.lowestCALevelToStillHit>175?t.extraNotes+="Even with CA175 you cannot hit this creature<br>":0!==t.lowestCALevelToStillHit&&(t.extraNotes+=`You need a minimum of CA${t.lowestCALevelToStillHit} to hit this creature<br>`)}(t),function(t){t.lowestCALevelToStillKill>175?t.extraNotes+="Even with CA175 you cannot 1-hit kill this creature<br>":0!==t.lowestCALevelToStillKill&&(t.extraNotes+=`You need a minimum of CA${t.lowestCALevelToStillKill} to 1-hit kill this creature<br>`)}(t)}(t)}function Ai(t){!function(t){const e=function(t){return t.callback.groupExists?t.callback.groupHPValue:t.player.hpValue}(t),{fortitudeLevel:a}=t.player
t.fortitudeExtraHPs=Math.floor(e*a*.001),a>0&&(t.extraNotes+=`Fortitude Bonus HP = ${t.fortitudeExtraHPs}<br>`),t.overallHPValue=e+t.fortitudeExtraHPs}(t),function(t){const{chiStrikeLevel:e}=t.player
t.chiStrikeExtraDamage=Math.floor(t.overallHPValue*e*.001),e>0&&(t.extraNotes+=`Chi Strike Bonus Damage = ${t.chiStrikeExtraDamage}<br>`)}(t)
const e=function(t){return t.callback.groupExists?t.callback.groupDamageValue:t.player.damageValue}(t)
if(t.overallDamageValue=e+t.deathDealerBonusDamage+t.counterAttackBonusDamage+t.holyFlameBonusDamage+t.chiStrikeExtraDamage,t.damageDone=Math.floor(t.overallDamageValue-(t.generalVariable*t.creature.armor+t.hpVariable*t.creature.hp)),t.hitByHowMuch>0){let e=1
t.overallDamageValue>=t.generalVariable*t.creature.armor&&(e=t.overallDamageValue-t.generalVariable*t.creature.armor),t.numberOfHitsRequired=Math.ceil(t.hpVariable*t.creature.hp/e)}else t.numberOfHitsRequired="-"}function Mi(t){return t.callback.groupExists?t.callback.groupDefenseValue:t.player.defenseValue}function Vi(t){t.overallDefenseValue=Mi(t)+Math.floor(Mi(t)*t.player.constitutionLevel*.001)+t.nightmareVisageAttackMovedToDefense,function(t){t.player.constitutionLevel>0&&(t.extraNotes+=`Constitution Bonus Defense = ${Math.floor(Mi(t)*t.player.constitutionLevel*.001)}<br>`)}(t),function(t){t.player.flinchLevel>0&&(t.extraNotes+=`Flinch Bonus Attack Reduction = ${Math.floor(t.creature.attack*t.player.flinchLevel*.001)}<br>`)}(t),t.creatureHitByHowMuch=Math.floor(t.attackVariable*t.creature.attack-t.creature.attack*t.player.flinchLevel*.001-t.overallDefenseValue),3===t.combatEvaluatorBias&&(t.creatureHitByHowMuch=Math.floor(t.creature.attack-t.creature.attack*t.player.flinchLevel*.001-t.overallDefenseValue-50))}function $i(t){t.extraNotes="",function(t){t.player.superEliteSlayerLevel>0&&(t.extraNotes+=`SES Stat Reduction Multiplier = ${t.player.superEliteSlayerMultiplier}<br>`)}(t),function(t){t.holyFlameBonusDamage=0,"Undead"===t.creature.class&&(t.holyFlameBonusDamage=Math.max(Math.floor((t.player.damageValue-t.creature.armor)*t.player.holyFlameLevel*.002),0),t.player.holyFlameLevel>0&&(t.extraNotes+=`HF Bonus Damage = ${t.holyFlameBonusDamage}<br>`))}(t),function(t){t.deathDealerBonusDamage=Math.floor(t.player.damageValue*(Math.min(.01*Math.floor(t.player.killStreakValue/5)*t.player.deathDealerLevel,20)/100))}(t),function(t){t.counterAttackBonusAttack=Math.floor(.0025*t.player.attackValue*t.player.counterAttackLevel),t.counterAttackBonusDamage=Math.floor(.0025*t.player.damageValue*t.player.counterAttackLevel)}(t),function(t){t.extraStaminaPerHit=0,t.player.counterAttackLevel>0&&(t.extraStaminaPerHit=Math.ceil(.0025*(1+t.player.doublerLevel/50)*t.player.counterAttackLevel))}(t),function(t){t.player.deathDealerLevel>0&&(t.extraNotes+=`DD Bonus Damage = ${t.deathDealerBonusDamage}<br>`)}(t),function(t){t.player.counterAttackLevel>0&&(t.extraNotes+=`CA Bonus Attack/Damage = ${t.counterAttackBonusAttack} / ${t.counterAttackBonusDamage}<br>CA Extra Stam Used = ${t.extraStaminaPerHit}<br>`)}(t)}let Si,Ni,Hi,Bi,Gi,Ti,xi,Ei,Pi,ji
function Ii(){return va(Ni)?"Remove from do not kill list":"Add to the do not kill list"}function Oi(){n(Ii(),Hi)}function Ri(){const e=t.doNotKillList.indexOf(Ni);-1===e?t.doNotKillList.push(Ni):t.doNotKillList.splice(e,1),Oi(),m("doNotKillList",t.doNotKillList.join()),ka()}function Fi(){Hi?Oi():function(){Hi=Bt({className:"fshBl",textContent:Ii(),type:"button"})
const t=e({className:"description",innerHTML:'<span class="ui-helper-hidden-accessible"><input type="text"></span>'})
r(t,Hi),r(Si,t),s(Hi,Ri)}()}function _i(t,e){!function(t){if(!Si){const e=Z("body",t)
1===e.length&&([Si]=e)}}(e),Si&&(Ni=t.trim(),Fi())}function qi(){Ti||(Gi||(Gi=e(),r(Bi,Gi),r(Bi,e({innerHTML:'<span class="fshFooter">*Does include CA, DD, HF, DC, Flinch, Super Elite Slayer, NMV, Sanctuary, Constitution, Fortitude, Chi Strike and Terrorize (if active) and allow for randomness (1.1053). Constitution, NMV, Fortitude and Chi Strike apply to group stats.</span>'}))),Ti=e(),r(Gi,Ti))}function Ki(t){qi(),x(t,Ti)}function Yi(t){xi||(qi(),xi=e(),r(Gi,xi)),x(t,xi)}function zi(t,e){const a={name:t.name,class:t.creature_class,attack:Number(t.attack),defense:Number(t.defense),armor:Number(t.armor),damage:Number(t.damage),hp:Number(t.hp)}
return function(t,e,a){3===a&&(e.attack-=Math.ceil(e.attack*t),e.defense-=Math.ceil(e.defense*t),e.armor-=Math.ceil(e.armor*t),e.damage-=Math.ceil(e.damage*t),e.hp-=Math.ceil(e.hp*t))}(e,a,t.type),a}function Ui(e,a,n){const r={}
r.callback=n,r.player=Kn(a),function(e){e.combatEvaluatorBias=t.combatEvaluatorBias,e.attackVariable=1.1053,e.generalVariable=t.generalVariable,e.hpVariable=t.hpVariable}(r),r.creature=zi(e.response.data,r.player.superEliteSlayerMultiplier),function(t){$i(t),wi(t),Ai(t),Vi(t),ki(t),vi(t),Di(t)}(r),r.evaluatorHTML=function(t){return`<table width="100%"><tbody>${function(t){return`<tr><td bgcolor="#CD9E4B" colspan="4" align="center">${function(t){return t.callback.groupExists?"Group ":""}(t)}Combat Evaluation</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333">Will I hit it? </td><td align="left">${function(t){return t.hitByHowMuch>0?"Yes":"No"}(t)}</td><td align="right"><span style="color:#333333">Extra Attack: </td><td align="left">( ${t.hitByHowMuch} )</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333"># Hits to kill it? </td><td align="left">${t.numberOfHitsRequired}</td><td align="right"><span style="color:#333333">Extra Damage: </td><td align="left">( ${t.damageDone} )</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333">Will I be hit? </td><td align="left">${function(t){return t.creatureHitByHowMuch>=0?"Yes":"No"}(t)}</td><td align="right"><span style="color:#333333">Extra Defense: </td><td align="left">( ${-1*t.creatureHitByHowMuch} )</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333"># Hits to kill me? </td><td align="left">${t.numberOfCreatureHitsTillDead}</td><td align="right"><span style="color:#333333">Extra Armor + HP: </td><td align="left">( ${-1*t.creatureDamageDone} )</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333"># Player Hits? </td><td align="left">${t.playerHits}</td><td align="right"><span style="color:#333333"># Creature Hits? </td><td align="left">${t.creatureHits}</td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333">Fight Status: </span></td><td align="left" colspan="3"><span>${t.fightStatus}</span></td></tr>`}(t)}${function(t){return`<tr><td align="right"><span style="color:#333333">Notes: </span></td><td align="left" colspan="3"><span style="font-size:x-small;">${t.extraNotes}</span></td></tr>`}(t)}</tbody></table>`}(r),n.groupExists?Yi(r.evaluatorHTML):Ki(r.evaluatorHTML)}function Qi(t){return t.members[0].name===Mt()}function Wi(t){if(l(t.r))return t.r.find(Qi).id}function Ji(t,e,a){if(!a.r||!a.r.attributes)return
const n=a.r.attributes
Ui(t,e,{groupExists:!0,groupAttackValue:n[0].value,groupDefenseValue:n[1].value,groupArmorValue:n[2].value,groupDamageValue:n[3].value,groupHPValue:n[4].value})}function Xi(t,e,a){a&&function(t){return st(mi,fi,t)}(a).then(o(Ji,t,e))}function Zi(t,e){st(hi).then(Wi).then(o(Xi,t,e))}function ts(t,e){t.player.hasGroup&&Zi(t,e),Ui(t,e,{groupExists:!1})}function es(t,e){Bi||(Bi=a("dialog-viewcreature")),Bi&&(Ki(""),Yi(""),function(t){return t.response&&t.response.data}(e)&&(_i(e.response.data.name,Bi),re(!0).then(o(ts,e))))}function as(){const e=[,[t.buffs,t.buffsName],[t.buffs2,t.buffs2Name],[t.buffs3,t.buffs3Name]][t.enabledHuntingMode]
l(e)&&([Ei,Pi]=e)}function ns(e){"enabledHuntingMode"===e.target.name&&(t.enabledHuntingMode=e.target.value,m("enabledHuntingMode",t.enabledHuntingMode),as(),GameData.fetch(u))}function rs(t){const e=Z("verbs",t)
1===e.length&&Kt(e[0])}function os(){if(!ji)return
const t=a("actionList")
Nt("player",t).forEach(rs)}const is={hideSubLvlCreature:function(){t.hideSubLvlCreature=!t.hideSubLvlCreature,m("hideSubLvlCreature",t.hideSubLvlCreature),GameData.fetch(V)},hidePlayerActions:function(){ji=!ji,m("hidePlayerActions",ji),GameData.fetch(V)},showCreatureInfo:function(){t.showCreatureInfo=!t.showCreatureInfo,m("showCreatureInfo",t.showCreatureInfo)},showHuntingBuffs:function(){t.showBuffs=!t.showBuffs,m("showHuntingBuffs",t.showBuffs),GameData.fetch(u)},showMonsterLog:function(){t.showMonsterLog=!t.showMonsterLog,m("showMonsterLog",t.showMonsterLog)},showTitanInfo:function(){t.showTitanInfo=!t.showTitanInfo,m("showTitanInfo",t.showTitanInfo),_o(GameData.realm().dynamic)},showBuffInfo:function(){t.showBuffInfo=!t.showBuffInfo,m("showBuffInfo",t.showBuffInfo),ea()}}
function ss(t){const e=is[t.target.name]
L(e)&&(t.target.blur(),e(t))}function us(){const t=e({className:"fshCenter fshFten"}),n=e({id:"fshWorldPrefs",innerHTML:`${ie("showCreatureInfo")}&nbsp;&nbsp;${ie("showMonsterLog")}&nbsp;&nbsp;${ie("showTitanInfo")}&nbsp;&nbsp;${ie("showBuffInfo")}<br>${ie("hideSubLvlCreature")}&nbsp;&nbsp;${ie("hidePlayerActions")}&nbsp;&nbsp;${oe()}`})
s(n,ss),p(n,"change",ns),r(t,n)
const o=e()
r(t,o)
const i=a("worldContainerBelow").children[0]
return Tt(t,i),o}function ls(t,e){return t[e.name]=!0,t}function cs(t,e,a){return t[a.trim()]||e.push(a),e}function fs(t){x("",t)}function ds(t,e){const a=e.b.reduce(ls,{}),n=Ei.reduce(o(cs,a),[])
n.length>0?function(t,e){x(`You are missing some ${Pi} hunting buffs<br>(${e.join(", ")})`,t)}(t,n):fs(t)}function ms(e,a,n){Ei&&function(e,a,n){t.showBuffs?ds(e,n):fs(e)}(e,0,n)}const hs=[{generalVariable:1.1053,hpVariable:1.1},{generalVariable:1.1,hpVariable:1.053},{generalVariable:1.053,hpVariable:1},{generalVariable:1.1053,hpVariable:1}]
function ps(){var e
t.combatEvaluatorBias=k("combatEvaluatorBias"),t.generalVariable=(e=t.combatEvaluatorBias,hs[e]?hs[e].generalVariable:1.1053),t.hpVariable=function(t){return hs[t]?hs[t].hpVariable:1.1}(t.combatEvaluatorBias)}function bs(t,e){return 6!==e.type||(0!==e.data.creature_type||e.data.level>=t)}function gs(t){const e=ht(t)
return function(t){return!t||!t.actions||0===t.actions.length}(e)?t:(e.actions=e.actions.filter(o(bs,function(t){return t.realm&&t.realm.minlevel||GameData.realm().minlevel}(e))),JSON.stringify(e))}function vs(e,a){t.hideSubLvlCreature&&function(t){return t.data&&t.data.d&&se(t.data.d,V)}(a)&&(e.dataFilter=gs)}function ys(e){t[e[0]]=ue(e[1])}function ks(e){t[e]=ue(e)}function ws(){[["buffs","huntingBuffs"],["buffs2","huntingBuffs2"],["buffs3","huntingBuffs3"]].forEach(ys),["doNotKillList"].forEach(ks)}function Cs(e){t[e[0]]=k(e[1])}function Ls(e){t[e]=k(e)}function Ds(){[["buffsName","huntingBuffsName"],["buffs2Name","huntingBuffs2Name"],["buffs3Name","huntingBuffs3Name"],["showBuffs","showHuntingBuffs"]].forEach(Cs),["enabledHuntingMode","hideSubLvlCreature","showTitanInfo","showBuffInfo","showMonsterLog","showCreatureInfo"].forEach(Ls)}function As(t){$(`#actionList li.creature-${t.toString()} a.create-group`).hide()}const Ms=["hideChampionsGroup","hideElitesGroup","hideSEGroup","hideTitanGroup","hideLegendaryGroup"]
function Vs(t,e){var a
k(t)&&(a=e+1,$.subscribe(A,o(As,a)),As(e+1))}function $s(t,e){"ACT_REPAIR"===e&&GameData.fetch(bt+u+M+V)}function Ss(t){H(t.target)}const Ns=[function(){ps(),ws(),Ds()
const e=us()
$.ajaxPrefilter("JSON",vs),t.hideSubLvlCreature&&GameData.fetch(V),function(e){as()
const a=o(ms,e)
$.subscribe(c,a),t.showBuffs&&window.initialGameData&&a(null,{b:window.initialGameData.player.buffs})}(e),ji=k("hidePlayerActions"),$.subscribe(A,os),os()},function(){Y(),z&&Lr()},function(){$.subscribe(mt,es)},function(){Ms.forEach(Vs)},function(){k("enableCreatureColoring")&&r(document.body,St("#actionList .creature-1 {color: green;}\n#actionList .creature-2 {color: yellow;}\n#actionList .creature-3 {color: red;}"))},function(){$.subscribe(A,ka),ka(),function(){const t=GameData.doAction
GameData.doAction=La(t)}()},function(){Vt("fsh_monsterLog").then(ri),$.subscribe("-1-success.action-response 4-success.action-response 5-success.action-response 25-success.action-response",li),li()},function(){$.subscribe(pt,$s)},function(){k("keepLogs")&&Vt("fsh_combatLog").then(ga)},function(){window.initialGameData&&Ko(0,window.initialGameData),$.subscribe(`${ct} ${ft}`,Ko)},function(){$.subscribe(dt,Wo)},function(){$.subscribe(_,kr)},function(){$("#messageCenter").worldMessageCenter({offset:"0 60"})},function(){H("#mapTooltip")},function(){qa(),$.subscribe(S,Ka),$.subscribe(N,Ya)},function(){ea(),$.subscribe(`${c} ${f}`,ea),$.subscribe(d,aa)},function(){s(a("buffList"),Ss)},function(){p(a("actionList"),"mouseover",Kr)},function(){const t=h("body")[0]
p(t,"keydown",ua),p(t,"keyup",la)}]
function Hs(){Ht(Ns),$.subscribe(w,Aa)}export default Hs
//# sourceMappingURL=newMap-3cd90214.js.map
