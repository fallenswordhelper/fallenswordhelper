import{c as S}from"./chunk-CVQZXUFM.js";import"./chunk-KTJNAJHL.js";import{a as y}from"./chunk-5KQNYLBM.js";import{a as V,b as J}from"./chunk-4MXLGWYV.js";import"./chunk-YAWZ5Z3S.js";import{a as q}from"./chunk-TLDKSKZ6.js";import{a as _}from"./chunk-H3M42MG7.js";import"./chunk-DM5NY3YK.js";import{a as W}from"./chunk-JYJDUK7M.js";import"./chunk-YJVBIGD3.js";import{a as j}from"./chunk-JVVO4BIM.js";import{a as D}from"./chunk-JNJ2L7JL.js";import"./chunk-2DWXCWIM.js";import"./chunk-CQHRZYSX.js";import"./chunk-4MM6RLJ7.js";import{a as O}from"./chunk-MBJ37FYW.js";import{a as M}from"./chunk-JJR4MJC5.js";import"./chunk-E4LGDQH2.js";import{b as P,c as R}from"./chunk-NM56CO5K.js";import"./chunk-YZ2VIXA6.js";import"./chunk-C4L2DL62.js";import{a as m}from"./chunk-7DWVT37O.js";import"./chunk-MED54ICD.js";import"./chunk-IRVI43RT.js";import{a}from"./chunk-AMIV6VU6.js";import{a as l}from"./chunk-XKBBMJSB.js";import"./chunk-CAKCK4NI.js";import{a as $}from"./chunk-CQI4LTJC.js";import"./chunk-DREXNAOH.js";import"./chunk-S4JGXK5I.js";import{a as u}from"./chunk-VOWLBX22.js";import{a as w}from"./chunk-GMERTW32.js";import"./chunk-IPCPLARM.js";import"./chunk-SGJW3QOZ.js";import{a as A}from"./chunk-WMZAS474.js";import{a as g}from"./chunk-H3CO5HSE.js";import{a as h}from"./chunk-ODQJYK6Y.js";import"./chunk-SMGTENZD.js";import{a as F}from"./chunk-R5QTS4JB.js";import{a as k}from"./chunk-LZ2L2TIX.js";import{a as b}from"./chunk-EUWXZKWZ.js";import"./chunk-DO7SCVXY.js";import"./chunk-HNI63WVA.js";import"./chunk-KE767BLN.js";import"./chunk-TUVTWIHM.js";import"./chunk-RTMHI3L7.js";import{a as x}from"./chunk-JZHGPOOI.js";import{a as o}from"./chunk-TUVTX7TQ.js";import"./chunk-IWE7LPGP.js";import{a as r}from"./chunk-VWFYI5BK.js";import"./chunk-QVWAWWED.js";import{a as N}from"./chunk-4QNYZHAB.js";import"./chunk-PYHGZC4L.js";import{a as H}from"./chunk-D76XH5RX.js";import{a as f}from"./chunk-MA3AC62H.js";import"./chunk-IWF73C7V.js";import"./chunk-YJHKALOE.js";import"./chunk-ZMMQFEZR.js";import"./chunk-DTSXLBNB.js";import"./chunk-NCV3HP3S.js";import{a as c}from"./chunk-YG74QOJP.js";import{a as T,b as p}from"./chunk-STY5NEH4.js";import"./chunk-M7Q5FD7X.js";import"./chunk-K2U7JEMX.js";import"./chunk-PUAVFQTB.js";import{ua as d}from"./chunk-OHKPSLFK.js";import{a as E}from"./chunk-EJREXK3Y.js";var I;function G(){let e=r("item-div");if(!e){e=u({id:"item-div",className:"itemDiv"});let t=r("item-list"),n=b(d,t);for(;n.length;)n[0].classList.add("fshBlock"),w(e,n[0]);l(e,t)}return e}function K(e,t,n){return e&&N(t,n)}function X(e,t,n){return!e&&!t&&!n}function Y(e,t){t.children[0].lastElementChild.children[0].children[0].checked=!1;let n=o("fshHide",t),i=e==="folderid0",s=o(e,t);K(n,i,s)&&(t.classList.remove("fshHide"),t.classList.add("fshBlock")),X(n,i,s)&&(t.classList.remove("fshBlock"),M(t))}function Z(e){a("trade","doHideFolder"),k(d,G()).forEach(f(Y,e.target.id))}function ee(e){e.target.nodeName==="SPAN"&&e.target.id.indexOf("folderid")!==-1&&Z(e)}function te(e){return` &ensp;<span id="folderid${e[0]}" class="fshLink fshNoWrap" fid=${e[0]}>${e[1]}</span> `}function ne(e){let t=y({id:"fshFolderSelect",innerHTML:`<td colspan=6><span id="folderid0" class="fshLink" fid=0>All</span> &ensp;<span id="folderid-1" class="fshLink" fid="-1">Main</span>${H(e).map(te).join("")}`});c(t,ee);let n=r("item-list").parentNode.parentNode;D(n,'<tr id="fshShowSTs"><td align="center" colspan=6><label><input type="checkbox" id="itemsInSt" checked> Select items in ST</label></td></tr>'),l(t,n)}function ie(e,t){t.is_in_st&&e.classList.add("isInST")}function re(e){let t=e.children[0]?.lastElementChild.children[0];if(!t)return;let n=t.children[0];if(!n)return;let i=I[n.getAttribute("value")];i&&(e.classList.add(`folderid${i.folder_id}`),I.fshHasST&&ie(e,i),n.classList.add(`itemid${i.item_id}`),n.classList.add(`itemtype${i.type}`))}function oe(e){let t=p("betaOptIn");t&&P("trade.processTrade"),I=e.items,k(d,r("item-list")).forEach(re),ne(e.folders),t&&R("trade.processTrade")}function se(e){m(3,oe,[e])}function v(){x()||_().then(se)}function L(e,t){return $(V,J,e,t)}var me=e=>W(e).previousElementSibling.children[0].children[0].children[0],ce=e=>me(e).remove();function ae(e,t,n){n.s?(ce(e),e.classList.remove("fshSpinner")):e.replaceWith(t)}async function fe(e,t){let n=await e;if(n.s){let i=u({className:"fshSpinner fshSpinner12 fshRelative",style:{height:"16px"}}),[s]=t;s.replaceWith(i);let C=await L(t[1],t[2]);return ae(i,s,C),C}return n}function le(e){e.s?S("Items sent successfully!"):S(e.e.message)}var de=()=>h('[name="sendItemList[]"]:checked'),pe=()=>g('form[name="sendItemForm"] [name="target_username"]').value,he=e=>de().map(t=>[t,e,[t.value]]),ue=e=>e.reduce(fe,Promise.resolve({s:1}));async function ye(e,t){a("trade","oneByOne");let n=O({className:"fshSpinner fshRelative",style:{marginLeft:"40px"}}),i=e.target;i.replaceWith(n);let s=await ue(t);le(s),n.replaceWith(i)}function ke(e){let t=he(pe());t.length&&ye(e,t)}function B(){let e=g('form[name="sendItemForm"] input[value="Send"]'),t=q({className:"fshBl",id:"oneByOneBtn",textContent:"OneByOne",type:"button"});j(t,e),c(t,ke)}function ge(e){let t=parseInt(r("fshSendHowMany").value,10);return F(t)?e.length:E.subcmd!=="-"?Math.min(100,t):t}function Se(e,t){return e==="itemid-2"&&o("itemtype12",t)}function Ie(e,t){return e==="itemid-1"||Se(e,t)||o(e,t)}function ve(){let e=r("itemsInSt");if(e)return e.checked}function Le(e,t){return e||!o("isInST",t)}function U(e){return e.children[0].lastElementChild.children[0].children[0]}function z(e,t){t.checked=e}function Be(e){z(!1,e)}function Ce(e){z(!0,e)}function Ee(e,t){t.filter(f(Le,ve())).map(U).filter(f(Ie,e)).slice(0,ge(t)).forEach(Ce)}function Te(e){a("trade","doCheckAll");let t=r("item-div")||r("item-list"),n=h("table:not(.fshHide)",t);n.map(U).forEach(Be),Ee(e.target.id,n)}function Ae(e){o("fshCheckAll",e.target)&&Te(e)}function Q(e){return A(`[${e}]`)}function Ne(){let e=p("sendClasses"),t=Q(e);return t||Q(T.sendClasses)}function be(e){return` &ensp;<span id="itemid${e[1]}" class="fshCheckAll fshLink fshNoWrap">${e[0]}</span>`}function He(e){let t=y({id:"fshSelectMultiple",innerHTML:`<td colspan=6>Select:&ensp;<span id="itemid-1" class="fshCheckAll fshLink fshNoWrap">All Items</span> &ensp;<span id="itemid-2" class="fshCheckAll fshLink fshNoWrap">All Resources</span>${Ne().map(be).join("")} &ensp;How&nbsp;many:<input id="fshSendHowMany" type="text" class="custominput fshHowMany" value="all"></td>`});c(t,Ae),l(t,e.parentNode.parentNode)}function we(){let e=r("item-list");!e||(m(3,v),m(3,He,[e]),m(3,B))}export{we as default};
//# sourceMappingURL=trade-23ZDKE5P.js.map
