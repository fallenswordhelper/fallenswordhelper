import{a as je}from"./chunk-QB6JSKIY.js";import{a as Te}from"./chunk-7XOBSHQZ.js";import{a as Ee}from"./chunk-QUHORU62.js";import{a as Fe}from"./chunk-YTQRLILB.js";import{a as De}from"./chunk-CKN7HU5O.js";import{b as J}from"./chunk-XXZOONC5.js";import{a as Se}from"./chunk-WEN7JPPW.js";import{a as Ae}from"./chunk-A4SVD2MS.js";import"./chunk-XSBXLWG4.js";import"./chunk-AF6X2EPJ.js";import{a as xe}from"./chunk-O3WMWG4C.js";import{a as Re}from"./chunk-2FWCZQ2C.js";import"./chunk-PQQEDEVZ.js";import"./chunk-5THSM4BA.js";import{a as K}from"./chunk-HRU4Z4QT.js";import{A as V,B as ve,D as a,E as z,F,G as H,H as r,T as ge,V as he,W as _e,X as T,Y as B,Z as U,b as pe,d as de,fa as be,ga as Ie,ha as ke,ia as we,ja as ye,s as i,t as L,u as N,w as m,x as I,y as k}from"./chunk-NEOIIKPE.js";import"./chunk-XWM4YOEC.js";import"./chunk-Z7UI4YWM.js";import"./chunk-VZP2JUPU.js";import{a as qe}from"./chunk-MG45P7RB.js";import"./chunk-CQKCIFA5.js";import"./chunk-GEQ6SBFU.js";import"./chunk-5JOFCACO.js";import{a as E}from"./chunk-HZVS66QI.js";import"./chunk-327LTRO2.js";import"./chunk-27TM5UBE.js";import{a as fe}from"./chunk-MUNFS2PQ.js";import"./chunk-SY4GQ6JX.js";import"./chunk-THRA3S6L.js";import"./chunk-TM7HV6I4.js";import{a as G}from"./chunk-R4VVRPE7.js";import"./chunk-D4CTFWTI.js";import"./chunk-ZS2ZYLXC.js";import{a as le}from"./chunk-ACU3ECUK.js";import{b as Ce}from"./chunk-OHGKEFPZ.js";import"./chunk-KWZPRQOD.js";import{Y as ae,b as ce,r as me}from"./chunk-S2DS6Q2Q.js";import"./chunk-DPOGJLEK.js";import"./chunk-MHZN7LER.js";import"./chunk-JVNW5U7Y.js";import"./chunk-IWZ3GP32.js";import"./chunk-57NIVQFE.js";function Ge(t){let[e,n]=fe(E("tr:nth-child(2) td",t)).split("/").map(c=>parseInt(c,10));return{have:e,need:n}}function Me(){return G(`#pCC td[background^="${ce}ui/inventory/"]`).map(e=>e.parentElement.parentElement).map(Ge)}function W(){return Me().reduce((e,n)=>Math.min(e,Math.floor(n.have/n.need)),1/0)}function X(t){return je({subcmd:"doinvent",recipe_id:t})}function Qe(t){let e=De(t);return e.includes("successfully")?{r:{item:{}},s:!0}:{e:{message:e},s:!1}}async function Y(t){let e=await Se({cmd:"inventing",subcmd:"doinvent",recipe_id:t});return Qe(e)}function Z(t){return Ae(X,Y,t)}function Pe(t){let e;return{c(){e=I("(max)")},m(n,c){L(n,e,c)},d(n){n&&N(e)}}}function Le(t){let e,n,c,s,p,o,d;return{c(){e=m("div"),n=m("div"),n.textContent="INFORMATION",c=k(),s=m("div"),p=I(t[4]),r(n,"background","#8E8668"),r(n,"color","#FFF"),r(n,"font-size","smaller"),r(e,"border","2px solid #FFF"),r(e,"margin","10px auto"),r(e,"width","80%"),r(e,"background","#D3CFC1")},m(u,_){L(u,e,_),i(e,n),i(e,c),i(e,s),i(s,p),d=!0},p(u,_){(!d||_&16)&&F(p,u[4])},i(u){d||(u&&ge(()=>{d&&(o||(o=U(e,J,{},!0)),o.run(1))}),d=!0)},o(u){u&&(o||(o=U(e,J,{},!1)),o.run(0)),d=!1},d(u){u&&N(e),u&&o&&o.end()}}}function Oe(t){let e,n,c,s,p,o,d,u,_,b,j,v,h,y,C,S=t[1]+t[2]+"",R,q,M,ne,D,x,ie,Q,re,A,oe,P,w,O,se;o=new Ee({props:{$$slots:{default:[Pe]},$$scope:{ctx:t}}}),o.$on("click",t[5]);let f=t[4]&&Le(t);return{c(){e=m("form"),n=m("label"),n.textContent="Select how many to quick invent",c=k(),s=m("input"),p=k(),be(o.$$.fragment),d=k(),u=m("input"),_=k(),b=m("div"),f&&f.c(),j=k(),v=m("div"),h=m("div"),y=k(),C=m("p"),R=I(S),q=I(" / "),M=I(t[0]),ne=k(),D=m("div"),x=m("div"),ie=I("Successes: "),Q=I(t[1]),re=k(),A=m("div"),oe=I("Failures: "),P=I(t[2]),a(n,"for","quick-invent-amount"),a(s,"type","number"),a(s,"id","quick-invent-amount"),a(s,"name","quick-invent-amount"),a(s,"min","0"),a(s,"step","1"),a(s,"class","custominput fshNumberInput"),s.required=!0,a(u,"class","custombutton"),a(u,"type","submit"),u.value="Quick Invent",r(u,"margin-left","8px"),a(h,"class","composing-progress-bar"),r(h,"background-position","right top"),r(h,"width",t[3]+"%"),r(h,"transition","width 0.4s ease-out"),r(h,"position","absolute"),r(h,"top","0px"),r(C,"position","relative"),a(v,"class","composing-progress"),r(v,"margin","0px auto"),r(v,"font-weight","bold"),r(v,"color","#fff"),r(v,"left","0px"),r(x,"display","inline-block"),r(x,"width","250px"),a(x,"class","fshQs fshGreen"),r(A,"display","inline-block"),r(A,"width","250px"),a(A,"class","fshQs fshRed"),r(D,"margin-top","36px"),a(e,"class","fshCenter"),r(e,"margin-top","12px")},m(l,g){L(l,e,g),i(e,n),i(e,c),i(e,s),H(s,t[0]),i(e,p),Ie(o,e,null),i(e,d),i(e,u),i(e,_),i(e,b),f&&f.m(b,null),i(b,j),i(b,v),i(v,h),i(v,y),i(v,C),i(C,R),i(C,q),i(C,M),i(b,ne),i(b,D),i(D,x),i(x,ie),i(x,Q),i(D,re),i(D,A),i(A,oe),i(A,P),w=!0,O||(se=[V(s,"input",t[9]),V(e,"submit",ve(t[6]))],O=!0)},p(l,[g]){g&1&&z(s.value)!==l[0]&&H(s,l[0]);let ue={};g&2048&&(ue.$$scope={dirty:g,ctx:l}),o.$set(ue),l[4]?f?(f.p(l,g),g&16&&T(f,1)):(f=Le(l),f.c(),T(f,1),f.m(b,j)):f&&(he(),B(f,1,1,()=>{f=null}),_e()),(!w||g&8)&&r(h,"width",l[3]+"%"),(!w||g&6)&&S!==(S=l[1]+l[2]+"")&&F(R,S),(!w||g&1)&&F(M,l[0]),(!w||g&2)&&F(Q,l[1]),(!w||g&4)&&F(P,l[2])},i(l){w||(T(o.$$.fragment,l),T(f),w=!0)},o(l){B(o.$$.fragment,l),B(f),w=!1},d(l){l&&N(e),ke(o),f&&f.d(),O=!1,pe(se)}}}function Ve(t,e,n){let{max:c}=e,{recipeID:s}=e,p=1,o=0,d=0,u=0,_="";function b(){n(1,o=0),n(2,d=0),n(3,u=0),n(4,_="")}function j(){n(0,p=c),K("inventing","maxInventButton")}async function v(){if(K("inventing","quickInvent"),!p)return;b(),Array(p).fill(s).reduce(async(C,S)=>{let R=await C;if(!R||R.s===!0){let q=await Z(S);return q?.s?q.r.success_count>0?n(1,o+=1):n(2,d+=1):n(4,_=q?.e?.message??"Server Error"),n(3,u=100*((o+d)/p)),q}return R},Promise.resolve())}function h(){p=z(this.value),n(0,p)}return t.$$set=y=>{"max"in y&&n(7,c=y.max),"recipeID"in y&&n(8,s=y.recipeID)},[p,o,d,u,_,j,v,c,s,h]}var $=class extends ye{constructor(e){super(),we(this,e,Ve,Oe,de,{max:7,recipeID:8})}},Ne=$;function ze(t,e){return new Ne({props:t,target:e})}function He(t){let n=t.insertRow(-1).insertCell(-1);n.className="header",n.setAttribute("height","1")}function Ue(t){let n=t.insertRow(-1).insertCell(-1);return n.className="fshCenter",n}function ee(){let t=E('input[name="recipe_id"]');if(!t)return;let e=W(),n=Ce().lastElementChild;He(n),ze({max:e,recipeID:t.value},Ue(n))}function Je(t){if(!t)return;let e=le(/\/items\/(?<id>\d+)\.gif/,t.src);if(e)return e}function Ke(t){return`${ae}items${me}view&item_id=${t}`}function We(t){return xe({href:Ke(t),target:"_blank"})}function Be(t,e){let n=Je(e);if(!n)return;let c=We(n);Fe(c,t),Re(c,t)}function Xe(t){Be(t,t)}function Ye(){let t=Te('.//b[.="Target Invention"]/../../following-sibling::*[1]//img'),e=E("#pCC b");Be(e,t)}function Ze(){G('#pCC img[src*="/items/"]').forEach(Xe)}function te(){Ye(),Ze()}function $e(){qe()&&(te(),ee())}export{$e as default};
//# sourceMappingURL=viewRecipe-ORMHEH6B.js.map
