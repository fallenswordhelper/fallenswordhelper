import{a as nt}from"./chunk-46H4OCUY.js";import{a as x,b as tt}from"./chunk-AGGAGXAQ.js";import{a as et}from"./chunk-IM6ICQMC.js";import{a as ot}from"./chunk-7CJVFSHW.js";import{a as S}from"./chunk-WKIH54NU.js";import{a as Z}from"./chunk-IO5SOFP7.js";import{a as K,b as W}from"./chunk-P5FKFGKU.js";import{a as k}from"./chunk-WECAB7BZ.js";import{a as Y}from"./chunk-EHR57YJJ.js";import{a as X}from"./chunk-YTQRLILB.js";import{a as C}from"./chunk-B3TMG7X6.js";import"./chunk-HT2E4BH5.js";import{a as z}from"./chunk-CKN7HU5O.js";import{a as V}from"./chunk-MC5MD6GH.js";import{a as g}from"./chunk-3OTERK3T.js";import"./chunk-ZWF3BA7K.js";import{a as U}from"./chunk-WEN7JPPW.js";import{a as M}from"./chunk-A4SVD2MS.js";import"./chunk-XSBXLWG4.js";import"./chunk-AF6X2EPJ.js";import{a as R}from"./chunk-5CREU7DW.js";import{a as b}from"./chunk-2FWCZQ2C.js";import"./chunk-PQQEDEVZ.js";import{a as H}from"./chunk-6BJHGS5L.js";import{a as s}from"./chunk-HRU4Z4QT.js";import"./chunk-3M4BGLDY.js";import"./chunk-ZHNBOA2F.js";import"./chunk-XWM4YOEC.js";import"./chunk-VYBTCWLD.js";import{a as $}from"./chunk-Z7UI4YWM.js";import"./chunk-CA4APEYC.js";import{a as D}from"./chunk-IKLQU6YP.js";import{c as O}from"./chunk-CIKNJBXV.js";import{a as J}from"./chunk-2UUQ3JZJ.js";import"./chunk-3N7IQHYA.js";import"./chunk-VZP2JUPU.js";import{a as _}from"./chunk-MG45P7RB.js";import"./chunk-CQKCIFA5.js";import"./chunk-GEQ6SBFU.js";import"./chunk-5JOFCACO.js";import"./chunk-NFXVO5QH.js";import{a as j}from"./chunk-HZVS66QI.js";import"./chunk-E546N3MN.js";import{a as G}from"./chunk-327LTRO2.js";import"./chunk-27TM5UBE.js";import{a as d}from"./chunk-MUNFS2PQ.js";import"./chunk-SY4GQ6JX.js";import"./chunk-THRA3S6L.js";import"./chunk-TM7HV6I4.js";import{a as l}from"./chunk-R4VVRPE7.js";import{a}from"./chunk-D4CTFWTI.js";import"./chunk-ZS2ZYLXC.js";import"./chunk-ACU3ECUK.js";import{b as i}from"./chunk-OHGKEFPZ.js";import{a as r}from"./chunk-KGBQEEPA.js";import{a as c}from"./chunk-MO5YK3AA.js";import{a as L}from"./chunk-KWZPRQOD.js";import{a as p}from"./chunk-BMEPSGPW.js";import"./chunk-X2HBFA4R.js";import"./chunk-2FN2TMEO.js";import{c as F}from"./chunk-7CIGM6WR.js";import{b as I,f as Q,qa as h,ra as w}from"./chunk-S2DS6Q2Q.js";import"./chunk-DPOGJLEK.js";import"./chunk-MHZN7LER.js";import{a as m}from"./chunk-JVNW5U7Y.js";import{a as P}from"./chunk-IWZ3GP32.js";import"./chunk-57NIVQFE.js";async function y(t){let e=await G({cache:!1,dataType:"text",data:{cmd:"composing",subcmd:"createajax",template_id:t,fshrnd:tt()}});return $(e)??{error:"Server Error"}}function ct(){return`url(${I}composing/${x(1,11)}_${x(1,51)}.png)`}function lt(t,e){r("",t.children[0]),t.children[0].classList.add("fshPot"),t.children[0].style.backgroundImage=ct(),r(`Creating '<span class="fshBold">${e}</span>' Potion`,t.children[2]),r("",t.children[3])}function mt(){a('[id|="composing-template"]:not(#composing-template-multi)').length===0&&p(h,!1)}function at(t){let e=t.parentNode;e&&(r('<div class="fshScs">Success</div>',e),lt(e.previousElementSibling.previousElementSibling,t[t.selectedIndex].text),mt())}function pt(t,e){let o=t.parentNode;!o||!e||(e.error?r(`<div class="fshScs">${e.error}</div>`,o):at(t))}async function ft(t){let e=await y(t.value);pt(t,e)}function f(t,e){e.id=`proc-${e.id}`,r("",t),t.classList.add("fshSpinner","fshSpinner12","fshComposingSpinner"),ft(e),K("quickcreate")}function it(t,e){t.classList.add(`left-${e.toString()}`)}function ut(t){let e=a(".quickCreate .sendLink");it(t,e.length)}function dt(t,e){s("composing","FastComposeButton");let o=a('[id|="composing-template"]:not(#composing-template-multi)');if(!(o.length<t.value))for(let n=0;n<t.value;n+=1)o[n].value=e,f(o[n].nextElementSibling.nextElementSibling,o[n])}function gt(t){let e=t.target,{templateId:o}=e.dataset;o&&dt(e,o)}function ht(t,e){return k({className:"awesome orange",dataset:{templateId:e},type:"button",value:t})}function Ct(t,e,o,n){return n===0&&Y(t[1],e.insertCell(-1)),b(e.insertCell(-1),ht((n+1).toString(),t[0])),e}function bt(t,e,o){return t.forEach(m(Ct,o,e.insertRow(-1))),e}function kt(t,e,o){let n=et({id:"fshFastCompose"});return it(n,o),t.reduce(m(bt,e),n)}function St(t){return[t.value,t.text]}function xt(t,e,o){let n=l("#composing-template-multi option").map(St),u=kt(n,e,o);b(t,u),c(i(),gt),W("quickcreate",m(ut,u))}function yt(t){s("composing","FastCompose"),g(t,"<br>");let e=C("composing-potion-time",document),o=e.filter(J("ETA: n/a")).length;o>0?xt(t,e,o):g(t,"No open slots!")}function v(){let t=j("#pCC div.centered");g(t,'<span class="fsh-fast-compose">[ <label for="fast-compose"><span class="sendLink">Fast Compose</span></label> ]</span>');let e=R({className:"centered"});S(e,t);let o=k({id:"fast-compose",type:"checkbox"});S(o,t),H(o,"change",m(yt,e))}function vt(t){let e=D(Q,d(t));if(e){let{h:o,m:n,s:u}=e;return(o*3600+n*60+Number(u))*1e3+O()}return 0}function rt(t){p(h,t)}function E(){if(!P.enableComposingAlert)return;let t=C("composing-potion-time",document),e=Math.min(...t.map(vt));e===0?rt(!0):(rt(!1),p(w,e))}function B(t){return Z({subcmd:"collect",potion_id:t})}async function N(t){let e=await U({cmd:"composing",subcmd:"collect",potion_id:t}),o=z(e);return o.includes("collected")?{s:!0}:{s:!1,e:{message:o}}}function q(t){return M(B,N,t)}function Et(t){let e=t.getAttribute("onclick").split("&")[2].split("=")[1];nt(t.parentNode,`[ <span class="fsh-quick-collect"><button class="fshBl fsh-bli" type="button" value="${e}">Quick Collect</button></span> ]&nbsp;`)}var Bt=t=>t.tagName==="BUTTON"&&d(t)==="Quick Collect";function Nt(t){t.nextElementSibling.disabled=!0,t.nextElementSibling.nextElementSibling.disabled=!0,r("",t),t.classList.add("fshSpinner")}function st(t,e,o){r(o,t),t.classList.add(e)}function qt(t,e){t.classList.remove("fshSpinner"),e.s?st(t,"fshGreen","Collected"):st(t,"fshRed","Error")}async function Tt(t){s("composing","quickCollect");let e=t.parentNode,o=t.value;Nt(e);let n=await q(o);qt(e,n)}function At(t){Bt(t.target)&&Tt(t.target)}function T(){l('input[value="Collect Potion"]',i()).forEach(Et),c(i(),At)}function Lt(t){ot(t,'<span class="quickCreate">[<span class="sendLink">Quick Create</span>]</span>')}var Pt=t=>t.tagName==="SPAN"&&t.className==="quickCreate";function It(t){let e=t.previousElementSibling.previousElementSibling;e&&e.value!=="none"&&(f(t,e),s("composing","QuickCreate"))}function Qt(t){let e=t.target.parentNode;Pt(e)&&It(e)}function A(){l("input[id^=create-]:not(#create-multi)",i()).forEach(Lt),c(i(),Qt)}function wt(){if(!F("moveComposingButtons"))return;let t=L("composing-error-dialog").previousElementSibling;t.setAttribute("style","text-align: right; padding: 0 38px 0 0");let e=V("composing-level",i())[0].parentNode;X(t,e)}function Ft(){E(),A(),wt(),v(),T()}function $t(){_()&&i()&&Ft()}export{$t as default};
//# sourceMappingURL=composing-5CU7ZKAA.js.map
