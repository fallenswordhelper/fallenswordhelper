import{a as z}from"./chunk-B436GNC6.js";import{a as W}from"./chunk-LRJOIJLN.js";import{a as V}from"./chunk-YZM7RPN6.js";import{a as D}from"./chunk-PT6PVZSN.js";import{a as U,b as j}from"./chunk-VTHO5FXN.js";import{a as Y}from"./chunk-46H4OCUY.js";import{a as G}from"./chunk-D6GLMLM7.js";import{a as M}from"./chunk-7CJVFSHW.js";import{a as s}from"./chunk-U4PTS6TH.js";import{a as h}from"./chunk-EHR57YJJ.js";import{a as c}from"./chunk-3OTERK3T.js";import{a as H}from"./chunk-KKZ6YNXE.js";import{a as d}from"./chunk-JD6SFYTB.js";import{a as _}from"./chunk-5CREU7DW.js";import{a as f}from"./chunk-X6FEZLDJ.js";import{a as g}from"./chunk-2FWCZQ2C.js";import{a as B}from"./chunk-RIMALT5Z.js";import{a as u}from"./chunk-NFXVO5QH.js";import{a as I}from"./chunk-HZVS66QI.js";import{a as w}from"./chunk-MUNFS2PQ.js";import{a as R}from"./chunk-TM7HV6I4.js";import{a as n}from"./chunk-R4VVRPE7.js";import{a as q}from"./chunk-BMEPSGPW.js";import{c as p}from"./chunk-7CIGM6WR.js";import{Ma as C,Na as m,U as x,ua as y,w as A}from"./chunk-S2DS6Q2Q.js";import{a as E}from"./chunk-JVNW5U7Y.js";var Q=r=>[r,d(r.href,"target_username")],X=async([r,e])=>[r,e,await U(e)],J=r=>r?' class="pmAttackUrl"':"";function K(r,[e,t]){M(e,` | <a${J(r)} href="${x}${t}">Attack</a>`)}async function L(r,e){let t=n('a[href*="=createsecure&"]',r);if(!t.length)return;let o=t.map(Q);(await f(o.map(X))).filter(([,,i])=>!i).forEach(i=>K(e,i))}var O=r=>r?' class="pmIgnoreUrl"':"",Z=(r,e)=>`<a${O(r)} href="${A}${u(e)}" data-tooltip="Add to Ignore List">Ignore</a>`;function rr(r,[e,t]){c(t.cells[1],`<font size="1"><br>[ ${Z(r,e)} ]</font>`)}function P(r,e){let t=n(m,r);if(t.length===0)return;t.map(a=>[a,s(a)]).forEach(a=>rr(e,a))}var F="fshGreen",N="fshRed",er=([,r])=>I(m,r),tr=async([r,e,t])=>[e,t,await z(e,D(r))],or=([,,r])=>r?.s,nr=r=>[18,21,31].includes(r.id),k=r=>`<span class="fshRed fshBold">${r}.</span>`;function ar(r){return r.includes("You were victorious over")?[F,`You were <span class="${F}">victorious</span> over `]:r.includes("You were defeated by")?[N,`You were <span class="${N}">defeated</span> by `]:["",null]}function sr(r){return r.id===18?k(`${r.params[0]} leeched the buff '${r.params[1]}'`):r.id===21?k(`${r.params[0]} was mesmerized by Spell Breaker, losing the '${r.params[1]}' buff`):k(`${r.params[0]} activated Fist Fight`)}function l(r,e,t){return r!==0?`${e}:<span class="${t}">${H(r)}</span> `:""}function ir(r,e){let t=r.specials.filter(nr).map(sr),o=l(r.xp_gain,"XP stolen",e)+l(r.gold_gain,"Gold lost",e)+l(r.gold_stolen,"Gold stolen",e)+l(r.pvp_prestige_gain,"Prestige gain",e)+l(r.pvp_rating_change,"PvP change",e);return o+(o&&t.length?"<br>":"")+(t.length?`${t.join("<br>")}`:"")}function mr([r,e,t]){let[o,a]=ar(e);a&&(r.cells[2].firstChild.remove(),Y(r.cells[2],a));let i=ir(t.r.combat,o);i&&g(r.cells[2],_({innerHTML:i}))}function fr(r){return r.map(e=>[e,s(e)]).filter(er).map(([e,t])=>[e,t,t.cells[2].innerHTML]).map(tr)}async function T(r){let e=n('a[href*="&combat_id="]',r);if(e.length===0)return;(await f(fr(e))).filter(or).forEach(mr)}function v(r){n('a[href*="=trade&"]',r).filter(e=>!d(e.href,"subcmd")).forEach(e=>h("Trade",e)),n('a[href*="=createsecure&"]',r).forEach(e=>h("ST",e))}function lr(r,e){let[,,t]=r.rows[0].cells;t&&!e&&c(t,'&nbsp;&nbsp;<span class="fshWhite">(Guild mates show up in <span class="fshGreen">green</span>)</span>')}async function cr(r){let[,e]=await j(r);return[`.fshPlayerColoring tr:nth-of-type(${s(r).rowIndex+1}) td:nth-of-type(3) > a:first-of-type`,e]}function pr(r,[e,t]){return r[t]?r[t].push(e):r[t]=[e],r}var dr={guild:"green",ally:"blue",enemy:"red"};function ur([r,e]){return`${e.join(", ")} { color: ${dr[r]}; }`}var gr=([,r])=>r;function yr(r){return R(r.filter(gr).reduce(pr,{})).map(ur)}function hr(r,e,t){let o=yr(e);o.length&&(lr(r,t),r.classList.add("fshPlayerColoring"),g(document.body,G(o.join(`
`))))}async function S(r,e){let t=n(m,r);if(!t.length)return;let o=await f(t.map(cr));hr(r,o,e)}var b=0,Lr=/You ranked \w{3} in your PvP Band! You have gained \d x PvP Ladder Token/;function Pr(r){return Lr.test(w(r.cells[2]))}function kr(r){let e=V(u(r.cells[1]));e>b&&(q(y,e),b=e)}function $(r){b=p(y),n(C,r).map(s).filter(Pr).forEach(kr)}var Tr=[["addIgnoreLink",P],["colorPlayerNames",S],["addAttackLinkToLog",L],["changeButtonLabels",v],["trackLadderReset",$],["showPvPSummaryInLog",T]];function vr(r,e,[t,o]){p(t)&&o(r,e)}function Sr(r,e){Tr.forEach(E(vr,r,e))}function br(r){if(B())return;let e=W();e&&Sr(e,r)}export{br as a};
//# sourceMappingURL=chunk-CTBA4KCK.js.map
