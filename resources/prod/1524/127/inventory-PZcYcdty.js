import{g as t}from"./getMembrList-BDQPPwA5.js"
import{a as e}from"./all-YfMtr2SN.js"
import{cn as n,i as s,c1 as a,ag as i,p as r,aJ as c,bQ as o,cG as d,s as l,c as u,aO as f,bp as p,ai as m,cw as h,cH as b,br as y,C as v,bL as g,aQ as k,k as _,G as I,$ as x,aI as w,aN as R,S as L,L as M,M as S,O as E,P as j,Q as T,T as D,U as N,X as C,_ as A,a0 as G,a1 as U,aA as q,a3 as O,cI as P,a4 as B,g as F,cJ as H,cK as W,a_ as Q,cL as V,cM as Y,cN as J,bh as X,bi as K,bc as z,bf as Z,bj as tt,am as et,d as nt,v as st,m as at,w as it,bT as rt,f as ct,aT as ot}from"./calfSystem-DCvZki7i.js"
import{e as dt}from"./executeAll-DIAWIge1.js"
import{l as lt}from"./loadDataTables-CigZ3n06.js"
import{d as ut,a as ft,b as pt}from"./deepClone-Dd6UpMeX.js"
import{d as mt}from"./daLoadInventory-kJvaiZTL.js"
import{b as ht}from"./basicItem-Bx8ZUJIE.js"
import{e as bt,d as yt,a as vt,m as gt}from"./dropItem-zMMuBR-f.js"
import{f as kt}from"./flattenItems-C4pfIrZn.js"
import{c as _t}from"./createTable-Dw6k9216.js"
import{i as $t}from"./isSelected-BWnMzKlW.js"
import{c as It}from"./changeMinMax-8kupOwY_.js"
import{c as xt}from"./chromeHandlers-BZBLmyuV.js"
import{a as wt,u as Rt,e as Lt}from"./useItem-CKnBAyQe.js"
import{g as Mt}from"./guildInventory-DuL8Kvqy.js"
import{h as St}from"./htmlResult-kS1VcWpW.js"
import{e as Et}from"./errorDialog-B4_TjdGG.js"
import{q as jt,a as Tt}from"./queue-RnNAHd6o.js"
import{p as Dt,l as Nt}from"./lvlTests-BXbkGopt.js"
import{i as Ct}from"./intValue-C7nTQec1.js"
import{i as At}from"./isArray-eVldfhw1.js"
import"./guildMembers-7jZOBLQe.js"
import"./now-Cx4PsKjI.js"
import"./guild-CJIq2DIU.js"
import"./dialog-BW-ZNw6R.js"
import"./dialogMsg-rKdvzvMA.js"
import"./sendItems-CUyfmQIn.js"
import"./numberIsNaN-CGkd1jiA.js"
import"./daUseItem-BF62hguG.js"
import"./InfoBoxFrom-DMNuYGp2.js"
import"./backpack-BtODsafe.js"
import"./backpackOk-CagcATOI.js"
import"./takeItem-BtxgL6y2.js"
function Gt([t]){return"lastUpdate"!==t}function Ut(){return n({subcmd:"inventory"})}let qt=""
const Ot=()=>qt
function Pt(t,e){qt||(qt=e.message),qt&&s(t,a("p",{className:"fshRed",textContent:qt}))}let Bt={}
const Ft=()=>Bt
async function Ht(t){try{return await t()}catch(t){if(500!==t.jqXhr.status)throw t
Pt(r(),t)}}const Wt=(t,e)=>{return e.map(ht).map((n=t,function(t){const e=n?.find((({inv_id:e})=>e===t.inv_id))
return{...t,...e?.stats&&{stats:{...t.stats,armor:e.stats.armor,attack:e.stats.attack,damage:e.stats.damage,defense:e.stats.defense,hp:e.stats.hp,set_name:e.stats.set_name??""}}}}))
var n},Qt=t=>({...t,equipped:!0,folder_id:-2}),Vt=(t,e,n)=>({folders:bt(t),items:Wt(e,n),player_id:c()})
const Yt=t=>({...t,player:{id:-1}}),Jt=(t,e)=>({current_player_id:c(),items:Wt(t,e),guild_id:o()})
async function Xt(){if("invmanagernew"===i.subcmd){const t=await async function(){const[t,n]=await e([Ht(Ut),mt()]),s=t?.items??[],a=n?.r??{},i=(a.equipment?.map(Qt)??[]).concat(kt(a))
return Vt(a,s,i)}()
Bt=t}else if("guildinvmgr"===i.subcmd){const t=await async function(){const[t,n,s]=await e([Ht(d),ut(),ft()]),a=t?.items??[],i=n?.r??[],r=s?.r??[],c=i.concat(r.map(Yt))
return Jt(a,c)}()
Bt=t}}const Kt=t=>{l("Inventory","Header",t)},zt=t=>{l("Inventory","Datatable",t)}
function Zt(t,e){zt("clearSearch"),e.val(""),$(t).DataTable().search("").draw()}function te(){Ft().folders&&(Ft().folders[-1]="Main")}const ee={checkedElements:{0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,100:1,101:1,102:1,103:1,104:1,105:1,106:1},fshMinLvl:1,fshMaxLvl:9999},ne='<table class="fshInvFilter"><tr><th colspan="14">@@reportTitle@@</th><th><span id="fshRefresh" class="fshLink">[Refresh]</span></th></tr><tr><td colspan="2" rowspan="3"><b>&nbsp;Show Items:</b></td><td class="fshRight">&nbsp;Helmet:</td><td><input id="fshHelmet" type="checkbox" item="0"/></td><td class="fshRight">&nbsp;Armor:</td><td><input id="fshArmor" type="checkbox" item="1"/></td><td class="fshRight">&nbsp;Gloves:</td><td><input id="fshGloves" type="checkbox" item="2"/></td><td class="fshRight">&nbsp;Boots:</td><td><input id="fshBoots" type="checkbox" item="3"/></td><td class="fshRight">&nbsp;Weapon:</td><td><input id="fshWeapon" type="checkbox" item="4"/></td><td></td><td class="fshRight">&nbsp;Min lvl:</td><td rowspan="2"><input id="fshMinLvl" class="fshNumberInput" type="number" value="1" min="0"><br><input id="fshMaxLvl" class="fshNumberInput" type="number" value="9999" min="0"></td></tr><tr><td class="fshRight">&nbsp;Shield:</td><td><input id="fshShield" type="checkbox" item="5"/></td><td class="fshRight">&nbsp;Ring:</td><td><input id="fshRing" type="checkbox" item="6"/></td><td class="fshRight">&nbsp;Amulet:</td><td><input id="fshAmulet" type="checkbox" item="7"/></td><td class="fshRight">&nbsp;Rune:</td><td><input id="fshRune" type="checkbox" item="8"/></td><td class="fshRight">&nbsp;Sets Only:</td><td><input id="fshSets" item="-1" type="checkbox"/></td><td></td><td class="fshRight">&nbsp;Max lvl:</td></tr><tr><td colspan="2">&nbsp;[<span id="fshAll" class="fshLink">Select All</span>]</td><td colspan="2">&nbsp;[<span id="fshNone" class="fshLink">Select None</span>]</td><td colspan="2">&nbsp;[<span id="fshDefault" class="fshLink">Defaults</span>]</td><td colspan="6"></td><td><input id="fshReset" type="button" value="Reset"/></td></tr><tr><td class="fshRight">&nbsp;Quest Item:</td><td><input id="fshQuest" item="9" type="checkbox"/></td><td class="fshRight">&nbsp;Potion:</td><td><input id="fshPotion" item="10" type="checkbox"/></td><td class="fshRight">&nbsp;Resource:</td><td><input id="fshResource" item="12" type="checkbox"/></td><td class="fshRight">&nbsp;Recipe:</td><td><input id="fshRecipe" item="13" type="checkbox"/></td><td class="fshRight">&nbsp;Container:</td><td><input id="fshContainer" item="14" type="checkbox"/></td><td class="fshRight">&nbsp;Frag Stash:</td><td><input id="fshStash" item="16" type="checkbox"/></td><td class="fshRight">&nbsp;Composed:</td><td><input id="fshComposed" item="15" type="checkbox"/></td><td></td></tr><tr><td class="fshRight">&nbsp;Common:</td><td><input id="fshCommon" item="100" type="checkbox" checked/></td><td class="fshRight">&nbsp;Rare:</td><td><input id="fshRare" item="101" type="checkbox" checked/></td><td class="fshRight">&nbsp;Unique:</td><td><input id="fshUnique" item="102" type="checkbox" checked/></td><td class="fshRight">&nbsp;Legendary:</td><td><input id="fshLegendary" item="103" type="checkbox" checked/></td><td class="fshRight">&nbsp;Super Elite:</td><td><input id="fshSuperElite" item="104" type="checkbox" checked/></td><td class="fshRight">&nbsp;Crystalline:</td><td><input id="fshCrystalline" item="105" type="checkbox" checked/></td><td class="fshRight">&nbsp;Epic:</td><td colspan="2"><input id="fshEpic" item="106" type="checkbox" checked/></td></tr></table>',se={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,100:1,101:1,102:1,103:1,104:1,105:1,106:1},ae={Perfect:{abbr:"Perf",colour:"#00b600",index:8},Excellent:{abbr:"Exc",colour:"#f6ed00",index:7},"Very Good":{abbr:"VG",colour:"#f67a00",index:6},Good:{abbr:"Good",colour:"#f65d00",index:5},Average:{abbr:"Ave",colour:"#f64500",index:4},Poor:{abbr:"Poor",colour:"#f61d00",index:3},"Very Poor":{abbr:"VPr",colour:"#b21500",index:2},Uncrafted:{abbr:"Unc",colour:"#666666",index:1}}
let ie={},re=0,ce=0
const oe=()=>ie,de=()=>re,le=()=>ce
function ue(t){return ae[t]?ae[t].abbr:""}function fe(t,e){const n=function(t){return t.folder_id?function(t){return t.equipped?"fshGreen":"fshNavy"}(t):function(t){return-1===t.player_id?"fshNavy":"fshMaroon"}(t)}(e)
t.classList.add(n),e.equipped&&t.classList.add("fshBold")}function pe(t){return function(t){return t.player_id&&-1!==t.player_id}(t)||function(t){return t.folder_id&&-1!==t.guild_tag}(t)}function me(t){return`<span class="fshLink recallItem" invid="${t.inv_id}" playerid="${p(t.player_id,Ft().player_id)}" mode="1" action="recall">GS</span>`}function he(t){return`<span class="fshLink storeItem" invid="${t.inv_id}">GS</span>`}function be(t,e,n){return"display"===t?n(e):"GS"}function ye(t,e){const n=function(t){return-1===t.player_id?4:pe(t)?7:1}(e),s=(a=Ft().player_id,i=e.player_id,r=Ft().guild_id,a||(-1!==i?i:r))
var a,i,r
let c=""
return function(t){return t.stats&&""!==t.stats.set_name}(e)&&(c=` (<span class="fshLink setName" set="${e.stats.set_name}">set</span>)`),`<a href="${h}${t}" class="fshInvItem tip-dynamic ${b[e.rarity].clas}" data-tipped="fetchitem.php?item_id=${e.item_id}&inv_id=${e.inv_id}&t=${n}&p=${s}">${t}</a>${c}`}const ve=[[t=>t.player_id&&-1===t.player_id,(t,e)=>`takeItem" action="${e.a}`],[t=>t.player_id&&t.player_id!==Ft().current_player_id,(t,e)=>`recallItem" playerid="${t.player_id}" mode="0" action="${e.a}`],[t=>function(t){return t.folder_id&&!t.equipped}(t)||function(t){return t.player_id&&!t.equipped&&t.player_id===Ft().current_player_id}(t),(t,e)=>e.c]]
function ge(t,e){const n=ve.find((([e])=>e(t)))
return n?`<span class="fshLink ${n[1](t,e)}" invid="${t.inv_id}">${e.b}</span>`:""}function ke(t){return p(t.folder_id,t.player_id)}function _e(t){return i.membrList[t]?i.membrList[t].username:"???"}function $e(t,e){return t[0]-e[0]}function Ie(t,e){return`<option value="${e[0]}"${$t(Number(e[0]),t)}>${e[1]}</option>`}const xe=[{title:"Name",data:"item_name",render:function(t,e,n){return"display"!==e?t:ye(t,n)}},{title:"Level",data:"stats.min_level"},{title:"Where",data:ke,render:{_:function(t,e,n){return n.folder_id?function(t){return t.equipped?-2:t.folder_id}(n):-1===n.player_id?"~":_e(n.player_id)},display:function(t,e,n){return n.player_id?function(t){return-1===t.player_id?"Guild Store":`<a class="fshMaroon" href="${y}${t.player_id}">${_e(t.player_id)}</a>`}(n):n.equipped?"Worn":`<select class="fshMoveItem" data-inv="${n.inv_id}">${s=n.folder_id,a=Ft().folders,v(a).sort($e).map(u(Ie,s)).join("")}</select>`
var s,a},filter:function(t,e,n){return n.player_id?function(t){return-1===t.player_id?"Guild Store":_e(t.player_id)}(n):n.equipped?"Worn":Ft().folders[n.folder_id]}}},{title:"Type",data:"type",render:t=>g[t]},{title:"Att",data:"stats.attack"},{title:"Def",data:"stats.defense"},{title:"Arm",data:"stats.armor"},{title:"Dam",data:"stats.damage"},{title:"HP",data:"stats.hp"},{title:"Frg",data:"forge",render:function(t,e,n){if(n.type<9)return n.forge}},{title:"Craft",data:"craft",render:{_:t=>ae[t]?ae[t].index:0,display:ue,filter:ue}},{title:"Du%",data:"durability",render:function(t,e,n){if(n.type<9&&n.max_durability>0)return Math.floor(n.durability/n.max_durability*100)}},{title:"BP",data:ke,render:function(t,e,n){if(!n.folder_id&&n.player_id!==Ft().current_player_id)return function(t,e){return"display"!==t?"BP":-1===e.player_id?`<span class="fshLink takeItem" invid="${e.inv_id}" action="take">BP</span>`:`<span class="fshLink recallItem" invid="${e.inv_id}" playerid="${e.player_id}" mode="0" action="recall">BP</span>`}(e,n)}},{title:"GS",data:ke,render:function(t,e,n){return pe(n)?be(e,n,me):function(t){return t.folder_id&&!t.bound}(n)?be(e,n,he):void 0}},{title:"W/U",data:"type",render:function(t,e,n){const s=[1,1,1,1,1,1,1,1,1,null,2,2,null,null,null,2][t]
return 1===s?ge(n,{a:"wear",b:"Wear",c:"wearItem"}):2===s?ge(n,{a:"use",b:"Use",c:"useItem"}):void 0}},{title:"setName",data:"stats.set_name",orderable:!1,visible:!1},{title:"Tag",data:"guild_tag",render:t=>-1===t?"No":"Yes"},{title:"Drop",data:"type",render:function(t,e,n){if(!function(t){return-1!==t.guild_tag||t.equipped}(n))return"display"!==e?"Drop":`<span class="dropItem dropLink" data-tooltip="INSTANTLY DESTROY THE ITEM. NO REFUNDS OR DO-OVERS! Use at own risk." data-inv="${n.inv_id}">Drop</span>`}},{title:"Send",data:"type",render:function(t,e,n){if(!function(t){return t.equipped||-1===t.guild_tag&&t.bound}(n))return"display"!==e?"Send":`<span class="sendItem sendLink" data-tooltip="INSTANTLY SEND THE ITEM. NO REFUNDS OR DO-OVERS! Use at own risk." data-inv="${n.inv_id}">Send</span>`}}]
function we(){return"player_id"in Ft()}function Re(){const t=function(){const t=_t({className:"hover fshXSmall",id:we()?"fshUserInv":"fshGuildInv"})
return s(r(),t),t}(),e=function(t){return $(t).DataTable({autoWidth:!1,columnDefs:[{targets:"_all",defaultContent:""},{targets:[1,4,5,6,7,8,9,10,12,13],orderSequence:["desc","asc"]}],columns:xe,createdRow:fe,data:Ft().items,deferRender:!0,lengthMenu:[[50,100,150,200,-1],[50,100,150,200,"All"]],pageLength:50,stateDuration:0,stateSave:!0})}(t)
return function(t){[[12,"current_player_id"in Ft()],[17,we()&&de()],[18,we()&&le()]].forEach((([e,n])=>t.column(e).visible(n)))}(e),t}function Le(t){k(`fsh_${i.subcmd}`,t)}function Me(){_('table.fshInvFilter input[type="checkbox"]').forEach((t=>{t.checked=1===oe().checkedElements[t.getAttribute("item")]})),Le(oe())}function Se(t){Kt("Select All"),oe().checkedElements=se,Me(),$(t).DataTable().draw(!1)}function Ee(t,e){oe().fshMinLvl=t,oe().fshMaxLvl=e,Le(oe())}function je(t){$(t).DataTable().draw(!1)}function Te(t){Kt("changeLvls"),It(Ee,u(je,t))}function De(t){return Number(t[0])>=100}function Ne(t,e){return t[e[0]]=e[1],t}function Ce(t){var e
Kt("Select None"),oe().checkedElements=(e=oe().checkedElements,v(e).filter(De).reduce(Ne,{})),Me(),$(t).DataTable().draw()}function Ae(t){Kt("Checkbox"),oe().checkedElements={},_('table.fshInvFilter input[type="checkbox"][item]:checked').forEach((t=>{oe().checkedElements[t.getAttribute("item")]=1})),Le(oe()),$(t).DataTable().draw(!1)}function Ge(t){Kt("Defaults"),oe().checkedElements=ee.checkedElements,Me(),$(t).DataTable().draw(!1)}function Ue(t){Kt("Reset levels"),oe().fshMinLvl=ee.fshMinLvl,oe().fshMaxLvl=ee.fshMaxLvl,Le(oe()),function(t){$("#fshMinLvl").val(oe().fshMinLvl),$("#fshMaxLvl").val(oe().fshMaxLvl),$(t).DataTable().draw(!1)}(t)}async function qe(t){const e=await yt(t)
return wt(e)}function Oe(t){return Mt({subcmd2:"dostoreitems",items:t})}async function Pe(t){const e=await I({cmd:"guild",subcmd:"inventory",subcmd2:"dostoreitems",storeIndex:t})
return St(e)}async function Be(t){const e=await function(t){return x(Oe,Pe,t)}(t)
return Et(e),wt(e)}function Fe(t,e){t.eq(e).empty()}function He(t,e){if(1===e.r)return
const n=t.closest("tr")
!function(t){[2,12,13,14,15,16].forEach(u(Fe,t))}($("td",n)),n.css("text-decoration","line-through")}async function We(t,e){w(e),function(t){t.closest("tr").find(".takeItem, .recallItem, .wearItem, .dropItem, .sendItem, .storeItem").removeClass()}(e),function(t){t.empty().append(`<img src="${R}ui/misc/spinner.gif" width="11" height="11">`)}(e)
const n=await t()
n&&He(e,n)}function Qe(t,e){zt("setName"),$(t).DataTable().search(e.attr("set")).draw(),$(`#${t.id}_filter input`).trigger("focus")}function Ve(t){zt("takeItem"),We(u(jt,t.attr("invid"),t.attr("action")),t)}function Ye(t){zt("recallItem"),We(u(Tt,t.attr("invid"),t.attr("playerid"),t.attr("mode"),t.attr("action")),t)}function Je(t,e,n,s){zt(n),We(u(t,e),s)}function Xe(t){Je(Be,[t.attr("invid")],"doStoreItem",t)}function Ke(t,e,n){Je(t,n.attr("invid"),e,n)}const ze=t=>Ke(Rt,"doUseItem",t),Ze=t=>Ke(Lt,"doWearItem",t)
function tn(t,e,n){Je(t,[n.data("inv")],e,n)}const en=t=>tn(vt,"doDropItem",t),nn=t=>tn(qe,"doSendItem",t),sn=t=>e=>t($(e.target))
function an(t,[e,n]){$(t).on("click",`span.${e}`,sn(n))}function rn(t){zt("doMoveItem")
const e=$(t.target)
gt([e.data("inv")],e.val())}function cn(t,e){$(e[0]).on("click",u(e[1],t))}const on=t=>()=>{zt(t)}
function dn(t){!function(t){[["#fshReset",Ue],["#fshAll",Se],["#fshNone",Ce],["#fshDefault",Ge]].forEach(u(cn,t))}(t),$("table.fshInvFilter").on("click",'input[type="checkbox"]',u(Ae,t)),function(t){[["dropItem",en],["recallItem",Ye],["sendItem",nn],["setName",u(Qe,t)],["storeItem",Xe],["takeItem",Ve],["useItem",ze],["wearItem",Ze]].forEach(u(an,t))}(t),function(t){["fshInvItem","fshMaroon","sorting"].forEach((e=>{$(t).on("click",`.${e}`,on(e))}))}(t)}let ln=0
function un(t,e){return Nt(ln,Ct(e[1]),oe().fshMinLvl,oe().fshMaxLvl)}function fn(){ln=[(t,e,n)=>0===n,...Dt],$.fn.dataTable.ext.search.push(un)}function pn(){$.fn.dataTable.ext.search.push(((t,e,n,s)=>!oe().checkedElements||oe().checkedElements[s.type]))}function mn(){$.fn.dataTable.ext.search.push(((t,e,n,s)=>!oe().checkedElements?.[-1]||function(t){return oe().checkedElements[-1]&&t.stats&&""!==t.stats.set_name}(s)))}function hn(){$.fn.dataTable.ext.search.push(((t,e,n,s)=>{const a=(parseInt(s.rarity,10)+100).toString()
return!oe().checkedElements||oe().checkedElements[a]}))}function bn(t){let e,n,s,a,i,r,c,o,d
return{c(){e=E("div"),n=E("div"),n.textContent="Recall all visible to",s=j(),a=E("div"),i=E("button"),i.textContent="BP",r=j(),c=E("button"),c.textContent="GS",T(n,"class","head svelte-1mlms3r"),T(i,"class","custombutton svelte-1mlms3r"),T(i,"type","button"),T(c,"class","custombutton svelte-1mlms3r"),T(c,"type","button"),T(a,"class","btnbox svelte-1mlms3r"),T(e,"class","main svelte-1mlms3r")},m(l,u){D(l,e,u),N(e,n),N(e,s),N(e,a),N(a,i),N(a,r),N(a,c),o||(d=[C(i,"click",t[0]),C(c,"click",t[1])],o=!0)},p:A,i:A,o:A,d(t){t&&G(e),o=!1,U(d)}}}function yn(t){const e=t=>{l("Inventory","Recall All",t)}
return[function(){e("toBp"),[..._('span[action="take"]'),..._('span[mode="0"][action="recall"]')].forEach(q)},function(){e("toGs"),_('span[mode="1"][action="recall"]').forEach(q)}]}class vn extends L{constructor(t){super(),M(this,t,yn,bn,S,{})}}function gn(t){let e,n,s,a,i,r,c,o,d,l=(t[0]||"")+"",u=(t[1]||"")+""
return{c(){e=E("div"),n=O("Chunks needed: "),s=E("span"),a=O(l),i=j(),r=E("div"),c=O("Chunks received: "),o=E("span"),d=O(u)},m(t,l){D(t,e,l),N(e,n),N(e,s),N(s,a),D(t,i,l),D(t,r,l),N(r,c),N(r,o),N(o,d)},p(t,e){1&e&&l!==(l=(t[0]||"")+"")&&B(a,l),2&e&&u!==(u=(t[1]||"")+"")&&B(d,u)},d(t){t&&(G(e),G(i),G(r))}}}function kn(t){let e,n,s,a,i,r,c,o,d,l,u,f,p,m,h,b,y,v,g,k,_,$=t[0]&&gn(t)
return{c(){e=E("div"),n=E("div"),s=O("Update Stats\n    "),a=E("div"),i=O("[\n      "),r=E("div"),c=E("span"),o=O("?"),d=O("\n      ]"),l=j(),u=E("div"),f=E("button"),f.textContent="On page",p=j(),m=E("button"),m.textContent="All",h=j(),b=E("div"),y=E("button"),y.textContent="Clear cache",v=j(),g=E("div"),$&&$.c(),T(c,"class","tooltip-multiline"),T(c,"data-tooltip",t[5]),T(r,"class","tooltip svelte-15yybge"),T(a,"class","wrapper svelte-15yybge"),T(n,"class","head svelte-15yybge"),T(f,"class","custombutton svelte-15yybge"),T(f,"type","button"),T(m,"class","custombutton svelte-15yybge"),T(m,"type","button"),T(u,"class","btnbox svelte-15yybge"),T(y,"class","custombutton svelte-15yybge"),T(y,"type","button"),T(b,"class","btnbox svelte-15yybge"),T(g,"class","chunkbox svelte-15yybge"),T(e,"class","main svelte-15yybge")},m(I,x){D(I,e,x),N(e,n),N(n,s),N(n,a),N(a,i),N(a,r),N(r,c),N(c,o),N(a,d),N(e,l),N(e,u),N(u,f),N(u,p),N(u,m),N(e,h),N(e,b),N(b,y),N(e,v),N(e,g),$&&$.m(g,null),k||(_=[C(f,"click",t[2]),C(m,"click",t[3]),C(y,"click",t[4])],k=!0)},p(t,[e]){t[0]?$?$.p(t,e):($=gn(t),$.c(),$.m(g,null)):$&&($.d(1),$=null)},i:A,o:A,d(t){t&&G(e),$&&$.d(),k=!1,U(_)}}}function _n(t,n,s){let{fshInv:a=0}=n
const r=new DataTable(a)
let c=0,o=0
async function d([t,e,n]){const a=await J(t,e,n)
return s(1,o+=1),a}async function u(t){const n=r.rows(H,t),a=W(Q(n.data()))
s(0,c=a.length),s(1,o=0)
const i=await e(a.map(d))
n.every(V(i.flatMap(Y))),r.draw()}const f=t=>{l("Inventory","Update Stats",t)}
P(a)
return t.$$set=t=>{"fshInv"in t&&s(6,a=t.fshInv)},[c,o,async function(){f("On page"),u({page:"current"})},function(){f("All"),u()},async function(){f("Clear cache"),await k(`fsh_${i.subcmd}_cache`,[]),q(F("fshRefresh"))},"This allows you to update the stats of items. It is useful in cases where stats are missing or if you want accurate stats for forged items. It can be slow for large data sets. The results are cached and will be used automatically next time you visit this page. You will need to update again if these stats become stale. For example, if you forged or crafted an item, or if a guild store item has moved.",a]}class $n extends L{constructor(t){super(),M(this,t,_n,kn,S,{fshInv:6})}}function In(t){let e
return{c(){e=E("div")},m(t,n){D(t,e,n)},p:A,i:A,o:A,d(t){t&&G(e)}}}function xn(t){let e,n,s,a
e=new vn({})
return{c(){X(e.$$.fragment),n=j(),s=et()},m(t,i){K(e,t,i),D(t,n,i),D(t,s,i),a=!0},p(t,e){},i(t){a||(z(e.$$.fragment,t),z(false),a=!0)},o(t){Z(e.$$.fragment,t),Z(false),a=!1},d(t){t&&(G(n),G(s)),tt(e,t)}}}function wn(t){let e,n,s,a,r,c
const o=[xn,In],d=[]
return n="guildinvmgr"===i.subcmd?0:1,s=d[n]=o[n](t),r=new $n({props:{fshInv:t[0]}}),{c(){e=E("div"),s.c(),a=j(),X(r.$$.fragment),T(e,"class","container svelte-1tjz5ud")},m(t,s){D(t,e,s),d[n].m(e,null),N(e,a),K(r,e,null),c=!0},p(t,[e]){s.p(t,e)
const n={}
1&e&&(n.fshInv=t[0]),r.$set(n)},i(t){c||(z(s),z(r.$$.fragment,t),c=!0)},o(t){Z(s),Z(r.$$.fragment,t),c=!1},d(t){t&&G(e),d[n].d(),tt(r)}}}function Rn(t,e,n){let{fshInv:s=0}=e
return t.$$set=t=>{"fshInv"in t&&n(0,s=t.fshInv)},[s]}class Ln extends L{constructor(t){super(),M(this,t,Rn,wn,S,{fshInv:0})}}function Mn(t){!function(t){new Ln({props:{fshInv:t},target:r()})}(t)}const Sn=()=>Ft().player_id?`<b>&nbsp;Inventory Manager</b> ${Ft().items.length} items (green = worn, blue = backpack)`:`<b>&nbsp;Guild Inventory Manager</b> ${Ft().items.length} items (maroon = in BP, blue=guild store)`
function En(){const t=Sn()
nt("",r()),function(){if(!Ot())return
Pt(s(F("pF"),at({style:{textAlign:"center"}})))}(),st(r(),ne.replace("@@reportTitle@@",t))}function jn(){At(Ft().items)&&En()}function Tn(){$("#fshMinLvl").val(oe().fshMinLvl),$("#fshMaxLvl").val(oe().fshMaxLvl)}const Dn=([,t])=>[t.id,t]
function Nn(t){dt([te,fn,pn,mn,hn,jn,Me,Tn])
const e=Re()
!function(t){$("#fshMinLvl, #fshMaxLvl").on("keyup",u(Te,t)),$(t).on("change","select.fshMoveItem",rn),dn(t),xt(t,on,zt)}(e),$("#fshRefresh").on("click",t),function(t){const e=$(`#${t.id}_filter input`)
e.prop("type","text")
const n=$("<span>&times;</span>")
e.wrap($('<span class="text-input-wrapper"/>')),e.after(n),n.on("click",u(Zt,t,e))}(e),Mn(e)}function Cn(t){Nn(t)}const An=()=>Object.getOwnPropertyNames(Ft()).length
async function Gn(n){const s=[lt(),Xt()]
"guildinvmgr"===i.subcmd&&s.push(async function(){await t(!1),i.membrList&&(i.membrList=ct(v(i.membrList).filter(Gt).map(Dn)))}()),s.push(async function(){const t=await f(`fsh_${i.subcmd}`)
ie={...pt(ee),...p(t,{})},re=m("showQuickDropLinks"),ce=m("showQuickSendLinks")}()),await e(s),An()&&function(t){ot(3,Cn,[t])}(n)}function Un(){!it()&&r()&&("guildinvmgr"!==i.subcmd||o())&&(nt(`<span id="fshInvMan"><img src = "${rt}">&nbsp;Getting inventory data...</span>`,r()),Gn(Un))}export{Un as default}
//# sourceMappingURL=inventory-PZcYcdty.js.map
