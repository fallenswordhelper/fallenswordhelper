import{a as Zt,b as te}from"./chunk-F6AKIFSR.js";import{a as Jt}from"./chunk-LASCLYJL.js";import{a as Yt}from"./chunk-PNVLVX53.js";import"./chunk-ACSNRXOV.js";import{a as _t,b as zt}from"./chunk-FF4VEH5U.js";import{a as Wt}from"./chunk-BRXG7WYJ.js";import{a as Qt}from"./chunk-WJZ2JRVV.js";import{a as Kt}from"./chunk-CUXKPZEX.js";import{a as w}from"./chunk-GOHIHN5O.js";import{a as _}from"./chunk-DOZB4EB3.js";import{a as Ft}from"./chunk-KQZWEXXU.js";import{a as Ot}from"./chunk-EA2RE2JR.js";import{a as qt}from"./chunk-HWYX7NEB.js";import"./chunk-XDA7R4DO.js";import{a as Xt}from"./chunk-I6W5AC6K.js";import"./chunk-DUWS5JIP.js";import"./chunk-JDX3PJWI.js";import{a as It}from"./chunk-6ZT3WHLZ.js";import{a as F}from"./chunk-NSIE2BGX.js";import{a as jt}from"./chunk-LT5JJUCH.js";import{a as Vt}from"./chunk-JDSHTCV6.js";import"./chunk-TY72DKY4.js";import{a as O}from"./chunk-LQA2QWW5.js";import{a as Gt}from"./chunk-S6D5RHY5.js";import{a as Ut}from"./chunk-EVDFCSED.js";import{a as kt}from"./chunk-GSQXO5YW.js";import"./chunk-AF5XS3UR.js";import{a as ut}from"./chunk-2WLRS4TM.js";import{a as q}from"./chunk-2LVJ7OMH.js";import{a as c}from"./chunk-MJ4TLF2J.js";import"./chunk-N6YFIN5D.js";import{a as x}from"./chunk-PEST2X2S.js";import{a as l}from"./chunk-W5TZOL5W.js";import"./chunk-NT4STL35.js";import{a as n}from"./chunk-MFU3L6UV.js";import{a as o}from"./chunk-NZDRUEQ7.js";import{a as vt}from"./chunk-NTMW32IA.js";import"./chunk-JYLJZMMH.js";import{a as yt}from"./chunk-SCNPNA6M.js";import{a as Tt}from"./chunk-46KDOJ4P.js";import{a as Bt}from"./chunk-4LBEXJWF.js";import{f as $}from"./chunk-JISJNNDC.js";import{a as Et}from"./chunk-7UPVBJI2.js";import{a as P}from"./chunk-UZ5AYIJF.js";import"./chunk-CJWUD3A7.js";import{a as R}from"./chunk-DVQ4HTUG.js";import{a as Lt}from"./chunk-AW7BR4RY.js";import"./chunk-GELOWOQR.js";import{a as Ct}from"./chunk-WDKM7RFE.js";import"./chunk-4Q2SRW7I.js";import{a as Rt,b as Mt,c as $t,d as Dt}from"./chunk-M77CHEQB.js";import"./chunk-3TOUNMHT.js";import"./chunk-4AZI4QQQ.js";import"./chunk-NBGTZWFP.js";import{a as Pt}from"./chunk-AL4KDQST.js";import"./chunk-X76JHTHA.js";import"./chunk-QNBBZPHD.js";import{a as C}from"./chunk-PE3FJ2RG.js";import{a as k}from"./chunk-ZCYTQ2UF.js";import{a as u}from"./chunk-Y65Z3XTF.js";import{a as Nt}from"./chunk-X2INWW4Q.js";import{a as At}from"./chunk-E5IM4RMA.js";import"./chunk-ZNKXZYAQ.js";import"./chunk-BSLTHMLI.js";import"./chunk-YO375HFG.js";import"./chunk-C7AAZRMQ.js";import"./chunk-2MNOMCC3.js";import"./chunk-WFSZD2EF.js";import{a as M}from"./chunk-ROGCWJM3.js";import"./chunk-PPVZKS76.js";import"./chunk-MVK2MUWC.js";import{a as St}from"./chunk-MNZWXHAO.js";import{a as D}from"./chunk-VNQGA6OZ.js";import"./chunk-J27NFZBK.js";import{a as Ht}from"./chunk-GVB5EEEL.js";import"./chunk-Z4DLYK4X.js";import{b as m}from"./chunk-Q224JHGT.js";import{a as f}from"./chunk-EKJRFQUL.js";import"./chunk-7KZSXEZV.js";import{a as X}from"./chunk-LQUQAOOA.js";import"./chunk-J7HJMT5D.js";import"./chunk-Y6VKRV7H.js";import"./chunk-QTXZJQPG.js";import{a as s}from"./chunk-NSORKVUP.js";import{a as xt,b as wt}from"./chunk-RWWHXXL2.js";import"./chunk-BYNMPNFU.js";import"./chunk-AIEFEA62.js";import"./chunk-QAN7R2R4.js";import"./chunk-TDBXMRU5.js";import"./chunk-BBWJJBGA.js";import{a as L}from"./chunk-6KVKWMOW.js";import{b as a}from"./chunk-ILOP54SQ.js";import{a as bt}from"./chunk-AGGFW4LO.js";import{a as p}from"./chunk-XGNI62R7.js";import{E as H,I as gt,La as ht,g as E,ra as T,ta as y,w as dt}from"./chunk-QFVOKILJ.js";import{a as S}from"./chunk-6ZU7XATI.js";var ee=0,re=1;function ve(t,e){let r=E.exec(e.dataset.tipped);return Bt({min:r[3],hour:r[2],day:r[1]})<44640&&(t[ee]+=1,t[re]+=Number(/Stamina:<\/td><td>(\d+)/.exec(e.dataset.tipped)[1])),t}function Se(t){return t.reduce(ve,[0,0])}function Q(){let t=C("b",m).find(P("Members"));if(t){let e=_t(),r=Se(e);t.classList.add("tip-static"),Xt(`Active: ${r[ee]}/${e.length}<br>Stamina: ${D(r[re])}`,t)}}function oe(t,e){let r=t.replace(/,/g,"").match(e);return r?parseInt(r[1],10):0}function Te(t,e){let r="";return t>e&&(r="+"),r+D(t-e)}function xe(t){let e=t.dataset.tipped,r=oe(e,/XP Lock: <b>(?<lockXp>\d*)/),i=oe(e,/XP: <b>(?<realXp>\d*)/);l(t.parentNode.nextElementSibling,` (<b>${Te(i,r)}</b>)`)}function z(){let t=u('#pCC a[data-tipped^="<b>Guild XP</b>"]');t&&xe(t)}function W(){let t=C(y,m).slice(-2,-1)[0].rows[0].cells[0],e=n({id:"profile-bio",innerHTML:t.innerHTML});f("",t),o(t,e),Wt()}var J,Y;function we(t){return J&&t>=Rt()&&t<=Mt()}function Ne(t){return Y&&t>=$t()&&t<=Dt()}var Ae=t=>[t,E.exec(t.dataset.tipped)[1]],Be=([,t])=>t<7,Ee=([t])=>[t,Number(/VL:.+?(\d+)/.exec(t.dataset.tipped)[1])],He=([t,e])=>[t.parentNode.parentNode.rowIndex,we(e),Ne(e)];function Pe(){return R('#pCC a[data-tipped*="<td>VL:</td>"]').map(Ae).filter(Be).map(Ee).map(He)}function Re(){return Number(kt("guild_id"))!==Pt()&&(J||Y)}var ie=t=>t.map(([e])=>`.fshHighlight tr:nth-child(${e+1})`).join(",");function Me(t){if(t.length){let e=`${ie(t)} {background-color: #4671C8;}`;o(document.body,w(e))}}function $e(t){if(t.length){let e=`${ie(t)} {background-color: #FF9900;}`;o(document.body,w(e))}}function De(t,e){if(t.length+e.length){let r=k(y,m);r[r.length-1].classList.add("fshHighlight")}}function Ie(){let t=Pe(),e=t.filter(([,i])=>i),r=t.filter(([,i,v])=>!i&&v);Me(e),$e(r),De(e,r)}function Ge(){Re()&&Ie()}function Z(){J=a("highlightPlayersNearMyLvl"),Y=a("highlightGvGPlayersNearMyLvl"),Ge(),a("enableHistoryCompressor")&&W()}function je(t){l(t.parentNode,' <span class="smallLink">[b]</span>')}function Ve(t){t.target.className==="smallLink"&&Vt(jt(t.target.previousElementSibling.href))}function K(){let t=Lt(`#pCC a[href^="${dt}"]`);Qt([3,t,0,je]),L(m,Ve)}function I(t){return At({cmd:"guild",subcmd:"conflicts",page:t})}function ne(t,e){f(e,t.insertCell(-1))}function me(t,e,r){let i=t.insertRow(t.rows.length-2);ne(i,e),ne(i,r)}function Ue(t){me(t,`<a href="${H}conflicts">Active Conflicts</a>`,"Score")}function qe(t,e){me(t,e.cells[0].innerHTML,`<b>${e.cells[6].innerHTML}</b>`)}function Xe(t,e,r){e===1&&Ue(r),qt(t,7,0).forEach(s(qe,r))}function Fe(t,e,r){let i=u("#pCC > table > tbody > tr > td > table",t);i&&i.rows.length>3&&Xe(i,e,r)}function Oe(t){return Number(t.nextSibling.textContent.split("\xA0")[2])}function _e(t,e,r){I(t+1).then(s(e,r))}function ae(t,e){let r=Nt(e),i=u('#pCC input[name="page"]',r);if(!i)return;let v=Number(i.value),Le=Oe(i);Fe(r,v,t.node),Le>v&&_e(v,ae,t)}function tt(t){let[e]=t.rows[6].cells[0].children;e&&I(1).then(s(ae,{node:e}))}function Qe(t){t.target.id===T&&M(T,!a(T))}function et(){let t=u("#pCC img.guild_openGuildStore");if(!t)return;let e=t.parentNode,r=n({className:"fsh-tracker"}),i=n({innerHTML:`${$(T)}&nbsp;<label class="custombutton" for="tracker">Show</label>`});p(i,"change",Qe),o(r,t),o(r,i),Ut(e,r)}function rt(t){return vt("th",t)}var ot,G,A,it,j;function Ke(t,e){return`${t}<option value="${e}">${e}</option>`}function tr(t){return`<select name="member"><option value="- All -" selected>- All -</option>${X(t).sort(Ht).reduce(Ke,"")}</select>`}function N(t){return bt(t)?"#DEF":t.toLocaleString()}function er(t){return G&&G!=="- All -"&&G!==t}function rr(t,e,r){return`${e}<tr><td>${Yt(new Date(r[4]*1e3))}</td><td>${t}</td><td class="fshRight">${N(r[2])}</td><td class="fshRight">${N(r[5])}</td><td class="fshRight">${N(r[1])}</td><td class="fshRight">${N(r[3])}</td><td class="fshRight">${Math.floor(r[1]/r[3]*100)}</td><td class="fshRight">${r[0]}</td><td class="fshRight">${N(r[6])}</td></tr>`}function or(t,e){return er(e)?t:t+j[e].reduce(s(rr,e),"")}function ir(){return X(j).reduce(or,"")}function nr(){j&&f(ir(),ot),A.classList.remove("fshSpinner")}function se(){A.classList.add("fshSpinner"),c(3,nr)}function mr(t){G=t.target.value,se()}function V(t){t&&(j=t,f(tr(t),it),se())}function ar(){let t=rt({textContent:"Member"});return it=n(),o(t,it),t}function lr(t){let e=t.createTHead().insertRow(-1);l(e,"<th>Date</th>");let r=ar();o(e,r),l(e,"<th>Level</th><th>VL</th><th>Stam</th><th>Max<br>Stam</th><th>Stam<br>%</th><th>Last<br>Activity<br>(Days)</th><th>GXP</th>")}function cr(t){ot=Jt(),o(t,ot)}function fe(){let t=Ft({id:"tg"});return lr(t),cr(t),p(t,"change",mr),A=n({className:"tgCont fshSpinner64"}),o(A,t),A}var d,pe,ue,g;function sr(t){d.value=t,g.classList.remove("fshSpinner")}function ge(t){t&&(g.classList.add("fshSpinner"),c(4,sr,[t]))}function fr(){d.value='{"lastUpdate": 0, "members": {}}'}function pr(t){_("Update successful"),V(t.members)}function ur(){let t=yt(d.value);wt("fsh_guildActivity",t).then(s(pr,t)).catch(_)}function de(t,e){let r=Ot({className:"custombutton",textContent:t});return L(r,e),r}function dr(){d=Kt(),d.setAttribute("autocapitalize","off"),d.setAttribute("autocomplete","off"),d.setAttribute("autocorrect","off"),d.setAttribute("spellcheck","false")}function he(){return g=n({id:"io",className:"fshSpinner64"}),dr(),pe=de("Save",ur),ue=de("Reset",fr),o(g,d),o(g,Zt()),o(g,pe),o(g,ue),g}var mt,h,B,nt;function be(){return!h.checked}function gr(){return h.checked}function hr(){h.checked=!1}function br(t){gr()&&t.code==="Escape"&&hr()}function yr(t){be()&&(t.style.transform=null)}function kr(){return It({className:"fshMove ui-tabs-nav ui-widget-header ui-corner-all ui-helper-reset ui-helper-clearfix",innerHTML:'<li class="ui-state-default ui-corner-top"><label class="fsh-tab-label" for="acttab1">Guild Activity Tracker</label></li><li class="ui-state-default ui-corner-top"><label class="fsh-tab-label" for="acttab2">Import/Export</label></li><label for="tracker" class="fsh-dialog-close ui-dialog-titlebar-close">&times;</label>'})}function Cr(){x("guildTracker","updateRawData"),mt&&ge(mt)}function Lr(){let t=n({className:"fsh-dialog-popup ui-dialog ui-tabs ui-widget ui-widget-content ui-corner-all",innerHTML:'<input id="acttab1" class="fsh-tab-open" name="acttabs" checked type="radio">'});return nt=F({className:"fsh-tab-open",id:"acttab2",name:"acttabs",type:"radio"}),q(nt,"change",Cr),o(t,nt),t}function vr(){let t=Lr(),e=kr();return o(t,e),ut(e,t),t}function Sr(){let t=n({className:"fsh-dialog-content"});return o(t,fe()),o(t,he()),t}function Tr(){let t=vr(),e=Sr();o(t,e),p(h,"change",s(yr,t)),o(B,t)}function xr(){l(B,'<div class="fsh-dialog-overlay"><label class="fsh-dialog-cancel" for="tracker"></label></div>')}function wr(t){t&&(mt=Tt(t),V(t.members))}function Nr(){x("guildTracker","openDialog"),xt("fsh_guildActivity").then(wr),S.dialogIsClosed=be,xr(),Tr()}function Ar(){h=F({id:"tracker",className:"fsh-dialog-open",type:"checkbox"}),q(h,"change",Nr),B=n({className:"fsh-dialog"}),o(B,h),p(document.body,"keydown",br),o(document.body,B)}function at(){et(),Ar()}var lt=0;function Br(t){let e=t.dataset.tipped.match(/Stamina:<\/td><td>(?<stam>\d{1,12}) \/ (?<max>\d{1,12})<\/td>/);return Math.min(Math.round(Number(e[1])/Number(e[2])*100),100)}function Er(t){let e=Br(t);return`.fshProgressBar tr:nth-child(${t.parentNode.parentNode.rowIndex+1}) {background-image: linear-gradient(to right, rgba(255, 153, 0, 0.5) ${e}%, transparent ${e+1}%)}`}function Hr(){let t=k(y,m),e=t[t.length-1];e.classList.add("fshProgressBar");let i=R(ht,e).map(Er).join(`
`);lt=o(document.body,w(i)).sheet}function U(t){lt?lt.disabled=!t:Hr()}var ct="enableStamBars",b=0;function Pr(){b=!b,M(ct,b),U(b),x("guildManage","StamBars")}function Rr(){if(!u("#pCC img.guild_openGuildStore"))return;let e=o(m,n({innerHTML:$(ct),style:{marginLeft:"66%"}}));p(e,"change",Pr)}function st(){Rr(),b=a(ct),b&&U(b)}function Mr(t){return O({className:"fshLink",dataset:{linkto:t,tooltip:"Toggle Section"},textContent:"X"})}function $r(t){let e=O({className:"fshNoWrap",innerHTML:"[&nbsp;"});return o(e,t),l(e,"&nbsp;]"),e}function ft(t,e,r){let i=Mr(r);o(t,$r(i)),e.id=r,a(r)&&Gt(e),L(i,te)}function ye(t){ft(t.rows[0].cells[1].children[0],t.rows[2].cells[0].children[0],"guildLogoControl")}function ke(t){let e=t.rows[4].cells[1].children[0];f(Ct(e.innerHTML),e),ft(e,t.rows[6].cells[0].children[0],"statisticsControl")}function Ce(t){let e=t.rows[15]?.cells[1].children[0];e&&ft(e,t.rows[17].cells[0].children[0],"guildStructureControl")}function Dr(t){let e=C("b",t).filter(P("Relics"));if(e.length!==1)return;let r=e[0].parentNode.nextElementSibling.children[0];f(`[ <a href="${H}reliclist">Control</a> ]&nbsp;`,r)}function Ir(t){let e=k("li",t);if(!e||!e.length)return;let r=e[e.length-1].parentNode;l(r,`<li><a href="${gt}${Et()}" data-tooltip="Self Recall">Self Recall</a></li>`)}function Gr(){return m.lastElementChild.rows[2].cells[0].children[0]}function jr(t,e){c(3,e,[t])}function Vr(t){[ye,ke,Ce,Dr,Ir].forEach(s(jr,t))}function Ur(t){St()||(a("detailedConflictInfo")&&c(3,tt,[t]),c(4,at))}function pt(){if(!m)return;let t=Gr();Vr(t),a("showBuffLinks")&&c(3,K),Ur(t),st()}function qr(){c(3,zt),c(3,z),c(3,Q),["-","manage"].includes(S.subcmd)&&pt(),S.subcmd==="view"&&Z()}export{qr as default};
//# sourceMappingURL=injectGuild-GSRUNAMF.js.map
