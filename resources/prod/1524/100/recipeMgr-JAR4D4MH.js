import{a as G}from"./chunk-DA6DS34W.js";import{a as V}from"./chunk-ISCNUKL2.js";import{a as w}from"./chunk-GL2JM7PT.js";import{a as y}from"./chunk-EWKAFMUH.js";import{a as s}from"./chunk-YCLUS5KN.js";import"./chunk-JIU2ZQ7U.js";import{a as _}from"./chunk-OE36OPV6.js";import{a as j}from"./chunk-CGNOQGJE.js";import"./chunk-VLTGAALF.js";import{c as L}from"./chunk-4JZPKQQU.js";import"./chunk-2IK5DI2L.js";import"./chunk-YIGOP5YW.js";import"./chunk-3DBYCCIU.js";import"./chunk-ORS7RZTA.js";import{b as S}from"./chunk-MCG7PUE5.js";import{a as g}from"./chunk-T2VZIH7R.js";import{a as b}from"./chunk-QGMSNVNO.js";import{a as M}from"./chunk-V33BE362.js";import{a as l}from"./chunk-FF3XNQMK.js";import{a as D}from"./chunk-PGIARPJZ.js";import"./chunk-F6PWUOK3.js";import{a as U}from"./chunk-QDSVKE5U.js";import{a as x}from"./chunk-GDRAS4TK.js";import"./chunk-LRBN5EPE.js";import"./chunk-JBM326AL.js";import{a}from"./chunk-AWX7T366.js";import{a as Q}from"./chunk-S6W3GI6A.js";import"./chunk-3D277W4L.js";import{a as c}from"./chunk-JUP5RL3F.js";import"./chunk-HEIWEESD.js";import"./chunk-EPLN5MO7.js";import"./chunk-OAFPCVC2.js";import{a as O,b as I}from"./chunk-6ZRACZU5.js";import"./chunk-57W4LSPW.js";import"./chunk-NIBRUHHR.js";import"./chunk-FTO2ZBWK.js";import{a as q}from"./chunk-NVW4NMP3.js";import"./chunk-K3FFRUMO.js";import"./chunk-GUMMI6ND.js";import{a as H}from"./chunk-CPWTUMEP.js";import{b as E}from"./chunk-VXJUTFBI.js";import{g as C}from"./chunk-6CCTYJXE.js";import{a as R}from"./chunk-M5HK4G4Q.js";import"./chunk-CSUKS4GS.js";import"./chunk-TGZ7LJUR.js";import{b as d}from"./chunk-FTXPWRDQ.js";import{a as i}from"./chunk-PTNJTFVL.js";import"./chunk-W2YYCP36.js";import"./chunk-TSMX3MI2.js";import"./chunk-X5GPKOZG.js";import"./chunk-7V4YID4M.js";import"./chunk-BSKKCHEC.js";import"./chunk-UCDZC42X.js";var v=0,J=[];function X(t){return`<div class="rmItem"><img class="tip-dynamic" data-tipped="fetchitem.php?item_id=${t.id}&inv_id=-1&t=2&p=${v}&vcode=${t.verify}" src="${t.img}" height="20px" width="20px"><p>${t.amountPresent}/${t.amountNeeded}</p></div>`}var z=t=>t?t.map(X).join(""):"";function Y(t){return t.target?` <img class="tip-dynamic" data-tipped="fetchitem.php?item_id=${t.target.id}&inv_id=-1&t=2&p=${v}&vcode=${t.target.verify}" src="${t.target.img}" height="30px" width="30px"><br/>`:""}function Z(t){return!J.includes(t.name)}function tt(t){return`<tr class="rmTr"><td class="rmTd"><a href="${t.link}"><img src="${t.img}" height="30px" width="30px"></a></td><td class="rmTd"><a href="${t.link}">${t.name}</a></td><td class="rmTd">${z(t.items)}</td><td class="rmTd">${z(t.components)}</td><td class="rmTd">${Y(t)}</td></tr>`}function et(t,r){v=w();let e='<table width="100%"><tr class="rmTh"><th>Recipe</th><th><span id="sortName" class="fshLink" sortkey="name">Name</span></th><th>Items</th><th>Components</th><th>Target</th></tr>';e+=r.recipe.filter(Z).map(tt).join(""),e+="</table>",g(e,t),I("fsh_recipeBook",r)}function u(t,r){r&&(E("hideRecipes")&&(J=V("hideRecipeNames")),et(t,r))}function h(t){return R('#pCC img[src*="/folder"]',t)}function rt(t){return x("td",b("pCC",t))}function ot(t,r){let e=r.getAttribute("background");return e&&e.includes(t)}function nt(t){let{itemId:r,vcode:e}=U(C,t.dataset.tipped);return{img:t.getAttribute("src"),id:r,verify:e}}function it(t,r){if(r){let e=c(r).split("/");t.amountPresent=parseInt(e[0],10),t.amountNeeded=parseInt(e[1],10)}}function mt(t){let r=t.children[0].children[0],e=nt(r);return it(e,t.parentNode.nextElementSibling),e}function P(t,r){return t.filter(i(ot,r)).map(mt)}function $(t,r,e,o){let n=a(o);s(t,`Parsing blueprint ${e.name}...<br>`);let f=rt(n);e.items=P(f,"/inventory/2x3."),e.components=P(f,"/inventory/1x1mini."),[e.target]=P(f,"/hellforge/2x3."),r.recipe.push(e)}function st(t){return R('#pCC a[href*="=viewrecipe&"]',t)}function at(t){return{img:t.parentNode.previousElementSibling.children[0].getAttribute("src"),link:t.href,name:c(t),id:y(t.search,"recipe_id")}}async function pt(t,r,e){s(t,`Found blueprint "${c(e)}".<br>`);let o=at(e),n=await d(e.href);$(t,r,o,n)}function A(t,r,e){let o=a(e),n=st(o).map(i(pt,t,r));return l(n)}function ct(t){return/\/folder_on\./.test(t.getAttribute("src"))}function ft(t){return h(t).find(ct).parentNode.href}function dt(t,r){return r!==0}function lt(t){return t.value}function ut(t){return x("option",D("customselect",b("pCC",t))[0]).filter(dt).map(lt)}async function gt(t,r,e){let o=await d(`${t}&page=${e}`);return r(o)}function ht(t,r,e){return ut(t).map(i(gt,r,e))}function F(t,r,e){let o=a(e),n=ft(o),f=i(A,t,r),B=ht(o,n,f);return B.push(f(e)),l(B)}function bt(t){return y(t.parentNode.search,"folder_id")!=="-1"}function yt(t,r){let e=c(r.parentNode.parentNode.nextElementSibling),o=/quest/i.test(e);return o&&s(t,`Skipping folder "${e}"  as it has the word "quest" in folder name.<br>`),!o}async function xt(t,r){let e=await d(r.parentNode.href);return t(e)}function It(t,r,e){let o=a(r);return h(o).filter(bt).filter(i(yt,t)).map(i(xt,e))}function T(t,r,e){let o=i(F,t,r),n=It(t,e,o);return n.push(o(e)),l(n)}var m=0,p=0,k=()=>m,K=()=>p;function Rt(){s(p,"Finished parsing ... formatting ..."),I("fsh_recipeBook",m),u(p,m)}async function N(){m={},m.recipe=[],g("<br>Parsing inventing screen ...<br>",p);let t=await Q({cmd:"inventing"});T(p,m,t),Rt()}function W(t,r){m=r,g('<table class="fshInvFilter"><thead><tr><th width="90%"><b>&nbsp;Recipe Manager</b></th><th width="10%" class="fshBtnBox">[<span id="rfsh" class="fshLink">Refresh</span>]</th></tr></thead></table>',t),p=_(),j(t,p),m?u(p,m):N()}function vt(t){G(t),k().recipe.sort(L),u(K(),k())}var Pt=[["rfsh",N],["sortName",vt]];async function $t(t){if(q())return;let r=t||S(),e=await O("fsh_recipeBook");W(r,e),H(r,M(Pt))}export{$t as default};
//# sourceMappingURL=recipeMgr-JAR4D4MH.js.map
