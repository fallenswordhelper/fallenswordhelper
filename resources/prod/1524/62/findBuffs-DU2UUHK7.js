import{a as p}from"./chunk-Q4DWWJPE.js";import{b as W}from"./chunk-ILTMC3ON.js";import{c as J}from"./chunk-PQV7MLDM.js";import{a as Z}from"./chunk-7ONOIJO4.js";import{a as Y}from"./chunk-K6MZKY6U.js";import{a as X}from"./chunk-V3AM6ELX.js";import{a as _}from"./chunk-SS3QYSR2.js";import"./chunk-6HCREAXP.js";import{a as C}from"./chunk-TTIL6Q2Q.js";import"./chunk-CYTNSAKG.js";import"./chunk-4KBBARFN.js";import{a as B}from"./chunk-57Z3RMCJ.js";import"./chunk-COCD6PSO.js";import{a as w}from"./chunk-RJN2VE6Z.js";import{a as K}from"./chunk-SXJ2GCOL.js";import{a as U}from"./chunk-IXAZ6GFZ.js";import{a as L}from"./chunk-YIEWHY6V.js";import{a as c}from"./chunk-7XTGUVW5.js";import{a as z}from"./chunk-CF4P6XS2.js";import"./chunk-AH5EZJ7R.js";import"./chunk-G3R5NAPB.js";import{a as I}from"./chunk-CQ3PZTYF.js";import{a}from"./chunk-C5OE7PQU.js";import"./chunk-RY5JB5JV.js";import{a as E}from"./chunk-XDUXVHJP.js";import"./chunk-ZOPLLTNB.js";import"./chunk-HTCI2HHR.js";import{a as Q}from"./chunk-5AABVCBG.js";import{c as ee}from"./chunk-CBUWKPHX.js";import"./chunk-456CPU7X.js";import"./chunk-4VL7TVGR.js";import{b as v}from"./chunk-QOWOSZRG.js";import{a as i}from"./chunk-3WYOJJSD.js";import{a as n}from"./chunk-FM7OJ7NO.js";import"./chunk-YBC6MMGI.js";import"./chunk-U546IVLZ.js";import"./chunk-DXI2WUUD.js";import{a as f}from"./chunk-JQPK3YVC.js";import"./chunk-HT7PAWAR.js";import"./chunk-T34QP7UC.js";import"./chunk-WHLURLGI.js";import"./chunk-M6FQTS4T.js";import{a as T}from"./chunk-VU3PZWN5.js";import{a as A}from"./chunk-2URZ55LX.js";import{b}from"./chunk-FTOV4GKD.js";import"./chunk-NY6FBFCL.js";import"./chunk-UWALNOSV.js";import"./chunk-27JTUOQX.js";import{a as q}from"./chunk-POXCGSYQ.js";import{Fa as G,P as j,g as H,w as O}from"./chunk-M72CYKCS.js";import{a as x}from"./chunk-ZP7KCDX3.js";function S(){return z({cmd:"guild",subcmd:"manage"})}function ye(e){return`<tr><td rowspan="2" colspan="2" class="headCell"><h1>Find ${e.header}</h1></td><td class="findLabel">Select ${e.what} to search for:</td><td>${e.control()}</td></tr>`}function Pe(e){return`<tr><td class="findLabel">Level ${e.cutoff}ers only:</td><td><input id="level175" type="checkbox"></td></tr>`}function xe(e){return`<tr><td class="leftLabel">${e.searched}:&nbsp;</td><td id="buffNicks">&nbsp;</td><td class="findLabel">Search guild members:</td><td><input id="guildMembers" type="checkbox" checked></td></tr>`}function ve(){return J("Search Allies/Enemies","The checkbox enables searching your own personal allies/enemies list for buffs.<br><br>Additional profiles to search can be added in the text field to the right, separated by commas.")}function Le(e,t){return`<tr><td class="findLabel"># potential ${e.potential}ers to search:&nbsp;</td><td id="potentialBuffers"></td><td class="findLabel">Search allies/enemies:${ve()}</td><td><input id="alliesEnemies" type="checkbox" checked><input class="extraProfile" class="custominput" id="extraProfile" type="text" title="Extra profiles to search" value="${t||""}"></td></tr>`}function $e(e){return`<tr><td class="findLabel"># ${e.processed}ers processed:&nbsp;</td><td id="buffersProcessed">0</td><td class="findLabel">Search online list:</td><td><select class="selectOnline" id="onlinePlayers"><option value="0">Disabled</option><option value="49">Short (fastest)</option><option value="47">Medium (medium)</option><option value="45">Long (slowest)</option></select></td></tr>`}function Be(e){return`<tr><td class="findLabel">Find ${e.progress} progress:&nbsp;</td><td class="buffProg" id="bufferProgress">Idle</td><td align="center"><input id="clearresultsbutton" class="custombutton" type="button" value="Clear Results"></td><td align="center"><input id="findbuffsbutton" class="custombutton" type="button" value="Find Buffers"></td></tr>`}function Ce(e){return`<br><h1>Potential ${e.processed}ers and Bio Info</h1><br><table class="fshResult" id="buffTable"><tbody><tr><th class="nameCol">&nbsp;Name</th><th class="infoCol">&nbsp;Player Info</th><th>&nbsp;Notable Bio Text</th></tr></tbody></table><br>`}function Te(){return'<div class="disclaim">Disclaimer: This functionality does a simple text search for the terms above. It is not as smart as you are, so please do not judge the results too harshly. It does not search all online players, just a subset of those that have been on recently. The aim is to be fast and still return a good set of results. This feature is a work in progress, so it may be tweaked and enhanced over time.</div>'}function g(e,t){return`<table class="fshFind"><tbody>${ye(e)}${Pe(e)}${xe(e)}${Le(e,t)}${$e(e)}${Be(e)}</tbody></table>${Ce(e)}${Te()}`}var k;function N(){k=n("bufferProgress")}function l(e,t){i(e,k),t&&(k.style.color=t)}var Ae=/Level<br>(\d+)%/;function Ee(e,t){let r=new RegExp(`^.*\\b(?:(?:${t.replace(/,/g,")|(?:")}))\\b.*$`,"gim");return[...e.matchAll(r)].map(o=>o[0])}function Ie(e){let t=U("a",n("profileLeftColumn",e)).find(_("Sustain"));if(t){let r=t.parentNode.parentNode.parentNode.nextElementSibling.children[0].dataset.tipped;return parseInt(Ae.exec(r)[1],10)||-1}return 0}function we(e){return a(L("h1",n("pCC",e))[0])}function Se(e){return K(a(n("profileLeftColumn",e).children[4].children[0].rows[0].cells[1]))}function ke(e){return parseInt(a(n(G,e)),10)}function Ne(e,t,r,o){let s=we(e),D=Se(e),d=ke(e),me=parseInt(r[1],10),he=W({min:me}),be=t.href,ge=o.replace(/'|"|\n/g,"");return`<nobr>${he}&nbsp;<a href="${be}" target="new" class="tip-static" data-tipped="${ge}">${s}</a>&nbsp;<span class="fshBlue">[<span class="a-reply fshLink" target_player="${s}">m</span>]</span></nobr><br><span class="fshGrey">Level:&nbsp;</span>${D}&nbsp;(${d})`}function Me(e){window.openQuickMsgDialog(e.target.getAttribute("target_player"))}function Re(e){let t=e.newRow.insertCell(0);t.style.verticalAlign="top",i(Ne(e.doc,e.callback,e.lastActivity,e.bioCellHtml),t),$(".a-reply").on("click",Me)}function Fe(e,t,r){let o="fshRed";t>=100&&(o="fshGreen");let s='<span class="fshRed">No</span>';return r&&(s='<span class="fshGreen">Yes</span>'),`<table><tbody><tr><td colspan="2" class="resAct">Last Activity:</td><td colspan="2"><nobr>${e[0]}</nobr></td></tr><tr><td class="resLbl">Sustain:</td><td class="resVal ${o}">${t}%</td><td class="resLbl">Extend:</td><td class="resVal">${s}</td></tr>`}function Ve(e,t,r,o){let s=e.insertCell(1);i(Fe(t,r,o),s),s.style.verticalAlign="top"}function De(e,t){e.innerHTML+=`${t}<br>`}function He(e,t){let r=e.insertCell(2);t.forEach(f(De,r))}function Oe(){let e=n("buffersProcessed"),t=parseInt(a(n("potentialBuffers")),10),r=parseInt(a(e),10);i(r+1,e),t===r+1&&l("Done.","blue")}function je(e){let t=n("pCC",e),r=L("p",t)[0];return/(\d{1,2}) mins, (\d{1,2}) secs/.exec(a(r))}function Ge(e){return X('img.tip-static[data-tipped*="Extend"]',e)}function qe(e,t,r,o){let s=je(r),d=n("buffTable").insertRow(-1);Re({newRow:d,doc:r,callback:t,lastActivity:s,bioCellHtml:e}),Ve(d,s,Ie(r),Ge(r)),He(d,o)}function M(e,t){let r=c(e),o=n("profile-bio",r).innerHTML,s=Ee(o,t.findBuffNicks);s.length>0&&qe(o,t,r,s),Oe()}function Ue(e){return`<option value="${e.id}">${e.name}</option>`}var te={header:"Buff",what:"buff",control(){return`<select style="width:140px;" id="selectedBuff">${p.map(Ue).join("")}</select>`},cutoff:"175 buff",searched:"Nicknames of buff searched",potential:"buff",processed:"Buff",progress:"buffers"},re={header:"Other",what:"text",control(){return`<input style="width:140px;" class="custominput" id="textToSearchFor" type="text" title="Text to search for" value="${b("textToSearchFor")||""}">`},cutoff:"500+ play",searched:"Text searched for",potential:"play",processed:"Play",progress:"Other"};var ne;function R(){return ne?500:1}function oe(){ne=n("level175").checked}var y,P,m,F,u,h,V;function _e(e,t){M(t,{href:e,findBuffNicks:y})}function Qe(e){I(e).then(f(_e,e))}function se(){if(i(m.length,n("potentialBuffers")),m.length<=0){l("Done.","blue");return}l("Parsing player data ...","green"),m.forEach(Qe)}function Ye(e,t){return e===1?Math.round(F*t/50):e+1}function ie(e,t){Z()!==B(t)&&m.push(e)}function ze(e){return parseInt($(e).find("td:eq(2)").text().replace(/,/g,""),10)}function Je(e){return e>=P&&e>=R()}function Ke(e,t){if(Je(ze(t))){let r=$(t).find("td:eq(1) a").attr("href"),o=$(t).find("td:eq(1) a").text();ie(r,o)}}function We(e){return parseInt($(e).find('td:has(input[name="page"]):last').text().replace(/\D/g,""),10)}function Xe(e){return parseInt($(e).find('input[name="page"]:last').val().replace(/\D/g,""),10)}function Ze(e){$(e).find('table:contains("Username")>tbody>tr:has(td>a[href*="cmd=profile&player_id="])').each(Ke)}function et(e,t,r){let o=Ye(e,t);l(`Parsing online page ${e} ...`),w(o).then(r)}function ae(e){let t=c(e),r=Xe(t);r!==1&&Ze(t);let o=We(t);r<o?et(r,o,ae):se()}function le(){F=parseInt(n("onlinePlayers").value,10),F!==0?w(1).then(ae):se()}function tt(e){let t=H.exec(e),r=parseInt(t[1],10),o=parseInt(t[2],10)+r*24;return parseInt(t[3],10)+o*60}function rt(e,t,r){return e<5&&t>=P&&t>=r}function fe(e){let{tipped:t}=e.dataset,r=tt(t),o=Number(/VL:.+?(\d+)/.exec(t)[1]),s=R();rt(r,o,s)&&ie(e.href,a(e))}function nt(e){let t=c(e);C('#profileLeftColumn a[data-tipped*="Last Activity"]',t).forEach(fe),V+=1,V===h.length&&le()}function ot(e){h.push(j+e)}function st(e){I(e).then(nt)}function it(){h=[],h.push(O),Y(u).forEach(ot),V=0,n("alliesEnemies").checked?h.forEach(st):le()}function at(e){let t=c(e);n("guildMembers").checked&&C('#pCC a[data-tipped*="<td>VL:</td>"]',t).forEach(fe),it()}function lt(e,t){return t!==0}function ft(e){e.deleteRow(-1)}function ct(){let e=n("buffTable");q(e.rows).filter(lt).forEach(f(ft,e)),i("",n("buffNicks")),l("Idle.","black"),i("",n("potentialBuffers")),i("0",n("buffersProcessed"))}function ce(e){Q()||(i(y,n("buffNicks")),l(`Gathering list of ${e} ...`,"green"),oe(),i("0",n("buffersProcessed")),m=[],u=n("extraProfile").value,E("extraProfile",u),S().then(at))}function ut(e,t){return e===t.id}function dt(){let e=parseInt($("#selectedBuff").val(),10),t=p.find(f(ut,e));y=t.nicks,P=t.lvl,ce("potential buffers")}function pt(){let e=$("#textToSearchFor").val().split(",").map(B).join(",");E("textToSearchFor",e),y=e,P=1,ce("profiles to search")}function ue(){u=b("extraProfile")}function de(e){A(n("findbuffsbutton"),e,!0)}function pe(){A(n("clearresultsbutton"),ct,!0)}function mr(e){let t=e||v;x.sortBy="name",x.sortAsc=!0,p.sort(ee),ue(),i(g(te,u),t),N(),de(dt),pe(),T("ui-dialog-titlebar-close").forEach(r=>r.blur())}function hr(e){let t=e||v;ue(),i(g(re,u),t),N(),de(pt),pe(),T("ui-dialog-titlebar-close").forEach(r=>r.blur())}export{u as extraProfile,mr as injectFindBuffs,hr as injectFindOther};
//# sourceMappingURL=findBuffs-DU2UUHK7.js.map
