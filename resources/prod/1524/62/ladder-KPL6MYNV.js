import{O as y,P,T as K,U as Q,a,b as z,d as G,o as v,p as u,q as f,s as p,u as J,v as S,w as F,y as g}from"./chunk-5AZ2HWTX.js";import{a as X}from"./chunk-V6GAZ7PZ.js";import"./chunk-DW5XDJCZ.js";import{a as Y}from"./chunk-DL66VPIS.js";import{a as I}from"./chunk-TNC2Z5WR.js";import"./chunk-BWU6C5Z3.js";import{a as B}from"./chunk-EHOBQCEV.js";import{a as L}from"./chunk-VML6VTTW.js";import{a as U}from"./chunk-73BUZD3L.js";import{a as W}from"./chunk-5RCOVVCV.js";import{a as j}from"./chunk-IPXXUBBR.js";import{a as w}from"./chunk-V3AM6ELX.js";import{a as b}from"./chunk-7XTGUVW5.js";import{a as m}from"./chunk-CF4P6XS2.js";import{a as C}from"./chunk-AH5EZJ7R.js";import"./chunk-G3R5NAPB.js";import"./chunk-CQ3PZTYF.js";import"./chunk-RY5JB5JV.js";import{a as x}from"./chunk-ZOPLLTNB.js";import{a as N}from"./chunk-SWDYJ63E.js";import"./chunk-QOWOSZRG.js";import{a as E}from"./chunk-3WYOJJSD.js";import"./chunk-FM7OJ7NO.js";import"./chunk-HA7HK2NF.js";import"./chunk-U546IVLZ.js";import"./chunk-DXI2WUUD.js";import"./chunk-JQPK3YVC.js";import"./chunk-WHLURLGI.js";import"./chunk-M6FQTS4T.js";import{b as d}from"./chunk-FTOV4GKD.js";import"./chunk-NY6FBFCL.js";import"./chunk-UWALNOSV.js";import{ta as H}from"./chunk-M72CYKCS.js";import"./chunk-ZP7KCDX3.js";function ne(e){return{c:a,m:a,p:a,d:a}}function re(e){let t=x(e[0]),n,r=t&&Z(e);return{c(){r&&r.c(),n=S()},m(o,i){r&&r.m(o,i),u(o,n,i)},p(o,i){i&1&&(t=x(o[0])),t?r?r.p(o,i):(r=Z(o),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},d(o){r&&r.d(o),o&&f(n)}}}function Z(e){let t,n,r,o,i,s={ctx:e,current:null,token:null,hasCatch:!1,pending:ae,then:ie,catch:oe};return y(i=e[1],s),{c(){t=p("tr"),n=p("td"),n.innerHTML='<span data-tooltip="Ticking this box opts you in to the PVP Ladder, unticking it will remove you from the PVP Ladder." class="svelte-1quw1g">PvP Ladder Opt-in:</span>',r=J(),o=p("td"),s.block.c(),g(n,"class","svelte-1quw1g"),g(o,"class","svelte-1quw1g")},m(l,c){u(l,t,c),v(t,n),v(t,r),v(t,o),s.block.m(o,s.anchor=null),s.mount=()=>o,s.anchor=null},p(l,c){e=l,s.ctx=e,c&2&&i!==(i=e[1])&&y(i,s)||P(s,e,c)},d(l){l&&f(t),s.block.d(),s.token=null,s=null}}}function oe(e){return{c:a,m:a,p:a,d:a}}function ie(e){let t,n,r;return{c(){t=p("input"),g(t,"type","checkbox")},m(o,i){u(o,t,i),t.checked=e[0],n||(r=[F(t,"change",e[6]),F(t,"click",e[3])],n=!0)},p(o,i){i&1&&(t.checked=o[0])},d(o){o&&f(t),n=!1,z(r)}}}function ae(e){let t;return{c(){t=p("div"),t.innerHTML='<span class="fshSpinner fshSpinner12 svelte-1quw1g"></span>',g(t,"class","svelte-1quw1g")},m(n,r){u(n,t,r)},p:a,d(n){n&&f(t)}}}function se(e){return{c:a,m:a,p:a,d:a}}function le(e){let t,n,r={ctx:e,current:null,token:null,hasCatch:!1,pending:se,then:re,catch:ne,value:7};return y(n=e[2](),r),{c(){t=S(),r.block.c()},m(o,i){u(o,t,i),r.block.m(o,r.anchor=i),r.mount=()=>t.parentNode,r.anchor=t},p(o,[i]){e=o,P(r,e,i)},i:a,o:a,d(o){o&&f(t),r.block.d(o),r.token=null,r=null}}}function ce(e,t,n){let{isOnLadder:r}=t,{toggleLadder:o}=t,i;async function s(){n(0,i=await r())}let l;function c(){n(0,i=!i),n(1,l=o(i)),B("ladder","opt in/out")}function te(){i=this.checked,n(0,i)}return e.$$set=k=>{"isOnLadder"in k&&n(4,r=k.isOnLadder),"toggleLadder"in k&&n(5,o=k.toggleLadder)},[i,l,s,c,r,o,te]}var $=class extends Q{constructor(t){super();K(this,t,ce,le,G,{isOnLadder:4,toggleLadder:5})}},ee=$;function _(e){return U(N({cmd:"settings"},e))}function R(e){return _({subcmd:"flags",flags:e.map(t=>t?1:0)})}var ue=["ui_preference_11","ui_preference_15","disable_wordcensor","ui_preference_30","ui_preference_21","ui_preference_33","ui_preference_23"];function fe(e,t){let n=new FormData(e);return n.append("pvp_ladder",t),I(n.entries())}function pe(e,t){let n=new FormData(e);return ue.forEach((r,o)=>n.set(r,t[o+1])),I(n.entries())}async function q(e){let t=await m({cmd:"settings"}),n=b(t),r=fe(n.forms[0],e[0]),o=pe(n.forms[2],e);return await Promise.all([r,o].map(i=>m(i))),{s:!0}}function O(e){return L(R,q,e)}var de=[{name:"ca_default",id:54},{name:"sc_default",id:101},{name:"nv_default",id:60},{name:"barricade_default",id:98}];function me(e){let t=e.getAll("blockedSkillList[]").map(n=>({id:parseInt(n,10),blocked:!0,level:0}));return de.forEach(n=>{let r=t.findIndex(o=>o.id===t.id);r===-1?t.push({id:parseInt(n.id,10),blocked:!1,level:e.get(n.name)}):t[r].level=e.get(n.name)}),t}function ge(e){return[...e.entries()].filter(n=>n[0].startsWith("discardPref")).map(n=>({id:parseInt(n[0][n[0].length-1],10),action:parseInt(n[1],10)}))}function _e(e){return[e[0].get("pvp_ladder")==="1",e[2].get("ui_preference_11")==="1",e[2].get("ui_preference_15")==="1",e[2].get("disable_wordcensor")==="1",e[2].get("ui_preference_30")==="1",e[2].get("ui_preference_21")==="1",e[2].get("ui_preference_33")==="1",e[2].get("ui_preference_23")==="1"]}function he(e){return{s:!0,r:{skills:me(e[4]),item_drop_rarity:ge(e[1]),flags:_e(e),min_group_join_level:parseInt(e[0].get("min_group_level"),10),item_drop_discard_level:parseInt(e[1].get("auto_discard_level"),10),player_block_type:parseInt(e[2].get("block_level"),10)}}}async function T(){let e=await m({cmd:"settings"});if(!e)return{s:!1,e:{message:"Could not connect to FS servers",code:1}};let n=[...b(e).forms].map(r=>new FormData(r));return he(n)}function A(){return _({subcmd:"view"})}function D(){return L(A,T)}var h;async function ke(){return h=(await D()).r?.flags,h?.[0]}async function be(e){if(j(h))return h[0]=e,O(h)}function we(e){return new ee({props:{toggleLadder:be,isOnLadder:ke},target:e})}function V(){if(d("optInOnLadderPage")){let e=w("#pCC table tbody");we(e)}}function Le(e){let t=Math.floor((C-e)/6e4),n=Math.floor(t/60);return t%=60,`${Y(n," hours, ")+t} mins`}function ve(){let e=d(H);return e<C-48*60*60*1e3?'<span class="fshLink tip-static" data-tipped="FSH has not seen the last ladder reset.<br>You can find it in your log if you qualified<br>or Tavern Rumours.">???</span>':Le(e)}function ye(e){let t=e.insertCell(-1);t.height=25,W("Last Reset:",t)}function xe(e){let t=e.insertCell(-1);t.align="right",E(ve(),t)}function Ce(){let e=w("#pCC table");if(!e)return;let t=e.insertRow(-1);ye(t),xe(t)}function M(){d("trackLadderReset")&&Ce()}function Ie(){X(),M(),V()}export{Ie as default};
//# sourceMappingURL=ladder-KPL6MYNV.js.map
