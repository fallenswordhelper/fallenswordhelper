import{a as U}from"./chunk-XG3XJ43M.js";import{a as Q}from"./chunk-WPPV5C7D.js";import{a as x}from"./chunk-I4D4CXXN.js";import{a as p}from"./chunk-6WXPRACV.js";import"./chunk-34NYN3UK.js";import{a as k}from"./chunk-T3KU5OD5.js";import{a as w}from"./chunk-U6MH67WD.js";import"./chunk-67AICILL.js";import"./chunk-K6MZKY6U.js";import"./chunk-57Z3RMCJ.js";import{a as g}from"./chunk-FEXWWVND.js";import{a as f}from"./chunk-IXAZ6GFZ.js";import"./chunk-YIEWHY6V.js";import{a as c}from"./chunk-7XTGUVW5.js";import{a as D}from"./chunk-CF4P6XS2.js";import"./chunk-G3R5NAPB.js";import{a as u}from"./chunk-CQ3PZTYF.js";import{a as d}from"./chunk-C5OE7PQU.js";import"./chunk-RY5JB5JV.js";import{a as j}from"./chunk-5AABVCBG.js";import{a as O}from"./chunk-EJSRJ2V2.js";import{c as M}from"./chunk-CBUWKPHX.js";import"./chunk-456CPU7X.js";import"./chunk-4VL7TVGR.js";import{b as C}from"./chunk-QOWOSZRG.js";import{a as b}from"./chunk-3WYOJJSD.js";import{a}from"./chunk-FM7OJ7NO.js";import"./chunk-YBC6MMGI.js";import"./chunk-U546IVLZ.js";import"./chunk-DXI2WUUD.js";import{a as n}from"./chunk-JQPK3YVC.js";import{a as H,b as v}from"./chunk-7KBBV5J4.js";import"./chunk-J2QMB37G.js";import"./chunk-HT7PAWAR.js";import"./chunk-T34QP7UC.js";import"./chunk-WHLURLGI.js";import"./chunk-M6FQTS4T.js";import{a as _}from"./chunk-VU3PZWN5.js";import{a as S}from"./chunk-2URZ55LX.js";import{b as F}from"./chunk-FTOV4GKD.js";import"./chunk-NY6FBFCL.js";import"./chunk-UWALNOSV.js";import{a as E}from"./chunk-27JTUOQX.js";import"./chunk-POXCGSYQ.js";import"./chunk-M72CYKCS.js";import"./chunk-ZP7KCDX3.js";var $,q=[];function z(t){return`<div class="rmItem"><img class="tip-dynamic" data-tipped="fetchitem.php?item_id=${t.id}&inv_id=-1&t=2&p=${$}&vcode=${t.verify}" src="${t.img}" height="20px" width="20px"><p>${t.amountPresent}/${t.amountNeeded}</p></div>`}function V(t){return t.items?t.items.map(z).join(""):""}function G(t){return`<div class="rmItem"><img class="tip-dynamic" data-tipped="fetchitem.php?item_id=${t.id}&inv_id=-1&t=2&p=${$}&vcode=${t.verify}" src="${t.img}" height="20px" width="20px"><p>${t.amountPresent}/${t.amountNeeded}</p></div>`}function J(t){return t.components?t.components.map(G).join(""):""}function K(t){return t.target?` <img class="tip-dynamic" data-tipped="fetchitem.php?item_id=${t.target.id}&inv_id=-1&t=2&p=${$}&vcode=${t.target.verify}" src="${t.target.img}" height="30px" width="30px"><br/>`:""}function W(t){return!q.includes(t.name)}function X(t){return`<tr class="rmTr"><td class="rmTd"><a href="${t.link}"><img src="${t.img}" height="30px" width="30px"></a></td><td class="rmTd"><a href="${t.link}">${t.name}</a></td><td class="rmTd">${V(t)}</td><td class="rmTd">${J(t)}</td><td class="rmTd">${K(t)}</td></tr>`}function Y(t,e){$=Q();let r='<table width="100%"><tr class="rmTh"><th>Recipe</th><th><span id="sortName" class="fshLink" sortkey="name">Name</span></th><th>Items</th><th>Components</th><th>Target</th></tr>';r+=e.recipe.filter(W).map(X).join(""),r+="</table>",b(r,t),v("fsh_recipeBook",e)}function h(t,e){e&&(F("hideRecipes")&&(q=U("hideRecipeNames")),Y(t,e))}function y(t){let e=a("pCC",t).children[0].rows[4].cells[0].children[0];return f("img",e)}var Z=/fetchitem.php\?item_id=(\d+)&inv_id=-1&t=2&p=(\d+)&vcode=([a-z0-9]+)/i;function tt(t){return f("td",a("pCC",t))}function et(t,e){let r=e.getAttribute("background");return r&&r.includes(t)}function rt(t){return t.dataset.tipped.match(Z)}function ot(t,e){return{img:t.getAttribute("src"),id:e[1],verify:e[3]}}function nt(t,e){if(e){let r=d(e).split("/");t.amountPresent=parseInt(r[0],10),t.amountNeeded=parseInt(r[1],10)}}function it(t){let e=t.children[0].children[0],r=rt(e),o=ot(e,r);return nt(o,t.parentNode.nextElementSibling),o}function I(t,e){return t.filter(n(et,e)).map(it)}function P(t,e,r,o){let m=c(o);p(t,`Parsing blueprint ${r.name}...<br>`);let l=tt(m);r.items=I(l,"/inventory/2x3."),r.components=I(l,"/inventory/1x1mini."),[r.target]=I(l,"/hellforge/2x3."),e.recipe.push(r)}function mt(t){let r=a("pCC",t).children[0].rows[6].cells[0].children[0];return f("a",r)}function st(t){return{img:t.parentNode.previousElementSibling.children[0].getAttribute("src"),link:t.href,name:d(t),id:x(t.search,"recipe_id")}}function at(t,e,r){p(t,`Found blueprint "${d(r)}".<br>`);let o=st(r);return u(r.href).then(n(P,t,e,o))}function B(t,e,r){let o=c(r),m=mt(o).map(n(at,t,e));return g(m)}function pt(t){return/\/folder_on\./.test(t.getAttribute("src"))}function ft(t){return y(t).find(pt).parentNode.href}function ct(t,e){return e!==0}function dt(t){return t.value}function lt(t){return f("option",E("customselect",a("pCC",t))[0]).filter(ct).map(dt)}function ut(t,e,r){return u(`${t}&page=${r}`).then(e)}function gt(t,e,r){return lt(t).map(n(ut,e,r))}function N(t,e,r){let o=c(r),m=ft(o),l=n(B,t,e),A=gt(o,m,l);return A.push(l(r)),g(A)}function ht(t){return x(t.parentNode.search,"folder_id")!=="-1"}function bt(t,e){let r=d(e.parentNode.nextElementSibling.nextElementSibling.firstChild),o=/quest/i.test(r);return o&&p(t,`Skipping folder "${r}"  as it has the word "quest" in folder name.<br>`),!o}function yt(t,e){return u(e.parentNode.href).then(t)}function xt(t,e,r){let o=c(e);return y(o).filter(ht).filter(n(bt,t)).map(n(yt,r))}function R(t,e,r){let o=n(N,t,e),m=xt(t,r,o);return m.push(o(r)),g(m)}var i,s;function vt(){p(s,"Finished parsing ... formatting ..."),v("fsh_recipeBook",i),h(s,i)}function T(){i={},i.recipe=[],b("<br>Parsing inventing screen ...<br>",s),D({cmd:"inventing"}).then(n(R,s,i)).then(vt)}function L(t,e){i=e,b('<table class="fshInvFilter"><thead><tr><th width="90%"><b>&nbsp;Recipe Manager</b></th><th width="10%" class="fshBtnBox">[<span id="rfsh" class="fshLink">Refresh</span>]</th></tr></thead></table>',t),s=k(),w(t,s),i?h(s,i):T()}function $t(t){O(t.target),i.recipe.sort(M),h(s,i)}function It(t){t.target.id==="rfsh"&&T(),t.target.id==="sortName"&&$t(t)}function Pt(t){if(j())return;let e=t||C;H("fsh_recipeBook").then(n(L,e)),S(e,It),_("ui-dialog-titlebar-close").forEach(r=>r.blur())}export{Pt as default};
//# sourceMappingURL=recipeMgr-V4B7O2SC.js.map
