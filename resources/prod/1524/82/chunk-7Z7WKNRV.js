import{a as Q}from"./chunk-BC7UIYV4.js";import{a as U}from"./chunk-LCWKC7LR.js";import{a as V}from"./chunk-K4WAYVFG.js";import{a as G,b as J,c as u,d as K}from"./chunk-BB2P5RYU.js";import{a as z}from"./chunk-SSQF7EFV.js";import{a as P}from"./chunk-FWL2OWGY.js";import{b as D,c as F}from"./chunk-G74VGEOG.js";import{a as C}from"./chunk-VKNAZHSW.js";import{a as E}from"./chunk-SGIZTIIQ.js";import{a as R}from"./chunk-UFHHOZKJ.js";import{a as l}from"./chunk-6ZR46QZG.js";import{a as N,b as B}from"./chunk-LFLU4NXM.js";import{a as q}from"./chunk-OVNS4OBJ.js";import{a as A}from"./chunk-AEWB35UI.js";import{a as S}from"./chunk-7HLQ4YMN.js";import{a as c}from"./chunk-LWLVQTKS.js";import{a as I}from"./chunk-WBTHTD34.js";import{a as s}from"./chunk-G34A357Q.js";import{a as g,b as p}from"./chunk-QL5YK4M4.js";import{a as H}from"./chunk-LG3KLILQ.js";import{a as f}from"./chunk-IWCA3B2P.js";import{a as d,b as k}from"./chunk-EEF6C5L4.js";import{va as m}from"./chunk-KWAUBU52.js";import{a as _}from"./chunk-TISVYXYU.js";function x(t){return E({cmd:"arena",...t})}function b(){return x({subcmd:"view"})}function it(t,e,[r,o]){let i=t.find(([,v])=>v===r);return i&&(P(i[0]).style.backgroundColor="#ff0000",e[r]=o),e}function y(t){if(!c(t))return;let r=l('#arenaTypeTabs tr:not([style="display: none;"]) input[type="submit"]').map(i=>[i,i.previousElementSibling.value]),o=I(t).reduce(s(it,r),{});p("fsh_arenaFull",o)}var n=0,j=0,a=()=>n,W=()=>j;function h(){p(u,n)}function X(t,e){n=n||{},n.minLvl=t,n.maxLvl=e,h()}function Y(){$('#arenaTypeTabs table[width="635"]').DataTable().draw()}function Z(){Q(X,Y)}function tt(){X(d.arenaMinLvl,d.arenaMaxLvl),$("#fshMinLvl").val(n.minLvl),$("#fshMaxLvl").val(n.maxLvl),Y()}function et(t){n=n||{},n.hideMoves=t.target.checked,h(),$(".moveMax").toggle(!t.target.checked)}function rt(t){n=t||{},j=n.id||{},n.id={}}function st(t){let e=a().minLvl,r=a().maxLvl,o=S(t[7]);return B(N,o,e,r)}function ct(t,e){return a()?st(e):!0}function ft(t,e,r,o){return!0}function M(){$.fn.dataTable.ext.search.push(ct),_.userIsDev&&$.fn.dataTable.ext.search.push(ft)}function lt(){let t=$("#pCC > table > tbody > tr:nth-child(4)");return t.clone().insertBefore(t).find("td").attr("height","2"),t.clone().insertAfter(t).find("td").attr("height","1"),t}function dt(t){let e=$("#fshHideMoves",t);a()?.hideMoves!=null&&(e.prop("checked",a().hideMoves),$(".moveMax").toggle(!a().hideMoves)),e.on("click",et)}function ot(t,e,r,o){$(`#${t}`,e).val(a()?.[r]??d[o])}function mt(t){ot("fshMinLvl",t,"minLvl","arenaMinLvl")}function pt(t){ot("fshMaxLvl",t,"maxLvl","arenaMaxLvl")}function ut(t){$("#fshMinLvl, #fshMaxLvl",t).on("keyup",Z),$("#fshReset",t).on("click",tt)}function w(){let t=lt(),e=$(J);dt(e),mt(e),pt(e),ut(e),$("td",t).append(e)}function ht(t,e){W()?.[e]||(t.css("background-color","#F5F298"),t.find("tr").css("background-color","#F5F298"))}function vt(t,e){let r=f(/#\s(?<id>\d+)/,e.eq(0).text());r&&c(a()?.id)&&(a().id[r]=r,ht(t,r))}function gt(t){let e=t.eq(1),r=e.text().split(/\s\/\s/);r&&e.attr("data-order",(Number(r[0])-Number(r[1]))*100+Number(r[1]))}function xt(t){let e=t.eq(2);e.attr("data-order",$("td",e).first().text().replace(/[,\s]/g,""))}function bt(t,e){let r=f(/(?<move>\d)\.png/,$("img",e).attr("src"));r&&$(e).attr("data-order",r)}function yt(t){t.slice(4,7).each(bt)}function Mt(t,e){a()?.moves?.[t]===3&&e.addClass("moveMax")}function wt(t,e){let r=f(K,$("img",t).attr("src"));r&&(Mt(r,e),t.attr("data-order",r))}function Lt(t,e){let r=t.eq(8);a()?.moves&&wt(r,e)}function $t(t){let e=t.eq(8);e.children(m).length===1&&e.attr("data-order",e.find("td").first().text().replace(/[,\s]/g,""))}function Tt(t,e){let r=$(e),o=r.children();vt(r,o),gt(o),xt(o),yt(o),Lt(o,r),$t(o)}function L(t){t.children("tbody").children("tr").each(Tt)}var Ot=t=>[t,Number(t.previousElementSibling.value)];function _t(t,e){return t.r.arenas?e.concat(t.r.arenas.find(r=>r.id===e[1])):e}function Dt(t,e){return e.guild_id===t?`<span class="fshRed">${e.name}</span>`:e.name}function nt(t){t&&t.classList&&t.classList.add("fshGray")}var Ft=(t,e)=>e.reward_type===1&&t.r.moves,kt=(t,e)=>t.r.moves.find(r=>r.id===e.reward),Rt=t=>t&&t.max===3,Ct=(t,e)=>Ft(t,e)&&Rt(kt(t,e));function It(t,[e,,r]){r&&Ct(t,r)&&nt(e)}function Et(t,e,r){let o=r.players.filter(v=>v.guild_id===t).length,i=r.max_players/4;o===i&&nt(e)}function Ht(t,e,r){U(r.players.map(s(Dt,t)).join("<br>"),e),e.classList.add("tip-static"),t&&e.value==="Join"&&Et(t,e,r)}var St=[c,t=>R(t.players),t=>t.players.length>0];function qt(t,[e,,r]){St.every(o=>o(r))&&Ht(t,e,r)}function At(t){return l('#arenaTypeTabs tr:not([style="display: none;"]) input[type="submit"]').map(Ot).map(s(_t,t))}function T(t){if(!t||!t.s||!c(t.r))return;let e=At(t);e.forEach(s(qt,A())),e.forEach(s(It,t))}var at="td.sorting, td.sorting_asc, td.sorting_desc";function Nt(t){let e=t.attr("class");return f(/sorting(?<dir>[^\s]+)/,e)==="_desc"?"asc":"desc"}function Bt(t,e,r){let o=t.closest(m).DataTable();e!==3?o.order([3,"asc"],[e,r]).draw():o.order([3,r]).draw()}function Pt(t){let e=$(t.target).closest("td"),r=Nt(e);Bt(e,e.index(),r)}function O(t){$(at,t).off("click"),t.on("click",at,Pt)}function zt(){l('#arenaTypeTabs tr[style="display: none;"]').forEach(e=>e.remove())}function Vt(t,e){let r=$("tr",e).first();$("a",r).contents().unwrap(),$(e).prepend($("<thead/>").append(r))}function Gt(){w(),h(),M()}function Jt(t,[e,r,o]){let i=$('table[width="635"]',t);i.each(Vt),rt(e),L(i),y(r),T(o),Gt(),i.DataTable(G),O(t)}function Kt(t,e){let r=k("betaOptIn");r&&D("arena.process"),zt(),Jt(t,e),V(),r&&F("arena.process")}function Qt(t){z([g(u),g("fsh_arenaFull"),b().catch(()=>({})),q()],s(Kt,t))}function Ut(){if(H())return;let t=$("#arenaTypeTabs");t.length===1?Qt(t):C("arena","Join error screen ?")}export{x as a,b,Ut as c};
//# sourceMappingURL=chunk-7Z7WKNRV.js.map
