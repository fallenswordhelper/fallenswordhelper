import{a as ze}from"./chunk-B75T52YW.js";import{a as We,b as Fe,c as Ge}from"./chunk-N6E4M2XP.js";import"./chunk-KGBWXIL5.js";import{a as Ue}from"./chunk-TC3YVAFJ.js";import{a as z}from"./chunk-YDODXXEV.js";import{a as Re}from"./chunk-KX2F6B4J.js";import"./chunk-B7X7TQBP.js";import{a as H}from"./chunk-TDUZZ733.js";import"./chunk-PZDGCOKP.js";import"./chunk-6I5R6OXL.js";import{B as ne,D as K,I as re,J as le,M as P,N as V,O as h,P as v,R as Le,S as Pe,V as M,W as Q,X as x,Y as F,Z as G,a as D,d as U,e as se,g as Ne,h as te,m as W,o as u,p as y,q as C,r as je,s as g,t as A,u as B,v as oe,z as E}from"./chunk-L6GQNQR4.js";import{a as ie}from"./chunk-FWGO5OVV.js";import{a as Ve}from"./chunk-GSYKZIIR.js";import{a as He}from"./chunk-IVWMNR5J.js";import{a as Qe}from"./chunk-OTW7J4YQ.js";import{a as ee}from"./chunk-HJWRYLQE.js";import{a as xe}from"./chunk-Y6HMCJPU.js";import"./chunk-77XPBRJF.js";import{a as L}from"./chunk-TRNMZZEK.js";import{a as Z}from"./chunk-RNF4KCS5.js";import"./chunk-UM564T7I.js";import"./chunk-VT3FG2IA.js";import{a as qe}from"./chunk-KWCCWSHG.js";import"./chunk-PMAGLG7V.js";import{a as Me}from"./chunk-RNIUOJRT.js";import{a as J}from"./chunk-REMGFCSI.js";import{a as Te}from"./chunk-THMELYB7.js";import{a as Y}from"./chunk-5PX2ZDHA.js";import{a as ce}from"./chunk-PM4JYVPN.js";import{a as X}from"./chunk-FCN2SCZU.js";import"./chunk-FTOTZBEG.js";import{a as Be}from"./chunk-2XSNLBB5.js";import"./chunk-LL7EZAKT.js";import"./chunk-HSLYILSV.js";import{a as Se}from"./chunk-5H66GZ4Q.js";import"./chunk-FFFKYVLG.js";import{a as Ee}from"./chunk-PDSYNNV7.js";import{a as j}from"./chunk-FS5GA4BE.js";import"./chunk-WBGREN3P.js";import"./chunk-SOCGTSZG.js";import{a as Ie}from"./chunk-G24MBLFU.js";import"./chunk-3HXRWLGC.js";import"./chunk-OZW2BU7Q.js";import"./chunk-CJWCCIGF.js";import{a as Ae}from"./chunk-ZKIS7VJL.js";import"./chunk-YKB3MUO2.js";import{b as we,i as De}from"./chunk-E427CPYE.js";import"./chunk-7MAPWPFS.js";var N=We(new Map),Je=Fe(N,t=>[...t].reduce((e,[,o])=>e+(o.get("del")?.length??0),0));function it(t){let e;return{c(){e=g("tr"),e.innerHTML='<td class="compDel svelte-1qoer4b" colspan="3">Deleted</td>'},m(o,n){y(o,e,n)},p:D,i:D,o:D,d(o){o&&C(e)}}}function ct(t){let e,o,n,r,l,s,i,$=t[0].get("del").length+"",p,a,f,k,w,m,d=[at,st],_=[];function T(c,I){return I&1&&(f=null),f==null&&(f=!!c[0].get("delPending")),f?0:1}return k=T(t,-1),w=_[k]=d[k](t),{c(){e=g("tr"),o=g("td"),n=g("img"),s=B(),i=g("td"),p=A($),a=B(),w.c(),se(n.src,r=t[1](t[0]))||E(n,"src",r),E(n,"class","tip-dynamic"),E(n,"data-tipped",l=t[2](t[0])),E(n,"alt","component")},m(c,I){y(c,e,I),u(e,o),u(o,n),u(e,s),u(e,i),u(i,p),u(e,a),_[k].m(e,null),m=!0},p(c,I){(!m||I&1&&!se(n.src,r=c[1](c[0])))&&E(n,"src",r),(!m||I&1&&l!==(l=c[2](c[0])))&&E(n,"data-tipped",l),(!m||I&1)&&$!==($=c[0].get("del").length+"")&&ne(p,$);let b=k;k=T(c,I),k===b?_[k].p(c,I):(P(),v(_[b],1,1,()=>{_[b]=null}),V(),w=_[k],w?w.p(c,I):(w=_[k]=d[k](c),w.c()),h(w,1),w.m(e,null))},i(c){m||(h(w),m=!0)},o(c){v(w),m=!1},d(c){c&&C(e),_[k].d()}}}function st(t){let e,o,n;return o=new H({props:{$$slots:{default:[pt]},$$scope:{ctx:t}}}),o.$on("click",W(t[3])),{c(){e=g("td"),M(o.$$.fragment)},m(r,l){y(r,e,l),Q(o,e,null),n=!0},p(r,l){let s={};l&256&&(s.$$scope={dirty:l,ctx:r}),o.$set(s)},i(r){n||(h(o.$$.fragment,r),n=!0)},o(r){v(o.$$.fragment,r),n=!1},d(r){r&&C(e),x(o)}}}function at(t){let e;return{c(){e=g("td"),e.innerHTML='<span class="fshSpinner fshSpinner12"></span>',E(e,"class","compSumSpin")},m(o,n){y(o,e,n)},p:D,i:D,o:D,d(o){o&&C(e)}}}function pt(t){let e;return{c(){e=A("Del")},m(o,n){y(o,e,n)},d(o){o&&C(e)}}}function ft(t){let e,o,n,r,l,s=[ct,it],i=[];function $(p,a){return a&1&&(e=null),e==null&&(e=!!p[0].get("del").length),e?0:1}return o=$(t,-1),n=i[o]=s[o](t),{c(){n.c(),r=oe()},m(p,a){i[o].m(p,a),y(p,r,a),l=!0},p(p,[a]){let f=o;o=$(p,a),o===f?i[o].p(p,a):(P(),v(i[f],1,1,()=>{i[f]=null}),V(),n=i[o],n?n.p(p,a):(n=i[o]=s[o](p),n.c()),h(n,1),n.m(r.parentNode,r))},i(p){l||(h(n),l=!0)},o(p){v(n),l=!1},d(p){i[o].d(p),p&&C(r)}}}function mt(t,e,o){let n;te(t,N,f=>o(5,n=f));let{itemId:r}=e,l=re(),s=Qe(),i=f=>`${we}items/${f.get("b")}.gif`,$=f=>`fetchitem.php?item_id=${f.get("b")}&inv_id=${f.get("a")}&t=2&p=${s}&vcode=${f.get("v")}`,p;function a(){L("components","delType"),l("delType",r)}return t.$$set=f=>{"itemId"in f&&o(4,r=f.itemId)},t.$$.update=()=>{if(t.$$.dirty&48){e:o(0,p=n.get(r))}},[p,i,$,a,r,n]}var ae=class extends G{constructor(e){super(),F(this,e,mt,ft,U,{itemId:4})}},Ke=ae;var ut=/\?item_id=(\d+)&inv_id=(\d+)&.*&vcode=([0-9a-f]+)/;function dt(t){let e=t.children[0].dataset.tipped.match(ut);return{a:Number(e[2]),b:Number(e[1]),v:e[3]}}var _t=t=>Be(t.href),bt=t=>J('a[href*="=destroycomponent&"]',t).map(dt),gt=t=>Te('td[background*="/1x1mini."]',t).length;function ht(t){let e=ce(t);return J('a[href*="profile&component_page="]',e).slice(1).map(_t)}function kt(t){let e=Array(57);return e[56]={k:56,v:t.map(gt).reduce(ze,0)},{p:e}}var $t=t=>({h:kt(t),r:t.flatMap(bt),s:!0});async function pe(){let t=await X({cmd:"profile"}),e=await Y([t,...ht(t)]);return $t(e.map(ce))}function fe(){return ee({subcmd:"loadcomponents"})}function me(){return Z(fe,pe)}async function ue(t){let e=await t();if(!e?.s)throw new Error(e?.e?.message??"Unknown Error");return e}function de(t){return new Map(Ee(t))}function Oe(t){t[4]=t[6].rollup,t[5]=t[6].maxComp}function Xe(t,e,o){let n=t.slice();return n[7]=e[o],n}function vt(t){let e,o=t[10].message+"",n;return{c(){e=g("p"),n=A(o),K(e,"color","red")},m(r,l){y(r,e,l),u(e,n)},p:D,i:D,o:D,d(r){r&&C(e)}}}function yt(t){Oe(t);let e,o,n,r,l,s,i,$,p,a,f,k,w,m=t[5]+"",d,_,T=t[4],c=[];for(let b=0;b<T.length;b+=1)c[b]=Ye(Xe(t,T,b));let I=b=>v(c[b],1,1,()=>{c[b]=null});return{c(){e=g("div"),o=g("table"),n=g("thead"),n.innerHTML='<tr><th colspan="3">Component Summary</th></tr>',r=B(),l=g("tbody");for(let b=0;b<c.length;b+=1)c[b].c();s=B(),i=g("tfoot"),$=g("tr"),p=g("td"),p.textContent="Total:",a=B(),f=g("td"),k=A(t[0]),w=A(" / "),d=A(m),E(f,"colspan","2"),E(o,"class","fshTblCenter")},m(b,q){y(b,e,q),u(e,o),u(o,n),u(o,r),u(o,l);for(let S=0;S<c.length;S+=1)c[S].m(l,null);u(o,s),u(o,i),u(i,$),u($,p),u($,a),u($,f),u(f,k),u(f,w),u(f,d),_=!0},p(b,q){if(Oe(b),q&2){T=b[4];let S;for(S=0;S<T.length;S+=1){let Ce=Xe(b,T,S);c[S]?(c[S].p(Ce,q),h(c[S],1)):(c[S]=Ye(Ce),c[S].c(),h(c[S],1),c[S].m(l,null))}for(P(),S=T.length;S<c.length;S+=1)I(S);V()}(!_||q&1)&&ne(k,b[0])},i(b){if(!_){for(let q=0;q<T.length;q+=1)h(c[q]);_=!0}},o(b){c=c.filter(Boolean);for(let q=0;q<c.length;q+=1)v(c[q]);_=!1},d(b){b&&C(e),je(c,b)}}}function Ye(t){let e,o;return e=new Ke({props:{itemId:t[7]}}),e.$on("delType",t[2]),{c(){M(e.$$.fragment)},m(n,r){Q(e,n,r),o=!0},p:D,i(n){o||(h(e.$$.fragment,n),o=!0)},o(n){v(e.$$.fragment,n),o=!1},d(n){x(e,n)}}}function Ct(t){let e;return{c(){e=g("div"),e.innerHTML='<span class="fshSpinner fshSpinner12"></span>',E(e,"class","compSumSpin")},m(o,n){y(o,e,n)},p:D,i:D,o:D,d(o){o&&C(e)}}}function St(t){let e,o,n,r={ctx:t,current:null,token:null,hasCatch:!0,pending:Ct,then:yt,catch:vt,value:6,error:10,blocks:[,,,]};return Le(o=t[1](),r),{c(){e=oe(),r.block.c()},m(l,s){y(l,e,s),r.block.m(l,r.anchor=s),r.mount=()=>e.parentNode,r.anchor=e,n=!0},p(l,[s]){t=l,Pe(r,t,s)},i(l){n||(h(r.block),n=!0)},o(l){for(let s=0;s<3;s+=1){let i=r.blocks[s];v(i)}n=!1},d(l){l&&C(e),r.block.d(l),r.token=null,r=null}}}function wt(t,e,o){let n;te(t,Je,i=>o(0,n=i));function r(i){let $=new Map(ie(i,"b").map(p=>[p.b,de({...p,del:i.filter(({b:a})=>a===p.b).map(({a})=>a),delPending:!1})]));return N.set($),[...$.keys()]}async function l(){let i=await ue(me);return{rollup:r(i.r),maxComp:i.h?.p[56]?.v}}function s(i){le.call(this,t,i)}return[n,l,s]}var _e=class extends G{constructor(e){super(),F(this,e,wt,St,U,{})}},Ze=_e;function et(t){let e,o,n;return o=new H({props:{$$slots:{default:[Dt]},$$scope:{ctx:t}}}),o.$on("click",W(t[2])),{c(){e=g("div"),M(o.$$.fragment)},m(r,l){y(r,e,l),Q(o,e,null),n=!0},p(r,l){let s={};l&256&&(s.$$scope={dirty:l,ctx:r}),o.$set(s)},i(r){n||(h(o.$$.fragment,r),n=!0)},o(r){v(o.$$.fragment,r),n=!1},d(r){r&&C(e),x(o)}}}function Dt(t){let e;return{c(){e=A("Enable Quick Del")},m(o,n){y(o,e,n)},d(o){o&&C(e)}}}function Tt(t){let e,o;return e=new Ze({}),e.$on("delType",t[6]),{c(){M(e.$$.fragment)},m(n,r){Q(e,n,r),o=!0},p:D,i(n){o||(h(e.$$.fragment,n),o=!0)},o(n){v(e.$$.fragment,n),o=!1},d(n){x(e,n)}}}function Et(t){let e,o,n;return o=new H({props:{$$slots:{default:[qt]},$$scope:{ctx:t}}}),o.$on("click",W(t[3])),{c(){e=g("div"),M(o.$$.fragment)},m(r,l){y(r,e,l),Q(o,e,null),n=!0},p(r,l){let s={};l&256&&(s.$$scope={dirty:l,ctx:r}),o.$set(s)},i(r){n||(h(o.$$.fragment,r),n=!0)},o(r){v(o.$$.fragment,r),n=!1},d(r){r&&C(e),x(o)}}}function qt(t){let e;return{c(){e=A("Count Components")},m(o,n){y(o,e,n)},d(o){o&&C(e)}}}function At(t){let e;return{c(){e=A("Quick Extract")},m(o,n){y(o,e,n)},d(o){o&&C(e)}}}function tt(t){let e,o,n,r;return o=new H({props:{$$slots:{default:[It]},$$scope:{ctx:t}}}),o.$on("click",W(t[5])),{c(){e=g("div"),n=g("div"),M(o.$$.fragment),K(n,"display","contents"),K(n,"--button-color","red")},m(l,s){y(l,e,s),u(e,n),Q(o,n,null),r=!0},p(l,s){let i={};s&256&&(i.$$scope={dirty:s,ctx:l}),o.$set(i)},i(l){r||(h(o.$$.fragment,l),r=!0)},o(l){v(o.$$.fragment,l),r=!1},d(l){l&&C(e),x(o)}}}function It(t){let e;return{c(){e=A("Delete All Visible")},m(o,n){y(o,e,n)},d(o){o&&C(e)}}}function Bt(t){let e,o,n,r,l,s,i,$,p,a=!t[0]&&et(t),f=[Et,Tt],k=[];function w(d,_){return d[1]?1:0}n=w(t,-1),r=k[n]=f[n](t),i=new H({props:{$$slots:{default:[At]},$$scope:{ctx:t}}}),i.$on("click",t[4]);let m=t[0]&&tt(t);return{c(){e=g("div"),a&&a.c(),o=B(),r.c(),l=B(),s=g("div"),M(i.$$.fragment),$=B(),m&&m.c(),E(e,"class","fshCenter")},m(d,_){y(d,e,_),a&&a.m(e,null),u(e,o),k[n].m(e,null),u(e,l),u(e,s),Q(i,s,null),u(e,$),m&&m.m(e,null),p=!0},p(d,[_]){d[0]?a&&(P(),v(a,1,1,()=>{a=null}),V()):a?(a.p(d,_),_&1&&h(a,1)):(a=et(d),a.c(),h(a,1),a.m(e,o));let T=n;n=w(d,_),n===T?k[n].p(d,_):(P(),v(k[T],1,1,()=>{k[T]=null}),V(),r=k[n],r?r.p(d,_):(r=k[n]=f[n](d),r.c()),h(r,1),r.m(e,l));let c={};_&256&&(c.$$scope={dirty:_,ctx:d}),i.$set(c),d[0]?m?(m.p(d,_),_&1&&h(m,1)):(m=tt(d),m.c(),h(m,1),m.m(e,null)):m&&(P(),v(m,1,1,()=>{m=null}),V())},i(d){p||(h(a),h(r),h(i.$$.fragment,d),h(m),p=!0)},o(d){v(a),v(r),v(i.$$.fragment,d),v(m),p=!1},d(d){d&&C(e),a&&a.d(),k[n].d(),x(i),m&&m.d()}}}function Mt(t,e,o){let n,r,l=re();function s(){L("components","enableQuickDel"),o(0,n=!0),l("enableQuickDel")}function i(){L("components","countComponents"),o(1,r=!0)}function $(){L("components","insertQuickExtract"),Ve()}function p(){L("components","deleteAllVisible"),l("deleteAllVisible")}function a(f){le.call(this,t,f)}return[n,r,s,i,$,p,a]}var be=class extends G{constructor(e){super(),F(this,e,Mt,Bt,U,{})}},ot=be;function ge(t){return ee({subcmd:"destroycomponent",removeIndex:t})}function Qt(t,e){let o=xe(e),n=1;return o==="Component destroyed."&&(n=0),{r:n,m:o,c:t}}function xt(t){return X({cmd:"profile",subcmd:"destroycomponent",component_id:t}).then(j(Qt,t))}function Nt(t){let e=t.filter(n=>n.r===0),o=t.filter(n=>n.r===1);return e.length>0?{r:e.map(n=>n.c),s:!0}:o.length>0?{e:{message:o[0].m},s:!1}:{e:{message:t[0].m},s:!1}}function he(t){return Re(t.map(xt),Nt)}function ke(t){return Z(ge,he,t)}function jt(t,e){if(!e)return;let o=e.get("del").filter(n=>!t.includes(n));e.set("del",o)}function Lt(t,e){N.update(o=>(jt(e,o.get(t)),o))}function Pt(t,e,o){N.update(n=>(n.get(t)?.set(e,o),n))}function Vt(t){if(!t)return;let e=t.children[0];return e.replaceWith(qe({className:"compSumSpin",innerHTML:'<span class="fshSpinner fshSpinner12"></span>'})),e}function nt(t,e){Pt(e,"delPending",t)}function Ht(t){t.forEach(([e,o])=>{o&&e.children[0].replaceWith(o)})}var Rt=t=>t.forEach(([e])=>e?.children[0]?.remove()),Ut=t=>t.map(([e])=>[e,Vt(e)]),Wt=([,t])=>t,rt=t=>ie(t.map(Wt)),lt=([,,t])=>t,Ft=t=>rt(t).map(e=>[e,t.filter(([,o])=>o===e).map(lt)]),Gt=t=>Lt(...t);async function zt(t){let e=Ut(t),o=await ke(t.map(lt));o?.s?(Ft(t).forEach(Gt),Rt(e)):(Ge(o?.e?.message??"Unknown Error"),Ht(e))}async function R(t){let e=rt(t);e.forEach(j(nt,!0)),await Y(Ue(30,t).map(zt)),e.forEach(j(nt,!1))}var Jt=t=>Ne(N).get(t.detail).get("del"),Kt=(t,e)=>z(Me(`img[data-tipped*="&inv_id=${e}&"]`,t));async function $e(t,e){R(Jt(e).map(o=>[Kt(t,o),e.detail,o]))}function O(t){let e=t.dataset.tipped.match(De);return[Number(e[1]),Number(e[2])]}var Ot=t=>[z(t),...O(t)];function ve(t){R(J("img",t).map(Ot))}function Xt(t){t.target.tagName==="IMG"&&(t.preventDefault(),L("components","quickDel"),He(t.target),R([[z(t.target),...O(t.target)]]))}function ye(t){t.classList.add("fshQuickDel"),Ie(t,Xt)}function Yt(){let t=Se("profileRightColumn"),e=Ae("inventory-table",t);if(e.length===2)return e[1]}function Zt(){let t=Yt();if(!t)return;let e=new ot({target:t.parentNode});e.$on("enableQuickDel",j(ye,t)),e.$on("delType",j($e,t)),e.$on("deleteAllVisible",j(ve,t))}export{Zt as default};
//# sourceMappingURL=components-XY66CUOC.js.map
