import{g as t}from"./getMembrList-BlwQHY-c.js"
import{dc as e,i as n,cB as s,am as a,u as i,p as r,b0 as c,cm as o,dd as d,s as l,c as u,b6 as f,bQ as p,ao as m,d0 as h,de as b,bS as v,E as y,ch as g,b8 as k,k as _,J as x,$ as I,a$ as R,b5 as w,aA as L,S,O as M,P as E,R as T,T as D,U as j,W as N,X as C,_ as A,a3 as G,a4 as q,a5 as P,b4 as U,bj as O,a7 as B,as as F,av as W,df as H,a8 as V,g as Q,dg as Y,dh as X,di as J,dj as z,dk as Z,bF as K,bG as tt,bA as et,bD as nt,bH as st,H as at,d as it,w as rt,m as ct,x as ot,cp as dt,f as lt,bb as ut}from"./calfSystem-CvwhhJv4.js"
import{e as ft}from"./executeAll-DIAWIge1.js"
import{l as pt}from"./loadDataTables-Djl1XjSy.js"
import{d as mt,a as ht}from"./deepClone-Cc61T-NG.js"
import{d as bt}from"./daGuildReport-CKK1XNZY.js"
import{d as vt}from"./daLoadInventory-4yalcPvn.js"
import{b as yt}from"./basicItem-BMNuU5Rv.js"
import{e as gt,d as kt,a as $t,m as _t}from"./dropItem-BszxNwUZ.js"
import{f as xt}from"./flattenItems-DOc6e0_m.js"
import{c as It}from"./createTable-DRk_KQFM.js"
import{i as Rt}from"./isSelected-BWnMzKlW.js"
import{c as wt}from"./changeMinMax-CuM7cDBf.js"
import{c as Lt}from"./chromeHandlers-DccOn_OX.js"
import{a as St,u as Mt,e as Et}from"./useItem-D46LvPXq.js"
import{g as Tt}from"./guildInventory-mCp60d9Z.js"
import{h as Dt}from"./htmlResult-CRj7vbsR.js"
import{e as jt}from"./errorDialog-B4_TjdGG.js"
import{q as Nt,a as Ct}from"./queue-y2VO3l2R.js"
import{p as At,l as Gt}from"./lvlTests-9KC65II_.js"
import{d as qt}from"./daGsTake-CoRFjC9R.js"
import"./dialog-BW-ZNw6R.js"
import"./dialogMsg-rKdvzvMA.js"
import"./sendItems-B9CLITPM.js"
import"./daUseItem-DGqwb-TL.js"
import"./InfoBoxFrom-CWtMVvia.js"
import"./backpackOk-OI_WsN5f.js"
import"./takeItem-t2YovuJh.js"
function Pt([t]){return"lastUpdate"!==t}function Ut(){return e({subcmd:"inventory"})}let Ot=""
const Bt=()=>Ot
function Ft(t,e){Ot||(Ot=e.message),Ot&&n(t,s("p",{className:"fshRed",textContent:Ot}))}let Wt={}
const Ht=()=>Wt
async function Vt(t){try{return await t()}catch(t){if(500!==t.jqXhr.status)throw t
Ft(r(),t)}}const Qt=(t,e)=>{return e.map(yt).map((n=t,function(t){const e=n?.find((({inv_id:e})=>e===t.inv_id))
return{...t,...e?.stats&&{stats:{...t.stats,armor:e.stats.armor,attack:e.stats.attack,damage:e.stats.damage,defense:e.stats.defense,hp:e.stats.hp,set_name:e.stats.set_name??""}}}}))
var n},Yt=t=>({...t,equipped:!0,folder_id:-2}),Xt=(t,e,n)=>({folders:gt(t),items:Qt(e,n),player_id:c()})
const Jt=t=>({...t,player:{id:-1}}),zt=(t,e)=>({current_player_id:c(),items:Qt(t,e),guild_id:o()})
async function Zt(){if("invmanagernew"===a.subcmd){const t=await async function(){const[t,e]=await i([Vt(Ut),vt()]),n=t?.items??[],s=e?.r??{},a=(s.equipment?.map(Yt)??[]).concat(xt(s))
return Xt(s,n,a)}()
Wt=t}else if("guildinvmgr"===a.subcmd){const t=await async function(){const[t,e,n]=await i([Vt(d),bt(),mt()]),s=t?.items??[],a=e?.r??[],r=n?.r??[],c=a.concat(r.map(Jt))
return zt(s,c)}()
Wt=t}}const Kt=t=>{l("Inventory","Header",t)},te=t=>{l("Inventory","Datatable",t)}
function ee(t,e){te("clearSearch"),e.val(""),$(t).DataTable().search("").draw()}function ne(){Ht().folders&&(Ht().folders[-1]="Main")}const se={checkedElements:{0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,100:1,101:1,102:1,103:1,104:1,105:1,106:1},fshMinLvl:1,fshMaxLvl:9999},ae='<table class="fshInvFilter"><tr><th colspan="14">@@reportTitle@@</th><th><span id="fshRefresh" class="fshLink">[Refresh]</span></th></tr><tr><td colspan="2" rowspan="3"><b>&nbsp;Show Items:</b></td><td class="fshRight">&nbsp;Helmet:</td><td><input id="fshHelmet" type="checkbox" item="0"/></td><td class="fshRight">&nbsp;Armor:</td><td><input id="fshArmor" type="checkbox" item="1"/></td><td class="fshRight">&nbsp;Gloves:</td><td><input id="fshGloves" type="checkbox" item="2"/></td><td class="fshRight">&nbsp;Boots:</td><td><input id="fshBoots" type="checkbox" item="3"/></td><td class="fshRight">&nbsp;Weapon:</td><td><input id="fshWeapon" type="checkbox" item="4"/></td><td></td><td class="fshRight">&nbsp;Min lvl:</td><td rowspan="2"><input id="fshMinLvl" class="fshNumberInput" type="number" value="1" min="0"><br><input id="fshMaxLvl" class="fshNumberInput" type="number" value="9999" min="0"></td></tr><tr><td class="fshRight">&nbsp;Shield:</td><td><input id="fshShield" type="checkbox" item="5"/></td><td class="fshRight">&nbsp;Ring:</td><td><input id="fshRing" type="checkbox" item="6"/></td><td class="fshRight">&nbsp;Amulet:</td><td><input id="fshAmulet" type="checkbox" item="7"/></td><td class="fshRight">&nbsp;Rune:</td><td><input id="fshRune" type="checkbox" item="8"/></td><td class="fshRight">&nbsp;Sets Only:</td><td><input id="fshSets" item="-1" type="checkbox"/></td><td></td><td class="fshRight">&nbsp;Max lvl:</td></tr><tr><td colspan="2">&nbsp;[<span id="fshAll" class="fshLink">Select All</span>]</td><td colspan="2">&nbsp;[<span id="fshNone" class="fshLink">Select None</span>]</td><td colspan="2">&nbsp;[<span id="fshDefault" class="fshLink">Defaults</span>]</td><td colspan="6"></td><td><input id="fshReset" type="button" value="Reset"/></td></tr><tr><td class="fshRight">&nbsp;Quest Item:</td><td><input id="fshQuest" item="9" type="checkbox"/></td><td class="fshRight">&nbsp;Potion:</td><td><input id="fshPotion" item="10" type="checkbox"/></td><td class="fshRight">&nbsp;Resource:</td><td><input id="fshResource" item="12" type="checkbox"/></td><td class="fshRight">&nbsp;Recipe:</td><td><input id="fshRecipe" item="13" type="checkbox"/></td><td class="fshRight">&nbsp;Container:</td><td><input id="fshContainer" item="14" type="checkbox"/></td><td class="fshRight">&nbsp;Frag Stash:</td><td><input id="fshStash" item="16" type="checkbox"/></td><td class="fshRight">&nbsp;Composed:</td><td><input id="fshComposed" item="15" type="checkbox"/></td><td></td></tr><tr><td class="fshRight">&nbsp;Common:</td><td><input id="fshCommon" item="100" type="checkbox" checked/></td><td class="fshRight">&nbsp;Rare:</td><td><input id="fshRare" item="101" type="checkbox" checked/></td><td class="fshRight">&nbsp;Unique:</td><td><input id="fshUnique" item="102" type="checkbox" checked/></td><td class="fshRight">&nbsp;Legendary:</td><td><input id="fshLegendary" item="103" type="checkbox" checked/></td><td class="fshRight">&nbsp;Super Elite:</td><td><input id="fshSuperElite" item="104" type="checkbox" checked/></td><td class="fshRight">&nbsp;Crystalline:</td><td><input id="fshCrystalline" item="105" type="checkbox" checked/></td><td class="fshRight">&nbsp;Epic:</td><td colspan="2"><input id="fshEpic" item="106" type="checkbox" checked/></td></tr></table>',ie={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,100:1,101:1,102:1,103:1,104:1,105:1,106:1},re={Perfect:{abbr:"Perf",colour:"#00b600",index:8},Excellent:{abbr:"Exc",colour:"#f6ed00",index:7},"Very Good":{abbr:"VG",colour:"#f67a00",index:6},Good:{abbr:"Good",colour:"#f65d00",index:5},Average:{abbr:"Ave",colour:"#f64500",index:4},Poor:{abbr:"Poor",colour:"#f61d00",index:3},"Very Poor":{abbr:"VPr",colour:"#b21500",index:2},Uncrafted:{abbr:"Unc",colour:"#666666",index:1}}
let ce={},oe=0,de=0
const le=()=>ce,ue=()=>oe,fe=()=>de
function pe(t){return re[t]?re[t].abbr:""}function me(t,e){const n=function(t){return t.folder_id?function(t){return t.equipped?"fshGreen":"fshNavy"}(t):function(t){return-1===t.player_id?"fshNavy":"fshMaroon"}(t)}(e)
t.classList.add(n),e.equipped&&t.classList.add("fshBold")}function he(t){return function(t){return t.player_id&&-1!==t.player_id}(t)||function(t){return t.folder_id&&-1!==t.guild_tag}(t)}function be(t){return`<span class="fshLink recallItem" invid="${t.inv_id}" playerid="${p(t.player_id,Ht().player_id)}" mode="1" action="recall">GS</span>`}function ve(t){return`<span class="fshLink storeItem" invid="${t.inv_id}">GS</span>`}function ye(t,e,n){return"display"===t?n(e):"GS"}function ge(t,e){const n=function(t){return-1===t.player_id?4:he(t)?7:1}(e),s=(a=Ht().player_id,i=e.player_id,r=Ht().guild_id,a||(-1!==i?i:r))
var a,i,r
let c=""
return function(t){return t.stats&&""!==t.stats.set_name}(e)&&(c=` (<span class="fshLink setName" set="${e.stats.set_name}">set</span>)`),`<a href="${h}${t}" class="fshInvItem tip-dynamic ${b[e.rarity].clas}" data-tipped="fetchitem.php?item_id=${e.item_id}&inv_id=${e.inv_id}&t=${n}&p=${s}">${t}</a>${c}`}const ke=[[t=>t.player_id&&-1===t.player_id,(t,e)=>`takeItem" action="${e.a}`],[t=>t.player_id&&t.player_id!==Ht().current_player_id,(t,e)=>`recallItem" playerid="${t.player_id}" mode="0" action="${e.a}`],[t=>function(t){return t.folder_id&&!t.equipped}(t)||function(t){return t.player_id&&!t.equipped&&t.player_id===Ht().current_player_id}(t),(t,e)=>e.c]]
function $e(t,e){const n=ke.find((([e])=>e(t)))
return n?`<span class="fshLink ${n[1](t,e)}" invid="${t.inv_id}">${e.b}</span>`:""}function _e(t){return p(t.folder_id,t.player_id)}function xe(t){return a.membrList[t]?a.membrList[t].username:"???"}function Ie(t,e){return t[0]-e[0]}function Re(t,e){return`<option value="${e[0]}"${Rt(Number(e[0]),t)}>${e[1]}</option>`}const we=[{title:"Name",data:"item_name",render:function(t,e,n){return"display"!==e?t:ge(t,n)}},{title:"Level",data:"stats.min_level"},{title:"Where",data:_e,render:{_:function(t,e,n){return n.folder_id?function(t){return t.equipped?-2:t.folder_id}(n):-1===n.player_id?"~":xe(n.player_id)},display:function(t,e,n){return n.player_id?function(t){return-1===t.player_id?"Guild Store":`<a class="fshMaroon" href="${v}${t.player_id}">${xe(t.player_id)}</a>`}(n):n.equipped?"Worn":`<select class="fshMoveItem" data-inv="${n.inv_id}">${s=n.folder_id,a=Ht().folders,y(a).sort(Ie).map(u(Re,s)).join("")}</select>`
var s,a},filter:function(t,e,n){return n.player_id?function(t){return-1===t.player_id?"Guild Store":xe(t.player_id)}(n):n.equipped?"Worn":Ht().folders[n.folder_id]}}},{title:"Type",data:"type",render:t=>g[t]},{title:"Att",data:"stats.attack"},{title:"Def",data:"stats.defense"},{title:"Arm",data:"stats.armor"},{title:"Dam",data:"stats.damage"},{title:"HP",data:"stats.hp"},{title:"Frg",data:"forge",render:function(t,e,n){if(n.type<9)return n.forge}},{title:"Craft",data:"craft",render:{_:t=>re[t]?re[t].index:0,display:pe,filter:pe}},{title:"Du%",data:"durability",render:function(t,e,n){if(n.type<9&&n.max_durability>0)return Math.floor(n.durability/n.max_durability*100)}},{title:"BP",data:_e,render:function(t,e,n){if(!n.folder_id&&n.player_id!==Ht().current_player_id)return function(t,e){return"display"!==t?"BP":-1===e.player_id?`<span class="fshLink takeItem" invid="${e.inv_id}" action="take">BP</span>`:`<span class="fshLink recallItem" invid="${e.inv_id}" playerid="${e.player_id}" mode="0" action="recall">BP</span>`}(e,n)}},{title:"GS",data:_e,render:function(t,e,n){return he(n)?ye(e,n,be):function(t){return t.folder_id&&!t.bound}(n)?ye(e,n,ve):void 0}},{title:"W/U",data:"type",render:function(t,e,n){const s=[1,1,1,1,1,1,1,1,1,null,2,2,null,null,null,2][t]
return 1===s?$e(n,{a:"wear",b:"Wear",c:"wearItem"}):2===s?$e(n,{a:"use",b:"Use",c:"useItem"}):void 0}},{title:"setName",data:"stats.set_name",orderable:!1,visible:!1},{title:"Tag",data:"guild_tag",render:t=>-1===t?"No":"Yes"},{title:"Drop",data:"type",render:function(t,e,n){if(!function(t){return-1!==t.guild_tag||t.equipped}(n))return"display"!==e?"Drop":`<span class="dropItem dropLink" data-tooltip="INSTANTLY DESTROY THE ITEM. NO REFUNDS OR DO-OVERS! Use at own risk." data-inv="${n.inv_id}">Drop</span>`}},{title:"Send",data:"type",render:function(t,e,n){if(!function(t){return t.equipped||-1===t.guild_tag&&t.bound}(n))return"display"!==e?"Send":`<span class="sendItem sendLink" data-tooltip="INSTANTLY SEND THE ITEM. NO REFUNDS OR DO-OVERS! Use at own risk." data-inv="${n.inv_id}">Send</span>`}}]
function Le(){return"player_id"in Ht()}function Se(){const t=function(){const t=It({className:"hover fshXSmall",id:Le()?"fshUserInv":"fshGuildInv"})
return n(r(),t),t}(),e=function(t){return $(t).DataTable({autoWidth:!1,columnDefs:[{targets:"_all",defaultContent:""},{targets:[1,4,5,6,7,8,9,10,12,13],orderSequence:["desc","asc"]}],columns:we,createdRow:me,data:Ht().items,deferRender:!0,lengthMenu:[[50,100,150,200,-1],[50,100,150,200,"All"]],pageLength:50,stateDuration:0,stateSave:!0})}(t)
return function(t){[[12,"current_player_id"in Ht()],[17,Le()&&ue()],[18,Le()&&fe()]].forEach((([e,n])=>t.column(e).visible(n)))}(e),t}function Me(t){k(`fsh_${a.subcmd}`,t)}function Ee(){_('table.fshInvFilter input[type="checkbox"]').forEach((t=>{t.checked=1===le().checkedElements[t.getAttribute("item")]})),Me(le())}function Te(t){Kt("Select All"),le().checkedElements=ie,Ee(),$(t).DataTable().draw(!1)}function De(t,e){le().fshMinLvl=t,le().fshMaxLvl=e,Me(le())}function je(t){$(t).DataTable().draw(!1)}function Ne(t){Kt("changeLvls"),wt(De,u(je,t))}function Ce(t){return Number(t[0])>=100}function Ae(t,e){return t[e[0]]=e[1],t}function Ge(t){var e
Kt("Select None"),le().checkedElements=(e=le().checkedElements,y(e).filter(Ce).reduce(Ae,{})),Ee(),$(t).DataTable().draw()}function qe(t){Kt("Checkbox"),le().checkedElements={},_('table.fshInvFilter input[type="checkbox"][item]:checked').forEach((t=>{le().checkedElements[t.getAttribute("item")]=1})),Me(le()),$(t).DataTable().draw(!1)}function Pe(t){Kt("Defaults"),le().checkedElements=se.checkedElements,Ee(),$(t).DataTable().draw(!1)}function Ue(t){Kt("Reset levels"),le().fshMinLvl=se.fshMinLvl,le().fshMaxLvl=se.fshMaxLvl,Me(le()),function(t){$("#fshMinLvl").val(le().fshMinLvl),$("#fshMaxLvl").val(le().fshMaxLvl),$(t).DataTable().draw(!1)}(t)}async function Oe(t){const e=await kt(t)
return St(e)}function Be(t){return Tt({subcmd2:"dostoreitems",items:t})}async function Fe(t){const e=await x({cmd:"guild",subcmd:"inventory",subcmd2:"dostoreitems",storeIndex:t})
return Dt(e)}async function We(t){const e=await function(t){return I(Be,Fe,t)}(t)
return jt(e),St(e)}function He(t,e){t.eq(e).empty()}function Ve(t,e){if(1===e.r)return
const n=t.closest("tr")
!function(t){[2,12,13,14,15,16].forEach(u(He,t))}($("td",n)),n.css("text-decoration","line-through")}async function Qe(t,e){R(e),function(t){t.closest("tr").find(".takeItem, .recallItem, .wearItem, .dropItem, .sendItem, .storeItem").removeClass()}(e),function(t){t.empty().append(`<img src="${w}ui/misc/spinner.gif" width="11" height="11">`)}(e)
const n=await t()
n&&Ve(e,n)}function Ye(t,e){te("setName"),$(t).DataTable().search(e.attr("set")).draw(),$(`#${t.id}_filter input`).trigger("focus")}function Xe(t){te("takeItem"),Qe(u(Nt,t.attr("invid"),t.attr("action")),t)}function Je(t){te("recallItem"),Qe(u(Ct,t.attr("invid"),t.attr("playerid"),t.attr("mode"),t.attr("action")),t)}function ze(t,e,n,s){te(n),Qe(u(t,e),s)}function Ze(t){ze(We,[t.attr("invid")],"doStoreItem",t)}function Ke(t,e,n){ze(t,n.attr("invid"),e,n)}const tn=t=>Ke(Mt,"doUseItem",t),en=t=>Ke(Et,"doWearItem",t)
function nn(t,e,n){ze(t,[n.data("inv")],e,n)}const sn=t=>nn($t,"doDropItem",t),an=t=>nn(Oe,"doSendItem",t),rn=t=>e=>t($(e.target))
function cn(t,[e,n]){$(t).on("click",`span.${e}`,rn(n))}function on(t){te("doMoveItem")
const e=$(t.target)
_t([e.data("inv")],e.val())}function dn(t,e){$(e[0]).on("click",u(e[1],t))}const ln=t=>()=>{te(t)}
function un(t){!function(t){[["#fshReset",Ue],["#fshAll",Te],["#fshNone",Ge],["#fshDefault",Pe]].forEach(u(dn,t))}(t),$("table.fshInvFilter").on("click",'input[type="checkbox"]',u(qe,t)),function(t){[["dropItem",sn],["recallItem",Je],["sendItem",an],["setName",u(Ye,t)],["storeItem",Ze],["takeItem",Xe],["useItem",tn],["wearItem",en]].forEach(u(cn,t))}(t),function(t){["fshInvItem","fshMaroon","sorting"].forEach((e=>{$(t).on("click",`.${e}`,ln(e))}))}(t)}let fn=0
function pn(t,e){return Gt(fn,L(e[1]),le().fshMinLvl,le().fshMaxLvl)}function mn(){fn=[(t,e,n)=>0===n,...At],$.fn.dataTable.ext.search.push(pn)}function hn(){$.fn.dataTable.ext.search.push(((t,e,n,s)=>!le().checkedElements||le().checkedElements[s.type]))}function bn(){$.fn.dataTable.ext.search.push(((t,e,n,s)=>!le().checkedElements?.[-1]||function(t){return le().checkedElements[-1]&&t.stats&&""!==t.stats.set_name}(s)))}function vn(){$.fn.dataTable.ext.search.push(((t,e,n,s)=>{const a=(parseInt(s.rarity,10)+100).toString()
return!le().checkedElements||le().checkedElements[a]}))}function yn(t){let e,n,s,a,i,r,c,o,d
return{c(){e=T("div"),n=T("div"),n.textContent="Recall all visible to",s=D(),a=T("div"),i=T("button"),i.textContent="BP",r=D(),c=T("button"),c.textContent="GS",j(n,"class","head svelte-1mlms3r"),j(i,"class","custombutton svelte-1mlms3r"),j(i,"type","button"),j(c,"class","custombutton svelte-1mlms3r"),j(c,"type","button"),j(a,"class","btnbox svelte-1mlms3r"),j(e,"class","main svelte-1mlms3r")},m(l,u){N(l,e,u),C(e,n),C(e,s),C(e,a),C(a,i),C(a,r),C(a,c),o||(d=[A(i,"click",t[0]),A(c,"click",t[1])],o=!0)},p:G,i:G,o:G,d(t){t&&q(e),o=!1,P(d)}}}function gn(t){const e=t=>{l("Inventory","Recall All",t)}
return[function(){e("toBp"),[..._('span[action="take"]'),..._('span[mode="0"][action="recall"]')].forEach(U)},function(){e("toGs"),_('span[mode="1"][action="recall"]').forEach(U)}]}class kn extends S{constructor(t){super(),M(this,t,gn,yn,E,{})}}function $n(t){let e,n,s,a
return{c(){e=T("button"),n=B("BP"),j(e,"class","custombutton svelte-fvareh"),e.disabled=t[0],j(e,"type","button")},m(i,r){N(i,e,r),C(e,n),s||(a=A(e,"click",t[4],{once:!0}),s=!0)},p(t,n){1&n&&(e.disabled=t[0])},d(t){t&&q(e),s=!1,a()}}}function _n(t){let e,n={ctx:t,current:null,token:null,hasCatch:!1,pending:Rn,then:In,catch:xn}
return F(t[3](),n),{c(){e=W(),n.block.c()},m(t,s){N(t,e,s),n.block.m(t,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e},p(e,n){t=e},d(t){t&&q(e),n.block.d(t),n.token=null,n=null}}}function xn(t){return{c:G,m:G,d:G}}function In(t){let e
return{c(){e=T("span"),e.textContent="Recalled",j(e,"class","fshGreen")},m(t,n){N(t,e,n)},d(t){t&&q(e)}}}function Rn(t){let e
return{c(){e=T("span"),j(e,"class","fshSpinner")},m(t,n){N(t,e,n)},d(t){t&&q(e)}}}function wn(t){let e,n,s,a,i,r
function c(t,e){return t[1]?_n:$n}let o=c(t),d=o(t)
return{c(){e=T("div"),n=T("div"),n.textContent="Recall repairable to",s=D(),a=T("div"),d.c(),i=D(),r=T("div"),r.textContent=`${t[2].length} items to repair`,j(n,"class","head svelte-fvareh"),j(a,"class","btnbox svelte-fvareh"),j(r,"class","btnbox svelte-fvareh"),j(e,"class","main svelte-fvareh")},m(t,c){N(t,e,c),C(e,n),C(e,s),C(e,a),d.m(a,null),C(e,i),C(e,r)},p(t,[e]){o===(o=c(t))&&d?d.p(t,e):(d.d(1),d=o(t),d&&(d.c(),d.m(a,null)))},i:G,o:G,d(t){t&&q(e),d.d()}}}function Ln(t,e,n){let{fshInv:s=0}=e,a=1,i=0
const r=new DataTable(s).rows(((t,{durability:e,max_durability:n,player_id:s,rarity:a,type:i})=>e<n&&-1===s&&5!==a&&i<9)),c=O(r.data())
return c.length&&(a=0),t.$$set=t=>{"fshInv"in t&&n(5,s=t.fshInv)},[a,i,c,function(){return qt(c.map((({inv_id:t})=>t)))},function(){n(1,i=1)},s]}class Sn extends S{constructor(t){super(),M(this,t,Ln,wn,E,{fshInv:5})}}function Mn(t){let e,n,s,a,i,r,c,o,d,l=(t[0]||"")+"",u=(t[1]||"")+""
return{c(){e=T("div"),n=B("Chunks needed: "),s=T("span"),a=B(l),i=D(),r=T("div"),c=B("Chunks received: "),o=T("span"),d=B(u)},m(t,l){N(t,e,l),C(e,n),C(e,s),C(s,a),N(t,i,l),N(t,r,l),C(r,c),C(r,o),C(o,d)},p(t,e){1&e&&l!==(l=(t[0]||"")+"")&&V(a,l),2&e&&u!==(u=(t[1]||"")+"")&&V(d,u)},d(t){t&&(q(e),q(i),q(r))}}}function En(t){let e,n,s,a,i,r,c,o,d,l,u,f,p,m,h,b,v,y,g,k,$,_=t[0]&&Mn(t)
return{c(){e=T("div"),n=T("div"),s=B("Update Stats\n    "),a=T("div"),i=B("[\n      "),r=T("div"),c=T("span"),o=B("?"),d=B("\n      ]"),l=D(),u=T("div"),f=T("button"),f.textContent="On page",p=D(),m=T("button"),m.textContent="All",h=D(),b=T("div"),v=T("button"),v.textContent="Clear cache",y=D(),g=T("div"),_&&_.c(),j(c,"class","tooltip-multiline"),j(c,"data-tooltip",t[5]),j(r,"class","tooltip svelte-15yybge"),j(a,"class","wrapper svelte-15yybge"),j(n,"class","head svelte-15yybge"),j(f,"class","custombutton svelte-15yybge"),j(f,"type","button"),j(m,"class","custombutton svelte-15yybge"),j(m,"type","button"),j(u,"class","btnbox svelte-15yybge"),j(v,"class","custombutton svelte-15yybge"),j(v,"type","button"),j(b,"class","btnbox svelte-15yybge"),j(g,"class","chunkbox svelte-15yybge"),j(e,"class","main svelte-15yybge")},m(x,I){N(x,e,I),C(e,n),C(n,s),C(n,a),C(a,i),C(a,r),C(r,c),C(c,o),C(a,d),C(e,l),C(e,u),C(u,f),C(u,p),C(u,m),C(e,h),C(e,b),C(b,v),C(e,y),C(e,g),_&&_.m(g,null),k||($=[A(f,"click",t[2]),A(m,"click",t[3]),A(v,"click",t[4])],k=!0)},p(t,[e]){t[0]?_?_.p(t,e):(_=Mn(t),_.c(),_.m(g,null)):_&&(_.d(1),_=null)},i:G,o:G,d(t){t&&q(e),_&&_.d(),k=!1,P($)}}}function Tn(t,e,n){let{fshInv:s=0}=e
const r=new DataTable(s)
let c=0,o=0
async function d([t,e,s]){const a=await Z(t,e,s)
return n(1,o+=1),a}async function u(t){const e=r.rows(Y,t),s=X(O(e.data()))
n(0,c=s.length),n(1,o=0)
const a=await i(s.map(d))
e.every(J(a.flatMap(z))),r.draw()}const f=t=>{l("Inventory","Update Stats",t)}
H(s)
return t.$$set=t=>{"fshInv"in t&&n(6,s=t.fshInv)},[c,o,async function(){f("On page"),u({page:"current"})},function(){f("All"),u()},async function(){f("Clear cache"),await k(`fsh_${a.subcmd}_cache`,[]),U(Q("fshRefresh"))},"This allows you to update the stats of items. It is useful in cases where stats are missing or if you want accurate stats for forged items. It can be slow for large data sets. The results are cached and will be used automatically next time you visit this page. You will need to update again if these stats become stale. For example, if you forged or crafted an item, or if a guild store item has moved.",s]}class Dn extends S{constructor(t){super(),M(this,t,Tn,En,E,{fshInv:6})}}function jn(t){let e
return{c(){e=T("div")},m(t,n){N(t,e,n)},p:G,i:G,o:G,d(t){t&&q(e)}}}function Nn(t){let e,n,s,a
return e=new kn({}),s=new Sn({props:{fshInv:t[0]}}),{c(){K(e.$$.fragment),n=D(),K(s.$$.fragment)},m(t,i){tt(e,t,i),N(t,n,i),tt(s,t,i),a=!0},p(t,e){const n={}
1&e&&(n.fshInv=t[0]),s.$set(n)},i(t){a||(et(e.$$.fragment,t),et(s.$$.fragment,t),a=!0)},o(t){nt(e.$$.fragment,t),nt(s.$$.fragment,t),a=!1},d(t){t&&q(n),st(e,t),st(s,t)}}}function Cn(t){let e,n,s,i,r,c
const o=[Nn,jn],d=[]
return n="guildinvmgr"===a.subcmd?0:1,s=d[n]=o[n](t),r=new Dn({props:{fshInv:t[0]}}),{c(){e=T("div"),s.c(),i=D(),K(r.$$.fragment),j(e,"class","container svelte-1tjz5ud")},m(t,s){N(t,e,s),d[n].m(e,null),C(e,i),tt(r,e,null),c=!0},p(t,[e]){s.p(t,e)
const n={}
1&e&&(n.fshInv=t[0]),r.$set(n)},i(t){c||(et(s),et(r.$$.fragment,t),c=!0)},o(t){nt(s),nt(r.$$.fragment,t),c=!1},d(t){t&&q(e),d[n].d(),st(r)}}}function An(t,e,n){let{fshInv:s=0}=e
return t.$$set=t=>{"fshInv"in t&&n(0,s=t.fshInv)},[s]}class Gn extends S{constructor(t){super(),M(this,t,An,Cn,E,{fshInv:0})}}function qn(t){!function(t){new Gn({props:{fshInv:t},target:r()})}(t)}const Pn=()=>Ht().player_id?`<b>&nbsp;Inventory Manager</b> ${Ht().items.length} items (green = worn, blue = backpack)`:`<b>&nbsp;Guild Inventory Manager</b> ${Ht().items.length} items (maroon = in BP, blue=guild store)`
function Un(){const t=Pn()
it("",r()),function(){if(!Bt())return
Ft(n(Q("pF"),ct({style:{textAlign:"center"}})))}(),rt(r(),ae.replace("@@reportTitle@@",t))}function On(){at(Ht().items)&&Un()}function Bn(){$("#fshMinLvl").val(le().fshMinLvl),$("#fshMaxLvl").val(le().fshMaxLvl)}const Fn=([,t])=>[t.id,t]
function Wn(t){ft([ne,mn,hn,bn,vn,On,Ee,Bn])
const e=Se()
!function(t){$("#fshMinLvl, #fshMaxLvl").on("keyup",u(Ne,t)),$(t).on("change","select.fshMoveItem",on),un(t),Lt(t,ln,te)}(e),$("#fshRefresh").on("click",t),function(t){const e=$(`#${t.id}_filter input`)
e.prop("type","text")
const n=$("<span>&times;</span>")
e.wrap($('<span class="text-input-wrapper"/>')),e.after(n),n.on("click",u(ee,t,e))}(e),qn(e)}function Hn(t){Wn(t)}const Vn=()=>Object.getOwnPropertyNames(Ht()).length
async function Qn(e){const n=[pt(),Zt()]
"guildinvmgr"===a.subcmd&&n.push(async function(){await t(!1),a.membrList&&(a.membrList=lt(y(a.membrList).filter(Pt).map(Fn)))}()),n.push(async function(){const t=await f(`fsh_${a.subcmd}`)
ce={...ht(se),...p(t,{})},oe=m("showQuickDropLinks"),de=m("showQuickSendLinks")}()),await i(n),Vn()&&function(t){ut(3,Hn,[t])}(e)}function Yn(){!ot()&&r()&&("guildinvmgr"!==a.subcmd||o())&&(it(`<span id="fshInvMan"><img src = "${dt}">&nbsp;Getting inventory data...</span>`,r()),Qn(Yn))}export{Yn as default}
//# sourceMappingURL=inventory-SGpXkvsh.js.map
