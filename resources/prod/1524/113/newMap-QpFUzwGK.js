import{e}from"./executeAll-EzEelzhH.js"
import{ab as t,m as a,g as n,a4 as r,i as o,c as s,v as l,o as i,s as c,ax as u,ay as f,az as d,aA as m,aB as p,aC as h,y as g,b as v,ad as b,aD as w,aE as y,aF as k,aG as C,a9 as L,k as V,av as D,q as M,aH as x,aI as A,D as S,aJ as N,aK as H,aL as B,aM as q,aN as T,aO as E,aP as G,aQ as j,aR as P,aS as F,aT as R,ae as _,a3 as I,aU as O,aV as W,aW as K,a as Y,$ as U,S as z,J as Q,K as J,ah as X,P as Z,W as ee,X as te,L as ae,_ as ne,aX as re,Q as oe,a0 as se,M as le,N as ie,aY as ce,aZ as ue,a_ as fe,a$ as de,U as me,b0 as pe,d as he,b1 as ge,b2 as ve,b3 as be,b4 as we,b5 as ye,b6 as ke,b7 as Ce,b8 as $e,b9 as Le,ba as Ve,bb as De,bc as Me,bd as xe,be as Ae,bf as Se,bg as Ne,bh as He,bi as Be,bj as qe,bk as Te,bl as Ee,bm as Ge,bn as je,bo as Pe,bp as Fe,bq as Re,br as _e,bs as Ie,bt as Oe,bu as We,bv as Ke,bw as Ye,bx as Ue,by as ze,ac as Qe}from"./calfSystem-VUa7wwu1.js"
import{i as Je}from"./insertElementAfter-2yfejYPO.js"
import{t as Xe}from"./toggleForce-4Mg38a6N.js"
import{c as Ze}from"./createSpan-3W4T-7NF.js"
import{i as et}from"./insertTextBeforeEnd-l_wbz-Jp.js"
import{r as tt,a as at}from"./roundToString-8wwt6Rp-.js"
import{a as nt}from"./addCommas-olJWnOGa.js"
import{d as rt,q as ot}from"./quickbuffSuccess-PSjDKbwo.js"
import{c as st}from"./createButton-jRLKoafr.js"
import{i as lt}from"./isArray-bNviZzJA.js"
import{o as it}from"./openQuickBuffById-XivPrE3T.js"
import{p as ct}from"./playerId-wTCAZ6WR.js"
import{c as ut}from"./createInput-NNh8Iaam.js"
import{c as ft}from"./createLabel-8iz0jsGz.js"
import{g as dt,s as mt}from"./idb-gpu32B-C.js"
import{r as pt}from"./rnd-7E7YIwpb.js"
import{v as ht}from"./valueText-13w7MOtM.js"
import{c as gt}from"./createStyle-RLyU9kJv.js"
import{h as vt,u as bt}from"./await_block-5SUqwqnQ.js"
import{e as wt,u as yt,d as kt}from"./each-z4oZkgsq.js"
import{u as Ct}from"./uniq-zrnDDej-.js"
import{g as $t}from"./guild-K9OhcFT0.js"
import{c as Lt}from"./createTable-pRrgqwY-.js"
import{g as Vt,t as Dt,a as Mt}from"./getTitanString-Fx1fxwUU.js"
import{n as xt,a as At,s as St,r as Nt}from"./now-pQzGw6vd.js"
import{p as Ht}from"./padZ-zYXZ2AFi.js"
import{f as Bt}from"./fshOpen-16hNCxKt.js"
import{c as qt}from"./chunk-joYXv2f3.js"
import{L as Tt}from"./LinkButton-ssp0QiF9.js"
import{r as Et}from"./reduceBuffArray-twG3MySG.js"
import{p as Gt}from"./profile-vhoHWGzK.js"
import{a as jt}from"./all-TTLWag-d.js"
import{n as Pt}from"./numberIsNaN--k2kVli9.js"
import{r as Ft}from"./reliclist-ayaxD72M.js"
import{d as Rt}from"./daGroupStats-z3rqlBac.js"
import{d as _t,m as It}from"./mercEffect-t7jXlZkT.js"
import{d as Ot}from"./daViewGroups-FGKUUtlR.js"
import{a as Wt}from"./attribsToArray-a5Vcnr-O.js"
import{g as Kt}from"./guildMembers-hej1TkS-.js"
import{r as Yt}from"./remainingPages-B8w0PByy.js"
import{t as Ut}from"./testQuant-ornCemKk.js"
import{m as zt}from"./myStats-8fU-XIMi.js"
import{s as Qt}from"./shouldBeArray-t5sXrRGh.js"
import{h as Jt}from"./hideElement-RABq1RME.js"
import{s as Xt,j as Zt}from"./simpleCheckbox-8yANFw8B.js"
import{i as ea}from"./isSelected-tg-1ZNBk.js"
import{b as ta}from"./bitwiseAnd-b_h0Z7XX.js"
import"./buffReportParser-ZXM7piOF.js"
import"./buffObj-QxLUrgH2.js"
import"./guildGroups-F7P2MLMQ.js"
import"./view-Z0srADtw.js"
import"./intValue-JHhLnq8V.js"
import"./csvSplit-5pKrKSoh.js"
import"./isChecked-k2ijSL8v.js"
let aa=0
function na(e){return e}function ra(e){if(function(e){return t.showBuffInfo&&e.some(na)}(e))return function(){if(aa)Xe(aa,!1)
else{aa=a({className:"fshActionBox",innerHTML:"<div></div><div></div><div></div><div></div><div></div>"})
const e=n("actionContainer")
Je(aa,e.children[2])}return aa}()
aa&&Xe(aa,!0)}function oa(e,t,a,n){t&&(e.className=t),r(a,e)
const s=Ze()
return o(e,s),et(e,n),s}let sa=0,la=0
function ia(e,t){sa?Xe(sa,!1):function(e){sa=e.children[3],la=oa(sa,"fshBlue","CA "," active")}(e),r(t.level,la)}function ca(e,t){t?ia(e,t):sa&&Xe(sa,!0)}let ua=0,fa=0
function da(e,t){ua?Xe(ua,!1):function(e){ua=e.children[4],fa=oa(ua,"fshRed","Doubler "," active")}(e),r(t.level,fa)}function ma(e,t){t?da(e,t):ua&&Xe(ua,!0)}let pa=0,ha=0
function ga(e,t,a){pa?Xe(pa,!1):function(e){pa=e.children[2],ha=oa(pa,"","Damage bonus: ","%")}(e),r(function(e,t){if(e){const a=Math.min(.01*Math.round(Math.floor(t/5)*Number(e.level)),20)
return tt(a,2).toString()}return"0"}(t,Number(a)),ha)}function va(e,t,a){t?ga(e,t,a):pa&&Xe(pa,!0)}let ba=0,wa=0
function ya(e,t){ba?Xe(ba,!1):function(e){ba=e.children[1],wa=oa(ba,"","Kill Streak: ","")}(e),function(e,t){r(nt(e),t)}(t,wa)}function ka(e,t,a,n){t||a?ya(e,n):ba&&Xe(ba,!0)}function Ca(e,t){return t.name===e}function $a(e){const{buffs:t}=GameData.player()
if(t)return t.find(s(Ca,e))}const La=["red","orange","yellow"]
let Va=0,Da=0
async function Ma(){if(c("NewMap","recastClick"),$a("Summon Shield Imp"))return
!function(e){ot(e)&&GameData.fetch(f)}(await rt([u()],[55]))}const xa=["imp-0","imp-1","imp-1"]
function Aa(e,t){Va?Xe(Va,!1):function(e){[Va]=e.children,r("Shield Imps Remaining: ",Va),Da=Ze(),o(Va,Da),l(Va,"&nbsp;")
const t=st({className:"xSmallLink",textContent:"Recast"})
o(Va,t),i(t,Ma)}(e)
const a=function(e){return e?Number(e.stack):0}(t)
Va.className=function(e){return xa[e]??"fshGreen"}(a),r(a,Da)}function Sa(e,t,a){t||a?Aa(e,t):Va&&Xe(Va,!0)}function Na(e){return 0===e.type}let Ha=0,Ba=0,qa=0,Ta=0,Ea=0,Ga=0
function ja(){Ha=$a("Death Dealer"),Ba=$a("Doubler"),qa=$a("Counter Attack"),Ta=$a("Summon Shield Imp"),Ea=function(){const{dynamic:e}=GameData.realm()
return lt(e)&&e.some(Na)}(),Ga=GameData.player().killStreak}function Pa(){!function(){const e=$("#actionlist-shield-imp")
1===e.length&&e.css("background-color",La[e.text()]||"#ad8043")}(),ja()
const e=ra([Ha,Ba,qa,Ta,Ea])
e&&(Sa(e,Ta,Ha),ka(e,Ha,Ea,Ga),va(e,Ha,Ga),ca(e,qa),ma(e,Ba))}function Fa(e){return Ze({textContent:e})}function Ra(){window.GameController&&GameController.Realm&&!GameController.Realm.footprintTileList&&(GameController.Realm.footprintTileList=[])}function _a(e,t,a){return ft({className:`fshCurveEle fshCurveLbl fshPoint tip-static ${e}`,dataset:{tipped:t},htmlFor:a})}function Ia(e){const t=a({className:"fshToggle"}),n=ut({checked:e.prefVal,id:e.checkId,type:"checkbox"})
o(t,n)
const r=_a(e.onClass,e.onTip,e.checkId)
o(t,r)
const s=_a(e.offClass,e.offTip,e.checkId)
return o(t,s),o(e.worldName,t),n}let Oa=0,Wa=0,Ka=0,Ya=0,Ua=0,za=0,Qa=0,Ja=0,Xa=0
const Za=e=>Fa(e?e.toString():"?")
function en(e,t,n){const r=a({textContent:`${t} Lvl: `})
o(r,n),o(e,r)}function tn(e,t,a){const n=st({className:`fshCurveEle fshCurveBtn fshPoint tip-static ${e}`,dataset:{tipped:t}})
return o(a,n),n}function an(e){!function(e){const t=a({className:"fshFsty"})
Wa=Za(GameData.realm().minlevel),en(t,"Min",Wa),Ka=Za(GameData.player().level),en(t,"Your",Ka),o(e,t)}(e),Ya=tn("fshFormGroup","Quick Create Attack Group",e),Ua=tn("fshQuickBuff","Open Quick Buff Popup",e),za=tn("fshRealmMap","Open Realm Map",e),Qa=tn("fshTempleOne","Search map in Ultimate FSG",e)}function nn(){an(Oa),function(e){if(b("showSpeakerOnWorld")){const t=b("playNewMessageSound")
Ja=Ia({prefVal:t,checkId:"fshSoundCheck",onClass:"soundOn",onTip:"Turn Off Sound when you have a new log message",offClass:"soundOff",offTip:"Turn On Sound when you have a new log message",worldName:e})}}(Oa),function(e){const a=t.huntingMode
Xa=Ia({prefVal:a,checkId:"fshHuntCheck",onClass:"huntOn",onTip:"Hunting mode is ON",offClass:"huntOff",offTip:"Hunting mode is OFF",worldName:e})}(Oa)}const rn=[[()=>Ja,function(){c("NewMap","toggleSound"),L("playNewMessageSound",!b("playNewMessageSound"))}],[()=>Xa,function(){c("NewMap","toggleHuntMode"),t.huntingMode=!t.huntingMode,L("huntingMode",t.huntingMode)}]],on=[[()=>Ya,function(e){c("NewMap","doFormGroup"),w(e),GameData.doAction(12,401,{},0)}],[()=>Ua,function(){c("NewMap","openQuickBuff"),it(ct())}],[()=>za,function(){c("NewMap","openRealmMap"),window.open(`${y+k}map`,"fsMap")}],[()=>Qa,function(){c("NewMap","openUfsgMap")
const e=GameData.realm()
window.open(`${C}realms${k}view&realm_id=${e.id}`,"mapUfsg")}]]
function sn(e,t){const{target:a}=t,[,n]=e.find((([e])=>e()===a))??[]
n&&(a.blur(),n(a))}function ln(e){return s(sn,e)}function cn(){Oa||(Oa=a({className:"fshCurveContainer",id:"fshWorldButtonContainer"}),nn(),i(Oa,ln(on)),v(Oa,"change",ln(rn)),g(Oa,n("worldCoord")))}function un(e,t){Wa&&t.b.minlevel&&(Ra(),r(t.b.minlevel,Wa))}function fn(e,t){Ka&&r(t.b,Ka)}const dn=["NORMAL","CHAMPION","ELITE","SUPER ELITE","TITAN","LEGENDARY"],mn=`url("${x}ui/world/icon_action_attack_`
let pn=!1
function hn(e){return M(".verb.attack",e)}function gn(e){const t=dn.indexOf(e.toUpperCase())
return V(`#actionList .actionListItem.creature.creature-${t}`)}function vn(e){e.classList.remove("attack-1","attack-2","attack-3","attack-4","attack-5","attack-6","attack-7","attack-8"),e.style.backgroundImage=""}function bn(e,t){null!==e&&(e.classList.add(`attack-${t+1}`),e.style.backgroundImage=`${mn}${t+1}.png")`)}function wn(e){const t=["LEGENDARY","NORMAL"].flatMap(gn),a=gn("CHAMPION"),[n,r]=e?[t,a]:[a,t]
n.map(hn).filter((e=>null!==e)).forEach(vn),r.slice(0,8).map(hn).forEach(bn)}function yn(e){if(!e.altKey||!e.shiftKey||"INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName)return
if(pn||wn(!0),pn=!0,!/(?:Digit|Numpad)[1-8]/.test(e.code))return
const t=gn("CHAMPION"),a=parseInt(e.code.slice(-1),10)-1
a<t.length&&function(e){const t=hn(e)
t&&(c("NewMap","ChampionAttack"),D(t))}(t[a])}function kn(e){!pn||e.ctrlKey&&e.shiftKey||(pn=!1,wn(!1))}const Cn=["Breaker","Protection","Master Thief","Protect Gold","Disarm","Duelist","Thievery","Master Blacksmith","Master Crafter","Fury Caster","Master Inventor","Sustain"]
let $n=[],Ln=0
function Vn(e){54!==e.id&&26!==e.id||(Ln.player.buffs[e.id]=parseInt(e.level,10))}function Dn(e){-1===Cn.indexOf(e.name)&&(Ln.player.enhancements[e.name]=e.value)}function Mn(e){Ln={},Ln.combat=e.response.data,Ln.combat.inventory_id&&(Ln.combat.drop=Ln.combat.item.id),Ln.player={},Ln.player.buffs={},Ln.player.enhancements={},function(e){e.player.buffs&&e.player.buffs.forEach(Vn)}(e),function(e){e.player.enhancements&&e.player.enhancements.forEach(Dn)}(e),Ln.time=e.time,$n.push(Ln),mt("fsh_combatLog",$n)}function xn(e,t){0===t.response.response&&Mn(t)}function An(e){return!e?.response?.data}async function Sn(e){const t=await N({cache:!1,url:"fetchdata.php",data:{...e,fshrnd:pt()},dataType:"text"})
return H(t)??{response:{msg:"Server Error",response:1}}}const Nn=[]
const Hn=(e,t)=>e===Number(t.response.data.id)
function Bn(e,t){e(t)}async function qn(e,t){const a=Nn.find(s(Hn,e))
if(a)return function(e){return new Promise((t=>{B(3,Bn,[t,e])}))}(a)
const n=await Sn({a:1,d:0,id:e,passback:t})
return function(e){An(e)||Nn.push(e)}(n),n}let Tn=0,En=0,Gn=0,jn=0,Pn=0,Fn=0
const Rn=()=>Tn,_n=()=>En,In=()=>Gn,On=()=>jn,Wn=()=>Pn,Kn=()=>Fn
function Yn(e,t){return ht(q(t,e))}function Un(){var e
Tn=GameData.player().level,e=n("statbar-character-tooltip-stats"),Gn=Yn(e,T),En=Yn(e,E),Pn=Yn(e,G),jn=Yn(e,j),Fn=Yn(e,P)}const zn=e=>`<td>${e}:&nbsp;</td>`,Qn=e=>`<td width="40%">${e}</td>`
function Jn([e,t,a,n,r]){return[zn(e),Qn(`${t} (your ${a}:<span class="${n}">${r()}</span>)`)]}function Xn(e){return["<tr>",...e,"</tr>"].join("")}function Zn(e,t){return Xn([...Jn(e),...Jn(t)])}const er='<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Enhancements</td></tr>'
function tr(e){return`<tr><td colspan="2">${e.name}:</td><td colspan="2">${e.value}</td></tr>`}function ar(e,t,a){return function(e){return`<table><tr><td><img src="${x}creatures/${e.image_id}.png" height="200" width="200"></td><td rowspan="2"><table width="400"><tr><td class="header" colspan="4" class="fshCenter">Statistics</td></tr>`}(e)+function(e,t){return Xn([zn("Class"),Qn(e.creature_class),...Jn(["Level",e.level,"level",t,Rn])])}(e,a)+function(e){return Zn(["Attack",e.attack,"defense","fshYellow",_n],["Defense",e.defense,"attack","fshYellow",In])}(e)+function(e){return Zn(["Armor",e.armor,"damage","fshYellow",On],["Damage",e.damage,"armor","fshYellow",Wn])}(e)+function(e,t){return Xn([zn("HP"),Qn(`${e.hp} (your HP:<span class="fshYellow">${Kn()}</span>)(1H: <span class="fshRed">${t}</span>)`),zn("Gold"),Qn(e.gold)])}(e,t)+er+function(e){return 0===e.enhancements.length?'<tr><td colspan="4">[no enhancements]</td></tr>':e.enhancements.map(tr).join("")}(e)+function(e){return`<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Description</td></tr><tr><td colspan="4">${e.description}</td></tr><tr><td colspan="4" height="5"></td></tr></table></td></tr><tr><td class="fshCenter"><b>${e.name}</b></td></tr></table>`}(e)}function nr(e){if(!An(e))return function(e){const a=Math.ceil(e.hp*t.hpVariable+e.armor*t.generalVariable)
let n="fshYellow"
return Un(),Rn()>e.level&&(n="fshRed"),ar(e,a,n)}(e.response.data)}const rr=["verb","view","tip-static"]
async function or(e,t){const a=function(e){return F(e.parentNode.children).indexOf(e)}(e),n=await qn(GameData.actions()[a].data.id,a)
An(n)||function(e,t){const a=nr(t)
e.set("content.text",a)}(t,n)}function sr(e,t){c("NewMap","CreatureInfo"),e.classList.add("fshTip")
var a
const n=(a="Loading...",$(e).qtip({overwrite:!0,show:{event:"mouseover",ready:!0},style:{classes:"qtip-tipsy qtip-custom"},position:{my:"center right",at:"center left",effect:!1,viewport:$(window)},content:{text:a},hide:{effect:!1}})).qtip("api")
n&&or(t,n)}function lr(e,t){return a=e,rr.every((e=>S(e,a)))&&!S("fshTip",e)&&S("creature",t)
var a}function ir(e){if(!t.showCreatureInfo)return
const{target:a}=e,n=a.parentNode.parentNode.parentNode
lr(a,n)&&sr(a,n)}function cr(e){return t.doNotKillList.includes(R(e))}function ur(e){e.classList.toggle("fshBlue",cr(I(e)))}function fr(){const e=n("actionList")
_("creature",e).forEach(ur)}function dr(e){const t=GameData.actions()[e]
if(t)return function(e,t){if(cr(e))return n("actionList").children[t].children[0].children[1].classList.remove("loading"),!0}(t.data.name,e)}const mr={2:function(e){return function(t,a,n,r){c("NewMap","interceptCreatureCombat"),dr(n.passback)||e(t,a,n,r)}}}
function pr(e){return function(t,a,n,r){const o=mr[t];(function(e){return e&&W(e)})(o)&&function(e){return O(e)||0===e}(r)?o(e)(t,a,n,r):e(t,a,n,r)}}function hr(){return e={subcmd:"contrib"},Y({cmd:"globalquests",...e})
var e}function gr(e){e[1]=e[2].r}function vr(e,t,a){const n=e.slice()
return n[3]=t[a].player,n[4]=t[a].value,n[6]=a,n}function br(e){let t,a,n=e[7].message+""
return{c(){t=ae("p"),a=ne(n),re(t,"color","red")},m(e,n){Z(e,t,n),oe(t,a)},p(e,t){1&t&&n!==(n=e[7].message+"")&&se(a,n)},d(e){e&&te(t)}}}function wr(e){let t,a
function n(e,a){return 1&a&&(t=null),null==t&&(t=!!lt(e[1])),t?kr:yr}gr(e)
let r=n(e,-1),o=r(e)
return{c(){o.c(),a=X()},m(e,t){o.m(e,t),Z(e,a,t)},p(e,t){gr(e),r===(r=n(e,t))&&o?o.p(e,t):(o.d(1),o=r(e),o&&(o.c(),o.m(a.parentNode,a)))},d(e){e&&te(a),o.d(e)}}}function yr(e){let t
return{c(){t=ne("Server Error")},m(e,a){Z(e,t,a)},p:ee,d(e){e&&te(t)}}}function kr(e){let t,a,n,r=wt(e[1]),o=[]
for(let t=0;t<r.length;t+=1)o[t]=$r(vr(e,r,t))
return{c(){t=ae("table"),a=ae("tr"),a.innerHTML='<td class="header"></td> <td class="header"></td> <td class="header">Username</td> <td class="header">Kills</td>',n=le()
for(let e=0;e<o.length;e+=1)o[e].c()
ie(a,"class","svelte-1p6satm"),ie(t,"id","world-event-contrib-table"),ie(t,"class","svelte-1p6satm")},m(e,r){Z(e,t,r),oe(t,a),oe(t,n)
for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,null)},p(e,a){if(1&a){let n
for(r=wt(e[1]),n=0;n<r.length;n+=1){const s=vr(e,r,n)
o[n]?o[n].p(s,a):(o[n]=$r(s),o[n].c(),o[n].m(t,null))}for(;n<o.length;n+=1)o[n].d(1)
o.length=r.length}},d(e){e&&te(t),ce(o,e)}}}function Cr(e){let t,a,n,r
return{c(){t=ae("a"),a=ae("img"),fe(a.src,n=x+"guilds/"+e[3].guild_id+"_mini.png")||ie(a,"src",n),ie(a,"alt","guild logo"),ie(a,"class","svelte-1p6satm"),ie(t,"href",r=""+(de+e[3].guild_id))},m(e,n){Z(e,t,n),oe(t,a)},p(e,o){1&o&&!fe(a.src,n=x+"guilds/"+e[3].guild_id+"_mini.png")&&ie(a,"src",n),1&o&&r!==(r=""+(de+e[3].guild_id))&&ie(t,"href",r)},d(e){e&&te(t)}}}function $r(e){let t,a,n,r,o,s,l,i,c,u,f,d,m,p=e[3].name+"",h=e[4]+"",g=e[3].guild_id&&Cr(e)
return{c(){t=ae("tr"),a=ae("td"),a.textContent=`${e[6]+1}`,n=le(),r=ae("td"),g&&g.c(),o=le(),s=ae("td"),l=ae("a"),i=ne(p),u=le(),f=ae("td"),d=ne(h),m=le(),ie(l,"href",c=""+(ue+e[3].name)),ie(t,"class","svelte-1p6satm")},m(e,c){Z(e,t,c),oe(t,a),oe(t,n),oe(t,r),g&&g.m(r,null),oe(t,o),oe(t,s),oe(s,l),oe(l,i),oe(t,u),oe(t,f),oe(f,d),oe(t,m)},p(e,t){e[3].guild_id?g?g.p(e,t):(g=Cr(e),g.c(),g.m(r,null)):g&&(g.d(1),g=null),1&t&&p!==(p=e[3].name+"")&&se(i,p),1&t&&c!==(c=""+(ue+e[3].name))&&ie(l,"href",c),1&t&&h!==(h=e[4]+"")&&se(d,h)},d(e){e&&te(t),g&&g.d()}}}function Lr(e){let t
return{c(){t=ne("Loading...")},m(e,a){Z(e,t,a)},p:ee,d(e){e&&te(t)}}}function Vr(e){let t,a,n={ctx:e,current:null,token:null,hasCatch:!0,pending:Lr,then:wr,catch:br,value:2,error:7}
return vt(a=e[0],n),{c(){t=X(),n.block.c()},m(e,a){Z(e,t,a),n.block.m(e,n.anchor=a),n.mount=()=>t.parentNode,n.anchor=t},p(t,[r]){e=t,n.ctx=e,1&r&&a!==(a=e[0])&&vt(a,n)||bt(n,e,r)},i:ee,o:ee,d(e){e&&te(t),n.block.d(e),n.token=null,n=null}}}function Dr(e,t,a){let{promise:n}=t
return e.$$set=e=>{"promise"in e&&a(0,n=e.promise)},[n]}class Mr extends z{constructor(e){super(),Q(this,e,Dr,Vr,J,{promise:0})}}let xr=0
const Ar=()=>({promise:U(hr)})
function Sr(){c("NewMap","GlobalTop")
const e=n("world-event-contrib")
var t
t=e,xr?xr.$set(Ar()):xr=new Mr({props:Ar(),target:t}),$(e).dialog({title:"Top 100 Event Contributers",minWidth:300,height:300,zIndex:9999})}function Nr(e){$(`#actionList li.creature-${e.toString()} a.create-group`).hide()}const Hr=["hideChampionsGroup","hideElitesGroup","hideSEGroup","hideTitanGroup","hideLegendaryGroup"]
function Br(e,t){var a
b(e)&&(a=t+1,$.subscribe(K,s(Nr,a)),Nr(t+1))}function qr(e,t,a){const n=e.slice()
return n[10]=t[a].msg,n[11]=t[a].type,n[12]=t[a].count,n}function Tr(e){let t,a,n,r=e[12]+""
return{c(){t=ae("div"),a=ne("x"),n=ne(r),ie(t,"class","count svelte-1leyf3b")},m(e,r){Z(e,t,r),oe(t,a),oe(t,n)},p(e,t){1&t&&r!==(r=e[12]+"")&&se(n,r)},d(e){e&&te(t)}}}function Er(e,t){let a,n,r,o,s,l,i,c=t[10]+"",u=t[12]>1&&Tr(t)
function f(){return t[3](t[10])}return{key:e,first:null,c(){a=ae("div"),n=ne(c),r=le(),u&&u.c(),o=le(),ie(a,"class",s="fsh-message "+t[11]+" svelte-1leyf3b"),this.first=a},m(e,t){Z(e,a,t),oe(a,n),oe(a,r),u&&u.m(a,null),oe(a,o),l||(i=me(a,"click",f),l=!0)},p(e,r){t=e,1&r&&c!==(c=t[10]+"")&&se(n,c),t[12]>1?u?u.p(t,r):(u=Tr(t),u.c(),u.m(a,o)):u&&(u.d(1),u=null),1&r&&s!==(s="fsh-message "+t[11]+" svelte-1leyf3b")&&ie(a,"class",s)},d(e){e&&te(a),u&&u.d(),l=!1,i()}}}function Gr(e){let t,a=[],n=new Map,r=wt(e[1](e[0]))
const o=e=>e[10]
for(let t=0;t<r.length;t+=1){let s=qr(e,r,t),l=o(s)
n.set(l,a[t]=Er(l,s))}return{c(){for(let e=0;e<a.length;e+=1)a[e].c()
t=X()},m(e,n){for(let t=0;t<a.length;t+=1)a[t]&&a[t].m(e,n)
Z(e,t,n)},p(e,[s]){7&s&&(r=wt(e[1](e[0])),a=yt(a,s,o,1,e,r,n,t.parentNode,kt,Er,t,qr))},i:ee,o:ee,d(e){e&&te(t)
for(let t=0;t<a.length;t+=1)a[t].d(e)}}}function jr(e,t,a){const n=document.body.appendChild(document.createElement("iframe"))
window.requestAnimationFrame=n.contentWindow.requestAnimationFrame,window.cancelAnimationFrame=n.contentWindow.cancelAnimationFrame,n.hidden=!0
let r=[]
const o=window.$("#messageCenter").data().hcsWorldMessageCenter,s=function*(){for(let e=0;;e++)yield e}()
function l(){o._reposition()}function i(e){a(0,r=r.filter((({msg:t})=>t!==e))),l()}o._displayMessage=async function(e,t,n=3e3){const o=s.next().value
a(0,r=[...r,{msg:e,type:t,expire:o}]),setTimeout((()=>{a(0,r=r.filter((({expire:e})=>e!==o)))}),n),await pe(),l()}
return[r,e=>Ct(e,"msg").map((({msg:t,type:a})=>({msg:t,type:a,count:e.filter((({msg:e})=>e===t)).length}))),i,e=>i(e)]}class Pr extends z{constructor(e){super(),Q(this,e,jr,Gr,J,{})}}let Fr=0
function Rr(e){Fr[e.name]?Fr[e.name].seen&&(Fr[e.name].seen+=1):(Fr[e.name]={seen:1},function(e,t){t.creature_class=e.creature_class,t.image_id=e.image_id,t.level=Number(e.level),t.type=e.type}(e,Fr[e.name]))}function _r(e,t,a){return t?e(t,a):a}function Ir(e,t){const a=e||{}
return a.min=_r(Math.min,a.min,t),a.max=_r(Math.max,a.max,t),a}const Or=["attack","armor","damage","defense","hp"]
function Wr(e,t,a){const n=Ir(t[a],Number(e[a]));(function(e,t){return!e||e.min!==t.min||e.max!==t.max})(t[a],n)&&(t[a]=n)}function Kr(e,t){e[t.name]=Ir(e[t.name],Number(t.value))}function Yr(e){Fr||(Fr={}),Rr(e),function(e,t){Or.forEach(s(Wr,e,t))}(e,Fr[e.name]),function(e,t){(function(e){return e.enhancements&&e.enhancements.length>0})(e)&&(t.enhancements=t.enhancements||{},e.enhancements.forEach(s(Kr,t.enhancements)))}(e,Fr[e.name]),mt("fsh_monsterLog",Fr)}async function Ur(){!function(e){Fr=e||{}}(await dt("fsh_monsterLog"))}const zr=[]
function Qr(e){var a
An(e)||(a=e.response.data,t.showMonsterLog&&Yr(a))}function Jr(e,t){return e.id===t.id}async function Xr(e,t){if(6!==e.type||function(e){if(zr.find(s(Jr,e.data)))return!0
zr.push(e.data)}(e))return
Qr(await qn(e.data.id,t))}function Zr(){t.showMonsterLog&&(GameData.actions().forEach(Xr),c("NewMap","MonsterLog"))}let eo=""
const to=()=>eo
function ao(){return $t({subcmd:"scouttower"})}function no(e,[t,a,n]){const r=e.insertCell(-1)
return r.colSpan=t,n&&(r.className="header"),o(r,a()),r}function ro(e,t,a){const n=e.insertRow(-1)
return a&&(n.className="fshBlue"),function(e,t){t.forEach(s(no,e))}(n,t),n}function oo(e,t){ro(e,t[0],t[1])}function so(e,t){t.forEach(s(oo,e))}let lo=0,io=0,co=0,uo=0,fo=0,mo=0,po=0,ho=0
const go=()=>lo,vo=()=>io,bo=()=>co,wo=()=>uo,yo=()=>fo,ko=()=>mo,Co=()=>po,$o=()=>ho
function Lo(){lo=Fa("Current"),io=Fa("Kills"),co=Fa("Member"),uo=Fa("% of Total"),fo=Fa("Status"),mo=Fa("Titan HP"),po=Fa("Total"),ho=Fa("Your Guild")}let Vo=0,Do=0,Mo=0,xo=0,Ao=0,So=0,No=0,Ho=0,Bo=0
const qo=()=>Vo,To=()=>Do,Eo=()=>Mo,Go=()=>xo,jo=()=>Ao,Po=()=>So,Fo=()=>No,Ro=()=>Ho,_o=()=>Bo
function Io(){Vo=Ze({innerHTML:"&nbsp;"}),Do=Ze({innerHTML:"&nbsp;"}),Mo=Ze(),xo=Ze(),Ao=Ze(),So=Ze(),No=Ze(),Ho=Ze(),Bo=Ze()}let Oo=0
const Wo=()=>Oo
function Ko(){for(;Oo.rows.length>8;)Oo.deleteRow(8)}function Yo(){const e=Ze()
return o(e,Eo()),et(e,"/"),o(e,Go()),e}function Uo(e){const t=Ze()
return o(t,e),et(t,"%"),t}let zo=0,Qo=0,Jo=""
const Xo=()=>Qo,Zo=()=>Jo
function es(){Qo=null,zo&&!S("fshHide",zo)&&(Xe(zo,!0),he("&nbsp;",Vo),he("&nbsp;",Do),r("",Mo),r("",xo),r("",Ao),r("",So),r("",No),he("",Ho),he("",Bo),Ko())}function ts(e){return 0===e.type&&(Qo=e.base_creature_id,Jo=`(${e.x},${e.y})`,!0)}function as(){if(zo)Xe(zo,!1)
else{const e=n("actionContainer")
zo=a({className:"fshActionBox titanInfo"}),Io(),Oo=Lt({className:"fshCenter"}),Lo(),so(Oo,[[[[5,qo,!0],[1,To,!0]]],[[[2,ko,!0],[4,$o,!0]]],[[[2,Yo],[4,jo]]],[[[2,go,!0],[4,s(Uo,Po())]],!0],[[[2,Co,!0],[4,s(Uo,Fo())]],!0],[[[2,yo,!0],[4,Ro]],!0],[[[6,_o]]],[[[2,bo,!0],[2,vo,!0],[2,wo,!0]]]]),o(zo,Wo()),o(e,zo)}}function ns(e){return e<=0?'<span class="fshGreen cooldown">No active cooldown</span>':`<span class="fshMaroon cooldown">Cooldown until: ${function(e){const t=new Date(xt()+1e3*e)
return`${Ht(t.getHours())}:${Ht(t.getMinutes())} ${Ht(t.getDate())}/${ge[t.getMonth()]}/${t.getFullYear()}`}(e)}</span>`}function rs(e){return at(Mt(e.max_hp-e.current_hp,e.kills),2)}function os(e){return at(100*e.kills/e.max_hp,2)}function ss(e){!function(e){[[Dt(e.creature.name),qo],[Zo(),To],[e.current_hp,Eo],[e.max_hp,Go],[e.kills,jo],[rs(e),Po],[os(e),Fo]].forEach((([e,t])=>r(e,t())))}(e),he(function(e){return Vt(e.kills,e.max_hp,e.current_hp)}(e),Ro()),he(ns(e.cooldown),_o())}function ls(e,t){return[[[2,()=>Fa(t.player.name)],[2,()=>Fa(t.kills.toString())],[2,()=>Fa(`${at(100*t.kills/e.kills,2)}%`)]]]}function is(e){return e.realm&&e.creature.base_id===Xo()&&e.realm===to()}function cs(e){const t=e.find(is)
t&&(ss(t),function(e){if(Ko(),!e.contributors)return
const t=e.contributors.map(s(ls,e))
so(Wo(),t)}(t))}let us=null
const fs=e=>e?.s&&lt(e.r),ds=e=>t.showTitanInfo&&lt(e)&&e.some(ts)
async function ms(){!function(e,t){fs(t)&&(cs(t.r),ds(GameData.realm().dynamic)?us=window.setTimeout(e,3e4):es())}(ms,await U(ao))}function ps(e){us&&(window.clearTimeout(us),us=null),ds(e)?(as(),ms()):es()}function hs(e){var t
e.dynamic&&(t=e.name,eo=t,ps(e.dynamic))}function gs(e,t){t.realm?.name&&hs(t.realm)}function vs(e,t,a){const n=e.slice()
return n[5]=t[a],n[7]=a,n}function bs(e){let t,a=e[1](e[7])+""
return{c(){t=ne(a)},m(e,a){Z(e,t,a)},p:ee,d(e){e&&te(t)}}}function ws(e){let t,a,n,r
return a=new Tt({props:{$$slots:{default:[bs]},$$scope:{ctx:e}}}),a.$on("click",(function(...t){return e[3](e[5],e[7],...t)})),{c(){t=ae("li"),Le(a.$$.fragment),n=le()},m(e,o){Z(e,t,o),Ve(a,t,null),oe(t,n),r=!0},p(t,n){e=t
const r={}
256&n&&(r.$$scope={dirty:n,ctx:e}),a.$set(r)},i(e){r||(we(a.$$.fragment,e),r=!0)},o(e){Ce(a.$$.fragment,e),r=!1},d(e){e&&te(t),De(a)}}}function ys(e){let t,a,n=wt(qt(16,e[0])),r=[]
for(let t=0;t<n.length;t+=1)r[t]=ws(vs(e,n,t))
const o=e=>Ce(r[e],1,1,(()=>{r[e]=null}))
return{c(){t=ae("ul")
for(let e=0;e<r.length;e+=1)r[e].c()
ie(t,"class","svelte-1k3xw12")},m(e,n){Z(e,t,n)
for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(t,null)
a=!0},p(e,[a]){if(7&a){let s
for(n=wt(qt(16,e[0])),s=0;s<n.length;s+=1){const o=vs(e,n,s)
r[s]?(r[s].p(o,a),we(r[s],1)):(r[s]=ws(o),r[s].c(),we(r[s],1),r[s].m(t,null))}for(ye(),s=n.length;s<r.length;s+=1)o(s)
ke()}},i(e){if(!a){for(let e=0;e<n.length;e+=1)we(r[e])
a=!0}},o(e){r=r.filter(Boolean)
for(let e=0;e<r.length;e+=1)Ce(r[e])
a=!1},d(e){e&&te(t),ce(r,e)}}}function ks(e,t,a){const n=$e()
let{members:r=[]}=t
const o=e=>`Buff ${Me[e]} 16`
function s(e,t,a){a.target.blur(),Bt(`${xe}&players=${e.join(",")}`,"fsQuickBuff",618,1e3,",scrollbars"),n("buffBatch",o(t))}return e.$$set=e=>{"members"in e&&a(0,r=e.members)},[r,o,s,(e,t,a)=>s(e,t,a)]}class Cs extends z{constructor(e){super(),Q(this,e,ks,ys,J,{members:0})}}function $s(e,t){return e>10*t||e<t?e:10*t}const Ls=[["levelValue","level"],["attackValue","attack"],["attackBonus","bonus_attack"],["defenseValue","defense"],["defenseBonus","bonus_defense"],["armorValue","armor"],["armorBonus","bonus_armor"],["damageValue","damage"],["damageBonus","bonus_damage"],["hpValue","hp"],["hpBonus","bonus_hp"],["killStreakValue","killstreak"]]
function Vs(e,t,a){e[a[0]]=Number(t[a[1]])}const Ds=[["counterAttackLevel","Counter Attack"],["doublerLevel","Doubler"],["deathDealerLevel","Death Dealer"],["darkCurseLevel","Dark Curse"],["holyFlameLevel","Holy Flame"],["constitutionLevel","Constitution"],["sanctuaryLevel","Sanctuary"],["flinchLevel","Flinch"],["nightmareVisageLevel","Nightmare Visage"],["superEliteSlayerLevel","Super Elite Slayer"],["fortitudeLevel","Fortitude"],["chiStrikeLevel","Chi Strike"],["terrorizeLevel","Terrorize"],["barricadeLevel","Barricade"],["reignOfTerrorLevel","Reign Of Terror"],["anchoredLevel","Anchored"],["severeConditionLevel","Severe Condition"],["entrenchLevel","Entrench"],["cloakLevel","Cloak"]]
function Ms(e,t,a){e[a[0]]=t[a[1]]||0}function xs(e){if(!e)return
const t=Et(e._skills),a={}
return function(e,t){Ls.forEach(s(Vs,e,t))}(a,e),function(e,t){Ds.forEach(s(Ms,e,t))}(a,t),a.superEliteSlayerMultiplier=tt(.002*a.superEliteSlayerLevel,2),Pt(a.armorValue)&&function(e){e.attackValue=$s(e.attackBonus,e.levelValue),e.defenseValue=$s(e.defenseBonus,e.levelValue),e.armorValue=$s(e.armorBonus,e.levelValue),e.damageValue=$s(e.damageBonus,e.levelValue),e.hpValue=e.hpBonus}(a),a}const As=Se(["statusStore","Done."])
let Ss=[]
const Ns=Ae(As,((e,t)=>{const a=Ss.find((([t])=>t===e[0]))
a?[,a[1]]=e:Ss=[...Ss,e]
const n=Ss.find((([,e])=>"Done."!==e))
t(n?.[1]??"Done.")})),Hs=Se(0)
const Bs=Ae(Hs,((e,t)=>{!async function(e,t){if(!e)return
As.set(["relicStore","Processing defending guild relics ... "])
const a=await Ft(e)
if(!a)return void As.set(["relicStore","AJAX Error"])
const n=a.r.relics.length,r=1===n?1.5:tt(1-n/10,2)
t({noOfRelics:n,relicMultiplier:r,leadDefenderBonus:`${String(100*r)}%`}),As.set(["relicStore","Done."])}(e,t)})),qs=Se([])
const Ts=Ae(qs,((e,t)=>{!async function(e,t){if(!e.length)return
As.set(["defendersStore","Processing defending group stats ... "])
const a=[]
await jt(e.map((async(e,n)=>{const r=await Gt(e)
a.push([n,xs(r)]),t(a)}))),As.set(["defendersStore","Done."])}(e,t)})),Es=Ae(Ts,((e,t)=>{const a=e?.find((([e])=>0===e))
a&&t(a[1])})),Gs=(e,t,a)=>Math.ceil(a*(0===t?e:Ne))
function js(e,t,[a,n]){return{armorValue:t.armorValue+Gs(e,a,n.armorValue),attackValue:t.attackValue+Gs(e,a,n.attackValue),damageValue:t.damageValue+Gs(e,a,n.damageValue),cloaked:t.cloaked+(n.cloakLevel?1:0),defenseValue:t.defenseValue+Gs(e,a,n.defenseValue),hpValue:t.hpValue+Gs(e,a,n.hpValue)}}const Ps=Ae([Bs,Ts],(([e,t],a)=>{if(!e?.relicMultiplier||!t?.length)return
const n=t?.reduce(s(js,e.relicMultiplier),{armorValue:0,attackValue:0,damageValue:0,cloaked:0,defenseValue:0,hpValue:0})
a(n)})),Fs=Se(0),Rs=e=>e.members[0].name===GameData.player().username
async function _s(e,t){if(!e)return
As.set(["groupStore","Processing attacking group stats ... "])
const a=await async function(){const e=await Ot()
return e?.r?.find(Rs)?.id}(),n=a&&await async function(e){const t=await Rt(e)
return Wt(t?.r?.attributes)}(a),r=n&&await async function(e){const t=await _t(),a=It(t)
return e?.map(((e,t)=>e-a[t]))}(n)
r&&t({attack:r[0],defense:r[1],armor:r[2],hp:r[3],damage:r[4]}),As.set(["groupStore","Done."])}const Is=Ae(Fs,((e,t)=>{_s(e,t)})),Os=(e,t,a)=>Math.ceil(e*He(t,0)*a),Ws=(e,t)=>Os(e,t,.0025),Ks=(e,t)=>Os(e,t,.001),Ys=Ks,Us=Ks,zs=Ks,Qs=Ks,Js=Ks,Xs=(e,t)=>Math.ceil(e*(1+.001*He(t,0))),Zs=(e,t)=>Math.ceil(e*(1-t*Be)),el=Se([]),tl=Ae(el,((e,t)=>{e&&t(Et(e))})),al=Ae([tl,Is],(([e,t],a)=>{if(!e||!t)return
const n=Xs(t.defense,e.Constitution),r=Ys(n,e.Fortitude),o=t.hp+r,s=Us(o,e["Chi Strike"])
a({dmgWithChiStrike:t.damage+s,defWithConst:n,hpWithFortitude:o,nmv:Ws(t.attack,e["Nightmare Visage"]),sanctuary:zs(t.armor,e.Sanctuary)})}))
const nl=Ae([al,Es,Is],(function([e,t,a],n){if(!e||!t||!a)return
const r=a.attack-e.nmv,o=Qs(r,t.flinchLevel),s=Js(e.dmgWithChiStrike,t.terrorizeLevel)
n({attack:r-o,defense:e.defWithConst+e.nmv,armor:a.armor+e.sanctuary,hp:e.hpWithFortitude,damage:e.dmgWithChiStrike-s})})),rl=Ae([Es,Ps],(([e,t],a)=>{if(!e||!t)return
const n=Ws(t.attackValue,e.nightmareVisageLevel),r=Xs(t.defenseValue,e.constitutionLevel),o=Ys(r,e.fortitudeLevel),s=t.hpValue+o,l=Us(s,e.chiStrikeLevel),i=t.damageValue+l
a({attackWithNmv:t.attackValue-n,chiStrike:e.chiStrikeLevel,cloak:e.cloakLevel?"Yes":"No",dmgWithChiStrike:i,defWithConst:r,hpWithFortitude:s,nmv:n,sanctuary:zs(t.armorValue,e.sanctuaryLevel)})}))
const ol=Ae([tl,rl,Ps],(function([e,t,a],n){if(!e||!t||!a)return
const r=Qs(t.attackWithNmv,e.Flinch),o=t.defWithConst+t.nmv,s=Js(t.dmgWithChiStrike,e.Terrorize)
n({attack:t.attackWithNmv-r,dc225:Zs(o,225),dc175:Zs(o,175),defense:o,armor:a.armorValue+t.sanctuary,hp:t.hpWithFortitude,damage:t.dmgWithChiStrike-s})})),sl=Ae(Bs,((e,t)=>{t({noOfRelics:e?.noOfRelics??"",leadDefenderBonus:e?.leadDefenderBonus??""})})),ll=Ae(Es,((e,t)=>{if(!e)return t("")
e.cloakLevel?t("Yes"):t("No")})),il=Ae(Ps,((e,t)=>{t({armorValue:e?.armorValue??"",attackValue:e?.attackValue??"",damageValue:e?.damageValue??"",cloaked:e?.cloaked??"",defenseValue:e?.defenseValue??"",hpValue:e?.hpValue??""})})),cl=Ae(Ts,((e,t)=>{t(e?.length??"")})),ul=Ae(ol,((e,t)=>{t({attack:e?.attack??"",dc225:e?.dc225??"",dc175:e?.dc175??"",defense:e?.defense??"",armor:e?.armor??"",hp:e?.hp??"",damage:e?.damage??""})})),fl=e=>({attack:e?.attack??"",defense:e?.defense??"",armor:e?.armor??"",hp:e?.hp??"",damage:e?.damage??""}),dl=Ae(Is,((e,t)=>{t(fl(e))})),ml=Ae(nl,((e,t)=>{t(fl(e))}))
function pl(e,t,a){const n=e.slice()
return n[6]=t[a].id,n[7]=t[a].username,n}function hl(e){let t,a,n,r,o=e[7]+""
return{c(){t=ae("a"),a=ne(o),r=ne(" "),ie(t,"href",n=""+(qe+e[6])),ie(t,"class","svelte-3priew")},m(e,n){Z(e,t,n),oe(t,a),Z(e,r,n)},p(e,r){1&r&&o!==(o=e[7]+"")&&se(a,o),1&r&&n!==(n=""+(qe+e[6]))&&ie(t,"href",n)},d(e){e&&(te(t),te(r))}}}function gl(e){let t,a,n,r=(e[0].length||"")+"",o=wt(e[0]),s=[]
for(let t=0;t<o.length;t+=1)s[t]=hl(pl(e,o,t))
return{c(){t=ne(r),a=ne(" Offline guild members not at relic:\n"),n=ae("div")
for(let e=0;e<s.length;e+=1)s[e].c()
ie(n,"class","missing svelte-3priew")},m(e,r){Z(e,t,r),Z(e,a,r),Z(e,n,r)
for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(n,null)},p(e,[a]){if(1&a&&r!==(r=(e[0].length||"")+"")&&se(t,r),1&a){let t
for(o=wt(e[0]),t=0;t<o.length;t+=1){const r=pl(e,o,t)
s[t]?s[t].p(r,a):(s[t]=hl(r),s[t].c(),s[t].m(n,null))}for(;t<s.length;t+=1)s[t].d(1)
s.length=o.length}},i:ee,o:ee,d(e){e&&(te(t),te(a),te(n)),ce(s,e)}}}function vl(e,t,a){let{members:n=[]}=t,r=[]
const o=[({username:e})=>!n.includes(e),({last_login:e})=>e,({last_login:e})=>e<At(),({last_login:e})=>e>St(),({level:e})=>e<400||e>421,({level:e})=>e<441||e>450],s=e=>o.every((t=>t(e))),l=({username:e},{username:t})=>Te(e,t)
return Hs.subscribe((e=>{!async function(e){const t=await Kt(e)
lt(t)&&a(0,r=t.filter(s).sort(l))}(e)})),e.$$set=e=>{"members"in e&&a(1,n=e.members)},[r,n]}class bl extends z{constructor(e){super(),Q(this,e,vl,gl,J,{members:1})}}function wl(e){let t,a,n
return a=new Cs({props:{members:e[10]}}),a.$on("buffBatch",e[11]),{c(){t=ae("div"),Le(a.$$.fragment),ie(t,"class","buff-links svelte-1qul0wc")},m(e,r){Z(e,t,r),Ve(a,t,null),n=!0},p:ee,i(e){n||(we(a.$$.fragment,e),n=!0)},o(e){Ce(a.$$.fragment,e),n=!1},d(e){e&&te(t),De(a)}}}function yl(e){let t,a,n,r,o,s,l,i
return{c(){t=ae("div"),t.textContent="Processing",a=le(),n=ae("div"),r=ne(e[2]),o=le(),s=ae("div"),s.textContent="Assumptions",l=le(),i=ae("div"),i.textContent="Above calculations include Constitution, Fortitude, Nightmare Visage, Chi Strike, Sanctuary,\n        Terrorize and Flinch bonus calculations (in that order) on both the defending group and\n        attacking group.",ie(t,"class","b-top svelte-1qul0wc"),ie(n,"class","proc-stat svelte-1qul0wc"),ie(s,"class","b-top svelte-1qul0wc"),ie(i,"class","assume svelte-1qul0wc")},m(e,c){Z(e,t,c),Z(e,a,c),Z(e,n,c),oe(n,r),Z(e,o,c),Z(e,s,c),Z(e,l,c),Z(e,i,c)},p(e,t){4&t&&se(r,e[2])},d(e){e&&(te(t),te(a),te(n),te(o),te(s),te(l),te(i))}}}function kl(e){let t,a,n
return{c(){t=ae("button"),t.textContent="Fetch Stats",ie(t,"class","custombutton"),ie(t,"type","button")},m(r,o){Z(r,t,o),a||(n=me(t,"click",e[12]),a=!0)},p:ee,d(e){e&&te(t),a=!1,n()}}}function Cl(e){let t,a,n,r,o,s,l,i,c,u,f,d,m,p,h,g,v,b,w,y,k,C,$,L,V,D,M,x,A,S,N,H,B,q,T,E,G,j,P,F,R,_,I,O,W,K,Y,U,z,Q,J,X,ee,re,ce,ue,fe,de,me,pe,he,ge,ve,be,ye,ke,$e,Me,xe,Ae,Se,Ne,He,Be,qe,Te,Ee,Ge,je,Pe,Fe,Re,_e,Ie,Oe,We,Ke,Ye,Ue,ze,Qe,Je,Xe,Ze,et,tt,at,nt,rt,ot,st,lt,it,ct,ut,ft,dt,mt,pt,ht,gt,vt,bt,wt,yt,kt,Ct,$t,Lt,Vt,Dt,Mt,xt,At,St,Nt,Ht,Bt=e[3].noOfRelics+"",qt=e[3].leadDefenderBonus+"",Tt=e[5].attackValue+"",Et=e[6].attack+"",Gt=e[5].defenseValue+"",jt=e[6].defense+"",Pt=e[5].armorValue+"",Ft=e[6].armor+"",Rt=e[5].damageValue+"",_t=e[6].damage+"",It=e[5].hpValue+"",Ot=e[6].hp+"",Wt=e[5].cloaked+"",Kt=e[6].dc225+"",Yt=e[6].dc175+"",Ut=e[8].attack+"",zt=e[9].attack+"",Qt=e[8].defense+"",Jt=e[9].defense+"",Xt=e[8].armor+"",Zt=e[9].armor+"",ea=e[8].damage+"",ta=e[9].damage+"",aa=e[8].hp+"",na=e[9].hp+""
return Nt=new bl({props:{members:e[10]}}),{c(){t=ae("div"),a=ae("div"),a.textContent="Defending Guild Stats",n=le(),r=ae("div"),o=ae("div"),o.textContent="Relic Count:",s=ae("div"),l=ne(Bt),i=le(),c=ae("div"),c.textContent="Lead Defender Bonus:",u=ae("div"),f=ne(qt),d=le(),m=ae("div"),m.textContent="Lead Defender Cloaked:",p=ae("div"),h=ne(e[4]),g=le(),v=ae("div"),v.textContent="Other Defender Stats",b=le(),w=ae("div"),y=ae("div"),y.textContent="Raw Attack:",k=ae("div"),C=ne(Tt),$=le(),L=ae("div"),L.textContent="Attack w/ buffs:",V=ae("div"),D=ne(Et),M=le(),x=ae("div"),x.textContent="Raw Defense:",A=ae("div"),S=ne(Gt),N=le(),H=ae("div"),H.textContent="Defense w/buffs:",B=ae("div"),q=ne(jt),T=le(),E=ae("div"),E.textContent="Raw Armor:",G=ae("div"),j=ne(Pt),P=le(),F=ae("div"),F.textContent="Armor w/ buffs:",R=ae("div"),_=ne(Ft),I=le(),O=ae("div"),O.textContent="Raw Damage:",W=ae("div"),K=ne(Rt),Y=le(),U=ae("div"),U.textContent="Damage w/ buffs:",z=ae("div"),Q=ne(_t),J=le(),X=ae("div"),X.textContent="Raw HP:",ee=ae("div"),re=ne(It),ce=le(),ue=ae("div"),ue.textContent="HP w/ buffs:",fe=ae("div"),de=ne(Ot),me=le(),pe=ae("div"),pe.textContent="Cloaked:",he=ae("div"),ge=ne(Wt),ve=le(),be=ae("div"),be.textContent="Processed:",ye=ae("div"),ke=ne(e[7]),$e=le(),Me=ae("div"),xe=ae("div"),xe.textContent="Adjusted Defense Values",Ae=le(),Se=ae("div"),Ne=ae("div"),Ne.textContent="DC225:",He=ae("div"),Be=ne(Kt),qe=le(),Te=ae("div"),Te.textContent="DC175:",Ee=ae("div"),Ge=ne(Yt),je=le(),Pe=ae("div"),Pe.textContent="Â ",Fe=le(),Re=ae("div"),Re.textContent="Attacking Group Stats",_e=le(),Ie=ae("div"),Oe=ae("div"),Oe.textContent="Raw Group Attack:",We=ae("div"),Ke=ne(Ut),Ye=le(),Ue=ae("div"),Ue.textContent="Group Attack w/ buffs:",ze=ae("div"),Qe=ne(zt),Je=le(),Xe=ae("div"),Xe.textContent="Raw Group Defense:",Ze=ae("div"),et=ne(Qt),tt=le(),at=ae("div"),at.textContent="Group Defense w/ buffs:",nt=ae("div"),rt=ne(Jt),ot=le(),st=ae("div"),st.textContent="Raw Group Armor:",lt=ae("div"),it=ne(Xt),ct=le(),ut=ae("div"),ut.textContent="Group Armor w/ buffs:",ft=ae("div"),dt=ne(Zt),mt=le(),pt=ae("div"),pt.textContent="Raw Group Damage:",ht=ae("div"),gt=ne(ea),vt=le(),bt=ae("div"),bt.textContent="Group Damage w/ buffs:",wt=ae("div"),yt=ne(ta),kt=le(),Ct=ae("div"),Ct.textContent="Raw Group HP:",$t=ae("div"),Lt=ne(aa),Vt=le(),Dt=ae("div"),Dt.textContent="Group HP w/ buffs:",Mt=ae("div"),xt=ne(na),At=le(),St=ae("div"),Le(Nt.$$.fragment),ie(a,"class","b-top svelte-1qul0wc"),ie(o,"class","svelte-1qul0wc"),ie(s,"class","svelte-1qul0wc"),ie(c,"class","svelte-1qul0wc"),ie(u,"class","svelte-1qul0wc"),ie(m,"class","svelte-1qul0wc"),ie(p,"class","svelte-1qul0wc"),ie(r,"class","stat-grid svelte-1qul0wc"),ie(v,"class","b-top svelte-1qul0wc"),ie(y,"class","svelte-1qul0wc"),ie(k,"class","svelte-1qul0wc"),ie(L,"class","svelte-1qul0wc"),ie(V,"class","svelte-1qul0wc"),ie(x,"class","svelte-1qul0wc"),ie(A,"class","svelte-1qul0wc"),ie(H,"class","svelte-1qul0wc"),ie(B,"class","svelte-1qul0wc"),ie(E,"class","svelte-1qul0wc"),ie(G,"class","svelte-1qul0wc"),ie(F,"class","svelte-1qul0wc"),ie(R,"class","svelte-1qul0wc"),ie(O,"class","svelte-1qul0wc"),ie(W,"class","svelte-1qul0wc"),ie(U,"class","svelte-1qul0wc"),ie(z,"class","svelte-1qul0wc"),ie(X,"class","svelte-1qul0wc"),ie(ee,"class","svelte-1qul0wc"),ie(ue,"class","svelte-1qul0wc"),ie(fe,"class","svelte-1qul0wc"),ie(pe,"class","svelte-1qul0wc"),ie(he,"class","svelte-1qul0wc"),ie(be,"class","svelte-1qul0wc"),ie(ye,"class","svelte-1qul0wc"),ie(w,"class","stat-grid svelte-1qul0wc"),ie(t,"class","middle svelte-1qul0wc"),ie(xe,"class","b-top svelte-1qul0wc"),ie(Ne,"class","svelte-1qul0wc"),ie(He,"class","svelte-1qul0wc"),ie(Te,"class","svelte-1qul0wc"),ie(Ee,"class","svelte-1qul0wc"),ie(Pe,"class","svelte-1qul0wc"),ie(Se,"class","stat-grid svelte-1qul0wc"),ie(Re,"class","b-top svelte-1qul0wc"),ie(Oe,"class","svelte-1qul0wc"),ie(We,"class","svelte-1qul0wc"),ie(Ue,"class","svelte-1qul0wc"),ie(ze,"class","svelte-1qul0wc"),ie(Xe,"class","svelte-1qul0wc"),ie(Ze,"class","svelte-1qul0wc"),ie(at,"class","svelte-1qul0wc"),ie(nt,"class","svelte-1qul0wc"),ie(st,"class","svelte-1qul0wc"),ie(lt,"class","svelte-1qul0wc"),ie(ut,"class","svelte-1qul0wc"),ie(ft,"class","svelte-1qul0wc"),ie(pt,"class","svelte-1qul0wc"),ie(ht,"class","svelte-1qul0wc"),ie(bt,"class","svelte-1qul0wc"),ie(wt,"class","svelte-1qul0wc"),ie(Ct,"class","svelte-1qul0wc"),ie($t,"class","svelte-1qul0wc"),ie(Dt,"class","svelte-1qul0wc"),ie(Mt,"class","svelte-1qul0wc"),ie(Ie,"class","stat-grid svelte-1qul0wc"),ie(Me,"class","right svelte-1qul0wc"),ie(St,"class","bottom b-top svelte-1qul0wc")},m(e,te){Z(e,t,te),oe(t,a),oe(t,n),oe(t,r),oe(r,o),oe(r,s),oe(s,l),oe(r,i),oe(r,c),oe(r,u),oe(u,f),oe(r,d),oe(r,m),oe(r,p),oe(p,h),oe(t,g),oe(t,v),oe(t,b),oe(t,w),oe(w,y),oe(w,k),oe(k,C),oe(w,$),oe(w,L),oe(w,V),oe(V,D),oe(w,M),oe(w,x),oe(w,A),oe(A,S),oe(w,N),oe(w,H),oe(w,B),oe(B,q),oe(w,T),oe(w,E),oe(w,G),oe(G,j),oe(w,P),oe(w,F),oe(w,R),oe(R,_),oe(w,I),oe(w,O),oe(w,W),oe(W,K),oe(w,Y),oe(w,U),oe(w,z),oe(z,Q),oe(w,J),oe(w,X),oe(w,ee),oe(ee,re),oe(w,ce),oe(w,ue),oe(w,fe),oe(fe,de),oe(w,me),oe(w,pe),oe(w,he),oe(he,ge),oe(w,ve),oe(w,be),oe(w,ye),oe(ye,ke),Z(e,$e,te),Z(e,Me,te),oe(Me,xe),oe(Me,Ae),oe(Me,Se),oe(Se,Ne),oe(Se,He),oe(He,Be),oe(Se,qe),oe(Se,Te),oe(Se,Ee),oe(Ee,Ge),oe(Se,je),oe(Se,Pe),oe(Me,Fe),oe(Me,Re),oe(Me,_e),oe(Me,Ie),oe(Ie,Oe),oe(Ie,We),oe(We,Ke),oe(Ie,Ye),oe(Ie,Ue),oe(Ie,ze),oe(ze,Qe),oe(Ie,Je),oe(Ie,Xe),oe(Ie,Ze),oe(Ze,et),oe(Ie,tt),oe(Ie,at),oe(Ie,nt),oe(nt,rt),oe(Ie,ot),oe(Ie,st),oe(Ie,lt),oe(lt,it),oe(Ie,ct),oe(Ie,ut),oe(Ie,ft),oe(ft,dt),oe(Ie,mt),oe(Ie,pt),oe(Ie,ht),oe(ht,gt),oe(Ie,vt),oe(Ie,bt),oe(Ie,wt),oe(wt,yt),oe(Ie,kt),oe(Ie,Ct),oe(Ie,$t),oe($t,Lt),oe(Ie,Vt),oe(Ie,Dt),oe(Ie,Mt),oe(Mt,xt),Z(e,At,te),Z(e,St,te),Ve(Nt,St,null),Ht=!0},p(e,t){(!Ht||8&t)&&Bt!==(Bt=e[3].noOfRelics+"")&&se(l,Bt),(!Ht||8&t)&&qt!==(qt=e[3].leadDefenderBonus+"")&&se(f,qt),(!Ht||16&t)&&se(h,e[4]),(!Ht||32&t)&&Tt!==(Tt=e[5].attackValue+"")&&se(C,Tt),(!Ht||64&t)&&Et!==(Et=e[6].attack+"")&&se(D,Et),(!Ht||32&t)&&Gt!==(Gt=e[5].defenseValue+"")&&se(S,Gt),(!Ht||64&t)&&jt!==(jt=e[6].defense+"")&&se(q,jt),(!Ht||32&t)&&Pt!==(Pt=e[5].armorValue+"")&&se(j,Pt),(!Ht||64&t)&&Ft!==(Ft=e[6].armor+"")&&se(_,Ft),(!Ht||32&t)&&Rt!==(Rt=e[5].damageValue+"")&&se(K,Rt),(!Ht||64&t)&&_t!==(_t=e[6].damage+"")&&se(Q,_t),(!Ht||32&t)&&It!==(It=e[5].hpValue+"")&&se(re,It),(!Ht||64&t)&&Ot!==(Ot=e[6].hp+"")&&se(de,Ot),(!Ht||32&t)&&Wt!==(Wt=e[5].cloaked+"")&&se(ge,Wt),(!Ht||128&t)&&se(ke,e[7]),(!Ht||64&t)&&Kt!==(Kt=e[6].dc225+"")&&se(Be,Kt),(!Ht||64&t)&&Yt!==(Yt=e[6].dc175+"")&&se(Ge,Yt),(!Ht||256&t)&&Ut!==(Ut=e[8].attack+"")&&se(Ke,Ut),(!Ht||512&t)&&zt!==(zt=e[9].attack+"")&&se(Qe,zt),(!Ht||256&t)&&Qt!==(Qt=e[8].defense+"")&&se(et,Qt),(!Ht||512&t)&&Jt!==(Jt=e[9].defense+"")&&se(rt,Jt),(!Ht||256&t)&&Xt!==(Xt=e[8].armor+"")&&se(it,Xt),(!Ht||512&t)&&Zt!==(Zt=e[9].armor+"")&&se(dt,Zt),(!Ht||256&t)&&ea!==(ea=e[8].damage+"")&&se(gt,ea),(!Ht||512&t)&&ta!==(ta=e[9].damage+"")&&se(yt,ta),(!Ht||256&t)&&aa!==(aa=e[8].hp+"")&&se(Lt,aa),(!Ht||512&t)&&na!==(na=e[9].hp+"")&&se(xt,na)},i(e){Ht||(we(Nt.$$.fragment,e),Ht=!0)},o(e){Ce(Nt.$$.fragment,e),Ht=!1},d(e){e&&(te(t),te($e),te(Me),te(At),te(St)),De(Nt)}}}function $l(e){let t,a,n,r,o,s=e[0].is_owner&&wl(e)
function l(e,t){return e[1]?yl:kl}let i=l(e),c=i(e),u=e[1]&&Cl(e)
return{c(){t=ae("div"),a=ae("div"),s&&s.c(),n=le(),c.c(),r=le(),u&&u.c(),ie(a,"class","left svelte-1qul0wc"),ie(t,"class","body svelte-1qul0wc")},m(e,l){Z(e,t,l),oe(t,a),s&&s.m(a,null),oe(a,n),c.m(a,null),oe(t,r),u&&u.m(t,null),o=!0},p(e,[r]){e[0].is_owner?s?(s.p(e,r),1&r&&we(s,1)):(s=wl(e),s.c(),we(s,1),s.m(a,n)):s&&(ye(),Ce(s,1,1,(()=>{s=null})),ke()),i===(i=l(e))&&c?c.p(e,r):(c.d(1),c=i(e),c&&(c.c(),c.m(a,null))),e[1]?u?(u.p(e,r),2&r&&we(u,1)):(u=Cl(e),u.c(),we(u,1),u.m(t,null)):u&&(ye(),Ce(u,1,1,(()=>{u=null})),ke())},i(e){o||(we(s),we(u),o=!0)},o(e){Ce(s),Ce(u),o=!1},d(e){e&&te(t),s&&s.d(),c.d(),u&&u.d()}}}function Ll(e,t,a){let n,r,o,s,l,i,u,f
Ee(e,Ns,(e=>a(2,n=e))),Ee(e,sl,(e=>a(3,r=e))),Ee(e,ll,(e=>a(4,o=e))),Ee(e,il,(e=>a(5,s=e))),Ee(e,ul,(e=>a(6,l=e))),Ee(e,cl,(e=>a(7,i=e))),Ee(e,dl,(e=>a(8,u=e))),Ee(e,ml,(e=>a(9,f=e)))
let{relicData:d={}}=t
const m=d.defenders.map((e=>e.player_name))
let p=!1
return Ge((()=>{a(1,p=!1),Hs.set(0),qs.set([]),Fs.set(0),el.set([])})),e.$$set=e=>{"relicData"in e&&a(0,d=e.relicData)},[d,p,n,r,o,s,l,i,u,f,m,function(e){c("relic",e.detail)},function(){c("relic","fetchStats"),a(1,p=!0),Hs.set(d.controlled_by.guild_id),qs.set(m),Fs.set(GameData.player().hasGroup),el.set(GameData.player().buffs)}]}class Vl extends z{constructor(e){super(),Q(this,e,Ll,$l,J,{relicData:0})}}let Dl=0
function Ml(e,t){var a,r
t?.response?.data?.defenders?.length>0&&(a=n("dialog-relic"),r=t.response.data,Dl&&Dl.$destroy(),Dl=new Vl({props:{relicData:r},target:a}))}function xl(e,t){"ACT_REPAIR"===t&&GameData.fetch(Fe+f+Re+_e)}let Al=!1
function Sl(e,t,a,n,r,o,s,l,i){return e.beginPath(),e.arc(o+l/2,s+i/2,l/6,0,2*Math.PI,!1),e.fillStyle=this.color,e.fill(),e.lineWidth=1,e.strokeStyle="black",e.stroke(),!0}function Nl(){if(!Al){const e=GameController.Realm.footprintTexture
e.color=b("footprintColor"),e.Draw=Sl,Al=!0}}function Hl(){GameController?.Realm?.footprintTexture&&(Nl(),$.unsubscribe("fixed.realm",Hl))}let Bl=0
function ql(e){$("#statbar-gold").css("background-color",e)}function Tl(){$("#HelperSendTotal").html(nt(b("currentGoldSentTotal"))),Number(GameData.player().gold)>Bl?ql("red"):ql("inherit")}function El(){Bl=b("goldAmount"),$("#statbar-gold-tooltip-general").append(`<dt class="stat-gold-sendTo">Send To:</dt><dd id="HelperSendTo">${b("goldRecipient")}</dd><dt class="stat-gold-sendAmt">Amount:</dt><dd id="HelperSendAmt">${nt(Bl)}</dd><dt class="stat-gold-sendTo">Send?</dt><dd><input id="HelperSendGold" value="Send!" class="custombutton" type="submit"><input type="hidden" id="xc" value=""</dd><dt class="stat-gold-sendTotal">Total Sent:</dt><dd id="HelperSendTotal">${nt(b("currentGoldSentTotal"))}</dd>`),$("#HelperSendGold").on("click",We),Tl(),$.subscribe(Ke,Tl)}let Gl=0,jl=0,Pl=0,Fl=0,Rl=0,_l=0
async function Il(){const e=await Sn({a:14,d:0,id:Gl.id,item_id:Gl.itemId}),t=e.response.response,a=e.response.msg
let n=a
if(0!==t){const e=a.indexOf("<");-1!==e&&(n=a.substring(0,e))}else n=`You purchased ${e.response.data.name} for ${nt(e.response.data.cost)} gold.`
l(_l,`${n}<br>`)}async function Ol(){const e=Ut(Rl.value)
e&&(c("NewMap","quickBuy"),await jt(Yt(e,Il)),GameData.doAction(14,3,{id:Gl.id,item_id:Gl.itemId},0),Pl.close())}function Wl(){Fl?r("",_l):function(){Fl=a({className:"fshClear",textContent:"Select how many to quick-buy:"}),Rl=ut({id:"buyAmount",className:"fshNumberInput",min:1,max:99,value:1,type:"number"}),o(Fl,Rl)
const e=st({textContent:"Quick-buy"})
i(e,Ol),o(Fl,e),_l=a(),o(Fl,_l),o(jl,Fl)}()}function Kl(e,t){Gl=t,jl=jl||n("shopDialogConfirm"),jl&&(Pl=Pl||$(jl).data("hcsWorldDialogShopConfirm"),Pl&&Wl())}function Yl(e){let t,a
return{c(){t=ae("div"),a=ne(e[0]),ie(t,"id","tp-overlay"),ie(t,"class","svelte-dcwx64")},m(e,n){Z(e,t,n),oe(t,a)},p(e,t){1&t&&se(a,e[0])},d(e){e&&te(t)}}}function Ul(e){let t,a=e[1]&&Yl(e)
return{c(){a&&a.c(),t=X()},m(e,n){a&&a.m(e,n),Z(e,t,n)},p(e,[n]){e[1]?a?a.p(e,n):(a=Yl(e),a.c(),a.m(t.parentNode,t)):a&&(a.d(1),a=null)},i:ee,o:ee,d(e){e&&te(t),a&&a.d(e)}}}function zl(e,t,a){let{tpButton:n}=t,r=0,o=0,s=!1
function l(){const e=GameData.player().teleportCooldown
a(0,r=e-Nt()+o),r>0||(clearInterval(s),a(1,s=!1),n.classList.remove("cooldown"))}return window.$.subscribe("stats.player",l),window.$.subscribe(Ue,(function(e,t){o=Nt(),l(),s||0!==t.response.response||a(1,s=setInterval((()=>{l()}),1e3))})),e.$$set=e=>{"tpButton"in e&&a(2,n=e.tpButton)},[r,s,n]}class Ql extends z{constructor(e){super(),Q(this,e,zl,Ul,J,{tpButton:2})}}function Jl(e){return e.numberOfCreatureHitsTillDead-e.numberOfHitsRequired<=1?", dies on miss":", survives a miss"}function Xl(e,t){return"-"===t?e:"-"===e||e>t?"-":e}const Zl=[[e=>"-"===e.playerHits&&"-"===e.creatureHits,()=>"Unresolved"],[e=>"-"===e.playerHits,()=>"Player dies"],[e=>1===e.playerHits,e=>`Player 1 hits${Jl(e)}`],[e=>e.playerHits>1,e=>`Player > 1 hits${Jl(e)}`]]
function ei(e,t){return t[0](e)}function ti(e){e.playerHits=Xl(e.numberOfHitsRequired,e.numberOfCreatureHitsTillDead),e.creatureHits=Xl(e.numberOfCreatureHitsTillDead,e.numberOfHitsRequired),e.fightStatus=function(e){const t=Zl.find(s(ei,e))
return t?t[1](e):"Unknown"}(e)}function ai(e,t,a){return e.callback.groupExists?t:a}function ni(e,t,a,n){t>0&&(e.extraNotes+=`${a} = ${Math.floor(n*t*.001)}<br>`)}const ri=e=>ai(e,e.callback.groupArmorValue,e.player.armorValue)
function oi(e){e.creatureHitByHowMuch>=0?function(e){const t=e.generalVariable*e.creature.damage
t<e.overallArmorValue?e.numberOfCreatureHitsTillDead=e.overallHPValue:e.numberOfCreatureHitsTillDead=Math.ceil(e.overallHPValue/(t-e.overallArmorValue))}(e):e.numberOfCreatureHitsTillDead="-"}function si(e){!function(e){const t=ri(e)
e.overallArmorValue=t+Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}(e),function(e){ni(e,e.player.sanctuaryLevel,"Sanc Bonus Armor",e.player.armorValue)}(e),function(e){e.terrorizeEffect=Math.floor(e.creature.damage*e.player.terrorizeLevel*.001)}(e),function(e){e.player.terrorizeLevel>0&&(e.extraNotes+=`Terrorize Creature Damage Effect = ${-1*e.terrorizeEffect}<br>`)}(e),e.creature.damage-=e.terrorizeEffect,function(e){e.creatureDamageDone=Math.ceil(e.generalVariable*e.creature.damage-e.overallArmorValue+e.overallHPValue)}(e),oi(e)}const li=e=>ai(e,e.callback.groupAttackValue,e.player.attackValue)
function ii(e){return Math.floor(e.creature.defense*e.player.darkCurseLevel*Be)}function ci(e){const t=li(e)
e.player.darkCurseLevel>0&&(e.extraNotes+=`DC Bonus Attack = ${ii(e)}<br>`),e.nightmareVisageAttackMovedToDefense=Math.floor((t+e.counterAttackBonusAttack)*e.player.nightmareVisageLevel*.0025),e.player.nightmareVisageLevel>0&&(e.extraNotes+=`NMV Attack moved to Defense = ${e.nightmareVisageAttackMovedToDefense}<br>`),e.overallAttackValue=t+e.counterAttackBonusAttack-e.nightmareVisageAttackMovedToDefense,e.hitByHowMuch=function(e){const t=e.creature.defense-ii(e)
return 3===e.combatEvaluatorBias?e.overallAttackValue-Math.ceil(t)-50:e.overallAttackValue-Math.ceil(e.attackVariable*t)}(e)}const ui=(e,t,a)=>Math.max(Math.ceil((e-t+1)/a/.0025),0)
function fi(e){e.lowestCALevelToStillHit=ui(e.counterAttackBonusAttack,e.hitByHowMuch,e.player.attackValue),e.lowestCALevelToStillKill=ui(e.counterAttackBonusDamage,e.damageDone,e.player.damageValue)}function di(e){fi(e),e.lowestFeasibleCALevel=Math.max(e.lowestCALevelToStillHit,e.lowestCALevelToStillKill),e.extraNotes+=`Lowest CA to still 1-hit this creature = ${e.lowestFeasibleCALevel}<br>`,0!==e.lowestFeasibleCALevel&&function(e){e.extraAttackAtLowestFeasibleCALevel=Math.floor(.0025*e.player.attackValue*e.lowestFeasibleCALevel),e.extraDamageAtLowestFeasibleCALevel=Math.floor(.0025*e.player.damageValue*e.lowestFeasibleCALevel),e.extraNotes+=`Extra CA Att/Dam at this lowered CA level = ${e.extraAttackAtLowestFeasibleCALevel} / ${e.extraDamageAtLowestFeasibleCALevel}<br>`}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel=function(e){return e.player.counterAttackLevel>0?Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.lowestFeasibleCALevel):0}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel<e.extraStaminaPerHit?e.extraNotes+=`Extra Stam Used at this lowered CA level = ${e.extraStaminaPerHitAtLowestFeasibleCALevel}<br>`:e.extraNotes+="No reduction of stam used at the lower CA level<br>"}function mi(e,t,a){e[t]>203?e.extraNotes+=`Even with CA203 you cannot ${a} this creature<br>`:0!==e[t]&&(e.extraNotes+=`You need a minimum of CA${e[t]} to ${a} this creature<br>`)}function pi(e){(function(e){return e.player.counterAttackLevel>0&&1===e.numberOfHitsRequired})(e)&&di(e),function(e){return"-"===e.numberOfHitsRequired||1!==e.numberOfHitsRequired}(e)&&function(e){fi(e),mi(e,"lowestCALevelToStillHit","hit"),mi(e,"lowestCALevelToStillKill","1-hit kill")}(e)}const hi=e=>ai(e,e.callback.groupHPValue,e.player.hpValue),gi=e=>ai(e,e.callback.groupDamageValue,e.player.damageValue)
function vi(e){if(function(e){const t=hi(e),{fortitudeLevel:a}=e.player
e.fortitudeExtraHPs=Math.floor(t*a*.001),a>0&&(e.extraNotes+=`Fortitude Bonus HP = ${e.fortitudeExtraHPs}<br>`),e.overallHPValue=t+e.fortitudeExtraHPs}(e),function(e){const{chiStrikeLevel:t}=e.player
e.chiStrikeExtraDamage=Math.floor(e.overallHPValue*t*.001),t>0&&(e.extraNotes+=`Chi Strike Bonus Damage = ${e.chiStrikeExtraDamage}<br>`)}(e),e.overallDamageValue=gi(e)+e.deathDealerBonusDamage+e.counterAttackBonusDamage+e.holyFlameBonusDamage+e.chiStrikeExtraDamage,e.damageDone=Math.floor(e.overallDamageValue-(e.generalVariable*e.creature.armor+e.hpVariable*e.creature.hp)),e.hitByHowMuch>0){let t=1
e.overallDamageValue>=e.generalVariable*e.creature.armor&&(t=e.overallDamageValue-e.generalVariable*e.creature.armor),e.numberOfHitsRequired=Math.ceil(e.hpVariable*e.creature.hp/t)}else e.numberOfHitsRequired="-"}const bi=e=>ai(e,e.callback.groupDefenseValue,e.player.defenseValue),wi=e=>Math.floor(bi(e)*e.player.constitutionLevel*.001)
const yi=e=>e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue
function ki(e){e.overallDefenseValue=bi(e)+wi(e)+e.nightmareVisageAttackMovedToDefense,function(e){e.player.constitutionLevel>0&&(e.extraNotes+=`Constitution Bonus Defense = ${wi(e)}<br>`)}(e),function(e){ni(e,e.player.flinchLevel,"Flinch Bonus Attack Reduction",e.creature.attack)}(e),e.creatureHitByHowMuch=Math.floor(e.attackVariable*yi(e)),3===e.combatEvaluatorBias&&(e.creatureHitByHowMuch=Math.floor(yi(e)-50))}function Ci(e){e.extraNotes="",function(e){e.player.superEliteSlayerLevel>0&&(e.extraNotes+=`SES Stat Reduction Multiplier = ${e.player.superEliteSlayerMultiplier}<br>`)}(e),function(e){e.holyFlameBonusDamage=0,"Undead"===e.creature.class&&(e.holyFlameBonusDamage=Math.max(Math.floor((e.player.damageValue-e.creature.armor)*e.player.holyFlameLevel*.002),0),e.player.holyFlameLevel>0&&(e.extraNotes+=`HF Bonus Damage = ${e.holyFlameBonusDamage}<br>`))}(e),function(e){e.deathDealerBonusDamage=Math.floor(e.player.damageValue*(Math.min(.01*Math.floor(e.player.killStreakValue/5)*e.player.deathDealerLevel,20)/100))}(e),function(e){e.counterAttackBonusAttack=Math.floor(.0025*e.player.attackValue*e.player.counterAttackLevel),e.counterAttackBonusDamage=Math.floor(.0025*e.player.damageValue*e.player.counterAttackLevel)}(e),function(e){e.extraStaminaPerHit=0,e.player.counterAttackLevel>0&&(e.extraStaminaPerHit=Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.player.counterAttackLevel))}(e),function(e){e.player.deathDealerLevel>0&&(e.extraNotes+=`DD Bonus Damage = ${e.deathDealerBonusDamage}<br>`)}(e),function(e){e.player.counterAttackLevel>0&&(e.extraNotes+=`CA Bonus Attack/Damage = ${e.counterAttackBonusAttack} / ${e.counterAttackBonusDamage}<br>CA Extra Stam Used = ${e.extraStaminaPerHit}<br>`)}(e)}const $i=e=>e.creatureHitByHowMuch>=0?"Yes":"No",Li=e=>e.hitByHowMuch>0?"Yes":"No",Vi=e=>`<span style="color:#333333">${e}</span>`,Di=e=>`<tr>${e}</tr>`,Mi=(e,t)=>`<td${t%2?"":' class="fshRight"'}>${e}</td>`,xi=e=>Di(e.map(Mi).join("")),Ai=e=>Di(`<td bgcolor="#CD9E4B" colspan="4" align="center">${(e=>e.callback.groupExists?"Group ":"")(e)}Combat Evaluation</td>`),Si=e=>xi([Vi("Will I hit it?"),Li(e),Vi("Extra Attack:"),`( ${e.hitByHowMuch} )`]),Ni=e=>xi([Vi("# Hits to kill it?"),e.numberOfHitsRequired,Vi("Extra Damage:"),`( ${e.damageDone} )`]),Hi=e=>xi([Vi("Will I be hit?"),$i(e),Vi("Extra Defense:"),`( ${-1*e.creatureHitByHowMuch} )`]),Bi=e=>xi([Vi("# Hits to kill me?"),e.numberOfCreatureHitsTillDead,Vi("Extra Armor + HP:"),`( ${-1*e.creatureDamageDone} )`]),qi=e=>xi([Vi("# Player Hits?"),e.playerHits,Vi("# Creature Hits?"),e.creatureHits]),Ti=e=>Di(`${Mi(Vi("Fight Status:"),0)}<td colspan="3"><span>${e.fightStatus}</span></td>`),Ei=e=>Di(`${Mi(Vi("Notes:"),0)}<td colspan="3"><span style="font-size:x-small;">${e.extraNotes}</span></td>`)
let Gi=0,ji=0,Pi=0
function Fi(){return cr(ji)?"Remove from do not kill list":"Add to the do not kill list"}function Ri(){r(Fi(),Pi)}function _i(){c("NewMap","doNotKillLink")
const e=t.doNotKillList.indexOf(ji);-1===e?t.doNotKillList.push(ji):t.doNotKillList.splice(e,1),Ri(),L("doNotKillList",t.doNotKillList.join()),fr()}function Ii(){Pi?Ri():function(){Pi=st({className:"fshBl",textContent:Fi()})
const e=a({className:"description",innerHTML:'<span class="ui-helper-hidden-accessible"><input type="text"></span>'})
o(e,Pi),o(Gi,e),i(Pi,_i)}()}function Oi(e,t){!function(e){if(!Gi){const t=q("body",e)
1===t.length&&([Gi]=t)}}(t),Gi&&(ji=R(e),Ii())}let Wi=0,Ki=0,Yi=0,Ui=0
function zi(){Yi||(Ki||(Ki=a(),o(Wi,Ki),o(Wi,a({innerHTML:'<span class="fshFooter">*Does include CA, DD, HF, DC, Flinch, Super Elite Slayer, NMV, Sanctuary, Constitution, Fortitude, Chi Strike and Terrorize (if active) and allow for randomness (1.1053). Constitution, NMV, Fortitude and Chi Strike apply to group stats.</span>'}))),Yi=a(),o(Ki,Yi))}function Qi(e){zi(),he(e,Yi)}function Ji(e){Ui||(zi(),Ui=a(),o(Ki,Ui)),he(e,Ui)}function Xi(e,t){const a={name:e.name,class:e.creature_class,attack:Number(e.attack),defense:Number(e.defense),armor:Number(e.armor),damage:Number(e.damage),hp:Number(e.hp)}
return function(e,t,a){3===a&&(t.attack-=Math.ceil(t.attack*e),t.defense-=Math.ceil(t.defense*e),t.armor-=Math.ceil(t.armor*e),t.damage-=Math.ceil(t.damage*e),t.hp-=Math.ceil(t.hp*e))}(t,a,e.type),a}function Zi(e,a,n){const r={}
r.callback=n,r.player=xs(a),function(e){e.combatEvaluatorBias=t.combatEvaluatorBias,e.attackVariable=1.1053,e.generalVariable=t.generalVariable,e.hpVariable=t.hpVariable}(r),r.creature=Xi(e.response.data,r.player.superEliteSlayerMultiplier),function(e){var t
t=e,[Ci,ci,vi,ki,si,ti,pi].forEach((e=>e(t)))}(r),r.evaluatorHTML=function(e){return`<table width="100%"><tbody>${Ai(e)}${Si(e)}${Ni(e)}${Hi(e)}${Bi(e)}${qi(e)}${Ti(e)}${Ei(e)}</tbody></table>`}(r),n.groupExists?Ji(r.evaluatorHTML):Qi(r.evaluatorHTML)}function ec(e){return e.members[0].name===u()}async function tc(e,t,a){if(a){!function(e,t,a){if(!a.r?.attributes)return
const n=a.r.attributes
Zi(e,t,{groupExists:!0,groupAttackValue:n[0].value,groupDefenseValue:n[1].value,groupArmorValue:n[2].value,groupDamageValue:n[3].value,groupHPValue:n[4].value})}(e,t,await Rt(a))}}async function ac(e,t){const a=function(e){if(lt(e.r))return e.r.find(ec).id}(await Ot())
tc(e,t,a)}async function nc(e,t){if(Wi||(Wi=n("dialog-viewcreature")),Wi&&(Qi(""),Ji(""),t?.response?.data)){Oi(t.response.data.name,Wi)
const e=await zt(!0)
e&&function(e,t){e.player.hasGroup&&ac(e,t),Zi(e,t,{groupExists:!1})}(t,e)}}let rc=0
function oc(e){const t=q("verbs",e)
1===t.length&&Jt(t[0])}function sc(){if(!rc)return
const e=n("actionList")
_("player",e).forEach(oc)}const lc="showHuntingBuffs"
function ic(){return`${Xt(lc)} ${Zt("enabledHuntingMode")}<select name="enabledHuntingMode"><option value="1"${ea(t.enabledHuntingMode,"1")}>${t.buffsName}</option><option value="2"${ea(t.enabledHuntingMode,"2")}>${t.buffs2Name}</option><option value="3"${ea(t.enabledHuntingMode,"3")}>${t.buffs3Name}</option></select>`}let cc=0,uc=""
const fc=()=>cc,dc=()=>uc
function mc(){const e=[null,[t.buffs,t.buffsName],[t.buffs2,t.buffs2Name],[t.buffs3,t.buffs3Name]][t.enabledHuntingMode]
lt(e)&&([cc,uc]=e)}function pc(e){"enabledHuntingMode"===e.target.name&&(c("NewMap","toggleEnabledHuntingMode"),t.enabledHuntingMode=e.target.value,L("enabledHuntingMode",t.enabledHuntingMode),mc(),GameData.fetch(f))}function hc(e){c("NewMap","togglePref"),t[e]=!t[e],L(e,t[e])}const gc={hideSubLvlCreature:function(){hc("hideSubLvlCreature"),GameData.fetch(_e)},hidePlayerActions:function(){c("NewMap","toggleHidePlayerActions"),rc=!rc,L("hidePlayerActions",rc),GameData.fetch(_e)},showCreatureInfo:()=>hc("showCreatureInfo"),showHuntingBuffs:function(){hc("showHuntingBuffs"),GameData.fetch(f)},showMonsterLog:()=>hc("showMonsterLog"),showTitanInfo:function(){hc("showTitanInfo"),ps(GameData.realm().dynamic)},showBuffInfo:function(){hc("showBuffInfo"),Pa()}}
function vc(e){const t=gc[e.target.name]
W(t)&&(e.target.blur(),t(e))}function bc(){const e=n("worldPage")
if(!e)return
const t=a({className:"fshCenter fshFten"}),r=a({id:"fshWorldPrefs",innerHTML:`${Xt("showCreatureInfo")}&nbsp;&nbsp;${Xt("showMonsterLog")}&nbsp;&nbsp;${Xt("showTitanInfo")}&nbsp;&nbsp;${Xt("showBuffInfo")}<br>${Xt("hideSubLvlCreature")}&nbsp;&nbsp;${Xt("hidePlayerActions")}&nbsp;&nbsp;${ic()}`})
i(r,vc),v(r,"change",pc),o(t,r)
const s=a()
return o(t,s),o(e,t),s}const wc=[{generalVariable:1.1053,hpVariable:1.1},{generalVariable:1.1,hpVariable:1.053},{generalVariable:1.053,hpVariable:1},{generalVariable:1.1053,hpVariable:1}]
function yc(){var e
t.combatEvaluatorBias=b("combatEvaluatorBias"),t.generalVariable=(e=t.combatEvaluatorBias,wc[e]?wc[e].generalVariable:1.1053),t.hpVariable=function(e){return wc[e]?wc[e].hpVariable:1.1}(t.combatEvaluatorBias)}function kc(e,t){return e[t.name]=!0,e}function Cc(e,t,a){return e[R(a)]||t.push(a),t}function $c(e){he("",e)}function Lc(e,t){const a=t.b.reduce(kc,{}),n=fc().reduce(s(Cc,a),[])
n.length>0?function(e,t){he(`You are missing some ${dc()} hunting buffs<br>(${t.join(", ")})`,e)}(e,n):$c(e)}function Vc(e,a,n){fc()&&function(e,a){t.showHuntingBuffs?Lc(e,a):$c(e)}(e,n)}function Dc(e,t){return 6!==t.type||(0!==t.data.creature_type||t.data.level>=e)}function Mc(e){const t=H(e)
return t?.actions?.length?(t.actions=t.actions.filter(s(Dc,function(e){return e.realm?.minlevel||GameData.realm().minlevel}(t))),Qe(t)):e}function xc(e,a){t.hideSubLvlCreature&&function(e){return e.data?.d&&ta(e.data.d,_e)}(a)&&(e.dataFilter=Mc)}function Ac(e){t[e[0]]=Qt(e[1])}function Sc(e){t[e]=Qt(e)}function Nc(){[["buffs","huntingBuffs"],["buffs2","huntingBuffs2"],["buffs3","huntingBuffs3"]].forEach(Ac),["doNotKillList"].forEach(Sc)}function Hc(e){t[e[0]]=b(e[1])}function Bc(e){t[e]=b(e)}function qc(){[["buffsName","huntingBuffsName"],["buffs2Name","huntingBuffs2Name"],["buffs3Name","huntingBuffs3Name"],["showHuntingBuffs","showHuntingBuffs"]].forEach(Hc),["enabledHuntingMode","hideSubLvlCreature","showTitanInfo","showBuffInfo","showMonsterLog","showCreatureInfo"].forEach(Bc)}const Tc=[function(){yc(),Nc(),qc()
const e=bc()
$.ajaxPrefilter("JSON",xc),t.hideSubLvlCreature&&GameData.fetch(_e),function(e){mc()
const a=s(Vc,e)
$.subscribe(d,a),t.showHuntingBuffs&&window.initialGameData&&a(null,{b:window.initialGameData.player.buffs})}(e),rc=b("hidePlayerActions"),$.subscribe(K,sc),sc()},function(){Ie(),Oe()&&El()},function(){$.subscribe(ze,nc)},function(){Hr.forEach(Br)},function(){b("enableCreatureColoring")&&o(document.body,gt("#actionList .creature-1 {color: green;}\n#actionList .creature-2 {color: yellow;}\n#actionList .creature-3 {color: red;}"))},function(){$.subscribe(K,fr),fr(),function(){const e=GameData.doAction
GameData.doAction=pr(e)}()},function(){Ur(),$.subscribe("-1-success.action-response 4-success.action-response 5-success.action-response 25-success.action-response",Zr),Zr()},function(){$.subscribe(Pe,xl)},async function(){if(b("keepLogs")){!function(e){e&&($n=e),$.subscribe(A,xn)}(await dt("fsh_combatLog"))}},function(){window.initialGameData&&gs(0,window.initialGameData),$.subscribe(`${ve} ${be}`,gs)},function(){$.subscribe(Ye,Kl)},function(){$.subscribe(je,Ml)},function(){$("#messageCenter").worldMessageCenter({offset:"0 60"})},function(){w("#mapTooltip")},function(){cn(),$.subscribe(p,un),$.subscribe(h,fn)},function(){Pa(),$.subscribe(`${d} ${m}`,Pa)},function(){v(n("actionList"),"mouseover",ir)},function(){const{body:e}=document
v(e,"keydown",yn),v(e,"keyup",kn)},function(){const e=$("#world-event-badge")
e.length&&(e.off(),i(e[0],Sr))},function(){const e=M(".actionListHeaderButton.teleport")
!function(e,t){new Ql({target:e,props:t})}(e,{tpButton:e})},function(){var e
b("messageStack")&&(e=n("messageCenter"),new Pr({target:e}))},function(){GameController?.Realm?.footprintTexture?Nl():$.subscribe("fixed.realm",Hl)}]
function Ec(){e(Tc)}export{Ec as default}
//# sourceMappingURL=newMap-QpFUzwGK.js.map
