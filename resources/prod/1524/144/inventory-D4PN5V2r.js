import{g as t}from"./getMembrList-FvUbc1-a.js"
import{dc as e,i as n,cB as s,am as a,u as i,p as r,b0 as c,cm as o,dd as d,s as l,c as u,b6 as f,bQ as p,ao as m,d0 as h,de as b,bS as y,E as v,ch as g,b8 as k,k as _,J as x,$ as I,a$ as R,b5 as w,aA as L,S,O as M,P as E,R as D,T,U as j,W as N,X as A,_ as C,a3 as G,a4 as q,a5 as U,b4 as P,a7 as O,df as B,a8 as F,g as W,dg as H,dh as V,bj as Q,di as Y,dj as X,dk as J,bF as z,bG as Z,bA as K,bD as tt,bH as et,av as nt,H as st,d as at,w as it,m as rt,x as ct,cp as ot,f as dt,bb as lt}from"./calfSystem-fMW-YMyF.js"
import{e as ut}from"./executeAll-DIAWIge1.js"
import{l as ft}from"./loadDataTables-DY-HcyBB.js"
import{d as pt,a as mt}from"./deepClone-BiqS5lj8.js"
import{d as ht}from"./daGuildReport-CvskNLmM.js"
import{d as bt}from"./daLoadInventory-C5VqDf3X.js"
import{b as yt}from"./basicItem-Co_lZL1x.js"
import{e as vt,d as gt,a as kt,m as $t}from"./dropItem-BWXTQknt.js"
import{f as _t}from"./flattenItems-DBwSgTaC.js"
import{c as xt}from"./createTable-BlxaNzLX.js"
import{i as It}from"./isSelected-BWnMzKlW.js"
import{c as Rt}from"./changeMinMax-rHOFY_Cb.js"
import{c as wt}from"./chromeHandlers--YD9g-3s.js"
import{a as Lt,u as St,e as Mt}from"./useItem-JApxkOKQ.js"
import{g as Et}from"./guildInventory-CBghvkUS.js"
import{h as Dt}from"./htmlResult-DQb6ND1_.js"
import{e as Tt}from"./errorDialog-B4_TjdGG.js"
import{q as jt,a as Nt}from"./queue-aTJOXuHY.js"
import{p as At,l as Ct}from"./lvlTests-CWxtARst.js"
import"./dialog-BW-ZNw6R.js"
import"./dialogMsg-rKdvzvMA.js"
import"./sendItems-CLqdpc-M.js"
import"./daUseItem-BS7q08-a.js"
import"./InfoBoxFrom-BQSTjSr-.js"
import"./backpackOk-DFWLxaGo.js"
import"./takeItem-V-Dy5IH9.js"
function Gt([t]){return"lastUpdate"!==t}function qt(){return e({subcmd:"inventory"})}let Ut=""
const Pt=()=>Ut
function Ot(t,e){Ut||(Ut=e.message),Ut&&n(t,s("p",{className:"fshRed",textContent:Ut}))}let Bt={}
const Ft=()=>Bt
async function Wt(t){try{return await t()}catch(t){if(500!==t.jqXhr.status)throw t
Ot(r(),t)}}const Ht=(t,e)=>{return e.map(yt).map((n=t,function(t){const e=n?.find((({inv_id:e})=>e===t.inv_id))
return{...t,...e?.stats&&{stats:{...t.stats,armor:e.stats.armor,attack:e.stats.attack,damage:e.stats.damage,defense:e.stats.defense,hp:e.stats.hp,set_name:e.stats.set_name??""}}}}))
var n},Vt=t=>({...t,equipped:!0,folder_id:-2}),Qt=(t,e,n)=>({folders:vt(t),items:Ht(e,n),player_id:c()})
const Yt=t=>({...t,player:{id:-1}}),Xt=(t,e)=>({current_player_id:c(),items:Ht(t,e),guild_id:o()})
async function Jt(){if("invmanagernew"===a.subcmd){const t=await async function(){const[t,e]=await i([Wt(qt),bt()]),n=t?.items??[],s=e?.r??{},a=(s.equipment?.map(Vt)??[]).concat(_t(s))
return Qt(s,n,a)}()
Bt=t}else if("guildinvmgr"===a.subcmd){const t=await async function(){const[t,e,n]=await i([Wt(d),ht(),pt()]),s=t?.items??[],a=e?.r??[],r=n?.r??[],c=a.concat(r.map(Yt))
return Xt(s,c)}()
Bt=t}}const zt=t=>{l("Inventory","Header",t)},Zt=t=>{l("Inventory","Datatable",t)}
function Kt(t,e){Zt("clearSearch"),e.val(""),$(t).DataTable().search("").draw()}function te(){Ft().folders&&(Ft().folders[-1]="Main")}const ee={checkedElements:{0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,100:1,101:1,102:1,103:1,104:1,105:1,106:1},fshMinLvl:1,fshMaxLvl:9999},ne='<table class="fshInvFilter"><tr><th colspan="14">@@reportTitle@@</th><th><span id="fshRefresh" class="fshLink">[Refresh]</span></th></tr><tr><td colspan="2" rowspan="3"><b>&nbsp;Show Items:</b></td><td class="fshRight">&nbsp;Helmet:</td><td><input id="fshHelmet" type="checkbox" item="0"/></td><td class="fshRight">&nbsp;Armor:</td><td><input id="fshArmor" type="checkbox" item="1"/></td><td class="fshRight">&nbsp;Gloves:</td><td><input id="fshGloves" type="checkbox" item="2"/></td><td class="fshRight">&nbsp;Boots:</td><td><input id="fshBoots" type="checkbox" item="3"/></td><td class="fshRight">&nbsp;Weapon:</td><td><input id="fshWeapon" type="checkbox" item="4"/></td><td></td><td class="fshRight">&nbsp;Min lvl:</td><td rowspan="2"><input id="fshMinLvl" class="fshNumberInput" type="number" value="1" min="0"><br><input id="fshMaxLvl" class="fshNumberInput" type="number" value="9999" min="0"></td></tr><tr><td class="fshRight">&nbsp;Shield:</td><td><input id="fshShield" type="checkbox" item="5"/></td><td class="fshRight">&nbsp;Ring:</td><td><input id="fshRing" type="checkbox" item="6"/></td><td class="fshRight">&nbsp;Amulet:</td><td><input id="fshAmulet" type="checkbox" item="7"/></td><td class="fshRight">&nbsp;Rune:</td><td><input id="fshRune" type="checkbox" item="8"/></td><td class="fshRight">&nbsp;Sets Only:</td><td><input id="fshSets" item="-1" type="checkbox"/></td><td></td><td class="fshRight">&nbsp;Max lvl:</td></tr><tr><td colspan="2">&nbsp;[<span id="fshAll" class="fshLink">Select All</span>]</td><td colspan="2">&nbsp;[<span id="fshNone" class="fshLink">Select None</span>]</td><td colspan="2">&nbsp;[<span id="fshDefault" class="fshLink">Defaults</span>]</td><td colspan="6"></td><td><input id="fshReset" type="button" value="Reset"/></td></tr><tr><td class="fshRight">&nbsp;Quest Item:</td><td><input id="fshQuest" item="9" type="checkbox"/></td><td class="fshRight">&nbsp;Potion:</td><td><input id="fshPotion" item="10" type="checkbox"/></td><td class="fshRight">&nbsp;Resource:</td><td><input id="fshResource" item="12" type="checkbox"/></td><td class="fshRight">&nbsp;Recipe:</td><td><input id="fshRecipe" item="13" type="checkbox"/></td><td class="fshRight">&nbsp;Container:</td><td><input id="fshContainer" item="14" type="checkbox"/></td><td class="fshRight">&nbsp;Frag Stash:</td><td><input id="fshStash" item="16" type="checkbox"/></td><td class="fshRight">&nbsp;Composed:</td><td><input id="fshComposed" item="15" type="checkbox"/></td><td></td></tr><tr><td class="fshRight">&nbsp;Common:</td><td><input id="fshCommon" item="100" type="checkbox" checked/></td><td class="fshRight">&nbsp;Rare:</td><td><input id="fshRare" item="101" type="checkbox" checked/></td><td class="fshRight">&nbsp;Unique:</td><td><input id="fshUnique" item="102" type="checkbox" checked/></td><td class="fshRight">&nbsp;Legendary:</td><td><input id="fshLegendary" item="103" type="checkbox" checked/></td><td class="fshRight">&nbsp;Super Elite:</td><td><input id="fshSuperElite" item="104" type="checkbox" checked/></td><td class="fshRight">&nbsp;Crystalline:</td><td><input id="fshCrystalline" item="105" type="checkbox" checked/></td><td class="fshRight">&nbsp;Epic:</td><td colspan="2"><input id="fshEpic" item="106" type="checkbox" checked/></td></tr></table>',se={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,100:1,101:1,102:1,103:1,104:1,105:1,106:1},ae={Perfect:{abbr:"Perf",colour:"#00b600",index:8},Excellent:{abbr:"Exc",colour:"#f6ed00",index:7},"Very Good":{abbr:"VG",colour:"#f67a00",index:6},Good:{abbr:"Good",colour:"#f65d00",index:5},Average:{abbr:"Ave",colour:"#f64500",index:4},Poor:{abbr:"Poor",colour:"#f61d00",index:3},"Very Poor":{abbr:"VPr",colour:"#b21500",index:2},Uncrafted:{abbr:"Unc",colour:"#666666",index:1}}
let ie={},re=0,ce=0
const oe=()=>ie,de=()=>re,le=()=>ce
function ue(t){return ae[t]?ae[t].abbr:""}function fe(t,e){const n=function(t){return t.folder_id?function(t){return t.equipped?"fshGreen":"fshNavy"}(t):function(t){return-1===t.player_id?"fshNavy":"fshMaroon"}(t)}(e)
t.classList.add(n),e.equipped&&t.classList.add("fshBold")}function pe(t){return function(t){return t.player_id&&-1!==t.player_id}(t)||function(t){return t.folder_id&&-1!==t.guild_tag}(t)}function me(t){return`<span class="fshLink recallItem" invid="${t.inv_id}" playerid="${p(t.player_id,Ft().player_id)}" mode="1" action="recall">GS</span>`}function he(t){return`<span class="fshLink storeItem" invid="${t.inv_id}">GS</span>`}function be(t,e,n){return"display"===t?n(e):"GS"}function ye(t,e){const n=function(t){return-1===t.player_id?4:pe(t)?7:1}(e),s=(a=Ft().player_id,i=e.player_id,r=Ft().guild_id,a||(-1!==i?i:r))
var a,i,r
let c=""
return function(t){return t.stats&&""!==t.stats.set_name}(e)&&(c=` (<span class="fshLink setName" set="${e.stats.set_name}">set</span>)`),`<a href="${h}${t}" class="fshInvItem tip-dynamic ${b[e.rarity].clas}" data-tipped="fetchitem.php?item_id=${e.item_id}&inv_id=${e.inv_id}&t=${n}&p=${s}">${t}</a>${c}`}const ve=[[t=>t.player_id&&-1===t.player_id,(t,e)=>`takeItem" action="${e.a}`],[t=>t.player_id&&t.player_id!==Ft().current_player_id,(t,e)=>`recallItem" playerid="${t.player_id}" mode="0" action="${e.a}`],[t=>function(t){return t.folder_id&&!t.equipped}(t)||function(t){return t.player_id&&!t.equipped&&t.player_id===Ft().current_player_id}(t),(t,e)=>e.c]]
function ge(t,e){const n=ve.find((([e])=>e(t)))
return n?`<span class="fshLink ${n[1](t,e)}" invid="${t.inv_id}">${e.b}</span>`:""}function ke(t){return p(t.folder_id,t.player_id)}function $e(t){return a.membrList[t]?a.membrList[t].username:"???"}function _e(t,e){return t[0]-e[0]}function xe(t,e){return`<option value="${e[0]}"${It(Number(e[0]),t)}>${e[1]}</option>`}const Ie=[{title:"Name",data:"item_name",render:function(t,e,n){return"display"!==e?t:ye(t,n)}},{title:"Level",data:"stats.min_level"},{title:"Where",data:ke,render:{_:function(t,e,n){return n.folder_id?function(t){return t.equipped?-2:t.folder_id}(n):-1===n.player_id?"~":$e(n.player_id)},display:function(t,e,n){return n.player_id?function(t){return-1===t.player_id?"Guild Store":`<a class="fshMaroon" href="${y}${t.player_id}">${$e(t.player_id)}</a>`}(n):n.equipped?"Worn":`<select class="fshMoveItem" data-inv="${n.inv_id}">${s=n.folder_id,a=Ft().folders,v(a).sort(_e).map(u(xe,s)).join("")}</select>`
var s,a},filter:function(t,e,n){return n.player_id?function(t){return-1===t.player_id?"Guild Store":$e(t.player_id)}(n):n.equipped?"Worn":Ft().folders[n.folder_id]}}},{title:"Type",data:"type",render:t=>g[t]},{title:"Att",data:"stats.attack"},{title:"Def",data:"stats.defense"},{title:"Arm",data:"stats.armor"},{title:"Dam",data:"stats.damage"},{title:"HP",data:"stats.hp"},{title:"Frg",data:"forge",render:function(t,e,n){if(n.type<9)return n.forge}},{title:"Craft",data:"craft",render:{_:t=>ae[t]?ae[t].index:0,display:ue,filter:ue}},{title:"Du%",data:"durability",render:function(t,e,n){if(n.type<9&&n.max_durability>0)return Math.floor(n.durability/n.max_durability*100)}},{title:"BP",data:ke,render:function(t,e,n){if(!n.folder_id&&n.player_id!==Ft().current_player_id)return function(t,e){return"display"!==t?"BP":-1===e.player_id?`<span class="fshLink takeItem" invid="${e.inv_id}" action="take">BP</span>`:`<span class="fshLink recallItem" invid="${e.inv_id}" playerid="${e.player_id}" mode="0" action="recall">BP</span>`}(e,n)}},{title:"GS",data:ke,render:function(t,e,n){return pe(n)?be(e,n,me):function(t){return t.folder_id&&!t.bound}(n)?be(e,n,he):void 0}},{title:"W/U",data:"type",render:function(t,e,n){const s=[1,1,1,1,1,1,1,1,1,null,2,2,null,null,null,2][t]
return 1===s?ge(n,{a:"wear",b:"Wear",c:"wearItem"}):2===s?ge(n,{a:"use",b:"Use",c:"useItem"}):void 0}},{title:"setName",data:"stats.set_name",orderable:!1,visible:!1},{title:"Tag",data:"guild_tag",render:t=>-1===t?"No":"Yes"},{title:"Drop",data:"type",render:function(t,e,n){if(!function(t){return-1!==t.guild_tag||t.equipped}(n))return"display"!==e?"Drop":`<span class="dropItem dropLink" data-tooltip="INSTANTLY DESTROY THE ITEM. NO REFUNDS OR DO-OVERS! Use at own risk." data-inv="${n.inv_id}">Drop</span>`}},{title:"Send",data:"type",render:function(t,e,n){if(!function(t){return t.equipped||-1===t.guild_tag&&t.bound}(n))return"display"!==e?"Send":`<span class="sendItem sendLink" data-tooltip="INSTANTLY SEND THE ITEM. NO REFUNDS OR DO-OVERS! Use at own risk." data-inv="${n.inv_id}">Send</span>`}}]
function Re(){return"player_id"in Ft()}function we(){const t=function(){const t=xt({className:"hover fshXSmall",id:Re()?"fshUserInv":"fshGuildInv"})
return n(r(),t),t}(),e=function(t){return $(t).DataTable({autoWidth:!1,columnDefs:[{targets:"_all",defaultContent:""},{targets:[1,4,5,6,7,8,9,10,12,13],orderSequence:["desc","asc"]}],columns:Ie,createdRow:fe,data:Ft().items,deferRender:!0,lengthMenu:[[50,100,150,200,-1],[50,100,150,200,"All"]],pageLength:50,stateDuration:0,stateSave:!0})}(t)
return function(t){[[12,"current_player_id"in Ft()],[17,Re()&&de()],[18,Re()&&le()]].forEach((([e,n])=>t.column(e).visible(n)))}(e),t}function Le(t){k(`fsh_${a.subcmd}`,t)}function Se(){_('table.fshInvFilter input[type="checkbox"]').forEach((t=>{t.checked=1===oe().checkedElements[t.getAttribute("item")]})),Le(oe())}function Me(t){zt("Select All"),oe().checkedElements=se,Se(),$(t).DataTable().draw(!1)}function Ee(t,e){oe().fshMinLvl=t,oe().fshMaxLvl=e,Le(oe())}function De(t){$(t).DataTable().draw(!1)}function Te(t){zt("changeLvls"),Rt(Ee,u(De,t))}function je(t){return Number(t[0])>=100}function Ne(t,e){return t[e[0]]=e[1],t}function Ae(t){var e
zt("Select None"),oe().checkedElements=(e=oe().checkedElements,v(e).filter(je).reduce(Ne,{})),Se(),$(t).DataTable().draw()}function Ce(t){zt("Checkbox"),oe().checkedElements={},_('table.fshInvFilter input[type="checkbox"][item]:checked').forEach((t=>{oe().checkedElements[t.getAttribute("item")]=1})),Le(oe()),$(t).DataTable().draw(!1)}function Ge(t){zt("Defaults"),oe().checkedElements=ee.checkedElements,Se(),$(t).DataTable().draw(!1)}function qe(t){zt("Reset levels"),oe().fshMinLvl=ee.fshMinLvl,oe().fshMaxLvl=ee.fshMaxLvl,Le(oe()),function(t){$("#fshMinLvl").val(oe().fshMinLvl),$("#fshMaxLvl").val(oe().fshMaxLvl),$(t).DataTable().draw(!1)}(t)}async function Ue(t){const e=await gt(t)
return Lt(e)}function Pe(t){return Et({subcmd2:"dostoreitems",items:t})}async function Oe(t){const e=await x({cmd:"guild",subcmd:"inventory",subcmd2:"dostoreitems",storeIndex:t})
return Dt(e)}async function Be(t){const e=await function(t){return I(Pe,Oe,t)}(t)
return Tt(e),Lt(e)}function Fe(t,e){t.eq(e).empty()}function We(t,e){if(1===e.r)return
const n=t.closest("tr")
!function(t){[2,12,13,14,15,16].forEach(u(Fe,t))}($("td",n)),n.css("text-decoration","line-through")}async function He(t,e){R(e),function(t){t.closest("tr").find(".takeItem, .recallItem, .wearItem, .dropItem, .sendItem, .storeItem").removeClass()}(e),function(t){t.empty().append(`<img src="${w}ui/misc/spinner.gif" width="11" height="11">`)}(e)
const n=await t()
n&&We(e,n)}function Ve(t,e){Zt("setName"),$(t).DataTable().search(e.attr("set")).draw(),$(`#${t.id}_filter input`).trigger("focus")}function Qe(t){Zt("takeItem"),He(u(jt,t.attr("invid"),t.attr("action")),t)}function Ye(t){Zt("recallItem"),He(u(Nt,t.attr("invid"),t.attr("playerid"),t.attr("mode"),t.attr("action")),t)}function Xe(t,e,n,s){Zt(n),He(u(t,e),s)}function Je(t){Xe(Be,[t.attr("invid")],"doStoreItem",t)}function ze(t,e,n){Xe(t,n.attr("invid"),e,n)}const Ze=t=>ze(St,"doUseItem",t),Ke=t=>ze(Mt,"doWearItem",t)
function tn(t,e,n){Xe(t,[n.data("inv")],e,n)}const en=t=>tn(kt,"doDropItem",t),nn=t=>tn(Ue,"doSendItem",t),sn=t=>e=>t($(e.target))
function an(t,[e,n]){$(t).on("click",`span.${e}`,sn(n))}function rn(t){Zt("doMoveItem")
const e=$(t.target)
$t([e.data("inv")],e.val())}function cn(t,e){$(e[0]).on("click",u(e[1],t))}const on=t=>()=>{Zt(t)}
function dn(t){!function(t){[["#fshReset",qe],["#fshAll",Me],["#fshNone",Ae],["#fshDefault",Ge]].forEach(u(cn,t))}(t),$("table.fshInvFilter").on("click",'input[type="checkbox"]',u(Ce,t)),function(t){[["dropItem",en],["recallItem",Ye],["sendItem",nn],["setName",u(Ve,t)],["storeItem",Je],["takeItem",Qe],["useItem",Ze],["wearItem",Ke]].forEach(u(an,t))}(t),function(t){["fshInvItem","fshMaroon","sorting"].forEach((e=>{$(t).on("click",`.${e}`,on(e))}))}(t)}let ln=0
function un(t,e){return Ct(ln,L(e[1]),oe().fshMinLvl,oe().fshMaxLvl)}function fn(){ln=[(t,e,n)=>0===n,...At],$.fn.dataTable.ext.search.push(un)}function pn(){$.fn.dataTable.ext.search.push(((t,e,n,s)=>!oe().checkedElements||oe().checkedElements[s.type]))}function mn(){$.fn.dataTable.ext.search.push(((t,e,n,s)=>!oe().checkedElements?.[-1]||function(t){return oe().checkedElements[-1]&&t.stats&&""!==t.stats.set_name}(s)))}function hn(){$.fn.dataTable.ext.search.push(((t,e,n,s)=>{const a=(parseInt(s.rarity,10)+100).toString()
return!oe().checkedElements||oe().checkedElements[a]}))}function bn(t){let e,n,s,a,i,r,c,o,d
return{c(){e=D("div"),n=D("div"),n.textContent="Recall all visible to",s=T(),a=D("div"),i=D("button"),i.textContent="BP",r=T(),c=D("button"),c.textContent="GS",j(n,"class","head svelte-1mlms3r"),j(i,"class","custombutton svelte-1mlms3r"),j(i,"type","button"),j(c,"class","custombutton svelte-1mlms3r"),j(c,"type","button"),j(a,"class","btnbox svelte-1mlms3r"),j(e,"class","main svelte-1mlms3r")},m(l,u){N(l,e,u),A(e,n),A(e,s),A(e,a),A(a,i),A(a,r),A(a,c),o||(d=[C(i,"click",t[0]),C(c,"click",t[1])],o=!0)},p:G,i:G,o:G,d(t){t&&q(e),o=!1,U(d)}}}function yn(t){const e=t=>{l("Inventory","Recall All",t)}
return[function(){e("toBp"),[..._('span[action="take"]'),..._('span[mode="0"][action="recall"]')].forEach(P)},function(){e("toGs"),_('span[mode="1"][action="recall"]').forEach(P)}]}class vn extends S{constructor(t){super(),M(this,t,yn,bn,E,{})}}function gn(t){let e,n,s,a,i,r,c,o,d,l=(t[0]||"")+"",u=(t[1]||"")+""
return{c(){e=D("div"),n=O("Chunks needed: "),s=D("span"),a=O(l),i=T(),r=D("div"),c=O("Chunks received: "),o=D("span"),d=O(u)},m(t,l){N(t,e,l),A(e,n),A(e,s),A(s,a),N(t,i,l),N(t,r,l),A(r,c),A(r,o),A(o,d)},p(t,e){1&e&&l!==(l=(t[0]||"")+"")&&F(a,l),2&e&&u!==(u=(t[1]||"")+"")&&F(d,u)},d(t){t&&(q(e),q(i),q(r))}}}function kn(t){let e,n,s,a,i,r,c,o,d,l,u,f,p,m,h,b,y,v,g,k,$,_=t[0]&&gn(t)
return{c(){e=D("div"),n=D("div"),s=O("Update Stats\n    "),a=D("div"),i=O("[\n      "),r=D("div"),c=D("span"),o=O("?"),d=O("\n      ]"),l=T(),u=D("div"),f=D("button"),f.textContent="On page",p=T(),m=D("button"),m.textContent="All",h=T(),b=D("div"),y=D("button"),y.textContent="Clear cache",v=T(),g=D("div"),_&&_.c(),j(c,"class","tooltip-multiline"),j(c,"data-tooltip",t[5]),j(r,"class","tooltip svelte-15yybge"),j(a,"class","wrapper svelte-15yybge"),j(n,"class","head svelte-15yybge"),j(f,"class","custombutton svelte-15yybge"),j(f,"type","button"),j(m,"class","custombutton svelte-15yybge"),j(m,"type","button"),j(u,"class","btnbox svelte-15yybge"),j(y,"class","custombutton svelte-15yybge"),j(y,"type","button"),j(b,"class","btnbox svelte-15yybge"),j(g,"class","chunkbox svelte-15yybge"),j(e,"class","main svelte-15yybge")},m(x,I){N(x,e,I),A(e,n),A(n,s),A(n,a),A(a,i),A(a,r),A(r,c),A(c,o),A(a,d),A(e,l),A(e,u),A(u,f),A(u,p),A(u,m),A(e,h),A(e,b),A(b,y),A(e,v),A(e,g),_&&_.m(g,null),k||($=[C(f,"click",t[2]),C(m,"click",t[3]),C(y,"click",t[4])],k=!0)},p(t,[e]){t[0]?_?_.p(t,e):(_=gn(t),_.c(),_.m(g,null)):_&&(_.d(1),_=null)},i:G,o:G,d(t){t&&q(e),_&&_.d(),k=!1,U($)}}}function $n(t,e,n){let{fshInv:s=0}=e
const r=new DataTable(s)
let c=0,o=0
async function d([t,e,s]){const a=await J(t,e,s)
return n(1,o+=1),a}async function u(t){const e=r.rows(H,t),s=V(Q(e.data()))
n(0,c=s.length),n(1,o=0)
const a=await i(s.map(d))
e.every(Y(a.flatMap(X))),r.draw()}const f=t=>{l("Inventory","Update Stats",t)}
B(s)
return t.$$set=t=>{"fshInv"in t&&n(6,s=t.fshInv)},[c,o,async function(){f("On page"),u({page:"current"})},function(){f("All"),u()},async function(){f("Clear cache"),await k(`fsh_${a.subcmd}_cache`,[]),P(W("fshRefresh"))},"This allows you to update the stats of items. It is useful in cases where stats are missing or if you want accurate stats for forged items. It can be slow for large data sets. The results are cached and will be used automatically next time you visit this page. You will need to update again if these stats become stale. For example, if you forged or crafted an item, or if a guild store item has moved.",s]}class _n extends S{constructor(t){super(),M(this,t,$n,kn,E,{fshInv:6})}}function xn(t){let e
return{c(){e=D("div")},m(t,n){N(t,e,n)},p:G,i:G,o:G,d(t){t&&q(e)}}}function In(t){let e,n,s,a
e=new vn({})
return{c(){z(e.$$.fragment),n=T(),s=nt()},m(t,i){Z(e,t,i),N(t,n,i),N(t,s,i),a=!0},p(t,e){},i(t){a||(K(e.$$.fragment,t),K(false),a=!0)},o(t){tt(e.$$.fragment,t),tt(false),a=!1},d(t){t&&(q(n),q(s)),et(e,t)}}}function Rn(t){let e,n,s,i,r,c
const o=[In,xn],d=[]
return n="guildinvmgr"===a.subcmd?0:1,s=d[n]=o[n](t),r=new _n({props:{fshInv:t[0]}}),{c(){e=D("div"),s.c(),i=T(),z(r.$$.fragment),j(e,"class","container svelte-1tjz5ud")},m(t,s){N(t,e,s),d[n].m(e,null),A(e,i),Z(r,e,null),c=!0},p(t,[e]){s.p(t,e)
const n={}
1&e&&(n.fshInv=t[0]),r.$set(n)},i(t){c||(K(s),K(r.$$.fragment,t),c=!0)},o(t){tt(s),tt(r.$$.fragment,t),c=!1},d(t){t&&q(e),d[n].d(),et(r)}}}function wn(t,e,n){let{fshInv:s=0}=e
return t.$$set=t=>{"fshInv"in t&&n(0,s=t.fshInv)},[s]}class Ln extends S{constructor(t){super(),M(this,t,wn,Rn,E,{fshInv:0})}}function Sn(t){!function(t){new Ln({props:{fshInv:t},target:r()})}(t)}const Mn=()=>Ft().player_id?`<b>&nbsp;Inventory Manager</b> ${Ft().items.length} items (green = worn, blue = backpack)`:`<b>&nbsp;Guild Inventory Manager</b> ${Ft().items.length} items (maroon = in BP, blue=guild store)`
function En(){const t=Mn()
at("",r()),function(){if(!Pt())return
Ot(n(W("pF"),rt({style:{textAlign:"center"}})))}(),it(r(),ne.replace("@@reportTitle@@",t))}function Dn(){st(Ft().items)&&En()}function Tn(){$("#fshMinLvl").val(oe().fshMinLvl),$("#fshMaxLvl").val(oe().fshMaxLvl)}const jn=([,t])=>[t.id,t]
function Nn(t){ut([te,fn,pn,mn,hn,Dn,Se,Tn])
const e=we()
!function(t){$("#fshMinLvl, #fshMaxLvl").on("keyup",u(Te,t)),$(t).on("change","select.fshMoveItem",rn),dn(t),wt(t,on,Zt)}(e),$("#fshRefresh").on("click",t),function(t){const e=$(`#${t.id}_filter input`)
e.prop("type","text")
const n=$("<span>&times;</span>")
e.wrap($('<span class="text-input-wrapper"/>')),e.after(n),n.on("click",u(Kt,t,e))}(e),Sn(e)}function An(t){Nn(t)}const Cn=()=>Object.getOwnPropertyNames(Ft()).length
async function Gn(e){const n=[ft(),Jt()]
"guildinvmgr"===a.subcmd&&n.push(async function(){await t(!1),a.membrList&&(a.membrList=dt(v(a.membrList).filter(Gt).map(jn)))}()),n.push(async function(){const t=await f(`fsh_${a.subcmd}`)
ie={...mt(ee),...p(t,{})},re=m("showQuickDropLinks"),ce=m("showQuickSendLinks")}()),await i(n),Cn()&&function(t){lt(3,An,[t])}(e)}function qn(){!ct()&&r()&&("guildinvmgr"!==a.subcmd||o())&&(at(`<span id="fshInvMan"><img src = "${ot}">&nbsp;Getting inventory data...</span>`,r()),Gn(qn))}export{qn as default}
//# sourceMappingURL=inventory-D4PN5V2r.js.map
