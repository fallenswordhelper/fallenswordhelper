import{a as Et,b as vt}from"./chunk-6IZG4CYM.js";import{a as h}from"./chunk-EUPTAZ7I.js";import{a as ht}from"./chunk-ONYD7SQS.js";import{a as gt}from"./chunk-RW26XEO6.js";import{a as dt}from"./chunk-UGRGRLDG.js";import"./chunk-YHMEPQN6.js";import{a as I}from"./chunk-PZKX2LFQ.js";import{a as ut}from"./chunk-JQAELPMM.js";import{a as ft}from"./chunk-WGVGLZHS.js";import{a as pt}from"./chunk-ZZGX6XAG.js";import"./chunk-7C6CQ5I2.js";import{a as f}from"./chunk-RK5HVFU5.js";import"./chunk-YMX6UH45.js";import"./chunk-5U3MVXXA.js";import"./chunk-RAPV3KZQ.js";import{a as m}from"./chunk-DSQHKKZ4.js";import{a as at}from"./chunk-IETC7J5T.js";import"./chunk-ILRQGVNQ.js";import"./chunk-QCITHZZO.js";import"./chunk-4BKRRB5O.js";import{a as it}from"./chunk-NZDFBLRQ.js";import{a as M}from"./chunk-IH6ZKMJ6.js";import"./chunk-S4DLXHFF.js";import"./chunk-PR2EAHHE.js";import{b as ct}from"./chunk-DLFJWHV6.js";import{a as C}from"./chunk-MT75LODT.js";import"./chunk-6SYTCZ5G.js";import{a as lt}from"./chunk-ADLGCSQK.js";import"./chunk-4JYNGGXH.js";import"./chunk-SUBR6HFY.js";import{f as mt}from"./chunk-V56KALMS.js";import"./chunk-3XEIZZHC.js";import"./chunk-ZWSICCTU.js";import"./chunk-APLZF2FC.js";import"./chunk-NIE6URWE.js";import"./chunk-VDZHRZJL.js";import"./chunk-KU5JAIEB.js";import"./chunk-N7M4WPYO.js";import"./chunk-BGM7VCLD.js";import"./chunk-ZOICBMHG.js";import"./chunk-EL33JOKC.js";import"./chunk-EOP2LXLP.js";import"./chunk-PCHFEFT4.js";import{a as N}from"./chunk-ARPRWHND.js";import"./chunk-3E53RUR7.js";import{a as A}from"./chunk-TTNOFDP6.js";import"./chunk-B3TUML6P.js";import{a as st}from"./chunk-KXXSC5XL.js";import"./chunk-34VPQFZA.js";var yt=t=>(e,r)=>t(r,e),p=(t,...e)=>(...r)=>e.reduce((n,o)=>o(n),t(...r)),T=(t,e)=>{let r=e||t.length;return(...n)=>{let o=n.length||1;return r===o?t(...n):T((...i)=>t(...n,...i),r-n.length)}};var B=t=>e=>(t(e),e);var E=t=>{let e=t.split("."),r=(o={},s=[])=>{let i=s.shift(),c=o[i];return c==null||s.length===0?c:r(c,s)};return{get(o){return r(o,[...e])},set:(o,s)=>{let i=o,[c,...a]=e.reverse();for(let l of a.reverse())i[l]===void 0&&(i[l]={},i=i[l]);return i[c]=s,o}}};var Jt=(t,e)=>t===e?0:t===void 0?1:e===void 0||t<e?-1:1,F;(function(t){t.ASC="asc",t.DESC="desc",t.NONE="none"})(F||(F={}));var Vt=(t,e)=>{let r=E(t).get;return(n,o)=>e(r(n),r(o))},$=t=>{let{pointer:e,direction:r="asc",comparator:n=Jt}=t;if(!e||r==="none")return i=>[...i];let o=Vt(e,n),s=r==="desc"?yt(o):o;return i=>[...i].sort(s)};var _;(function(t){t.BOOLEAN="boolean",t.NUMBER="number",t.DATE="date",t.STRING="string"})(_||(_={}));var jt=t=>{switch(t){case _.BOOLEAN:return Boolean;case _.NUMBER:return Number;case _.DATE:return e=>new Date(e);case _.STRING:return p(String,e=>e.toLowerCase());default:return e=>e}},z;(function(t){t.INCLUDES="includes",t.IS="is",t.IS_NOT="isNot",t.LOWER_THAN="lt",t.GREATER_THAN="gt",t.GREATER_THAN_OR_EQUAL="gte",t.LOWER_THAN_OR_EQUAL="lte",t.EQUALS="equals",t.NOT_EQUALS="notEquals",t.ANY_OF="anyOf"})(z||(z={}));var G=t=>e=>!t(e),At=t=>e=>Object.is(t,e),Ct=t=>e=>e<t,xt=t=>e=>e>t,_t=t=>e=>t===e,Kt=t=>e=>e.includes(t),Zt=t=>e=>t.includes(e),te={includes:Kt,is:At,isNot:p(At,G),lt:Ct,gte:p(Ct,G),gt:xt,lte:p(xt,G),equals:_t,notEquals:p(_t,G),anyOf:Zt},St=t=>(...e)=>t.every(r=>r(...e)),ee=({value:t="",operator:e="includes",type:r})=>{let n=jt(r),s=p(n,te[e])(t);return p(n,s)},re=t=>{let e={};return Object.keys(t).filter(n=>Array.isArray(t[n])).forEach(n=>{let o=t[n].filter(s=>s.value!=="");o.length>0&&(e[n]=o)}),e},U=t=>{let e=re(t),r=Object.keys(e).map(o=>{let s=E(o).get,i=e[o].map(ee);return p(s,St(i))}),n=St(r);return o=>o.filter(n)};function ne(t,...e){let r=Dt(t.raw[0]);for(let[o,s]of e.entries()){if(s instanceof RegExp)r+=s.source;else if(typeof s=="string")r+=oe(s);else throw new Error("Illegal substitution: "+s);r+=Dt(t.raw[o+1])}let n="";if(r.startsWith("/")){let o=r.lastIndexOf("/");if(o===0)throw new Error("If the `re` string starts with a slash, it must end with a second slash and zero or more flags: "+r);n=r.slice(o+1),r=r.slice(1,o)}return new RegExp(r,n)}function Dt(t){return t.replace(/\\`/g,"`")}function oe(t){return t.replace(/[\\^$.*+?()[\]{}|=!<>:-]/g,"\\$&")}var Y=t=>{let{value:e,scope:r=[],escape:n=!1,flags:o=""}=t,s=r.map(c=>E(c).get);if(r.length===0||!e)return c=>c;let i=n===!0?ne`/${e}/${o}`:new RegExp(e,o);return c=>c.filter(a=>s.some(l=>i.test(String(l(a)))))};var Lt=()=>{let t={},e={on(r,...n){return t[r]=(t[r]||[]).concat(n),e},dispatch(r,...n){let o=t[r]||[];for(let s of o)s(...n);return e},off(r,...n){if(r===void 0)Object.keys(t).forEach(o=>e.off(o));else{let o=t[r]||[];t[r]=n.length?o.filter(s=>!n.includes(s)):[]}return e}};return e},x=t=>({emitter:e})=>{let r={},n={off(o){return o||Object.keys(r).forEach(s=>n.off(s)),r[o]&&e.off(o,...r[o]),n}};for(let o of Object.keys(t)){let s=t[o];r[o]=[],n[s]=function(...i){return r[o]=r[o].concat(i),e.on(o,...i),n}}return n};var Nt=({page:t=1,size:e}={page:1})=>(r=[])=>{let n=e||r.length,o=(t-1)*n;return r.slice(o,o+n)},Tt;(function(t){t.TOGGLE_SORT="TOGGLE_SORT",t.DISPLAY_CHANGED="DISPLAY_CHANGED",t.PAGE_CHANGED="CHANGE_PAGE",t.EXEC_CHANGED="EXEC_CHANGED",t.FILTER_CHANGED="FILTER_CHANGED",t.SUMMARY_CHANGED="SUMMARY_CHANGED",t.SEARCH_CHANGED="SEARCH_CHANGED",t.EXEC_ERROR="EXEC_ERROR"})(Tt||(Tt={}));var H=t=>{let{get:e,set:r}=E(t);return{get:e,set:T(r)}},se=({sortFactory:t,tableState:e,data:r,filterFactory:n,searchFactory:o})=>{let s=r.length,i=r,c=Lt(),a=H("sort"),l=H("slice"),g=H("filter"),v=H("search");c.on("SUMMARY_CHANGED",({filteredCount:u})=>{s=u});let Ut=u=>Object.assign({},u),rt=T(c.dispatch,2),Yt=u=>(i=u,rt("SUMMARY_CHANGED",{page:e.slice.page,size:e.slice.size,filteredCount:u.length})),qt=({processingDelay:u=20}={processingDelay:20})=>{c.dispatch("EXEC_CHANGED",{working:!0}),setTimeout(()=>{try{let d=n(g.get(e)),y=o(v.get(e)),L=t(a.get(e)),w=Nt(l.get(e)),P=p(d,y,B(Yt),L,w)(r);c.dispatch("DISPLAY_CHANGED",P.map(ot=>({index:r.indexOf(ot),value:ot})))}catch(d){c.dispatch("EXEC_ERROR",d)}finally{c.dispatch("EXEC_CHANGED",{working:!1})}},u)},R=T((u,d,y)=>p(Ut,B(rt(d)),u.set(e))(y)),Xt=()=>R(l,"CHANGE_PAGE",Object.assign({},l.get(e),{page:1})),k=(u,d)=>{let y=p(R(u,d),Xt,()=>c.exec());return(L={})=>y(L)},Wt={sort:k(a,"TOGGLE_SORT"),filter:k(g,"FILTER_CHANGED"),search:k(v,"SEARCH_CHANGED"),slice:p(R(l,"CHANGE_PAGE"),()=>c.exec()),exec:qt,async eval(u=e){let d=t(a.get(u)),y=o(v.get(u)),L=n(g.get(u)),w=Nt(l.get(u));return p(L,y,d,w)(r).map(P=>({index:r.indexOf(P),value:P}))},onDisplayChange(u){c.on("DISPLAY_CHANGED",u)},getTableState(){return JSON.parse(JSON.stringify(e))},getMatchingItems(){return[...i]}},nt=Object.assign(c,Wt);return Object.defineProperties(nt,{filteredCount:{get(){return s}},length:{get(){return r.length}}}),nt},ie=x({FILTER_CHANGED:"onFilterChange"}),Pt;(function(t){t.BOOLEAN="boolean",t.NUMBER="number",t.DATE="date",t.STRING="string"})(Pt||(Pt={}));var Ot=({table:t,pointer:e,operator:r="includes",type:n="string"})=>{let o=ie({emitter:t});return Object.assign({filter(s){let i=this.state();return s===void 0?delete i[e]:Object.assign(i,{[e]:[{value:s,operator:r,type:n}]}),t.filter(i)},state(){return t.getTableState().filter||{}}},o)},ce=x({SEARCH_CHANGED:"onSearchChange"}),O=({table:t,scope:e=[]})=>{let r=ce({emitter:t});return Object.assign(r,{search(n,o={}){return t.search(Object.assign({},{value:n,scope:e},o))},state(){return t.getTableState().search}},r)},ae=x({CHANGE_PAGE:"onPageChange",SUMMARY_CHANGED:"onSummaryChange"}),S=({table:t})=>{let{slice:{page:e,size:r}}=t.getTableState(),n=t.filteredCount,o=r?Math.ceil(n/r):1,s=ae({emitter:t}),i={selectPage(a){return t.slice({page:a,size:r})},selectNextPage(){return i.selectPage(e+1)},selectPreviousPage(){return i.selectPage(e-1)},changePageSize(a){return t.slice({page:1,size:a})},isPreviousPageEnabled(){return e>1},isNextPageEnabled(){return o>e},state(){return Object.assign(t.getTableState().slice,{filteredCount:n,pageCount:o})}},c=Object.assign(i,s);return c.onSummaryChange(({page:a,size:l,filteredCount:g})=>{e=a,r=l,n=g,o=r?Math.ceil(n/r):1}),c},me=(t,e)=>{let r=null;return(...n)=>{r!==null&&clearTimeout(r),r=setTimeout(()=>t(...n),e)}},le=x({TOGGLE_SORT:"onSortToggle"}),Gt=["asc","desc"],bt=({pointer:t,table:e,cycle:r=!1,debounceTime:n=0})=>{let o=r===!0?["none"].concat(Gt):[...Gt].reverse(),s=me(e.sort,n),i=0,c=le({emitter:e}),a=Object.assign({toggle(){i++;let v=o[i%o.length];return s({pointer:t,direction:v})},state(){return e.getTableState().sort}},c);a.onSortToggle(({pointer:v})=>{i=t!==v?0:i});let{pointer:l,direction:g="asc"}=a.state();return i=l===t?g==="asc"?1:2:0,a},Ve=x({SUMMARY_CHANGED:"onSummaryChange"});var ue=x({EXEC_CHANGED:"onExecutionChange"}),Rt=({table:t})=>ue({emitter:t}),Ht=()=>({sort:{},slice:{page:1},filter:{},search:{}}),kt=({sortFactory:t=$,filterFactory:e=U,searchFactory:r=Y,tableState:n=Ht(),data:o=[]}={sortFactory:$,filterFactory:U,searchFactory:Y,tableState:Ht(),data:[]},...s)=>{let i=se({sortFactory:t,filterFactory:e,tableState:n,data:o,searchFactory:r});return s.reduce((c,a)=>Object.assign(c,a({sortFactory:t,filterFactory:e,searchFactory:r,tableState:n,data:o,table:i})),i)};var wt=({table:t,el:e})=>{let r=Rt({table:t});return r.onExecutionChange(function({working:n}){e.classList.remove("st-working"),n===!0&&e.classList.add("st-working")}),r};var Mt=({el:t,table:e,conf:r={}})=>{let n=r.pointer||t.getAttribute("data-st-sort"),o=r.cycle||t.hasAttribute("data-st-sort-cycle"),s=bt({pointer:n,table:e,cycle:o});s.onSortToggle(({pointer:c,direction:a})=>{if(t.classList.remove("st-sort-asc","st-sort-desc"),n===c&&a!=="none"){let l=a==="asc"?"st-sort-asc":"st-sort-desc";t.classList.add(l)}});let i=()=>s.toggle();return t.addEventListener("click",i),s};function b(t,e){let r;return n=>{r&&clearTimeout(r),r=setTimeout(function(){t(n)},e)}}var It=({table:t,el:e,delay:r=400,conf:n={}})=>{let o=n.pointer||e.getAttribute("data-st-filter"),s=n.operator||e.getAttribute("data-st-filter-operator")||"includes",i=e.hasAttribute("type")?e.getAttribute("type"):"string",c=n.type||e.getAttribute("data-st-filter-type");c||(c=["date","number"].includes(i)?i:"string");let a=Ot({table:t,pointer:o,type:c,operator:s}),l=b(g=>a.filter(e.value),r);return e.addEventListener("input",l),e.tagName==="SELECT"&&e.addEventListener("change",l),a};var Bt=({el:t,table:e,delay:r=400,conf:n={}})=>{let o=n.scope||(t.getAttribute("data-st-search")||"").split(",").map(a=>a.trim()),s=n.flags||t.getAttribute("data-st-search-flags")||"",i=O({table:e,scope:o}),c=b(()=>{i.search(t.value,{flags:s})},r);t.addEventListener("input",c)};var Ft=({el:t,table:e})=>{let r=(n,o)=>Array.from(t.querySelectorAll(o)).forEach(s=>n({el:s,table:e}));return r(Mt,"[data-st-sort]"),r(wt,"[data-st-loading-indicator]"),r(Bt,"[data-st-search]"),r(It,"[data-st-filter]"),e};function q(t){return at("tbody",t)}function pe(t){return`<td>${t.slot}</td><td>${ft(t.id,t.name)}</td><td>${t.level}</td><td>${t.rank_name}</td><td>${t.gxp}</td><td>${t.activity}</td><td>${t.pack}</td><td>${t.stam}</td>`}function fe(t){return t.dom||(t.dom=vt({innerHTML:pe(t)})),t.dom}function X(t,e,r){let n=t.tBodies[0],o=q();for(let s of r)o.appendChild(fe(s.value));t.replaceChild(o,n)}var D=f(),Q=h({innerHTML:"\xAB"}),J=h({innerHTML:"\u2039"}),$t=h({disabled:!0,innerHTML:"1"}),V=h({innerHTML:"\u203A"}),W=h({innerHTML:"\xBB"});function de(t){let e=1,r=S({table:t});return r.onSummaryChange(({page:n,size:o,filteredCount:s})=>{Q.disabled=!r.isPreviousPageEnabled(),J.disabled=!r.isPreviousPageEnabled(),V.disabled=!r.isNextPageEnabled(),W.disabled=!r.isNextPageEnabled(),C(n,$t),e=Math.ceil(s/o)}),A(W,()=>r.selectPage(e)),r}function ge(){m(D,Q),m(D,J),m(D,$t),m(D,V),m(D,W)}function j(t,e){let r=de(e);A(Q,()=>r.selectPage(1)),A(J,()=>r.selectPreviousPage()),A(V,()=>r.selectNextPage()),ge(),m(t,D)}var he=()=>ut({dataset:{stSearch:"name, rank_name",stSearchFlags:"i"},placeholder:"Enter search term",required:!0,type:"text"});function K(t,e){let r=f({className:"fsh-search-wrapper"}),n=he(),o=h({innerHTML:"&times;",type:"button"}),s=O({table:e});A(o,()=>{n.value="",n.focus(),s.search("")}),m(r,n),m(r,o),m(t,r)}function Z(t,e){let r=Et({innerHTML:'<option value="25">25</option><option value="50">50</option><option value="0" selected>All</option>'}),n=f();m(n,r),m(t,n);let o=S({table:e});st(r,"change",s=>{o.changePageSize(Number(s.target.value))})}function tt(t,e,r){let n=f();m(t,n),S({table:e}).onSummaryChange(({page:s,size:i,filteredCount:c})=>{let a=0;c&&(a=1),C(`showing ${(s-1)*i+a} - ${Math.min(c,s*i)} of ${c} (${r.length} total)`,n)})}function Ee(t,e){return e.equipped||(t[e.player_id]=t[e.player_id]||[],t[e.player_id].push(e)),t}var ve=(t,e)=>({...e,rank_name:t}),ye=t=>t.members.map(N(ve,t.name)),Ae=t=>t.r.flatMap(ye);function Ce(t,e,r){return{...e,slot:r+1,name_lower:M(e.name),lvl_reverse:0-e.level,rank_lower:M(it(e.rank_name)),gxp:I(e.guild_xp),gxp_reverse:0-e.guild_xp,activity:gt(e.last_activity),act:e.last_activity-mt(),pack:(t[e.id]||[]).length,pack_reverse:0-(t[e.id]||[]).length,stam:I(e.max_stamina),stam_reverse:0-e.max_stamina}}function et([t,e]){let r=t.items.reduce(Ee,{});return Ae(e).map(N(Ce,r))}var xe='<thead><tr><th data-st-sort="slot" class="st-sort-asc">Slot</th><th data-st-sort="name_lower">Name</th><th class="st-sort-reverse" data-st-sort="lvl_reverse">Level</th><th data-st-sort="rank_lower">Rank</th><th class="st-sort-reverse" data-st-sort="gxp_reverse">GXP</th><th class="st-sort-reverse" data-st-sort="act">Activity</th><th class="st-sort-reverse" data-st-sort="pack_reverse">Pack</th><th class="st-sort-reverse" data-st-sort="stam_reverse">Stam</th></tr></thead><tbody></tbody>',zt=xe;function _e(t){return m(t,ht({className:"whosGotWhat",innerHTML:zt}))}function Se(t){let e=m(t,f({className:"st-top-container"})),r=m(t,f()),n=_e(r),o=m(t,f({className:"st-bottom-container"}));return{top:e,domTable:n,bottom:o}}function De(t){return kt({data:t,tableState:{sort:{pointer:"slot",direction:"asc"},slice:{page:1,size:0},filter:{},search:{}}})}function Le(t,e,r,n){Z(e,n),K(e,n),tt(r,n,t),j(r,n)}function Ne(t,e,r){let n=Ft({el:t,table:e});n.onDisplayChange(N(X,r,e)),n.exec()}function Te(t,e){let r=et(e);C("",t);let n=m(t,f()),{top:o,domTable:s,bottom:i}=Se(n),c=De(r);Le(r,o,i,c),Ne(n,c,s)}var Pe=([t,e])=>t?.guild_id&&e?.s;async function Ge(){let t=ct();C("Loading...",t);let e=await lt([pt(),dt()]);Pe(e)&&Te(t,e)}export{Ge as default};
//# sourceMappingURL=whosGotWhat-MHYHKBPF.js.map
