import{a as K}from"./chunk-36UTPPWO.js";import{a as Q}from"./chunk-RT7VPC7K.js";import{a as z}from"./chunk-AF56K7S6.js";import{a as V,b as G,c as u,d as J}from"./chunk-LTR542NS.js";import{a as P}from"./chunk-RIVS3SLC.js";import{b as _,c as F}from"./chunk-C3ZUQKIG.js";import{a as D}from"./chunk-ZQDMEVYG.js";import{a as A,b as N}from"./chunk-2WMAFW7I.js";import{a as S}from"./chunk-TBNYDH33.js";import{a as H}from"./chunk-BQQ5Z2PH.js";import{a as q}from"./chunk-QVZVZ2TH.js";import{a as E}from"./chunk-OLL3OEZ7.js";import{a as s}from"./chunk-IGPEYEWI.js";import{a as C}from"./chunk-VNYEAL6H.js";import{a as g,b as p}from"./chunk-RIFWXPPJ.js";import{a as I}from"./chunk-5H2KFPOD.js";import{a as d,b as k}from"./chunk-IE7HJE6I.js";import{wa as m}from"./chunk-P5UJIVHH.js";import{a as B}from"./chunk-PNTQJ5ZY.js";import{a as R}from"./chunk-U7JQSSPD.js";import{a as l}from"./chunk-VV2IBFUQ.js";import{a as c}from"./chunk-Y7Z3DYSJ.js";import{a as f}from"./chunk-GOZAE5SK.js";function x(t){return B({cmd:"arena",...t})}function b(){return x({subcmd:"view"})}function at(t,e,[r,o]){let i=t.find(([,v])=>v===r);return i&&(P(i[0]).style.backgroundColor="#ff0000",e[r]=o),e}function y(t){if(!s(t))return;let r=l('#arenaTypeTabs tr:not([style="display: none;"]) input[type="submit"]').map(i=>[i,i.previousElementSibling.value]),o=C(t).reduce(c(at,r),{});p("fsh_arenaFull",o)}var n=0,U=0,a=()=>n,j=()=>U;function h(){p(u,n)}function W(t,e){n=n||{},n.minLvl=t,n.maxLvl=e,h()}function X(){$('#arenaTypeTabs table[width="635"]').DataTable().draw()}function Y(){K(W,X)}function Z(){W(d.arenaMinLvl,d.arenaMaxLvl),$("#fshMinLvl").val(n.minLvl),$("#fshMaxLvl").val(n.maxLvl),X()}function tt(t){n=n||{},n.hideMoves=t.target.checked,h(),$(".moveMax").toggle(!t.target.checked)}function et(t){n=t||{},U=n.id||{},n.id={}}function it(t){let e=a().minLvl,r=a().maxLvl,o=E(t[7]);return N(A,o,e,r)}function st(t,e){return a()?it(e):!0}function ct(t,e,r,o){return!0}function M(){$.fn.dataTable.ext.search.push(st),$.fn.dataTable.ext.search.push(ct)}function ft(){let t=$("#pCC > table > tbody > tr:nth-child(4)");return t.clone().insertBefore(t).find("td").attr("height","2"),t.clone().insertAfter(t).find("td").attr("height","1"),t}function lt(t){let e=$("#fshHideMoves",t);a()?.hideMoves!=null&&(e.prop("checked",a().hideMoves),$(".moveMax").toggle(!a().hideMoves)),e.on("click",tt)}function rt(t,e,r,o){$(`#${t}`,e).val(a()?.[r]??d[o])}function dt(t){rt("fshMinLvl",t,"minLvl","arenaMinLvl")}function mt(t){rt("fshMaxLvl",t,"maxLvl","arenaMaxLvl")}function pt(t){$("#fshMinLvl, #fshMaxLvl",t).on("keyup",Y),$("#fshReset",t).on("click",Z)}function w(){let t=ft(),e=$(G);lt(e),dt(e),mt(e),pt(e),$("td",t).append(e)}function ut(t,e){j()?.[e]||(t.css("background-color","#F5F298"),t.find("tr").css("background-color","#F5F298"))}function ht(t,e){let r=f(/#\s(?<id>\d+)/,e.eq(0).text());r&&s(a()?.id)&&(a().id[r]=r,ut(t,r))}function vt(t){let e=t.eq(1),r=e.text().split(/\s\/\s/);r&&e.attr("data-order",(Number(r[0])-Number(r[1]))*100+Number(r[1]))}function gt(t){let e=t.eq(2);e.attr("data-order",$("td",e).first().text().replace(/[,\s]/g,""))}function xt(t,e){let r=f(/(?<move>\d)\.png/,$("img",e).attr("src"));r&&$(e).attr("data-order",r)}function bt(t){t.slice(4,7).each(xt)}function yt(t,e){a()?.moves?.[t]===3&&e.addClass("moveMax")}function Mt(t,e){let r=f(J,$("img",t).attr("src"));r&&(yt(r,e),t.attr("data-order",r))}function wt(t,e){let r=t.eq(8);a()?.moves&&Mt(r,e)}function Lt(t){let e=t.eq(8);e.children(m).length===1&&e.attr("data-order",e.find("td").first().text().replace(/[,\s]/g,""))}function $t(t,e){let r=$(e),o=r.children();ht(r,o),vt(o),gt(o),bt(o),wt(o,r),Lt(o)}function L(t){t.children("tbody").children("tr").each($t)}var Tt=t=>[t,Number(t.previousElementSibling.value)];function Ot(t,e){return t.r.arenas?e.concat(t.r.arenas.find(r=>r.id===e[1])):e}function _t(t,e){return e.guild_id===t?`<span class="fshRed">${e.name}</span>`:e.name}function ot(t){t&&t.classList&&t.classList.add("fshGray")}var Ft=(t,e)=>e.reward_type===1&&t.r.moves,kt=(t,e)=>t.r.moves.find(r=>r.id===e.reward),Dt=t=>t&&t.max===3,Rt=(t,e)=>Ft(t,e)&&Dt(kt(t,e));function Ct(t,[e,,r]){r&&Rt(t,r)&&ot(e)}function It(t,e,r){let o=r.players.filter(v=>v.guild_id===t).length,i=r.max_players/4;o===i&&ot(e)}function Et(t,e,r){Q(r.players.map(c(_t,t)).join("<br>"),e),e.classList.add("tip-static"),t&&e.value==="Join"&&It(t,e,r)}var Ht=[s,t=>D(t.players),t=>t.players.length>0];function St(t,[e,,r]){Ht.every(o=>o(r))&&Et(t,e,r)}function qt(t){return l('#arenaTypeTabs tr:not([style="display: none;"]) input[type="submit"]').map(Tt).map(c(Ot,t))}function T(t){if(!t||!t.s||!s(t.r))return;let e=qt(t);e.forEach(c(St,q())),e.forEach(c(Ct,t))}var nt="td.sorting, td.sorting_asc, td.sorting_desc";function At(t){let e=t.attr("class");return f(/sorting(?<dir>[^\s]+)/,e)==="_desc"?"asc":"desc"}function Nt(t,e,r){let o=t.closest(m).DataTable();e!==3?o.order([3,"asc"],[e,r]).draw():o.order([3,r]).draw()}function Bt(t){let e=$(t.target).closest("td"),r=At(e);Nt(e,e.index(),r)}function O(t){$(nt,t).off("click"),t.on("click",nt,Bt)}function Pt(){l('#arenaTypeTabs tr[style="display: none;"]').forEach(e=>e.remove())}function zt(t,e){let r=$("tr",e).first();$("a",r).contents().unwrap(),$(e).prepend($("<thead/>").append(r))}function Vt(){w(),h(),M()}function Gt(t,[e,r,o]){let i=$('table[width="635"]',t);i.each(zt),et(e),L(i),y(r),T(o),Vt(),i.DataTable(V),O(t)}function Jt(t,e){let r=k("betaOptIn");r&&_("arena.process"),Pt(),Gt(t,e),z(),r&&F("arena.process")}async function Kt(t){let e=await H([g(u),g("fsh_arenaFull"),b().catch(()=>({})),S()]);Jt(t,e)}function Qt(){if(I())return;let t=$("#arenaTypeTabs");t.length===1?Kt(t):R("arena","Join error screen ?")}export{x as a,b,Qt as c};
//# sourceMappingURL=chunk-ANYIRSW2.js.map
