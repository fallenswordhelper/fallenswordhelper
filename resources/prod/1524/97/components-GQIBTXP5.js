import{a as ze}from"./chunk-6IHPDAUP.js";import{a as Fe}from"./chunk-BC5XVBXP.js";import"./chunk-T7KQVB5P.js";import{a as J}from"./chunk-EPIEAPGC.js";import{a as Ue,b as We}from"./chunk-LDENCUOF.js";import{a as Ge}from"./chunk-HA4SUDB3.js";import{a as H}from"./chunk-ODSCVYWU.js";import"./chunk-DQW5ASJU.js";import{a as se}from"./chunk-B5BLM7DB.js";import{a as He}from"./chunk-FTC5CJPF.js";import"./chunk-WR7PDPL3.js";import{a as Re}from"./chunk-KRLUSBSB.js";import"./chunk-UPZ3AKMZ.js";import{a as ie}from"./chunk-AT7LKIFM.js";import{a as Ve}from"./chunk-LNCEPZRN.js";import"./chunk-N6PH3IF5.js";import{a as ce}from"./chunk-KMMYFSVA.js";import{a as Te}from"./chunk-4AJW7EEA.js";import{a as qe}from"./chunk-7WFBZC7L.js";import"./chunk-ORHGY3QB.js";import{a as De}from"./chunk-IWEQS4A6.js";import{a as G}from"./chunk-BQQ5Z2PH.js";import{a as Be}from"./chunk-W3672ANI.js";import{a as ee}from"./chunk-Q2AMJ3AN.js";import{a as Ie}from"./chunk-AJAH6JFS.js";import{a as ae}from"./chunk-PHWG56X4.js";import{a as Z}from"./chunk-XVF2CJMZ.js";import"./chunk-KRBDNKGY.js";import"./chunk-OA25OZFH.js";import"./chunk-42DDVEBL.js";import"./chunk-IGPEYEWI.js";import{a as Ae}from"./chunk-VNYEAL6H.js";import{a as xe}from"./chunk-OCKAGFKQ.js";import{b as Ee,g as Y}from"./chunk-P5UJIVHH.js";import"./chunk-B4LNDEN5.js";import{$ as P,A as x,B as oe,F as E,I as ne,K as O,U as re,V as le,_ as L,a as D,aa as k,ba as v,da as Le,e as U,ea as Pe,f as pe,h as Ne,i as te,ka as B,la as M,ma as Q,na as F,oa as z,q as W,u,v as y,w as C,x as je,y as g,z as A}from"./chunk-BTRPULWW.js";import"./chunk-PNTQJ5ZY.js";import"./chunk-P45OKA3D.js";import{a as j}from"./chunk-U7JQSSPD.js";import{a as K}from"./chunk-VV2IBFUQ.js";import{a as Qe}from"./chunk-6AYZ2ZVW.js";import"./chunk-2TPDHRRV.js";import{b as Me}from"./chunk-KQN5ZURG.js";import{a as V}from"./chunk-Y7Z3DYSJ.js";import"./chunk-XS7UUVPQ.js";import"./chunk-GOZAE5SK.js";import"./chunk-GVTLUYA2.js";import"./chunk-BHGUITJJ.js";import"./chunk-VZNGURHD.js";import"./chunk-LGFZXCM7.js";function fe(){return ie({subcmd:"loadcomponents"})}function it(t){let{itemId:e,invId:o,vcode:n}=ee(Y,t.children[0].dataset.tipped);return{a:Number(o),b:Number(e),v:n}}var ct=t=>Me(t.href),st=t=>K('a[href*="=destroycomponent&"]',t).map(it),at=t=>Qe('td[background*="/1x1mini."]',t).length;function pt(t){let e=ae(t);return K('a[href*="profile&component_page="]',e).slice(1).map(ct)}function ft(t){let e=Array(57);return e[56]={k:56,v:t.map(at).reduce(ze,0)},{p:e}}var mt=t=>({h:ft(t),r:t.flatMap(st),s:!0});async function me(){let t=await Z({cmd:"profile"}),e=await G([t,...pt(t)]);return mt(e.map(ae))}function ue(){return ce(fe,me)}function de(t){return new Map(Ae(t))}var N=Ue(new Map),Je=We(N,t=>[...t].reduce((e,[,o])=>e+(o.get("del")?.length??0),0));function ut(t){let e;return{c(){e=g("tr"),e.innerHTML='<td class="compDel svelte-1qoer4b" colspan="3">Deleted</td>'},m(o,n){y(o,e,n)},p:D,i:D,o:D,d(o){o&&C(e)}}}function dt(t){let e,o,n,r,l,s,i,$=t[0].get("del").length+"",p,a,f,h,w,m,d=[bt,_t],_=[];function T(c,q){return q&1&&(f=null),f==null&&(f=!!c[0].get("delPending")),f?0:1}return h=T(t,-1),w=_[h]=d[h](t),{c(){e=g("tr"),o=g("td"),n=g("img"),s=x(),i=g("td"),p=A($),a=x(),w.c(),pe(n.src,r=t[1](t[0]))||E(n,"src",r),E(n,"class","tip-dynamic"),E(n,"data-tipped",l=t[2](t[0])),E(n,"alt","component")},m(c,q){y(c,e,q),u(e,o),u(o,n),u(e,s),u(e,i),u(i,p),u(e,a),_[h].m(e,null),m=!0},p(c,q){(!m||q&1&&!pe(n.src,r=c[1](c[0])))&&E(n,"src",r),(!m||q&1&&l!==(l=c[2](c[0])))&&E(n,"data-tipped",l),(!m||q&1)&&$!==($=c[0].get("del").length+"")&&ne(p,$);let b=h;h=T(c,q),h===b?_[h].p(c,q):(L(),v(_[b],1,1,()=>{_[b]=null}),P(),w=_[h],w?w.p(c,q):(w=_[h]=d[h](c),w.c()),k(w,1),w.m(e,null))},i(c){m||(k(w),m=!0)},o(c){v(w),m=!1},d(c){c&&C(e),_[h].d()}}}function _t(t){let e,o,n;return o=new H({props:{$$slots:{default:[gt]},$$scope:{ctx:t}}}),o.$on("click",W(t[3])),{c(){e=g("td"),B(o.$$.fragment)},m(r,l){y(r,e,l),M(o,e,null),n=!0},p(r,l){let s={};l&256&&(s.$$scope={dirty:l,ctx:r}),o.$set(s)},i(r){n||(k(o.$$.fragment,r),n=!0)},o(r){v(o.$$.fragment,r),n=!1},d(r){r&&C(e),Q(o)}}}function bt(t){let e;return{c(){e=g("td"),e.innerHTML='<span class="fshSpinner fshSpinner12"></span>',E(e,"class","compSumSpin")},m(o,n){y(o,e,n)},p:D,i:D,o:D,d(o){o&&C(e)}}}function gt(t){let e;return{c(){e=A("Del")},m(o,n){y(o,e,n)},d(o){o&&C(e)}}}function kt(t){let e,o,n,r,l,s=[dt,ut],i=[];function $(p,a){return a&1&&(e=null),e==null&&(e=!!p[0].get("del").length),e?0:1}return o=$(t,-1),n=i[o]=s[o](t),{c(){n.c(),r=oe()},m(p,a){i[o].m(p,a),y(p,r,a),l=!0},p(p,[a]){let f=o;o=$(p,a),o===f?i[o].p(p,a):(L(),v(i[f],1,1,()=>{i[f]=null}),P(),n=i[o],n?n.p(p,a):(n=i[o]=s[o](p),n.c()),k(n,1),n.m(r.parentNode,r))},i(p){l||(k(n),l=!0)},o(p){v(n),l=!1},d(p){i[o].d(p),p&&C(r)}}}function ht(t,e,o){let n;te(t,N,f=>o(5,n=f));let{itemId:r}=e,l=re(),s=Te(),i=f=>`${Ee}items/${f.get("b")}.gif`,$=f=>`fetchitem.php?item_id=${f.get("b")}&inv_id=${f.get("a")}&t=2&p=${s}&vcode=${f.get("v")}`,p;function a(){j("components","delType"),l("delType",r)}return t.$$set=f=>{"itemId"in f&&o(4,r=f.itemId)},t.$$.update=()=>{if(t.$$.dirty&48)e:o(0,p=n.get(r))},[p,i,$,a,r,n]}var _e=class extends z{constructor(e){super(),F(this,e,ht,kt,U,{itemId:4})}},Ke=_e;async function be(t){let e=await t();if(!e?.s)throw new Error(e?.e?.message??"Unknown Error");return e}function Oe(t){t[4]=t[6].rollup,t[5]=t[6].maxComp}function Xe(t,e,o){let n=t.slice();return n[7]=e[o],n}function $t(t){let e,o=t[10].message+"",n;return{c(){e=g("p"),n=A(o),O(e,"color","red")},m(r,l){y(r,e,l),u(e,n)},p:D,i:D,o:D,d(r){r&&C(e)}}}function vt(t){Oe(t);let e,o,n,r,l,s,i,$,p,a,f,h,w,m=t[5]+"",d,_,T=t[4],c=[];for(let b=0;b<T.length;b+=1)c[b]=Ye(Xe(t,T,b));let q=b=>v(c[b],1,1,()=>{c[b]=null});return{c(){e=g("div"),o=g("table"),n=g("thead"),n.innerHTML='<tr><th colspan="3">Component Summary</th></tr>',r=x(),l=g("tbody");for(let b=0;b<c.length;b+=1)c[b].c();s=x(),i=g("tfoot"),$=g("tr"),p=g("td"),p.textContent="Total:",a=x(),f=g("td"),h=A(t[0]),w=A(" / "),d=A(m),E(f,"colspan","2"),E(o,"class","fshTblCenter")},m(b,I){y(b,e,I),u(e,o),u(o,n),u(o,r),u(o,l);for(let S=0;S<c.length;S+=1)c[S].m(l,null);u(o,s),u(o,i),u(i,$),u($,p),u($,a),u($,f),u(f,h),u(f,w),u(f,d),_=!0},p(b,I){if(Oe(b),I&2){T=b[4];let S;for(S=0;S<T.length;S+=1){let we=Xe(b,T,S);c[S]?(c[S].p(we,I),k(c[S],1)):(c[S]=Ye(we),c[S].c(),k(c[S],1),c[S].m(l,null))}for(L(),S=T.length;S<c.length;S+=1)q(S);P()}(!_||I&1)&&ne(h,b[0])},i(b){if(!_){for(let I=0;I<T.length;I+=1)k(c[I]);_=!0}},o(b){c=c.filter(Boolean);for(let I=0;I<c.length;I+=1)v(c[I]);_=!1},d(b){b&&C(e),je(c,b)}}}function Ye(t){let e,o;return e=new Ke({props:{itemId:t[7]}}),e.$on("delType",t[2]),{c(){B(e.$$.fragment)},m(n,r){M(e,n,r),o=!0},p:D,i(n){o||(k(e.$$.fragment,n),o=!0)},o(n){v(e.$$.fragment,n),o=!1},d(n){Q(e,n)}}}function yt(t){let e;return{c(){e=g("div"),e.innerHTML='<span class="fshSpinner fshSpinner12"></span>',E(e,"class","compSumSpin")},m(o,n){y(o,e,n)},p:D,i:D,o:D,d(o){o&&C(e)}}}function Ct(t){let e,o,n,r={ctx:t,current:null,token:null,hasCatch:!0,pending:yt,then:vt,catch:$t,value:6,error:10,blocks:[,,,]};return Le(o=t[1](),r),{c(){e=oe(),r.block.c()},m(l,s){y(l,e,s),r.block.m(l,r.anchor=s),r.mount=()=>e.parentNode,r.anchor=e,n=!0},p(l,[s]){t=l,Pe(r,t,s)},i(l){n||(k(r.block),n=!0)},o(l){for(let s=0;s<3;s+=1){let i=r.blocks[s];v(i)}n=!1},d(l){l&&C(e),r.block.d(l),r.token=null,r=null}}}function St(t,e,o){let n;te(t,Je,i=>o(0,n=i));function r(i){let $=new Map(se(i,"b").map(p=>[p.b,de({...p,del:i.filter(({b:a})=>a===p.b).map(({a})=>a),delPending:!1})]));return N.set($),[...$.keys()]}async function l(){let i=await be(ue);return{rollup:r(i.r),maxComp:i.h?.p[56]?.v}}function s(i){le.call(this,t,i)}return[n,l,s]}var ge=class extends z{constructor(e){super(),F(this,e,St,Ct,U,{})}},Ze=ge;function et(t){let e,o,n;return o=new H({props:{$$slots:{default:[wt]},$$scope:{ctx:t}}}),o.$on("click",W(t[2])),{c(){e=g("div"),B(o.$$.fragment)},m(r,l){y(r,e,l),M(o,e,null),n=!0},p(r,l){let s={};l&256&&(s.$$scope={dirty:l,ctx:r}),o.$set(s)},i(r){n||(k(o.$$.fragment,r),n=!0)},o(r){v(o.$$.fragment,r),n=!1},d(r){r&&C(e),Q(o)}}}function wt(t){let e;return{c(){e=A("Enable Quick Del")},m(o,n){y(o,e,n)},d(o){o&&C(e)}}}function Dt(t){let e,o;return e=new Ze({}),e.$on("delType",t[6]),{c(){B(e.$$.fragment)},m(n,r){M(e,n,r),o=!0},p:D,i(n){o||(k(e.$$.fragment,n),o=!0)},o(n){v(e.$$.fragment,n),o=!1},d(n){Q(e,n)}}}function Tt(t){let e,o,n;return o=new H({props:{$$slots:{default:[Et]},$$scope:{ctx:t}}}),o.$on("click",W(t[3])),{c(){e=g("div"),B(o.$$.fragment)},m(r,l){y(r,e,l),M(o,e,null),n=!0},p(r,l){let s={};l&256&&(s.$$scope={dirty:l,ctx:r}),o.$set(s)},i(r){n||(k(o.$$.fragment,r),n=!0)},o(r){v(o.$$.fragment,r),n=!1},d(r){r&&C(e),Q(o)}}}function Et(t){let e;return{c(){e=A("Count Components")},m(o,n){y(o,e,n)},d(o){o&&C(e)}}}function It(t){let e;return{c(){e=A("Quick Extract")},m(o,n){y(o,e,n)},d(o){o&&C(e)}}}function tt(t){let e,o,n,r;return o=new H({props:{$$slots:{default:[At]},$$scope:{ctx:t}}}),o.$on("click",W(t[5])),{c(){e=g("div"),n=g("div"),B(o.$$.fragment),O(n,"display","contents"),O(n,"--button-color","red")},m(l,s){y(l,e,s),u(e,n),M(o,n,null),r=!0},p(l,s){let i={};s&256&&(i.$$scope={dirty:s,ctx:l}),o.$set(i)},i(l){r||(k(o.$$.fragment,l),r=!0)},o(l){v(o.$$.fragment,l),r=!1},d(l){l&&C(e),Q(o)}}}function At(t){let e;return{c(){e=A("Delete All Visible")},m(o,n){y(o,e,n)},d(o){o&&C(e)}}}function qt(t){let e,o,n,r,l,s,i,$,p,a=!t[0]&&et(t),f=[Tt,Dt],h=[];function w(d,_){return d[1]?1:0}n=w(t,-1),r=h[n]=f[n](t),i=new H({props:{$$slots:{default:[It]},$$scope:{ctx:t}}}),i.$on("click",t[4]);let m=t[0]&&tt(t);return{c(){e=g("div"),a&&a.c(),o=x(),r.c(),l=x(),s=g("div"),B(i.$$.fragment),$=x(),m&&m.c(),E(e,"class","fshCenter")},m(d,_){y(d,e,_),a&&a.m(e,null),u(e,o),h[n].m(e,null),u(e,l),u(e,s),M(i,s,null),u(e,$),m&&m.m(e,null),p=!0},p(d,[_]){d[0]?a&&(L(),v(a,1,1,()=>{a=null}),P()):a?(a.p(d,_),_&1&&k(a,1)):(a=et(d),a.c(),k(a,1),a.m(e,o));let T=n;n=w(d,_),n===T?h[n].p(d,_):(L(),v(h[T],1,1,()=>{h[T]=null}),P(),r=h[n],r?r.p(d,_):(r=h[n]=f[n](d),r.c()),k(r,1),r.m(e,l));let c={};_&256&&(c.$$scope={dirty:_,ctx:d}),i.$set(c),d[0]?m?(m.p(d,_),_&1&&k(m,1)):(m=tt(d),m.c(),k(m,1),m.m(e,null)):m&&(L(),v(m,1,1,()=>{m=null}),P())},i(d){p||(k(a),k(r),k(i.$$.fragment,d),k(m),p=!0)},o(d){v(a),v(r),v(i.$$.fragment,d),v(m),p=!1},d(d){d&&C(e),a&&a.d(),h[n].d(),Q(i),m&&m.d()}}}function xt(t,e,o){let n,r,l=re();function s(){j("components","enableQuickDel"),o(0,n=!0),l("enableQuickDel")}function i(){j("components","countComponents"),o(1,r=!0)}function $(){j("components","insertQuickExtract"),He()}function p(){j("components","deleteAllVisible"),l("deleteAllVisible")}function a(f){le.call(this,t,f)}return[n,r,s,i,$,p,a]}var ke=class extends z{constructor(e){super(),F(this,e,xt,qt,U,{})}},ot=ke;function he(t){return ie({subcmd:"destroycomponent",removeIndex:t})}function Bt(t,e){let o=Ve(e),n=1;return o==="Component destroyed."&&(n=0),{r:n,m:o,c:t}}async function Mt(t){let e=await Z({cmd:"profile",subcmd:"destroycomponent",component_id:t});return Bt(t,e)}function Qt(t){let e=t.filter(n=>n.r===0),o=t.filter(n=>n.r===1);return e.length>0?{r:e.map(n=>n.c),s:!0}:o.length>0?{e:{message:o[0].m},s:!1}:{e:{message:t[0].m},s:!1}}async function $e(t){let e=await G(t.map(Mt));return Qt(e)}function ve(t){return ce(he,$e,t)}function Nt(t,e){if(!e)return;let o=e.get("del").filter(n=>!t.includes(n));e.set("del",o)}function jt(t,e){N.update(o=>(Nt(e,o.get(t)),o))}function Lt(t,e,o){N.update(n=>(n.get(t)?.set(e,o),n))}function Pt(t){if(!t)return;let e=t.children[0];return e.replaceWith(qe({className:"compSumSpin",innerHTML:'<span class="fshSpinner fshSpinner12"></span>'})),e}function nt(t,e){Lt(e,"delPending",t)}function Vt(t){t.forEach(([e,o])=>{o&&e.children[0].replaceWith(o)})}var Ht=t=>t.forEach(([e])=>e?.children[0]?.remove()),Rt=t=>t.map(([e])=>[e,Pt(e)]),Gt=([,t])=>t,rt=t=>se(t.map(Gt)),lt=([,,t])=>t,Ut=t=>rt(t).map(e=>[e,t.filter(([,o])=>o===e).map(lt)]),Wt=t=>jt(...t);async function Ft(t){let e=Rt(t),o=await ve(t.map(lt));o?.s?(Ut(t).forEach(Wt),Ht(e)):(Fe(o?.e?.message??"Unknown Error"),Vt(e))}async function R(t){let e=rt(t);e.forEach(V(nt,!0)),await G(Ge(30,t).map(Ft)),e.forEach(V(nt,!1))}function X(t){let{itemId:e,invId:o}=ee(Y,t.dataset.tipped);return[Number(e),Number(o)]}var zt=t=>[J(t),...X(t)];function ye(t){R(K("img",t).map(zt))}var Jt=t=>Ne(N).get(t.detail).get("del"),Kt=(t,e)=>J(Ie(`img[data-tipped*="&inv_id=${e}&"]`,t));function Ce(t,e){R(Jt(e).map(o=>[Kt(t,o),e.detail,o]))}function Ot(t){t.target.tagName==="IMG"&&(t.preventDefault(),j("components","quickDel"),Re(t.target),R([[J(t.target),...X(t.target)]]))}function Se(t){t.classList.add("fshQuickDel"),xe(t,Ot)}function Xt(){let t=De("profileRightColumn"),e=Be("inventory-table",t);if(e.length===2)return e[1]}function Yt(){let t=Xt();if(!t)return;let e=new ot({target:t.parentNode});e.$on("enableQuickDel",V(Se,t)),e.$on("delType",V(Ce,t)),e.$on("deleteAllVisible",V(ye,t))}export{Yt as default};
//# sourceMappingURL=components-GQIBTXP5.js.map
