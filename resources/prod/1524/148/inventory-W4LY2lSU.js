import{g as t}from"./getMembrList-CBcI_RNr.js"
import{di as e,i as n,cE as s,ao as a,v as i,b3 as r,cp as c,p as o,dj as d,s as l,d as u,bw as f,bT as p,aq as m,d7 as h,dk as b,bV as v,F as y,ck as g,bx as k,l as _,$ as x,K as I,b2 as R,b8 as w,aC as L,S,P as M,Q as E,T,U as D,V as j,_ as C,a0 as N,a1 as A,a3 as G,a4 as q,a5 as U,b7 as P,bk as O,au as F,ax as B,a9 as W,dl as V,a8 as H,g as Q,dm as Y,dn as X,dp as K,dq as z,dr as J,bJ as Z,bD as tt,bE as et,bK as nt,bL as st,I as at,e as it,x as rt,n as ct,y as ot,cs as dt,f as lt,bc as ut}from"./calfSystem-BldO1y8X.js"
import{e as ft}from"./executeAll-DIAWIge1.js"
import{l as pt}from"./loadDataTables-CufrQcn_.js"
import{d as mt,a as ht}from"./deepClone-Dxf3yU2s.js"
import{d as bt}from"./daGuildReport-435Svqig.js"
import{d as vt}from"./daLoadInventory-B1LI3IE_.js"
import{b as yt}from"./basicItem-jvMH1Iol.js"
import{e as gt,d as kt,a as $t,m as _t}from"./dropItem-BXLktI5A.js"
import{f as xt}from"./flattenItems-g5kEa2JG.js"
import{c as It}from"./createTable-LhReG86D.js"
import{i as Rt}from"./isSelected-BWnMzKlW.js"
import{c as wt}from"./changeMinMax-ogi0Ijil.js"
import{c as Lt}from"./chromeHandlers-DSNQu5gb.js"
import{a as St,e as Mt,u as Et}from"./useItem-q9q5aS11.js"
import{g as Tt}from"./guildInventory-BTZVy_1P.js"
import{h as Dt}from"./htmlResult-BVZ0S6D_.js"
import{e as jt}from"./errorDialog-B4_TjdGG.js"
import{q as Ct,a as Nt}from"./queue-Rpw9t4ei.js"
import{p as At,l as Gt}from"./lvlTests-D_cSf1Ux.js"
import{d as qt}from"./daGsTake-DBWt8my9.js"
import"./dialog-nv9HUVDL.js"
import"./dialogMsg-rKdvzvMA.js"
import"./sendItems-BbvSea5F.js"
import"./daUseItem-Deu1zmzV.js"
import"./InfoBoxFrom-BaZ8ZoH1.js"
import"./backpackOk-DdJ8X7ny.js"
import"./takeItem-ijFETChH.js"
function Ut([t]){return"lastUpdate"!==t}function Pt(){return e({subcmd:"inventory"})}let Ot=""
const Ft=()=>Ot
function Bt(t,e){Ot||(Ot=e.message),Ot&&n(t,s("p",{className:"fshRed",textContent:Ot}))}let Wt={}
const Vt=()=>Wt
async function Ht(t){try{return await t()}catch(t){if(500!==t.jqXhr.status)throw t
Bt(o(),t)}}const Qt=(t,e)=>{return e.map(yt).map((n=t,function(t){const e=n?.find((({inv_id:e})=>e===t.inv_id))
return{...t,...e?.stats&&{stats:{...t.stats,armor:e.stats.armor,attack:e.stats.attack,damage:e.stats.damage,defense:e.stats.defense,hp:e.stats.hp,set_name:e.stats.set_name??""}}}}))
var n},Yt=t=>({...t,equipped:!0,folder_id:-2}),Xt=(t,e,n)=>({folders:gt(t),items:Qt(e,n),player_id:r()})
const Kt=t=>({...t,player:{id:-1}}),zt=(t,e)=>({current_player_id:r(),items:Qt(t,e),guild_id:c()})
async function Jt(){if("invmanagernew"===a.subcmd){const t=await async function(){const[t,e]=await i([Ht(Pt),vt()]),n=t?.items??[],s=e?.r??{},a=(s.equipment?.map(Yt)??[]).concat(xt(s))
return Xt(s,n,a)}()
Wt=t}else if("guildinvmgr"===a.subcmd){const t=await async function(){const[t,e,n]=await i([Ht(d),bt(),mt()]),s=t?.items??[],a=e?.r??[],r=n?.r??[],c=a.concat(r.map(Kt))
return zt(s,c)}()
Wt=t}}const Zt=t=>{l("Inventory","Header",t)},te=t=>{l("Inventory","Datatable",t)}
function ee(t,e){te("clearSearch"),e.val(""),$(t).DataTable().search("").draw()}function ne(){Vt().folders&&(Vt().folders[-1]="Main")}const se={checkedElements:{0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,100:1,101:1,102:1,103:1,104:1,105:1,106:1},fshMinLvl:1,fshMaxLvl:9999},ae='<table class="fshInvFilter"><tr><th colspan="14">@@reportTitle@@</th><th><span id="fshRefresh" class="fshLink">[Refresh]</span></th></tr><tr><td colspan="2" rowspan="3"><b>&nbsp;Show Items:</b></td><td class="fshRight">&nbsp;Helmet:</td><td><input id="fshHelmet" type="checkbox" item="0"/></td><td class="fshRight">&nbsp;Armor:</td><td><input id="fshArmor" type="checkbox" item="1"/></td><td class="fshRight">&nbsp;Gloves:</td><td><input id="fshGloves" type="checkbox" item="2"/></td><td class="fshRight">&nbsp;Boots:</td><td><input id="fshBoots" type="checkbox" item="3"/></td><td class="fshRight">&nbsp;Weapon:</td><td><input id="fshWeapon" type="checkbox" item="4"/></td><td></td><td class="fshRight">&nbsp;Min lvl:</td><td rowspan="2"><input id="fshMinLvl" class="fshNumberInput" type="number" value="1" min="0"><br><input id="fshMaxLvl" class="fshNumberInput" type="number" value="9999" min="0"></td></tr><tr><td class="fshRight">&nbsp;Shield:</td><td><input id="fshShield" type="checkbox" item="5"/></td><td class="fshRight">&nbsp;Ring:</td><td><input id="fshRing" type="checkbox" item="6"/></td><td class="fshRight">&nbsp;Amulet:</td><td><input id="fshAmulet" type="checkbox" item="7"/></td><td class="fshRight">&nbsp;Rune:</td><td><input id="fshRune" type="checkbox" item="8"/></td><td class="fshRight">&nbsp;Sets Only:</td><td><input id="fshSets" item="-1" type="checkbox"/></td><td></td><td class="fshRight">&nbsp;Max lvl:</td></tr><tr><td colspan="2">&nbsp;[<span id="fshAll" class="fshLink">Select All</span>]</td><td colspan="2">&nbsp;[<span id="fshNone" class="fshLink">Select None</span>]</td><td colspan="2">&nbsp;[<span id="fshDefault" class="fshLink">Defaults</span>]</td><td colspan="6"></td><td><input id="fshReset" type="button" value="Reset"/></td></tr><tr><td class="fshRight">&nbsp;Quest Item:</td><td><input id="fshQuest" item="9" type="checkbox"/></td><td class="fshRight">&nbsp;Potion:</td><td><input id="fshPotion" item="10" type="checkbox"/></td><td class="fshRight">&nbsp;Resource:</td><td><input id="fshResource" item="12" type="checkbox"/></td><td class="fshRight">&nbsp;Recipe:</td><td><input id="fshRecipe" item="13" type="checkbox"/></td><td class="fshRight">&nbsp;Container:</td><td><input id="fshContainer" item="14" type="checkbox"/></td><td class="fshRight">&nbsp;Frag Stash:</td><td><input id="fshStash" item="16" type="checkbox"/></td><td class="fshRight">&nbsp;Composed:</td><td><input id="fshComposed" item="15" type="checkbox"/></td><td></td></tr><tr><td class="fshRight">&nbsp;Common:</td><td><input id="fshCommon" item="100" type="checkbox" checked/></td><td class="fshRight">&nbsp;Rare:</td><td><input id="fshRare" item="101" type="checkbox" checked/></td><td class="fshRight">&nbsp;Unique:</td><td><input id="fshUnique" item="102" type="checkbox" checked/></td><td class="fshRight">&nbsp;Legendary:</td><td><input id="fshLegendary" item="103" type="checkbox" checked/></td><td class="fshRight">&nbsp;Super Elite:</td><td><input id="fshSuperElite" item="104" type="checkbox" checked/></td><td class="fshRight">&nbsp;Crystalline:</td><td><input id="fshCrystalline" item="105" type="checkbox" checked/></td><td class="fshRight">&nbsp;Epic:</td><td colspan="2"><input id="fshEpic" item="106" type="checkbox" checked/></td></tr></table>',ie={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,100:1,101:1,102:1,103:1,104:1,105:1,106:1},re={Perfect:{abbr:"Perf",colour:"#00b600",index:8},Excellent:{abbr:"Exc",colour:"#f6ed00",index:7},"Very Good":{abbr:"VG",colour:"#f67a00",index:6},Good:{abbr:"Good",colour:"#f65d00",index:5},Average:{abbr:"Ave",colour:"#f64500",index:4},Poor:{abbr:"Poor",colour:"#f61d00",index:3},"Very Poor":{abbr:"VPr",colour:"#b21500",index:2},Uncrafted:{abbr:"Unc",colour:"#666666",index:1}}
let ce={},oe=0,de=0
const le=()=>ce,ue=()=>oe,fe=()=>de
function pe(t){return re[t]?re[t].abbr:""}function me(t,e){const n=function(t){return t.folder_id?function(t){return t.equipped?"fshGreen":"fshNavy"}(t):function(t){return-1===t.player_id?"fshNavy":"fshMaroon"}(t)}(e)
t.classList.add(n),e.equipped&&t.classList.add("fshBold")}function he(t){return function(t){return t.player_id&&-1!==t.player_id}(t)||function(t){return t.folder_id&&-1!==t.guild_tag}(t)}function be(t){return`<span class="fshLink recallItem" invid="${t.inv_id}" playerid="${p(t.player_id,Vt().player_id)}" mode="1" action="recall">GS</span>`}function ve(t){return`<span class="fshLink storeItem" invid="${t.inv_id}">GS</span>`}function ye(t,e,n){return"display"===t?n(e):"GS"}function ge(t,e){const n=function(t){return-1===t.player_id?4:he(t)?7:1}(e),s=(a=Vt().player_id,i=e.player_id,r=Vt().guild_id,a||(-1!==i?i:r))
var a,i,r
let c=""
return function(t){return t.stats&&""!==t.stats.set_name}(e)&&(c=` (<span class="fshLink setName" set="${e.stats.set_name}">set</span>)`),`<a href="${h}${t}" class="fshInvItem tip-dynamic ${b[e.rarity].clas}" data-tipped="fetchitem.php?item_id=${e.item_id}&inv_id=${e.inv_id}&t=${n}&p=${s}">${t}</a>${c}`}const ke=[[t=>t.player_id&&-1===t.player_id,(t,e)=>`takeItem" action="${e.a}`],[t=>t.player_id&&t.player_id!==Vt().current_player_id,(t,e)=>`recallItem" playerid="${t.player_id}" mode="0" action="${e.a}`],[t=>function(t){return t.folder_id&&!t.equipped}(t)||function(t){return t.player_id&&!t.equipped&&t.player_id===Vt().current_player_id}(t),(t,e)=>e.c]]
function $e(t,e){const n=ke.find((([e])=>e(t)))
return n?`<span class="fshLink ${n[1](t,e)}" invid="${t.inv_id}">${e.b}</span>`:""}function _e(t){return p(t.folder_id,t.player_id)}function xe(t){return a.membrList[t]?a.membrList[t].username:"???"}function Ie(t,e){return t[0]-e[0]}function Re(t,e){return`<option value="${e[0]}"${Rt(Number(e[0]),t)}>${e[1]}</option>`}const we=[{title:"Name",data:"item_name",render:function(t,e,n){return"display"!==e?t:ge(t,n)}},{title:"Level",data:"stats.min_level"},{title:"Where",data:_e,render:{_:function(t,e,n){return n.folder_id?function(t){return t.equipped?-2:t.folder_id}(n):-1===n.player_id?"~":xe(n.player_id)},display:function(t,e,n){return n.player_id?function(t){return-1===t.player_id?"Guild Store":`<a class="fshMaroon" href="${v}${t.player_id}">${xe(t.player_id)}</a>`}(n):n.equipped?"Worn":`<select class="fshMoveItem" data-inv="${n.inv_id}">${s=n.folder_id,a=Vt().folders,y(a).sort(Ie).map(u(Re,s)).join("")}</select>`
var s,a},filter:function(t,e,n){return n.player_id?function(t){return-1===t.player_id?"Guild Store":xe(t.player_id)}(n):n.equipped?"Worn":Vt().folders[n.folder_id]}}},{title:"Type",data:"type",render:t=>g[t]},{title:"Att",data:"stats.attack"},{title:"Def",data:"stats.defense"},{title:"Arm",data:"stats.armor"},{title:"Dam",data:"stats.damage"},{title:"HP",data:"stats.hp"},{title:"Frg",data:"forge",render:function(t,e,n){if(n.type<9)return n.forge}},{title:"Craft",data:"craft",render:{_:t=>re[t]?re[t].index:0,display:pe,filter:pe}},{title:"Du%",data:"durability",render:function(t,e,n){if(n.type<9&&n.max_durability>0)return Math.floor(n.durability/n.max_durability*100)}},{title:"BP",data:_e,render:function(t,e,n){if(!n.folder_id&&n.player_id!==Vt().current_player_id)return function(t,e){return"display"!==t?"BP":-1===e.player_id?`<span class="fshLink takeItem" invid="${e.inv_id}" action="take">BP</span>`:`<span class="fshLink recallItem" invid="${e.inv_id}" playerid="${e.player_id}" mode="0" action="recall">BP</span>`}(e,n)}},{title:"GS",data:_e,render:function(t,e,n){return he(n)?ye(e,n,be):function(t){return t.folder_id&&!t.bound}(n)?ye(e,n,ve):void 0}},{title:"W/U",data:"type",render:function(t,e,n){const s=[1,1,1,1,1,1,1,1,1,null,2,2,null,null,null,2][t]
return 1===s?$e(n,{a:"wear",b:"Wear",c:"wearItem"}):2===s?$e(n,{a:"use",b:"Use",c:"useItem"}):void 0}},{title:"setName",data:"stats.set_name",orderable:!1,visible:!1},{title:"Tag",data:"guild_tag",render:t=>-1===t?"No":"Yes"},{title:"Drop",data:"type",render:function(t,e,n){if(!function(t){return-1!==t.guild_tag||t.equipped}(n))return"display"!==e?"Drop":`<span class="dropItem dropLink" data-tooltip="INSTANTLY DESTROY THE ITEM. NO REFUNDS OR DO-OVERS! Use at own risk." data-inv="${n.inv_id}">Drop</span>`}},{title:"Send",data:"type",render:function(t,e,n){if(!function(t){return t.equipped||-1===t.guild_tag&&t.bound}(n))return"display"!==e?"Send":`<span class="sendItem sendLink" data-tooltip="INSTANTLY SEND THE ITEM. NO REFUNDS OR DO-OVERS! Use at own risk." data-inv="${n.inv_id}">Send</span>`}}]
function Le(){return"player_id"in Vt()}function Se(){const t=function(){const t=It({className:"hover fshXSmall",id:Le()?"fshUserInv":"fshGuildInv"})
return n(o(),t),t}(),e=function(t){return $(t).DataTable({autoWidth:!1,columnDefs:[{targets:"_all",defaultContent:""},{targets:[1,4,5,6,7,8,9,10,12,13],orderSequence:["desc","asc"]}],columns:we,createdRow:me,data:Vt().items,deferRender:!0,lengthMenu:[[50,100,150,200,-1],[50,100,150,200,"All"]],pageLength:50,stateDuration:0,stateSave:!0})}(t)
return function(t){[[12,"current_player_id"in Vt()],[17,Le()&&ue()],[18,Le()&&fe()]].forEach((([e,n])=>t.column(e).visible(n)))}(e),t}function Me(t){k(`fsh_${a.subcmd}`,t)}function Ee(){_('table.fshInvFilter input[type="checkbox"]').forEach((t=>{t.checked=1===le().checkedElements[t.getAttribute("item")]})),Me(le())}function Te(t){Zt("Select All"),le().checkedElements=ie,Ee(),$(t).DataTable().draw(!1)}function De(t,e){le().fshMinLvl=t,le().fshMaxLvl=e,Me(le())}function je(t){$(t).DataTable().draw(!1)}function Ce(t){Zt("changeLvls"),wt(De,u(je,t))}function Ne(t){return Number(t[0])>=100}function Ae(t,e){return t[e[0]]=e[1],t}function Ge(t){var e
Zt("Select None"),le().checkedElements=(e=le().checkedElements,y(e).filter(Ne).reduce(Ae,{})),Ee(),$(t).DataTable().draw()}function qe(t){Zt("Checkbox"),le().checkedElements={},_('table.fshInvFilter input[type="checkbox"][item]:checked').forEach((t=>{le().checkedElements[t.getAttribute("item")]=1})),Me(le()),$(t).DataTable().draw(!1)}function Ue(t){Zt("Defaults"),le().checkedElements=se.checkedElements,Ee(),$(t).DataTable().draw(!1)}function Pe(t){Zt("Reset levels"),le().fshMinLvl=se.fshMinLvl,le().fshMaxLvl=se.fshMaxLvl,Me(le()),function(t){$("#fshMinLvl").val(le().fshMinLvl),$("#fshMaxLvl").val(le().fshMaxLvl),$(t).DataTable().draw(!1)}(t)}async function Oe(t){const e=await kt(t)
return St(e)}function Fe(t){return Tt({subcmd2:"dostoreitems",items:t})}async function Be(t){const e=await I({cmd:"guild",subcmd:"inventory",subcmd2:"dostoreitems",storeIndex:t})
return Dt(e)}async function We(t){const e=await function(t){return x(Fe,Be,t)}(t)
return jt(e),St(e)}function Ve(t,e){t.eq(e).empty()}function He(t,e){if(1===e.r)return
const n=t.closest("tr")
!function(t){[2,12,13,14,15,16].forEach(u(Ve,t))}($("td",n)),n.css("text-decoration","line-through")}async function Qe(t,e){R(e),function(t){t.closest("tr").find(".takeItem, .recallItem, .wearItem, .dropItem, .sendItem, .storeItem").removeClass()}(e),function(t){t.empty().append(`<img src="${w}ui/misc/spinner.gif" width="11" height="11">`)}(e)
const n=await t()
n&&He(e,n)}function Ye(t,e){te("setName"),$(t).DataTable().search(e.attr("set")).draw(),$(`#${t.id}_filter input`).trigger("focus")}function Xe(t){te("takeItem"),Qe(u(Nt,t.attr("invid"),t.attr("action")),t)}function Ke(t){te("recallItem"),Qe(u(Ct,t.attr("invid"),t.attr("playerid"),t.attr("mode"),t.attr("action")),t)}function ze(t,e,n,s){te(n),Qe(u(t,e),s)}function Je(t){ze(We,[t.attr("invid")],"doStoreItem",t)}function Ze(t,e,n){ze(t,n.attr("invid"),e,n)}const tn=t=>Ze(Et,"doUseItem",t),en=t=>Ze(Mt,"doWearItem",t)
function nn(t,e,n){ze(t,[n.data("inv")],e,n)}const sn=t=>nn($t,"doDropItem",t),an=t=>nn(Oe,"doSendItem",t),rn=t=>e=>t($(e.target))
function cn(t,[e,n]){$(t).on("click",`span.${e}`,rn(n))}function on(t){te("doMoveItem")
const e=$(t.target)
_t([e.data("inv")],e.val())}function dn(t,e){$(e[0]).on("click",u(e[1],t))}const ln=t=>()=>{te(t)}
function un(t){!function(t){[["#fshReset",Pe],["#fshAll",Te],["#fshNone",Ge],["#fshDefault",Ue]].forEach(u(dn,t))}(t),$("table.fshInvFilter").on("click",'input[type="checkbox"]',u(qe,t)),function(t){[["dropItem",sn],["recallItem",Ke],["sendItem",an],["setName",u(Ye,t)],["storeItem",Je],["takeItem",Xe],["useItem",tn],["wearItem",en]].forEach(u(cn,t))}(t),function(t){["fshInvItem","fshMaroon","sorting"].forEach((e=>{$(t).on("click",`.${e}`,ln(e))}))}(t)}let fn=0
function pn(t,e){return Gt(fn,L(e[1]),le().fshMinLvl,le().fshMaxLvl)}function mn(){fn=[(t,e,n)=>0===n,...At],$.fn.dataTable.ext.search.push(pn)}function hn(){$.fn.dataTable.ext.search.push(((t,e,n,s)=>!le().checkedElements||le().checkedElements[s.type]))}function bn(){$.fn.dataTable.ext.search.push(((t,e,n,s)=>!le().checkedElements?.[-1]||function(t){return le().checkedElements[-1]&&t.stats&&""!==t.stats.set_name}(s)))}function vn(){$.fn.dataTable.ext.search.push(((t,e,n,s)=>{const a=(parseInt(s.rarity,10)+100).toString()
return!le().checkedElements||le().checkedElements[a]}))}function yn(t){let e,n,s,a,i,r,c,o,d
return{c(){e=G("div"),n=G("div"),n.textContent="Recall all visible to",s=q(),a=G("div"),i=G("button"),i.textContent="BP",r=q(),c=G("button"),c.textContent="GS",U(n,"class","head svelte-1mlms3r"),U(i,"class","custombutton svelte-1mlms3r"),U(i,"type","button"),U(c,"class","custombutton svelte-1mlms3r"),U(c,"type","button"),U(a,"class","btnbox svelte-1mlms3r"),U(e,"class","main svelte-1mlms3r")},m(l,u){C(l,e,u),N(e,n),N(e,s),N(e,a),N(a,i),N(a,r),N(a,c),o||(d=[A(i,"click",t[0]),A(c,"click",t[1])],o=!0)},p:T,i:T,o:T,d(t){t&&D(e),o=!1,j(d)}}}function gn(t){const e=t=>{l("Inventory","Recall All",t)}
return[function(){e("toBp"),[..._('span[action="take"]'),..._('span[mode="0"][action="recall"]')].forEach(P)},function(){e("toGs"),_('span[mode="1"][action="recall"]').forEach(P)}]}class kn extends S{constructor(t){super(),M(this,t,gn,yn,E,{})}}function $n(t){let e,n,s,a
return{c(){e=G("button"),n=W("BP"),U(e,"class","custombutton svelte-fvareh"),e.disabled=t[0],U(e,"type","button")},m(i,r){C(i,e,r),N(e,n),s||(a=A(e,"click",t[4],{once:!0}),s=!0)},p(t,n){1&n&&(e.disabled=t[0])},d(t){t&&D(e),s=!1,a()}}}function _n(t){let e,n={ctx:t,current:null,token:null,hasCatch:!1,pending:Rn,then:In,catch:xn}
return F(t[3](),n),{c(){e=B(),n.block.c()},m(t,s){C(t,e,s),n.block.m(t,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e},p(e,n){t=e},d(t){t&&D(e),n.block.d(t),n.token=null,n=null}}}function xn(t){return{c:T,m:T,d:T}}function In(t){let e
return{c(){e=G("span"),e.textContent="Recalled",U(e,"class","fshGreen")},m(t,n){C(t,e,n)},d(t){t&&D(e)}}}function Rn(t){let e
return{c(){e=G("span"),U(e,"class","fshSpinner")},m(t,n){C(t,e,n)},d(t){t&&D(e)}}}function wn(t){let e,n,s,a,i,r
function c(t,e){return t[1]?_n:$n}let o=c(t),d=o(t)
return{c(){e=G("div"),n=G("div"),n.textContent="Recall repairable to",s=q(),a=G("div"),d.c(),i=q(),r=G("div"),r.textContent=`${t[2].length} items to repair`,U(n,"class","head svelte-fvareh"),U(a,"class","btnbox svelte-fvareh"),U(r,"class","btnbox svelte-fvareh"),U(e,"class","main svelte-fvareh")},m(t,c){C(t,e,c),N(e,n),N(e,s),N(e,a),d.m(a,null),N(e,i),N(e,r)},p(t,[e]){o===(o=c(t))&&d?d.p(t,e):(d.d(1),d=o(t),d&&(d.c(),d.m(a,null)))},i:T,o:T,d(t){t&&D(e),d.d()}}}function Ln(t,e,n){let{fshInv:s=0}=e,a=1,i=0
const r=new DataTable(s).rows(((t,{durability:e,max_durability:n,player_id:s,rarity:a,type:i})=>e<n&&-1===s&&5!==a&&i<9)),c=O(r.data())
return c.length&&(a=0),t.$$set=t=>{"fshInv"in t&&n(5,s=t.fshInv)},[a,i,c,function(){return qt(c.map((({inv_id:t})=>t)))},function(){n(1,i=1)},s]}class Sn extends S{constructor(t){super(),M(this,t,Ln,wn,E,{fshInv:5})}}function Mn(t){let e,n,s,a,i,r,c,o,d,l=(t[0]||"")+"",u=(t[1]||"")+""
return{c(){e=G("div"),n=W("Chunks needed: "),s=G("span"),a=W(l),i=q(),r=G("div"),c=W("Chunks received: "),o=G("span"),d=W(u)},m(t,l){C(t,e,l),N(e,n),N(e,s),N(s,a),C(t,i,l),C(t,r,l),N(r,c),N(r,o),N(o,d)},p(t,e){1&e&&l!==(l=(t[0]||"")+"")&&H(a,l),2&e&&u!==(u=(t[1]||"")+"")&&H(d,u)},d(t){t&&(D(e),D(i),D(r))}}}function En(t){let e,n,s,a,i,r,c,o,d,l,u,f,p,m,h,b,v,y,g,k,$,_=t[0]&&Mn(t)
return{c(){e=G("div"),n=G("div"),s=W("Update Stats\n    "),a=G("div"),i=W("[\n      "),r=G("div"),c=G("span"),o=W("?"),d=W("\n      ]"),l=q(),u=G("div"),f=G("button"),f.textContent="On page",p=q(),m=G("button"),m.textContent="All",h=q(),b=G("div"),v=G("button"),v.textContent="Clear cache",y=q(),g=G("div"),_&&_.c(),U(c,"class","tooltip-multiline"),U(c,"data-tooltip",t[5]),U(r,"class","tooltip svelte-15yybge"),U(a,"class","wrapper svelte-15yybge"),U(n,"class","head svelte-15yybge"),U(f,"class","custombutton svelte-15yybge"),U(f,"type","button"),U(m,"class","custombutton svelte-15yybge"),U(m,"type","button"),U(u,"class","btnbox svelte-15yybge"),U(v,"class","custombutton svelte-15yybge"),U(v,"type","button"),U(b,"class","btnbox svelte-15yybge"),U(g,"class","chunkbox svelte-15yybge"),U(e,"class","main svelte-15yybge")},m(x,I){C(x,e,I),N(e,n),N(n,s),N(n,a),N(a,i),N(a,r),N(r,c),N(c,o),N(a,d),N(e,l),N(e,u),N(u,f),N(u,p),N(u,m),N(e,h),N(e,b),N(b,v),N(e,y),N(e,g),_&&_.m(g,null),k||($=[A(f,"click",t[2]),A(m,"click",t[3]),A(v,"click",t[4])],k=!0)},p(t,[e]){t[0]?_?_.p(t,e):(_=Mn(t),_.c(),_.m(g,null)):_&&(_.d(1),_=null)},i:T,o:T,d(t){t&&D(e),_&&_.d(),k=!1,j($)}}}function Tn(t,e,n){let{fshInv:s=0}=e
const r=new DataTable(s)
let c=0,o=0
async function d([t,e,s]){const a=await J(t,e,s)
return n(1,o+=1),a}async function u(t){const e=r.rows(Y,t),s=X(O(e.data()))
n(0,c=s.length),n(1,o=0)
const a=await i(s.map(d))
e.every(K(a.flatMap(z))),r.draw()}const f=t=>{l("Inventory","Update Stats",t)}
V(s)
return t.$$set=t=>{"fshInv"in t&&n(6,s=t.fshInv)},[c,o,async function(){f("On page"),u({page:"current"})},function(){f("All"),u()},async function(){f("Clear cache"),await k(`fsh_${a.subcmd}_cache`,[]),P(Q("fshRefresh"))},"This allows you to update the stats of items. It is useful in cases where stats are missing or if you want accurate stats for forged items. It can be slow for large data sets. The results are cached and will be used automatically next time you visit this page. You will need to update again if these stats become stale. For example, if you forged or crafted an item, or if a guild store item has moved.",s]}class Dn extends S{constructor(t){super(),M(this,t,Tn,En,E,{fshInv:6})}}function jn(t){let e
return{c(){e=G("div")},m(t,n){C(t,e,n)},p:T,i:T,o:T,d(t){t&&D(e)}}}function Cn(t){let e,n,s,a
return e=new kn({}),s=new Sn({props:{fshInv:t[0]}}),{c(){st(e.$$.fragment),n=q(),st(s.$$.fragment)},m(t,i){nt(e,t,i),C(t,n,i),nt(s,t,i),a=!0},p(t,e){const n={}
1&e&&(n.fshInv=t[0]),s.$set(n)},i(t){a||(et(e.$$.fragment,t),et(s.$$.fragment,t),a=!0)},o(t){tt(e.$$.fragment,t),tt(s.$$.fragment,t),a=!1},d(t){t&&D(n),Z(e,t),Z(s,t)}}}function Nn(t){let e,n,s,i,r,c
const o=[Cn,jn],d=[]
return n="guildinvmgr"===a.subcmd?0:1,s=d[n]=o[n](t),r=new Dn({props:{fshInv:t[0]}}),{c(){e=G("div"),s.c(),i=q(),st(r.$$.fragment),U(e,"class","container svelte-1tjz5ud")},m(t,s){C(t,e,s),d[n].m(e,null),N(e,i),nt(r,e,null),c=!0},p(t,[e]){s.p(t,e)
const n={}
1&e&&(n.fshInv=t[0]),r.$set(n)},i(t){c||(et(s),et(r.$$.fragment,t),c=!0)},o(t){tt(s),tt(r.$$.fragment,t),c=!1},d(t){t&&D(e),d[n].d(),Z(r)}}}function An(t,e,n){let{fshInv:s=0}=e
return t.$$set=t=>{"fshInv"in t&&n(0,s=t.fshInv)},[s]}class Gn extends S{constructor(t){super(),M(this,t,An,Nn,E,{fshInv:0})}}function qn(t){!function(t){new Gn({props:{fshInv:t},target:o()})}(t)}const Un=()=>Vt().player_id?`<b>&nbsp;Inventory Manager</b> ${Vt().items.length} items (green = worn, blue = backpack)`:`<b>&nbsp;Guild Inventory Manager</b> ${Vt().items.length} items (maroon = in BP, blue=guild store)`
function Pn(){const t=Un()
it("",o()),function(){if(!Ft())return
Bt(n(Q("pF"),ct({style:{textAlign:"center"}})))}(),rt(o(),ae.replace("@@reportTitle@@",t))}function On(){at(Vt().items)&&Pn()}function Fn(){$("#fshMinLvl").val(le().fshMinLvl),$("#fshMaxLvl").val(le().fshMaxLvl)}const Bn=([,t])=>[t.id,t]
function Wn(t){ft([ne,mn,hn,bn,vn,On,Ee,Fn])
const e=Se()
!function(t){$("#fshMinLvl, #fshMaxLvl").on("keyup",u(Ce,t)),$(t).on("change","select.fshMoveItem",on),un(t),Lt(t,ln,te)}(e),$("#fshRefresh").on("click",t),function(t){const e=$(`#${t.id}_filter input`)
e.prop("type","text")
const n=$("<span>&times;</span>")
e.wrap($('<span class="text-input-wrapper"/>')),e.after(n),n.on("click",u(ee,t,e))}(e),qn(e)}function Vn(t){Wn(t)}const Hn=()=>Object.getOwnPropertyNames(Vt()).length
async function Qn(e){const n=[pt(),Jt()]
"guildinvmgr"===a.subcmd&&n.push(async function(){await t(!1),a.membrList&&(a.membrList=lt(y(a.membrList).filter(Ut).map(Bn)))}()),n.push(async function(){const t=await f(`fsh_${a.subcmd}`)
ce={...ht(se),...p(t,{})},oe=m("showQuickDropLinks"),de=m("showQuickSendLinks")}()),await i(n),Hn()&&function(t){ut(3,Vn,[t])}(e)}function Yn(){!ot()&&o()&&("guildinvmgr"!==a.subcmd||c())&&(it(`<span id="fshInvMan"><img src = "${dt}">&nbsp;Getting inventory data...</span>`,o()),Qn(Yn))}export{Yn as default}
//# sourceMappingURL=inventory-W4LY2lSU.js.map
