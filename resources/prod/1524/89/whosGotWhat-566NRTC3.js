import{a as ht,b as Et}from"./chunk-EW6ANURG.js";import{a as gt}from"./chunk-WXDI5P74.js";import{a as h}from"./chunk-TOBOH6AK.js";import{a as ft}from"./chunk-D44SL4L4.js";import{a as dt}from"./chunk-WH4JLHSO.js";import{a as pt}from"./chunk-GB6MKVPJ.js";import{a as ut}from"./chunk-QNU2EUR6.js";import"./chunk-XAIJKPRR.js";import{a as at}from"./chunk-CYZ2BHCX.js";import"./chunk-TMA3JJ3J.js";import{a as lt}from"./chunk-GATB2KES.js";import{a as mt}from"./chunk-6C3PD6P4.js";import"./chunk-3NLO6CWV.js";import"./chunk-BXO6DSDL.js";import"./chunk-UH3DQLEQ.js";import{a as f}from"./chunk-E2TRAGUE.js";import{a as m}from"./chunk-7GBB3QCV.js";import"./chunk-ZBKYZ2YU.js";import"./chunk-GSUWBLGD.js";import"./chunk-5UHRXVOP.js";import{a as M}from"./chunk-B6KP7GWD.js";import"./chunk-2D6L2THT.js";import{a as st}from"./chunk-HHBMG3A2.js";import{b as it}from"./chunk-JCMYL2IG.js";import{a as C}from"./chunk-2DTQHJVU.js";import"./chunk-EWZCJZ6Z.js";import"./chunk-PQNCJJBC.js";import"./chunk-E5TMKJMS.js";import"./chunk-EUKASYK5.js";import"./chunk-FLGR7E47.js";import"./chunk-F4AOEDND.js";import"./chunk-VSM6H66Z.js";import"./chunk-5KMEA72E.js";import"./chunk-6LZWMBZT.js";import"./chunk-NRKJIV3C.js";import"./chunk-BPYWQKVH.js";import"./chunk-ZF4YEV73.js";import"./chunk-SF3VAYKI.js";import"./chunk-HVBOPFGL.js";import{a as A}from"./chunk-BGM44O73.js";import{a as I}from"./chunk-2S22FDHI.js";import"./chunk-GWTCUF2Q.js";import"./chunk-RBCKIE7A.js";import{d as ct}from"./chunk-LWLNEV2H.js";import"./chunk-M63EVJYL.js";import"./chunk-K4JWVECD.js";import{a as D}from"./chunk-7KD3BGAV.js";import"./chunk-PJBT7EBJ.js";import"./chunk-QMEA3FHH.js";import"./chunk-5QU22RJP.js";import"./chunk-UELYWXNW.js";import"./chunk-OENBM34F.js";import{a as ot}from"./chunk-SWUMTTGA.js";import"./chunk-4JMWSEZ5.js";import"./chunk-IYBGVYMO.js";import"./chunk-ULXDH3QJ.js";var vt=t=>(e,r)=>t(r,e),p=(t,...e)=>(...r)=>e.reduce((n,o)=>o(n),t(...r)),T=(t,e)=>{let r=e||t.length;return(...n)=>{let o=n.length||1;return r===o?t(...n):T((...i)=>t(...n,...i),r-n.length)}};var B=t=>e=>(t(e),e);var E=t=>{let e=t.split("."),r=(o={},s=[])=>{let i=s.shift(),c=o[i];return c==null||s.length===0?c:r(c,s)};return{get(o){return r(o,[...e])},set:(o,s)=>{let i=o,[c,...a]=e.reverse();for(let l of a.reverse())i[l]===void 0&&(i[l]={},i=i[l]);return i[c]=s,o}}};var Qt=(t,e)=>t===e?0:t===void 0?1:e===void 0||t<e?-1:1,F;(function(t){t.ASC="asc",t.DESC="desc",t.NONE="none"})(F||(F={}));var Jt=(t,e)=>{let r=E(t).get;return(n,o)=>e(r(n),r(o))},$=t=>{let{pointer:e,direction:r="asc",comparator:n=Qt}=t;if(!e||r==="none")return i=>[...i];let o=Jt(e,n),s=r==="desc"?vt(o):o;return i=>[...i].sort(s)};var _;(function(t){t.BOOLEAN="boolean",t.NUMBER="number",t.DATE="date",t.STRING="string"})(_||(_={}));var Vt=t=>{switch(t){case _.BOOLEAN:return Boolean;case _.NUMBER:return Number;case _.DATE:return e=>new Date(e);case _.STRING:return p(String,e=>e.toLowerCase());default:return e=>e}},z;(function(t){t.INCLUDES="includes",t.IS="is",t.IS_NOT="isNot",t.LOWER_THAN="lt",t.GREATER_THAN="gt",t.GREATER_THAN_OR_EQUAL="gte",t.LOWER_THAN_OR_EQUAL="lte",t.EQUALS="equals",t.NOT_EQUALS="notEquals",t.ANY_OF="anyOf"})(z||(z={}));var G=t=>e=>!t(e),yt=t=>e=>Object.is(t,e),At=t=>e=>e<t,Ct=t=>e=>e>t,xt=t=>e=>t===e,jt=t=>e=>e.includes(t),Kt=t=>e=>t.includes(e),Zt={includes:jt,is:yt,isNot:p(yt,G),lt:At,gte:p(At,G),gt:Ct,lte:p(Ct,G),equals:xt,notEquals:p(xt,G),anyOf:Kt},_t=t=>(...e)=>t.every(r=>r(...e)),te=({value:t="",operator:e="includes",type:r})=>{let n=Vt(r),s=p(n,Zt[e])(t);return p(n,s)},ee=t=>{let e={};return Object.keys(t).filter(n=>Array.isArray(t[n])).forEach(n=>{let o=t[n].filter(s=>s.value!=="");o.length>0&&(e[n]=o)}),e},U=t=>{let e=ee(t),r=Object.keys(e).map(o=>{let s=E(o).get,i=e[o].map(te);return p(s,_t(i))}),n=_t(r);return o=>o.filter(n)};function re(t,...e){let r=St(t.raw[0]);for(let[o,s]of e.entries()){if(s instanceof RegExp)r+=s.source;else if(typeof s=="string")r+=ne(s);else throw new Error("Illegal substitution: "+s);r+=St(t.raw[o+1])}let n="";if(r.startsWith("/")){let o=r.lastIndexOf("/");if(o===0)throw new Error("If the `re` string starts with a slash, it must end with a second slash and zero or more flags: "+r);n=r.slice(o+1),r=r.slice(1,o)}return new RegExp(r,n)}function St(t){return t.replace(/\\`/g,"`")}function ne(t){return t.replace(/[\\^$.*+?()[\]{}|=!<>:-]/g,"\\$&")}var Y=t=>{let{value:e,scope:r=[],escape:n=!1,flags:o=""}=t,s=r.map(c=>E(c).get);if(r.length===0||!e)return c=>c;let i=n===!0?re`/${e}/${o}`:new RegExp(e,o);return c=>c.filter(a=>s.some(l=>i.test(String(l(a)))))};var Lt=()=>{let t={},e={on(r,...n){return t[r]=(t[r]||[]).concat(n),e},dispatch(r,...n){let o=t[r]||[];for(let s of o)s(...n);return e},off(r,...n){if(r===void 0)Object.keys(t).forEach(o=>e.off(o));else{let o=t[r]||[];t[r]=n.length?o.filter(s=>!n.includes(s)):[]}return e}};return e},x=t=>({emitter:e})=>{let r={},n={off(o){return o||Object.keys(r).forEach(s=>n.off(s)),r[o]&&e.off(o,...r[o]),n}};for(let o of Object.keys(t)){let s=t[o];r[o]=[],n[s]=function(...i){return r[o]=r[o].concat(i),e.on(o,...i),n}}return n};var Nt=({page:t=1,size:e}={page:1})=>(r=[])=>{let n=e||r.length,o=(t-1)*n;return r.slice(o,o+n)},Dt;(function(t){t.TOGGLE_SORT="TOGGLE_SORT",t.DISPLAY_CHANGED="DISPLAY_CHANGED",t.PAGE_CHANGED="CHANGE_PAGE",t.EXEC_CHANGED="EXEC_CHANGED",t.FILTER_CHANGED="FILTER_CHANGED",t.SUMMARY_CHANGED="SUMMARY_CHANGED",t.SEARCH_CHANGED="SEARCH_CHANGED",t.EXEC_ERROR="EXEC_ERROR"})(Dt||(Dt={}));var H=t=>{let{get:e,set:r}=E(t);return{get:e,set:T(r)}},oe=({sortFactory:t,tableState:e,data:r,filterFactory:n,searchFactory:o})=>{let s=r.length,i=r,c=Lt(),a=H("sort"),l=H("slice"),g=H("filter"),v=H("search");c.on("SUMMARY_CHANGED",({filteredCount:u})=>{s=u});let zt=u=>Object.assign({},u),et=T(c.dispatch,2),Ut=u=>(i=u,et("SUMMARY_CHANGED",{page:e.slice.page,size:e.slice.size,filteredCount:u.length})),Yt=({processingDelay:u=20}={processingDelay:20})=>{c.dispatch("EXEC_CHANGED",{working:!0}),setTimeout(()=>{try{let d=n(g.get(e)),y=o(v.get(e)),N=t(a.get(e)),w=Nt(l.get(e)),P=p(d,y,B(Ut),N,w)(r);c.dispatch("DISPLAY_CHANGED",P.map(nt=>({index:r.indexOf(nt),value:nt})))}catch(d){c.dispatch("EXEC_ERROR",d)}finally{c.dispatch("EXEC_CHANGED",{working:!1})}},u)},R=T((u,d,y)=>p(zt,B(et(d)),u.set(e))(y)),qt=()=>R(l,"CHANGE_PAGE",Object.assign({},l.get(e),{page:1})),k=(u,d)=>{let y=p(R(u,d),qt,()=>c.exec());return(N={})=>y(N)},Xt={sort:k(a,"TOGGLE_SORT"),filter:k(g,"FILTER_CHANGED"),search:k(v,"SEARCH_CHANGED"),slice:p(R(l,"CHANGE_PAGE"),()=>c.exec()),exec:Yt,async eval(u=e){let d=t(a.get(u)),y=o(v.get(u)),N=n(g.get(u)),w=Nt(l.get(u));return p(N,y,d,w)(r).map(P=>({index:r.indexOf(P),value:P}))},onDisplayChange(u){c.on("DISPLAY_CHANGED",u)},getTableState(){return JSON.parse(JSON.stringify(e))},getMatchingItems(){return[...i]}},rt=Object.assign(c,Xt);return Object.defineProperties(rt,{filteredCount:{get(){return s}},length:{get(){return r.length}}}),rt},se=x({FILTER_CHANGED:"onFilterChange"}),Tt;(function(t){t.BOOLEAN="boolean",t.NUMBER="number",t.DATE="date",t.STRING="string"})(Tt||(Tt={}));var Ht=({table:t,pointer:e,operator:r="includes",type:n="string"})=>{let o=se({emitter:t});return Object.assign({filter(s){let i=this.state();return s===void 0?delete i[e]:Object.assign(i,{[e]:[{value:s,operator:r,type:n}]}),t.filter(i)},state(){return t.getTableState().filter||{}}},o)},ie=x({SEARCH_CHANGED:"onSearchChange"}),O=({table:t,scope:e=[]})=>{let r=ie({emitter:t});return Object.assign(r,{search(n,o={}){return t.search(Object.assign({},{value:n,scope:e},o))},state(){return t.getTableState().search}},r)},ce=x({CHANGE_PAGE:"onPageChange",SUMMARY_CHANGED:"onSummaryChange"}),S=({table:t})=>{let{slice:{page:e,size:r}}=t.getTableState(),n=t.filteredCount,o=r?Math.ceil(n/r):1,s=ce({emitter:t}),i={selectPage(a){return t.slice({page:a,size:r})},selectNextPage(){return i.selectPage(e+1)},selectPreviousPage(){return i.selectPage(e-1)},changePageSize(a){return t.slice({page:1,size:a})},isPreviousPageEnabled(){return e>1},isNextPageEnabled(){return o>e},state(){return Object.assign(t.getTableState().slice,{filteredCount:n,pageCount:o})}},c=Object.assign(i,s);return c.onSummaryChange(({page:a,size:l,filteredCount:g})=>{e=a,r=l,n=g,o=r?Math.ceil(n/r):1}),c},ae=(t,e)=>{let r=null;return(...n)=>{r!==null&&clearTimeout(r),r=setTimeout(()=>t(...n),e)}},me=x({TOGGLE_SORT:"onSortToggle"}),Pt=["asc","desc"],Ot=({pointer:t,table:e,cycle:r=!1,debounceTime:n=0})=>{let o=r===!0?["none"].concat(Pt):[...Pt].reverse(),s=ae(e.sort,n),i=0,c=me({emitter:e}),a=Object.assign({toggle(){i++;let v=o[i%o.length];return s({pointer:t,direction:v})},state(){return e.getTableState().sort}},c);a.onSortToggle(({pointer:v})=>{i=t!==v?0:i});let{pointer:l,direction:g="asc"}=a.state();return i=l===t?g==="asc"?1:2:0,a},Qe=x({SUMMARY_CHANGED:"onSummaryChange"});var le=x({EXEC_CHANGED:"onExecutionChange"}),bt=({table:t})=>le({emitter:t}),Gt=()=>({sort:{},slice:{page:1},filter:{},search:{}}),Rt=({sortFactory:t=$,filterFactory:e=U,searchFactory:r=Y,tableState:n=Gt(),data:o=[]}={sortFactory:$,filterFactory:U,searchFactory:Y,tableState:Gt(),data:[]},...s)=>{let i=oe({sortFactory:t,filterFactory:e,tableState:n,data:o,searchFactory:r});return s.reduce((c,a)=>Object.assign(c,a({sortFactory:t,filterFactory:e,searchFactory:r,tableState:n,data:o,table:i})),i)};var kt=({table:t,el:e})=>{let r=bt({table:t});return r.onExecutionChange(function({working:n}){e.classList.remove("st-working"),n===!0&&e.classList.add("st-working")}),r};var wt=({el:t,table:e,conf:r={}})=>{let n=r.pointer||t.getAttribute("data-st-sort"),o=r.cycle||t.hasAttribute("data-st-sort-cycle"),s=Ot({pointer:n,table:e,cycle:o});s.onSortToggle(({pointer:c,direction:a})=>{if(t.classList.remove("st-sort-asc","st-sort-desc"),n===c&&a!=="none"){let l=a==="asc"?"st-sort-asc":"st-sort-desc";t.classList.add(l)}});let i=()=>s.toggle();return t.addEventListener("click",i),s};function b(t,e){let r;return n=>{r&&clearTimeout(r),r=setTimeout(function(){t(n)},e)}}var Mt=({table:t,el:e,delay:r=400,conf:n={}})=>{let o=n.pointer||e.getAttribute("data-st-filter"),s=n.operator||e.getAttribute("data-st-filter-operator")||"includes",i=e.hasAttribute("type")?e.getAttribute("type"):"string",c=n.type||e.getAttribute("data-st-filter-type");c||(c=["date","number"].includes(i)?i:"string");let a=Ht({table:t,pointer:o,type:c,operator:s}),l=b(g=>a.filter(e.value),r);return e.addEventListener("input",l),e.tagName==="SELECT"&&e.addEventListener("change",l),a};var It=({el:t,table:e,delay:r=400,conf:n={}})=>{let o=n.scope||(t.getAttribute("data-st-search")||"").split(",").map(a=>a.trim()),s=n.flags||t.getAttribute("data-st-search-flags")||"",i=O({table:e,scope:o}),c=b(()=>{i.search(t.value,{flags:s})},r);t.addEventListener("input",c)};var Bt=({el:t,table:e})=>{let r=(n,o)=>Array.from(t.querySelectorAll(o)).forEach(s=>n({el:s,table:e}));return r(wt,"[data-st-sort]"),r(kt,"[data-st-loading-indicator]"),r(It,"[data-st-search]"),r(Mt,"[data-st-filter]"),e};function ue(t){return`<td>${t.slot}</td><td>${lt(t.id,t.name)}</td><td>${t.level}</td><td>${t.rank_name}</td><td>${t.gxp}</td><td>${t.activity}</td><td>${t.pack}</td><td>${t.stam}</td>`}function pe(t){return t.dom||(t.dom=Et({innerHTML:ue(t)})),t.dom}function q(t,e,r){let n=t.tBodies[0],o=gt();for(let s of r)o.appendChild(pe(s.value));t.replaceChild(o,n)}var L=f(),W=h({innerHTML:"\xAB"}),Q=h({innerHTML:"\u2039"}),Ft=h({disabled:!0,innerHTML:"1"}),J=h({innerHTML:"\u203A"}),X=h({innerHTML:"\xBB"});function fe(t){let e=1,r=S({table:t});return r.onSummaryChange(({page:n,size:o,filteredCount:s})=>{W.disabled=!r.isPreviousPageEnabled(),Q.disabled=!r.isPreviousPageEnabled(),J.disabled=!r.isNextPageEnabled(),X.disabled=!r.isNextPageEnabled(),C(n,Ft),e=Math.ceil(s/o)}),A(X,()=>r.selectPage(e)),r}function de(){m(L,W),m(L,Q),m(L,Ft),m(L,J),m(L,X)}function V(t,e){let r=fe(e);A(W,()=>r.selectPage(1)),A(Q,()=>r.selectPreviousPage()),A(J,()=>r.selectNextPage()),de(),m(t,L)}var ge=()=>at({dataset:{stSearch:"name, rank_name",stSearchFlags:"i"},placeholder:"Enter search term",required:!0,type:"text"});function j(t,e){let r=f({className:"fsh-search-wrapper"}),n=ge(),o=h({innerHTML:"&times;",type:"button"}),s=O({table:e});A(o,()=>{n.value="",n.focus(),s.search("")}),m(r,n),m(r,o),m(t,r)}function K(t,e){let r=ht({innerHTML:'<option value="25">25</option><option value="50">50</option><option value="0" selected>All</option>'}),n=f();m(n,r),m(t,n);let o=S({table:e});ot(r,"change",s=>{o.changePageSize(Number(s.target.value))})}function Z(t,e,r){let n=f();m(t,n),S({table:e}).onSummaryChange(({page:s,size:i,filteredCount:c})=>{let a=0;c&&(a=1),C(`showing ${(s-1)*i+a} - ${Math.min(c,s*i)} of ${c} (${r.length} total)`,n)})}function he(t,e){return e.equipped||(t[e.player_id]=t[e.player_id]||[],t[e.player_id].push(e)),t}var Ee=(t,e)=>({...e,rank_name:t}),ve=t=>t.members.map(D(Ee,t.name)),ye=t=>t.r.flatMap(ve);function Ae(t,e,r){return{...e,slot:r+1,name_lower:M(e.name),lvl_reverse:0-e.level,rank_lower:M(st(e.rank_name)),gxp:I(e.guild_xp),gxp_reverse:0-e.guild_xp,activity:pt(e.last_activity),act:e.last_activity-ct(),pack:(t[e.id]||[]).length,pack_reverse:0-(t[e.id]||[]).length,stam:I(e.max_stamina),stam_reverse:0-e.max_stamina}}function tt([t,e]){let r=t.items.reduce(he,{});return ye(e).map(D(Ae,r))}var Ce='<thead><tr><th data-st-sort="slot" class="st-sort-asc">Slot</th><th data-st-sort="name_lower">Name</th><th class="st-sort-reverse" data-st-sort="lvl_reverse">Level</th><th data-st-sort="rank_lower">Rank</th><th class="st-sort-reverse" data-st-sort="gxp_reverse">GXP</th><th class="st-sort-reverse" data-st-sort="act">Activity</th><th class="st-sort-reverse" data-st-sort="pack_reverse">Pack</th><th class="st-sort-reverse" data-st-sort="stam_reverse">Stam</th></tr></thead><tbody></tbody>',$t=Ce;function xe(t){return m(t,ft({className:"whosGotWhat",innerHTML:$t}))}function _e(t){let e=m(t,f({className:"st-top-container"})),r=m(t,f()),n=xe(r),o=m(t,f({className:"st-bottom-container"}));return{top:e,domTable:n,bottom:o}}function Se(t){return Rt({data:t,tableState:{sort:{pointer:"slot",direction:"asc"},slice:{page:1,size:0},filter:{},search:{}}})}function Le(t,e,r,n){K(e,n),j(e,n),Z(r,n,t),V(r,n)}function Ne(t,e,r){let n=Bt({el:t,table:e});n.onDisplayChange(D(q,r,e)),n.exec()}function De(t,e){let r=tt(e);C("",t);let n=m(t,f()),{top:o,domTable:s,bottom:i}=_e(n),c=Se(r);Le(r,o,i,c),Ne(n,c,s)}function Te(){let t=it();C("Loading...",t),dt([mt(),ut()],e=>De(t,e))}export{Te as default};
//# sourceMappingURL=whosGotWhat-566NRTC3.js.map
