import{a as z}from"./chunk-PISTRTHV.js";import{a as D}from"./chunk-FJM5DSKB.js";import{a as W}from"./chunk-7M4F3JTZ.js";import{a as V}from"./chunk-OORQDBQC.js";import{a as U,b as j}from"./chunk-K4ZEWDXD.js";import{a as Y}from"./chunk-2L2PIYGC.js";import{a as M}from"./chunk-SYWE2KWN.js";import{a as s}from"./chunk-XAIJKPRR.js";import{a as G}from"./chunk-C4NBQWCM.js";import{a as p}from"./chunk-WNN3Q5TQ.js";import{a as l}from"./chunk-MDONIUUG.js";import{a as y}from"./chunk-ADRJRS7A.js";import{a as _}from"./chunk-E2TRAGUE.js";import{a as u}from"./chunk-7GBB3QCV.js";import{a as d}from"./chunk-2D6L2THT.js";import{a as I}from"./chunk-VPJYHXX4.js";import{a as $}from"./chunk-NRKJIV3C.js";import{a as R}from"./chunk-SF3VAYKI.js";import{a as q}from"./chunk-TGPTDRQZ.js";import{a as H}from"./chunk-RDOC4HAS.js";import{a as B}from"./chunk-2S22FDHI.js";import{a as n}from"./chunk-GWTCUF2Q.js";import{a as E}from"./chunk-7KD3BGAV.js";import{b as c}from"./chunk-UELYWXNW.js";import{La as x,Ma as C,Na as f,U as A,ua as g,w}from"./chunk-4JMWSEZ5.js";var Q=e=>[e,p(e.href,"target_username")],X=async([e,r])=>[e,r,await U(r)],J=e=>e?' class="pmAttackUrl"':"";function K(e,[r,t]){G(r,` | <a${J(e)} href="${A}${t}">Attack</a>`)}async function h(e,r){let t=n('a[href*="=createsecure&"]',e);if(!t.length)return;let o=t.map(Q);(await Promise.all(o.map(X))).filter(([,,i])=>!i).forEach(i=>K(r,i))}var O=e=>e?' class="pmIgnoreUrl"':"",Z=(e,r)=>`<a${O(e)} href="${w}${d(r)}" data-tooltip="Add to Ignore List">Ignore</a>`;function ee(e,[r,t]){l(t.cells[1],`<font size="1"><br>[ ${Z(e,r)} ]</font>`)}function L(e,r){let t=n(f,e);if(t.length===0)return;t.map(a=>[a,s(a)]).forEach(a=>ee(r,a))}var F="fshGreen",N="fshRed",re=([,e])=>I(x,e),te=async([e,r,t])=>[r,t,await z(r,D(e))],oe=([,,e])=>e&&e.s,ne=e=>[18,21,31].includes(e.id),P=e=>`<span class="fshRed fshBold">${e}.</span>`;function ae(e){return e.includes("You were victorious over")?[F,`You were <span class="${F}">victorious</span> over `]:e.includes("You were defeated by")?[N,`You were <span class="${N}">defeated</span> by `]:["",null]}function se(e){return e.id===18?P(`${e.params[0]} leeched the buff '${e.params[1]}'`):e.id===21?P(`${e.params[0]} was mesmerized by Spell Breaker, losing the '${e.params[1]}' buff`):P(`${e.params[0]} activated Fist Fight`)}function m(e,r,t){return e!==0?`${r}:<span class="${t}">${B(e)}</span> `:""}function ie(e,r){let t=e.specials.filter(ne).map(se),o=m(e.xp_gain,"XP stolen",r)+m(e.gold_gain,"Gold lost",r)+m(e.gold_stolen,"Gold stolen",r)+m(e.pvp_prestige_gain,"Prestige gain",r)+m(e.pvp_rating_change,"PvP change",r);return o+(o&&t.length?"<br>":"")+(t.length?`${t.join("<br>")}`:"")}function me([e,r,t]){let[o,a]=ae(r);a&&(e.cells[2].firstChild.remove(),Y(e.cells[2],a));let i=ie(t.r.combat,o);i&&u(e.cells[2],_({innerHTML:i}))}function le(e){return e.map(r=>[r,s(r)]).filter(re).map(([r,t])=>[r,t,t.cells[2].innerHTML]).map(te)}async function k(e){let r=n('a[href*="&combat_id="]',e);if(r.length===0)return;(await Promise.all(le(r))).filter(oe).forEach(me)}function T(e){n('a[href*="=trade&"]',e).filter(r=>!p(r.href,"subcmd")).forEach(r=>y("Trade",r)),n('a[href*="=createsecure&"]',e).forEach(r=>y("ST",r))}function fe(e,r){let[,,t]=e.rows[0].cells;t&&!r&&l(t,'&nbsp;&nbsp;<span class="fshWhite">(Guild mates show up in <span class="fshGreen">green</span>)</span>')}async function ce(e){let[,r]=await j(e);return[`.fshPlayerColoring tr:nth-of-type(${s(e).rowIndex+1}) td:nth-of-type(3) > a:first-of-type`,r]}function pe(e,[r,t]){return e[t]?e[t].push(r):e[t]=[r],e}var de={guild:"green",ally:"blue",enemy:"red"};function ue([e,r]){return`${r.join(", ")} { color: ${de[e]}; }`}var ge=([,e])=>e;function ye(e){return R(e.filter(ge).reduce(pe,{})).map(ue)}function he(e,r,t){let o=ye(r);o.length&&(fe(e,t),e.classList.add("fshPlayerColoring"),u(document.body,M(o.join(`
`))))}async function v(e,r){let t=n(f,e);if(!t.length)return;let o=await Promise.all(t.map(ce));he(e,o,r)}var S=0,Le=/You ranked \w{3} in your PvP Band! You have gained \d x PvP Ladder Token/;function Pe(e){return Le.test($(e.cells[2]))}function ke(e){let r=V(d(e.cells[1]));r>S&&(q(g,r),S=r)}function b(e){S=c(g),n(C,e).map(s).filter(Pe).forEach(ke)}var Te=[["addIgnoreLink",L],["colorPlayerNames",v],["addAttackLinkToLog",h],["changeButtonLabels",T],["trackLadderReset",b],["showPvPSummaryInLog",k]];function ve(e,r,[t,o]){c(t)&&o(e,r)}function Se(e,r){Te.forEach(E(ve,e,r))}function be(e){if(H())return;let r=W();r&&Se(r,e)}export{be as a};
//# sourceMappingURL=chunk-XRNUSR2C.js.map
